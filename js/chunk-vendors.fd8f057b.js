(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-vendors"],{"01f9":function(e,t,n){"use strict";var i=n("2d00"),r=n("5ca1"),o=n("2aba"),s=n("32e9"),a=n("84f2"),l=n("41a0"),u=n("7f20"),c=n("38fd"),d=n("2b4c")("iterator"),h=!([].keys&&"next"in[].keys()),f="@@iterator",p="keys",m="values",g=function(){return this};e.exports=function(e,t,n,y,v,b,E){l(n,t,y);var _,x,T,S=function(e){if(!h&&e in M)return M[e];switch(e){case p:return function(){return new n(this,e)};case m:return function(){return new n(this,e)}}return function(){return new n(this,e)}},w=t+" Iterator",I=v==m,D=!1,M=e.prototype,A=M[d]||M[f]||v&&M[v],L=A||S(v),R=v?I?S("entries"):L:void 0,P="Array"==t&&M.entries||A;if(P&&(T=c(P.call(new e)),T!==Object.prototype&&T.next&&(u(T,w,!0),i||"function"==typeof T[d]||s(T,d,g))),I&&A&&A.name!==m&&(D=!0,L=function(){return A.call(this)}),i&&!E||!h&&!D&&M[d]||s(M,d,L),a[t]=L,a[w]=g,v)if(_={values:I?L:S(m),keys:b?L:S(p),entries:R},E)for(x in _)x in M||o(M,x,_[x]);else r(r.P+r.F*(h||D),t,_);return _}},"07e3":function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},"097d":function(e,t,n){"use strict";var i=n("5ca1"),r=n("8378"),o=n("7726"),s=n("ebd6"),a=n("bcaa");i(i.P+i.R,"Promise",{finally:function(e){var t=s(this,r.Promise||o.Promise),n="function"==typeof e;return this.then(n?function(n){return a(t,e()).then(function(){return n})}:e,n?function(n){return a(t,e()).then(function(){throw n})}:e)}})},"0a49":function(e,t,n){var i=n("9b43"),r=n("626a"),o=n("4bf8"),s=n("9def"),a=n("cd1c");e.exports=function(e,t){var n=1==e,l=2==e,u=3==e,c=4==e,d=6==e,h=5==e||d,f=t||a;return function(t,a,p){for(var m,g,y=o(t),v=r(y),b=i(a,p,3),E=s(v.length),_=0,x=n?f(t,E):l?f(t,0):void 0;E>_;_++)if((h||_ in v)&&(m=v[_],g=b(m,_,y),e))if(n)x[_]=g;else if(g)switch(e){case 3:return!0;case 5:return m;case 6:return _;case 2:x.push(m)}else if(c)return!1;return d?-1:u||c?c:x}}},"0a90":function(e,t,n){var i=n("63b6"),r=n("10ff");i(i.G+i.F*(parseFloat!=r),{parseFloat:r})},"0d58":function(e,t,n){var i=n("ce10"),r=n("e11e");e.exports=Object.keys||function(e){return i(e,r)}},"10ff":function(e,t,n){var i=n("e53d").parseFloat,r=n("a1ce").trim;e.exports=1/i(n("e692")+"-0")!==-1/0?function(e){var t=r(String(e),3),n=i(t);return 0===n&&"-"==t.charAt(0)?-0:n}:i},1169:function(e,t,n){var i=n("2d95");e.exports=Array.isArray||function(e){return"Array"==i(e)}},1495:function(e,t,n){var i=n("86cc"),r=n("cb7c"),o=n("0d58");e.exports=n("9e1e")?Object.defineProperties:function(e,t){r(e);var n,s=o(t),a=s.length,l=0;while(a>l)i.f(e,n=s[l++],t[n]);return e}},1991:function(e,t,n){var i,r,o,s=n("9b43"),a=n("31f4"),l=n("fab2"),u=n("230e"),c=n("7726"),d=c.process,h=c.setImmediate,f=c.clearImmediate,p=c.MessageChannel,m=c.Dispatch,g=0,y={},v="onreadystatechange",b=function(){var e=+this;if(y.hasOwnProperty(e)){var t=y[e];delete y[e],t()}},E=function(e){b.call(e.data)};h&&f||(h=function(e){var t=[],n=1;while(arguments.length>n)t.push(arguments[n++]);return y[++g]=function(){a("function"==typeof e?e:Function(e),t)},i(g),g},f=function(e){delete y[e]},"process"==n("2d95")(d)?i=function(e){d.nextTick(s(b,e,1))}:m&&m.now?i=function(e){m.now(s(b,e,1))}:p?(r=new p,o=r.port2,r.port1.onmessage=E,i=s(o.postMessage,o,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(i=function(e){c.postMessage(e+"","*")},c.addEventListener("message",E,!1)):i=v in u("script")?function(e){l.appendChild(u("script"))[v]=function(){l.removeChild(this),b.call(e)}}:function(e){setTimeout(s(b,e,1),0)}),e.exports={set:h,clear:f}},"1bc3":function(e,t,n){var i=n("f772");e.exports=function(e,t){if(!i(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!i(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},"1ec9":function(e,t,n){var i=n("f772"),r=n("e53d").document,o=i(r)&&i(r.createElement);e.exports=function(e){return o?r.createElement(e):{}}},"1fa8":function(e,t,n){var i=n("cb7c");e.exports=function(e,t,n,r){try{return r?t(i(n)[0],n[1]):t(n)}catch(s){var o=e["return"];throw void 0!==o&&i(o.call(e)),s}}},"230e":function(e,t,n){var i=n("d3f4"),r=n("7726").document,o=i(r)&&i(r.createElement);e.exports=function(e){return o?r.createElement(e):{}}},"23c6":function(e,t,n){var i=n("2d95"),r=n("2b4c")("toStringTag"),o="Arguments"==i(function(){return arguments}()),s=function(e,t){try{return e[t]}catch(n){}};e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=s(t=Object(e),r))?n:o?i(t):"Object"==(a=i(t))&&"function"==typeof t.callee?"Arguments":a}},"25eb":function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},2621:function(e,t){t.f=Object.getOwnPropertySymbols},"27ee":function(e,t,n){var i=n("23c6"),r=n("2b4c")("iterator"),o=n("84f2");e.exports=n("8378").getIteratorMethod=function(e){if(void 0!=e)return e[r]||e["@@iterator"]||o[i(e)]}},2877:function(e,t,n){"use strict";function i(e,t,n,i,r,o,s,a){var l,u="function"===typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=n,u._compiled=!0),i&&(u.functional=!0),o&&(u._scopeId="data-v-"+o),s?(l=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},u._ssrRegister=l):r&&(l=a?function(){r.call(this,this.$root.$options.shadowRoot)}:r),l)if(u.functional){u._injectStyles=l;var c=u.render;u.render=function(e,t){return l.call(t),c(e,t)}}else{var d=u.beforeCreate;u.beforeCreate=d?[].concat(d,l):[l]}return{exports:e,options:u}}n.d(t,"a",function(){return i})},"294c":function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},"2aba":function(e,t,n){var i=n("7726"),r=n("32e9"),o=n("69a8"),s=n("ca5a")("src"),a=n("fa5b"),l="toString",u=(""+a).split(l);n("8378").inspectSource=function(e){return a.call(e)},(e.exports=function(e,t,n,a){var l="function"==typeof n;l&&(o(n,"name")||r(n,"name",t)),e[t]!==n&&(l&&(o(n,s)||r(n,s,e[t]?""+e[t]:u.join(String(t)))),e===i?e[t]=n:a?e[t]?e[t]=n:r(e,t,n):(delete e[t],r(e,t,n)))})(Function.prototype,l,function(){return"function"==typeof this&&this[s]||a.call(this)})},"2aeb":function(e,t,n){var i=n("cb7c"),r=n("1495"),o=n("e11e"),s=n("613b")("IE_PROTO"),a=function(){},l="prototype",u=function(){var e,t=n("230e")("iframe"),i=o.length,r="<",s=">";t.style.display="none",n("fab2").appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write(r+"script"+s+"document.F=Object"+r+"/script"+s),e.close(),u=e.F;while(i--)delete u[l][o[i]];return u()};e.exports=Object.create||function(e,t){var n;return null!==e?(a[l]=i(e),n=new a,a[l]=null,n[s]=e):n=u(),void 0===t?n:r(n,t)}},"2b0e":function(e,t,n){"use strict";(function(e){
/*!
 * Vue.js v2.6.9
 * (c) 2014-2019 Evan You
 * Released under the MIT License.
 */
var n=Object.freeze({});function i(e){return void 0===e||null===e}function r(e){return void 0!==e&&null!==e}function o(e){return!0===e}function s(e){return!1===e}function a(e){return"string"===typeof e||"number"===typeof e||"symbol"===typeof e||"boolean"===typeof e}function l(e){return null!==e&&"object"===typeof e}var u=Object.prototype.toString;function c(e){return"[object Object]"===u.call(e)}function d(e){return"[object RegExp]"===u.call(e)}function h(e){var t=parseFloat(String(e));return t>=0&&Math.floor(t)===t&&isFinite(e)}function f(e){return r(e)&&"function"===typeof e.then&&"function"===typeof e.catch}function p(e){return null==e?"":Array.isArray(e)||c(e)&&e.toString===u?JSON.stringify(e,null,2):String(e)}function m(e){var t=parseFloat(e);return isNaN(t)?e:t}function g(e,t){for(var n=Object.create(null),i=e.split(","),r=0;r<i.length;r++)n[i[r]]=!0;return t?function(e){return n[e.toLowerCase()]}:function(e){return n[e]}}g("slot,component",!0);var y=g("key,ref,slot,slot-scope,is");function v(e,t){if(e.length){var n=e.indexOf(t);if(n>-1)return e.splice(n,1)}}var b=Object.prototype.hasOwnProperty;function E(e,t){return b.call(e,t)}function _(e){var t=Object.create(null);return function(n){var i=t[n];return i||(t[n]=e(n))}}var x=/-(\w)/g,T=_(function(e){return e.replace(x,function(e,t){return t?t.toUpperCase():""})}),S=_(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}),w=/\B([A-Z])/g,I=_(function(e){return e.replace(w,"-$1").toLowerCase()});function D(e,t){function n(n){var i=arguments.length;return i?i>1?e.apply(t,arguments):e.call(t,n):e.call(t)}return n._length=e.length,n}function M(e,t){return e.bind(t)}var A=Function.prototype.bind?M:D;function L(e,t){t=t||0;var n=e.length-t,i=new Array(n);while(n--)i[n]=e[n+t];return i}function R(e,t){for(var n in t)e[n]=t[n];return e}function P(e){for(var t={},n=0;n<e.length;n++)e[n]&&R(t,e[n]);return t}function C(e,t,n){}var N=function(e,t,n){return!1},B=function(e){return e};function F(e,t){if(e===t)return!0;var n=l(e),i=l(t);if(!n||!i)return!n&&!i&&String(e)===String(t);try{var r=Array.isArray(e),o=Array.isArray(t);if(r&&o)return e.length===t.length&&e.every(function(e,n){return F(e,t[n])});if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if(r||o)return!1;var s=Object.keys(e),a=Object.keys(t);return s.length===a.length&&s.every(function(n){return F(e[n],t[n])})}catch(u){return!1}}function k(e,t){for(var n=0;n<e.length;n++)if(F(e[n],t))return n;return-1}function O(e){var t=!1;return function(){t||(t=!0,e.apply(this,arguments))}}var U="data-server-rendered",H=["component","directive","filter"],j=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch"],V={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:N,isReservedAttr:N,isUnknownElement:N,getTagNamespace:C,parsePlatformTagName:B,mustUseProp:N,async:!0,_lifecycleHooks:j},K=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function q(e){var t=(e+"").charCodeAt(0);return 36===t||95===t}function z(e,t,n,i){Object.defineProperty(e,t,{value:n,enumerable:!!i,writable:!0,configurable:!0})}var Y=new RegExp("[^"+K.source+".$_\\d]");function $(e){if(!Y.test(e)){var t=e.split(".");return function(e){for(var n=0;n<t.length;n++){if(!e)return;e=e[t[n]]}return e}}}var W,G="__proto__"in{},X="undefined"!==typeof window,Q="undefined"!==typeof WXEnvironment&&!!WXEnvironment.platform,J=Q&&WXEnvironment.platform.toLowerCase(),Z=X&&window.navigator.userAgent.toLowerCase(),ee=Z&&/msie|trident/.test(Z),te=Z&&Z.indexOf("msie 9.0")>0,ne=Z&&Z.indexOf("edge/")>0,ie=(Z&&Z.indexOf("android"),Z&&/iphone|ipad|ipod|ios/.test(Z)||"ios"===J),re=(Z&&/chrome\/\d+/.test(Z),Z&&/phantomjs/.test(Z),Z&&Z.match(/firefox\/(\d+)/)),oe={}.watch,se=!1;if(X)try{var ae={};Object.defineProperty(ae,"passive",{get:function(){se=!0}}),window.addEventListener("test-passive",null,ae)}catch(xs){}var le=function(){return void 0===W&&(W=!X&&!Q&&"undefined"!==typeof e&&(e["process"]&&"server"===e["process"].env.VUE_ENV)),W},ue=X&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function ce(e){return"function"===typeof e&&/native code/.test(e.toString())}var de,he="undefined"!==typeof Symbol&&ce(Symbol)&&"undefined"!==typeof Reflect&&ce(Reflect.ownKeys);de="undefined"!==typeof Set&&ce(Set)?Set:function(){function e(){this.set=Object.create(null)}return e.prototype.has=function(e){return!0===this.set[e]},e.prototype.add=function(e){this.set[e]=!0},e.prototype.clear=function(){this.set=Object.create(null)},e}();var fe=C,pe=0,me=function(){this.id=pe++,this.subs=[]};me.prototype.addSub=function(e){this.subs.push(e)},me.prototype.removeSub=function(e){v(this.subs,e)},me.prototype.depend=function(){me.target&&me.target.addDep(this)},me.prototype.notify=function(){var e=this.subs.slice();for(var t=0,n=e.length;t<n;t++)e[t].update()},me.target=null;var ge=[];function ye(e){ge.push(e),me.target=e}function ve(){ge.pop(),me.target=ge[ge.length-1]}var be=function(e,t,n,i,r,o,s,a){this.tag=e,this.data=t,this.children=n,this.text=i,this.elm=r,this.ns=void 0,this.context=o,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=t&&t.key,this.componentOptions=s,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=a,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1},Ee={child:{configurable:!0}};Ee.child.get=function(){return this.componentInstance},Object.defineProperties(be.prototype,Ee);var _e=function(e){void 0===e&&(e="");var t=new be;return t.text=e,t.isComment=!0,t};function xe(e){return new be(void 0,void 0,void 0,String(e))}function Te(e){var t=new be(e.tag,e.data,e.children&&e.children.slice(),e.text,e.elm,e.context,e.componentOptions,e.asyncFactory);return t.ns=e.ns,t.isStatic=e.isStatic,t.key=e.key,t.isComment=e.isComment,t.fnContext=e.fnContext,t.fnOptions=e.fnOptions,t.fnScopeId=e.fnScopeId,t.asyncMeta=e.asyncMeta,t.isCloned=!0,t}var Se=Array.prototype,we=Object.create(Se),Ie=["push","pop","shift","unshift","splice","sort","reverse"];Ie.forEach(function(e){var t=Se[e];z(we,e,function(){var n=[],i=arguments.length;while(i--)n[i]=arguments[i];var r,o=t.apply(this,n),s=this.__ob__;switch(e){case"push":case"unshift":r=n;break;case"splice":r=n.slice(2);break}return r&&s.observeArray(r),s.dep.notify(),o})});var De=Object.getOwnPropertyNames(we),Me=!0;function Ae(e){Me=e}var Le=function(e){this.value=e,this.dep=new me,this.vmCount=0,z(e,"__ob__",this),Array.isArray(e)?(G?Re(e,we):Pe(e,we,De),this.observeArray(e)):this.walk(e)};function Re(e,t){e.__proto__=t}function Pe(e,t,n){for(var i=0,r=n.length;i<r;i++){var o=n[i];z(e,o,t[o])}}function Ce(e,t){var n;if(l(e)&&!(e instanceof be))return E(e,"__ob__")&&e.__ob__ instanceof Le?n=e.__ob__:Me&&!le()&&(Array.isArray(e)||c(e))&&Object.isExtensible(e)&&!e._isVue&&(n=new Le(e)),t&&n&&n.vmCount++,n}function Ne(e,t,n,i,r){var o=new me,s=Object.getOwnPropertyDescriptor(e,t);if(!s||!1!==s.configurable){var a=s&&s.get,l=s&&s.set;a&&!l||2!==arguments.length||(n=e[t]);var u=!r&&Ce(n);Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:function(){var t=a?a.call(e):n;return me.target&&(o.depend(),u&&(u.dep.depend(),Array.isArray(t)&&ke(t))),t},set:function(t){var i=a?a.call(e):n;t===i||t!==t&&i!==i||a&&!l||(l?l.call(e,t):n=t,u=!r&&Ce(t),o.notify())}})}}function Be(e,t,n){if(Array.isArray(e)&&h(t))return e.length=Math.max(e.length,t),e.splice(t,1,n),n;if(t in e&&!(t in Object.prototype))return e[t]=n,n;var i=e.__ob__;return e._isVue||i&&i.vmCount?n:i?(Ne(i.value,t,n),i.dep.notify(),n):(e[t]=n,n)}function Fe(e,t){if(Array.isArray(e)&&h(t))e.splice(t,1);else{var n=e.__ob__;e._isVue||n&&n.vmCount||E(e,t)&&(delete e[t],n&&n.dep.notify())}}function ke(e){for(var t=void 0,n=0,i=e.length;n<i;n++)t=e[n],t&&t.__ob__&&t.__ob__.dep.depend(),Array.isArray(t)&&ke(t)}Le.prototype.walk=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)Ne(e,t[n])},Le.prototype.observeArray=function(e){for(var t=0,n=e.length;t<n;t++)Ce(e[t])};var Oe=V.optionMergeStrategies;function Ue(e,t){if(!t)return e;for(var n,i,r,o=he?Reflect.ownKeys(t):Object.keys(t),s=0;s<o.length;s++)n=o[s],"__ob__"!==n&&(i=e[n],r=t[n],E(e,n)?i!==r&&c(i)&&c(r)&&Ue(i,r):Be(e,n,r));return e}function He(e,t,n){return n?function(){var i="function"===typeof t?t.call(n,n):t,r="function"===typeof e?e.call(n,n):e;return i?Ue(i,r):r}:t?e?function(){return Ue("function"===typeof t?t.call(this,this):t,"function"===typeof e?e.call(this,this):e)}:t:e}function je(e,t){var n=t?e?e.concat(t):Array.isArray(t)?t:[t]:e;return n?Ve(n):n}function Ve(e){for(var t=[],n=0;n<e.length;n++)-1===t.indexOf(e[n])&&t.push(e[n]);return t}function Ke(e,t,n,i){var r=Object.create(e||null);return t?R(r,t):r}Oe.data=function(e,t,n){return n?He(e,t,n):t&&"function"!==typeof t?e:He(e,t)},j.forEach(function(e){Oe[e]=je}),H.forEach(function(e){Oe[e+"s"]=Ke}),Oe.watch=function(e,t,n,i){if(e===oe&&(e=void 0),t===oe&&(t=void 0),!t)return Object.create(e||null);if(!e)return t;var r={};for(var o in R(r,e),t){var s=r[o],a=t[o];s&&!Array.isArray(s)&&(s=[s]),r[o]=s?s.concat(a):Array.isArray(a)?a:[a]}return r},Oe.props=Oe.methods=Oe.inject=Oe.computed=function(e,t,n,i){if(!e)return t;var r=Object.create(null);return R(r,e),t&&R(r,t),r},Oe.provide=He;var qe=function(e,t){return void 0===t?e:t};function ze(e,t){var n=e.props;if(n){var i,r,o,s={};if(Array.isArray(n)){i=n.length;while(i--)r=n[i],"string"===typeof r&&(o=T(r),s[o]={type:null})}else if(c(n))for(var a in n)r=n[a],o=T(a),s[o]=c(r)?r:{type:r};else 0;e.props=s}}function Ye(e,t){var n=e.inject;if(n){var i=e.inject={};if(Array.isArray(n))for(var r=0;r<n.length;r++)i[n[r]]={from:n[r]};else if(c(n))for(var o in n){var s=n[o];i[o]=c(s)?R({from:o},s):{from:s}}else 0}}function $e(e){var t=e.directives;if(t)for(var n in t){var i=t[n];"function"===typeof i&&(t[n]={bind:i,update:i})}}function We(e,t,n){if("function"===typeof t&&(t=t.options),ze(t,n),Ye(t,n),$e(t),!t._base&&(t.extends&&(e=We(e,t.extends,n)),t.mixins))for(var i=0,r=t.mixins.length;i<r;i++)e=We(e,t.mixins[i],n);var o,s={};for(o in e)a(o);for(o in t)E(e,o)||a(o);function a(i){var r=Oe[i]||qe;s[i]=r(e[i],t[i],n,i)}return s}function Ge(e,t,n,i){if("string"===typeof n){var r=e[t];if(E(r,n))return r[n];var o=T(n);if(E(r,o))return r[o];var s=S(o);if(E(r,s))return r[s];var a=r[n]||r[o]||r[s];return a}}function Xe(e,t,n,i){var r=t[e],o=!E(n,e),s=n[e],a=et(Boolean,r.type);if(a>-1)if(o&&!E(r,"default"))s=!1;else if(""===s||s===I(e)){var l=et(String,r.type);(l<0||a<l)&&(s=!0)}if(void 0===s){s=Qe(i,r,e);var u=Me;Ae(!0),Ce(s),Ae(u)}return s}function Qe(e,t,n){if(E(t,"default")){var i=t.default;return e&&e.$options.propsData&&void 0===e.$options.propsData[n]&&void 0!==e._props[n]?e._props[n]:"function"===typeof i&&"Function"!==Je(t.type)?i.call(e):i}}function Je(e){var t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:""}function Ze(e,t){return Je(e)===Je(t)}function et(e,t){if(!Array.isArray(t))return Ze(t,e)?0:-1;for(var n=0,i=t.length;n<i;n++)if(Ze(t[n],e))return n;return-1}function tt(e,t,n){ye();try{if(t){var i=t;while(i=i.$parent){var r=i.$options.errorCaptured;if(r)for(var o=0;o<r.length;o++)try{var s=!1===r[o].call(i,e,t,n);if(s)return}catch(xs){it(xs,i,"errorCaptured hook")}}}it(e,t,n)}finally{ve()}}function nt(e,t,n,i,r){var o;try{o=n?e.apply(t,n):e.call(t),o&&!o._isVue&&f(o)&&!o._handled&&(o.catch(function(e){return tt(e,i,r+" (Promise/async)")}),o._handled=!0)}catch(xs){tt(xs,i,r)}return o}function it(e,t,n){if(V.errorHandler)try{return V.errorHandler.call(null,e,t,n)}catch(xs){xs!==e&&rt(xs,null,"config.errorHandler")}rt(e,t,n)}function rt(e,t,n){if(!X&&!Q||"undefined"===typeof console)throw e;console.error(e)}var ot,st=!1,at=[],lt=!1;function ut(){lt=!1;var e=at.slice(0);at.length=0;for(var t=0;t<e.length;t++)e[t]()}if("undefined"!==typeof Promise&&ce(Promise)){var ct=Promise.resolve();ot=function(){ct.then(ut),ie&&setTimeout(C)},st=!0}else if(ee||"undefined"===typeof MutationObserver||!ce(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())ot="undefined"!==typeof setImmediate&&ce(setImmediate)?function(){setImmediate(ut)}:function(){setTimeout(ut,0)};else{var dt=1,ht=new MutationObserver(ut),ft=document.createTextNode(String(dt));ht.observe(ft,{characterData:!0}),ot=function(){dt=(dt+1)%2,ft.data=String(dt)},st=!0}function pt(e,t){var n;if(at.push(function(){if(e)try{e.call(t)}catch(xs){tt(xs,t,"nextTick")}else n&&n(t)}),lt||(lt=!0,ot()),!e&&"undefined"!==typeof Promise)return new Promise(function(e){n=e})}var mt=new de;function gt(e){yt(e,mt),mt.clear()}function yt(e,t){var n,i,r=Array.isArray(e);if(!(!r&&!l(e)||Object.isFrozen(e)||e instanceof be)){if(e.__ob__){var o=e.__ob__.dep.id;if(t.has(o))return;t.add(o)}if(r){n=e.length;while(n--)yt(e[n],t)}else{i=Object.keys(e),n=i.length;while(n--)yt(e[i[n]],t)}}}var vt=_(function(e){var t="&"===e.charAt(0);e=t?e.slice(1):e;var n="~"===e.charAt(0);e=n?e.slice(1):e;var i="!"===e.charAt(0);return e=i?e.slice(1):e,{name:e,once:n,capture:i,passive:t}});function bt(e,t){function n(){var e=arguments,i=n.fns;if(!Array.isArray(i))return nt(i,null,arguments,t,"v-on handler");for(var r=i.slice(),o=0;o<r.length;o++)nt(r[o],null,e,t,"v-on handler")}return n.fns=e,n}function Et(e,t,n,r,s,a){var l,u,c,d;for(l in e)u=e[l],c=t[l],d=vt(l),i(u)||(i(c)?(i(u.fns)&&(u=e[l]=bt(u,a)),o(d.once)&&(u=e[l]=s(d.name,u,d.capture)),n(d.name,u,d.capture,d.passive,d.params)):u!==c&&(c.fns=u,e[l]=c));for(l in t)i(e[l])&&(d=vt(l),r(d.name,t[l],d.capture))}function _t(e,t,n){var s;e instanceof be&&(e=e.data.hook||(e.data.hook={}));var a=e[t];function l(){n.apply(this,arguments),v(s.fns,l)}i(a)?s=bt([l]):r(a.fns)&&o(a.merged)?(s=a,s.fns.push(l)):s=bt([a,l]),s.merged=!0,e[t]=s}function xt(e,t,n){var o=t.options.props;if(!i(o)){var s={},a=e.attrs,l=e.props;if(r(a)||r(l))for(var u in o){var c=I(u);Tt(s,l,u,c,!0)||Tt(s,a,u,c,!1)}return s}}function Tt(e,t,n,i,o){if(r(t)){if(E(t,n))return e[n]=t[n],o||delete t[n],!0;if(E(t,i))return e[n]=t[i],o||delete t[i],!0}return!1}function St(e){for(var t=0;t<e.length;t++)if(Array.isArray(e[t]))return Array.prototype.concat.apply([],e);return e}function wt(e){return a(e)?[xe(e)]:Array.isArray(e)?Dt(e):void 0}function It(e){return r(e)&&r(e.text)&&s(e.isComment)}function Dt(e,t){var n,s,l,u,c=[];for(n=0;n<e.length;n++)s=e[n],i(s)||"boolean"===typeof s||(l=c.length-1,u=c[l],Array.isArray(s)?s.length>0&&(s=Dt(s,(t||"")+"_"+n),It(s[0])&&It(u)&&(c[l]=xe(u.text+s[0].text),s.shift()),c.push.apply(c,s)):a(s)?It(u)?c[l]=xe(u.text+s):""!==s&&c.push(xe(s)):It(s)&&It(u)?c[l]=xe(u.text+s.text):(o(e._isVList)&&r(s.tag)&&i(s.key)&&r(t)&&(s.key="__vlist"+t+"_"+n+"__"),c.push(s)));return c}function Mt(e){var t=e.$options.provide;t&&(e._provided="function"===typeof t?t.call(e):t)}function At(e){var t=Lt(e.$options.inject,e);t&&(Ae(!1),Object.keys(t).forEach(function(n){Ne(e,n,t[n])}),Ae(!0))}function Lt(e,t){if(e){for(var n=Object.create(null),i=he?Reflect.ownKeys(e):Object.keys(e),r=0;r<i.length;r++){var o=i[r];if("__ob__"!==o){var s=e[o].from,a=t;while(a){if(a._provided&&E(a._provided,s)){n[o]=a._provided[s];break}a=a.$parent}if(!a)if("default"in e[o]){var l=e[o].default;n[o]="function"===typeof l?l.call(t):l}else 0}}return n}}function Rt(e,t){if(!e||!e.length)return{};for(var n={},i=0,r=e.length;i<r;i++){var o=e[i],s=o.data;if(s&&s.attrs&&s.attrs.slot&&delete s.attrs.slot,o.context!==t&&o.fnContext!==t||!s||null==s.slot)(n.default||(n.default=[])).push(o);else{var a=s.slot,l=n[a]||(n[a]=[]);"template"===o.tag?l.push.apply(l,o.children||[]):l.push(o)}}for(var u in n)n[u].every(Pt)&&delete n[u];return n}function Pt(e){return e.isComment&&!e.asyncFactory||" "===e.text}function Ct(e,t,i){var r,o=!e||!!e.$stable,s=Object.keys(t).length>0,a=e&&e.$key;if(e){if(e._normalized)return e._normalized;if(o&&i&&i!==n&&a===i.$key&&!s&&!i.$hasNormal)return i;for(var l in r={},e)e[l]&&"$"!==l[0]&&(r[l]=Nt(t,l,e[l]))}else r={};for(var u in t)u in r||(r[u]=Bt(t,u));return e&&Object.isExtensible(e)&&(e._normalized=r),z(r,"$stable",o),z(r,"$key",a),z(r,"$hasNormal",s),r}function Nt(e,t,n){var i=function(){var e=arguments.length?n.apply(null,arguments):n({});return e=e&&"object"===typeof e&&!Array.isArray(e)?[e]:wt(e),e&&(0===e.length||1===e.length&&e[0].isComment)?void 0:e};return n.proxy&&Object.defineProperty(e,t,{get:i,enumerable:!0,configurable:!0}),i}function Bt(e,t){return function(){return e[t]}}function Ft(e,t){var n,i,o,s,a;if(Array.isArray(e)||"string"===typeof e)for(n=new Array(e.length),i=0,o=e.length;i<o;i++)n[i]=t(e[i],i);else if("number"===typeof e)for(n=new Array(e),i=0;i<e;i++)n[i]=t(i+1,i);else if(l(e))if(he&&e[Symbol.iterator]){n=[];var u=e[Symbol.iterator](),c=u.next();while(!c.done)n.push(t(c.value,n.length)),c=u.next()}else for(s=Object.keys(e),n=new Array(s.length),i=0,o=s.length;i<o;i++)a=s[i],n[i]=t(e[a],a,i);return r(n)||(n=[]),n._isVList=!0,n}function kt(e,t,n,i){var r,o=this.$scopedSlots[e];o?(n=n||{},i&&(n=R(R({},i),n)),r=o(n)||t):r=this.$slots[e]||t;var s=n&&n.slot;return s?this.$createElement("template",{slot:s},r):r}function Ot(e){return Ge(this.$options,"filters",e,!0)||B}function Ut(e,t){return Array.isArray(e)?-1===e.indexOf(t):e!==t}function Ht(e,t,n,i,r){var o=V.keyCodes[t]||n;return r&&i&&!V.keyCodes[t]?Ut(r,i):o?Ut(o,e):i?I(i)!==t:void 0}function jt(e,t,n,i,r){if(n)if(l(n)){var o;Array.isArray(n)&&(n=P(n));var s=function(s){if("class"===s||"style"===s||y(s))o=e;else{var a=e.attrs&&e.attrs.type;o=i||V.mustUseProp(t,a,s)?e.domProps||(e.domProps={}):e.attrs||(e.attrs={})}var l=T(s),u=I(s);if(!(l in o)&&!(u in o)&&(o[s]=n[s],r)){var c=e.on||(e.on={});c["update:"+s]=function(e){n[s]=e}}};for(var a in n)s(a)}else;return e}function Vt(e,t){var n=this._staticTrees||(this._staticTrees=[]),i=n[e];return i&&!t?i:(i=n[e]=this.$options.staticRenderFns[e].call(this._renderProxy,null,this),qt(i,"__static__"+e,!1),i)}function Kt(e,t,n){return qt(e,"__once__"+t+(n?"_"+n:""),!0),e}function qt(e,t,n){if(Array.isArray(e))for(var i=0;i<e.length;i++)e[i]&&"string"!==typeof e[i]&&zt(e[i],t+"_"+i,n);else zt(e,t,n)}function zt(e,t,n){e.isStatic=!0,e.key=t,e.isOnce=n}function Yt(e,t){if(t)if(c(t)){var n=e.on=e.on?R({},e.on):{};for(var i in t){var r=n[i],o=t[i];n[i]=r?[].concat(r,o):o}}else;return e}function $t(e,t,n,i){t=t||{$stable:!n};for(var r=0;r<e.length;r++){var o=e[r];Array.isArray(o)?$t(o,t,n):o&&(o.proxy&&(o.fn.proxy=!0),t[o.key]=o.fn)}return i&&(t.$key=i),t}function Wt(e,t){for(var n=0;n<t.length;n+=2){var i=t[n];"string"===typeof i&&i&&(e[t[n]]=t[n+1])}return e}function Gt(e,t){return"string"===typeof e?t+e:e}function Xt(e){e._o=Kt,e._n=m,e._s=p,e._l=Ft,e._t=kt,e._q=F,e._i=k,e._m=Vt,e._f=Ot,e._k=Ht,e._b=jt,e._v=xe,e._e=_e,e._u=$t,e._g=Yt,e._d=Wt,e._p=Gt}function Qt(e,t,i,r,s){var a,l=this,u=s.options;E(r,"_uid")?(a=Object.create(r),a._original=r):(a=r,r=r._original);var c=o(u._compiled),d=!c;this.data=e,this.props=t,this.children=i,this.parent=r,this.listeners=e.on||n,this.injections=Lt(u.inject,r),this.slots=function(){return l.$slots||Ct(e.scopedSlots,l.$slots=Rt(i,r)),l.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return Ct(e.scopedSlots,this.slots())}}),c&&(this.$options=u,this.$slots=this.slots(),this.$scopedSlots=Ct(e.scopedSlots,this.$slots)),u._scopeId?this._c=function(e,t,n,i){var o=dn(a,e,t,n,i,d);return o&&!Array.isArray(o)&&(o.fnScopeId=u._scopeId,o.fnContext=r),o}:this._c=function(e,t,n,i){return dn(a,e,t,n,i,d)}}function Jt(e,t,i,o,s){var a=e.options,l={},u=a.props;if(r(u))for(var c in u)l[c]=Xe(c,u,t||n);else r(i.attrs)&&en(l,i.attrs),r(i.props)&&en(l,i.props);var d=new Qt(i,l,s,o,e),h=a.render.call(null,d._c,d);if(h instanceof be)return Zt(h,i,d.parent,a,d);if(Array.isArray(h)){for(var f=wt(h)||[],p=new Array(f.length),m=0;m<f.length;m++)p[m]=Zt(f[m],i,d.parent,a,d);return p}}function Zt(e,t,n,i,r){var o=Te(e);return o.fnContext=n,o.fnOptions=i,t.slot&&((o.data||(o.data={})).slot=t.slot),o}function en(e,t){for(var n in t)e[T(n)]=t[n]}Xt(Qt.prototype);var tn={init:function(e,t){if(e.componentInstance&&!e.componentInstance._isDestroyed&&e.data.keepAlive){var n=e;tn.prepatch(n,n)}else{var i=e.componentInstance=on(e,Ln);i.$mount(t?e.elm:void 0,t)}},prepatch:function(e,t){var n=t.componentOptions,i=t.componentInstance=e.componentInstance;Bn(i,n.propsData,n.listeners,t,n.children)},insert:function(e){var t=e.context,n=e.componentInstance;n._isMounted||(n._isMounted=!0,Un(n,"mounted")),e.data.keepAlive&&(t._isMounted?Qn(n):kn(n,!0))},destroy:function(e){var t=e.componentInstance;t._isDestroyed||(e.data.keepAlive?On(t,!0):t.$destroy())}},nn=Object.keys(tn);function rn(e,t,n,s,a){if(!i(e)){var u=n.$options._base;if(l(e)&&(e=u.extend(e)),"function"===typeof e){var c;if(i(e.cid)&&(c=e,e=_n(c,u),void 0===e))return En(c,t,n,s,a);t=t||{},Ei(e),r(t.model)&&ln(e.options,t);var d=xt(t,e,a);if(o(e.options.functional))return Jt(e,d,t,n,s);var h=t.on;if(t.on=t.nativeOn,o(e.options.abstract)){var f=t.slot;t={},f&&(t.slot=f)}sn(t);var p=e.options.name||a,m=new be("vue-component-"+e.cid+(p?"-"+p:""),t,void 0,void 0,void 0,n,{Ctor:e,propsData:d,listeners:h,tag:a,children:s},c);return m}}}function on(e,t){var n={_isComponent:!0,_parentVnode:e,parent:t},i=e.data.inlineTemplate;return r(i)&&(n.render=i.render,n.staticRenderFns=i.staticRenderFns),new e.componentOptions.Ctor(n)}function sn(e){for(var t=e.hook||(e.hook={}),n=0;n<nn.length;n++){var i=nn[n],r=t[i],o=tn[i];r===o||r&&r._merged||(t[i]=r?an(o,r):o)}}function an(e,t){var n=function(n,i){e(n,i),t(n,i)};return n._merged=!0,n}function ln(e,t){var n=e.model&&e.model.prop||"value",i=e.model&&e.model.event||"input";(t.attrs||(t.attrs={}))[n]=t.model.value;var o=t.on||(t.on={}),s=o[i],a=t.model.callback;r(s)?(Array.isArray(s)?-1===s.indexOf(a):s!==a)&&(o[i]=[a].concat(s)):o[i]=a}var un=1,cn=2;function dn(e,t,n,i,r,s){return(Array.isArray(n)||a(n))&&(r=i,i=n,n=void 0),o(s)&&(r=cn),hn(e,t,n,i,r)}function hn(e,t,n,i,o){if(r(n)&&r(n.__ob__))return _e();if(r(n)&&r(n.is)&&(t=n.is),!t)return _e();var s,a,l;(Array.isArray(i)&&"function"===typeof i[0]&&(n=n||{},n.scopedSlots={default:i[0]},i.length=0),o===cn?i=wt(i):o===un&&(i=St(i)),"string"===typeof t)?(a=e.$vnode&&e.$vnode.ns||V.getTagNamespace(t),s=V.isReservedTag(t)?new be(V.parsePlatformTagName(t),n,i,void 0,void 0,e):n&&n.pre||!r(l=Ge(e.$options,"components",t))?new be(t,n,i,void 0,void 0,e):rn(l,n,e,i,t)):s=rn(t,n,e,i);return Array.isArray(s)?s:r(s)?(r(a)&&fn(s,a),r(n)&&pn(n),s):_e()}function fn(e,t,n){if(e.ns=t,"foreignObject"===e.tag&&(t=void 0,n=!0),r(e.children))for(var s=0,a=e.children.length;s<a;s++){var l=e.children[s];r(l.tag)&&(i(l.ns)||o(n)&&"svg"!==l.tag)&&fn(l,t,n)}}function pn(e){l(e.style)&&gt(e.style),l(e.class)&&gt(e.class)}function mn(e){e._vnode=null,e._staticTrees=null;var t=e.$options,i=e.$vnode=t._parentVnode,r=i&&i.context;e.$slots=Rt(t._renderChildren,r),e.$scopedSlots=n,e._c=function(t,n,i,r){return dn(e,t,n,i,r,!1)},e.$createElement=function(t,n,i,r){return dn(e,t,n,i,r,!0)};var o=i&&i.data;Ne(e,"$attrs",o&&o.attrs||n,null,!0),Ne(e,"$listeners",t._parentListeners||n,null,!0)}var gn,yn=null;function vn(e){Xt(e.prototype),e.prototype.$nextTick=function(e){return pt(e,this)},e.prototype._render=function(){var e,t=this,n=t.$options,i=n.render,r=n._parentVnode;r&&(t.$scopedSlots=Ct(r.data.scopedSlots,t.$slots,t.$scopedSlots)),t.$vnode=r;try{yn=t,e=i.call(t._renderProxy,t.$createElement)}catch(xs){tt(xs,t,"render"),e=t._vnode}finally{yn=null}return Array.isArray(e)&&1===e.length&&(e=e[0]),e instanceof be||(e=_e()),e.parent=r,e}}function bn(e,t){return(e.__esModule||he&&"Module"===e[Symbol.toStringTag])&&(e=e.default),l(e)?t.extend(e):e}function En(e,t,n,i,r){var o=_e();return o.asyncFactory=e,o.asyncMeta={data:t,context:n,children:i,tag:r},o}function _n(e,t){if(o(e.error)&&r(e.errorComp))return e.errorComp;if(r(e.resolved))return e.resolved;var n=yn;if(n&&r(e.owners)&&-1===e.owners.indexOf(n)&&e.owners.push(n),o(e.loading)&&r(e.loadingComp))return e.loadingComp;if(n&&!r(e.owners)){var s=e.owners=[n],a=!0;n.$on("hook:destroyed",function(){return v(s,n)});var u=function(e){for(var t=0,n=s.length;t<n;t++)s[t].$forceUpdate();e&&(s.length=0)},c=O(function(n){e.resolved=bn(n,t),a?s.length=0:u(!0)}),d=O(function(t){r(e.errorComp)&&(e.error=!0,u(!0))}),h=e(c,d);return l(h)&&(f(h)?i(e.resolved)&&h.then(c,d):f(h.component)&&(h.component.then(c,d),r(h.error)&&(e.errorComp=bn(h.error,t)),r(h.loading)&&(e.loadingComp=bn(h.loading,t),0===h.delay?e.loading=!0:setTimeout(function(){i(e.resolved)&&i(e.error)&&(e.loading=!0,u(!1))},h.delay||200)),r(h.timeout)&&setTimeout(function(){i(e.resolved)&&d(null)},h.timeout))),a=!1,e.loading?e.loadingComp:e.resolved}}function xn(e){return e.isComment&&e.asyncFactory}function Tn(e){if(Array.isArray(e))for(var t=0;t<e.length;t++){var n=e[t];if(r(n)&&(r(n.componentOptions)||xn(n)))return n}}function Sn(e){e._events=Object.create(null),e._hasHookEvent=!1;var t=e.$options._parentListeners;t&&Mn(e,t)}function wn(e,t){gn.$on(e,t)}function In(e,t){gn.$off(e,t)}function Dn(e,t){var n=gn;return function i(){var r=t.apply(null,arguments);null!==r&&n.$off(e,i)}}function Mn(e,t,n){gn=e,Et(t,n||{},wn,In,Dn,e),gn=void 0}function An(e){var t=/^hook:/;e.prototype.$on=function(e,n){var i=this;if(Array.isArray(e))for(var r=0,o=e.length;r<o;r++)i.$on(e[r],n);else(i._events[e]||(i._events[e]=[])).push(n),t.test(e)&&(i._hasHookEvent=!0);return i},e.prototype.$once=function(e,t){var n=this;function i(){n.$off(e,i),t.apply(n,arguments)}return i.fn=t,n.$on(e,i),n},e.prototype.$off=function(e,t){var n=this;if(!arguments.length)return n._events=Object.create(null),n;if(Array.isArray(e)){for(var i=0,r=e.length;i<r;i++)n.$off(e[i],t);return n}var o,s=n._events[e];if(!s)return n;if(!t)return n._events[e]=null,n;var a=s.length;while(a--)if(o=s[a],o===t||o.fn===t){s.splice(a,1);break}return n},e.prototype.$emit=function(e){var t=this,n=t._events[e];if(n){n=n.length>1?L(n):n;for(var i=L(arguments,1),r='event handler for "'+e+'"',o=0,s=n.length;o<s;o++)nt(n[o],t,i,t,r)}return t}}var Ln=null;function Rn(e){var t=Ln;return Ln=e,function(){Ln=t}}function Pn(e){var t=e.$options,n=t.parent;if(n&&!t.abstract){while(n.$options.abstract&&n.$parent)n=n.$parent;n.$children.push(e)}e.$parent=n,e.$root=n?n.$root:e,e.$children=[],e.$refs={},e._watcher=null,e._inactive=null,e._directInactive=!1,e._isMounted=!1,e._isDestroyed=!1,e._isBeingDestroyed=!1}function Cn(e){e.prototype._update=function(e,t){var n=this,i=n.$el,r=n._vnode,o=Rn(n);n._vnode=e,n.$el=r?n.__patch__(r,e):n.__patch__(n.$el,e,t,!1),o(),i&&(i.__vue__=null),n.$el&&(n.$el.__vue__=n),n.$vnode&&n.$parent&&n.$vnode===n.$parent._vnode&&(n.$parent.$el=n.$el)},e.prototype.$forceUpdate=function(){var e=this;e._watcher&&e._watcher.update()},e.prototype.$destroy=function(){var e=this;if(!e._isBeingDestroyed){Un(e,"beforeDestroy"),e._isBeingDestroyed=!0;var t=e.$parent;!t||t._isBeingDestroyed||e.$options.abstract||v(t.$children,e),e._watcher&&e._watcher.teardown();var n=e._watchers.length;while(n--)e._watchers[n].teardown();e._data.__ob__&&e._data.__ob__.vmCount--,e._isDestroyed=!0,e.__patch__(e._vnode,null),Un(e,"destroyed"),e.$off(),e.$el&&(e.$el.__vue__=null),e.$vnode&&(e.$vnode.parent=null)}}}function Nn(e,t,n){var i;return e.$el=t,e.$options.render||(e.$options.render=_e),Un(e,"beforeMount"),i=function(){e._update(e._render(),n)},new ti(e,i,C,{before:function(){e._isMounted&&!e._isDestroyed&&Un(e,"beforeUpdate")}},!0),n=!1,null==e.$vnode&&(e._isMounted=!0,Un(e,"mounted")),e}function Bn(e,t,i,r,o){var s=r.data.scopedSlots,a=e.$scopedSlots,l=!!(s&&!s.$stable||a!==n&&!a.$stable||s&&e.$scopedSlots.$key!==s.$key),u=!!(o||e.$options._renderChildren||l);if(e.$options._parentVnode=r,e.$vnode=r,e._vnode&&(e._vnode.parent=r),e.$options._renderChildren=o,e.$attrs=r.data.attrs||n,e.$listeners=i||n,t&&e.$options.props){Ae(!1);for(var c=e._props,d=e.$options._propKeys||[],h=0;h<d.length;h++){var f=d[h],p=e.$options.props;c[f]=Xe(f,p,t,e)}Ae(!0),e.$options.propsData=t}i=i||n;var m=e.$options._parentListeners;e.$options._parentListeners=i,Mn(e,i,m),u&&(e.$slots=Rt(o,r.context),e.$forceUpdate())}function Fn(e){while(e&&(e=e.$parent))if(e._inactive)return!0;return!1}function kn(e,t){if(t){if(e._directInactive=!1,Fn(e))return}else if(e._directInactive)return;if(e._inactive||null===e._inactive){e._inactive=!1;for(var n=0;n<e.$children.length;n++)kn(e.$children[n]);Un(e,"activated")}}function On(e,t){if((!t||(e._directInactive=!0,!Fn(e)))&&!e._inactive){e._inactive=!0;for(var n=0;n<e.$children.length;n++)On(e.$children[n]);Un(e,"deactivated")}}function Un(e,t){ye();var n=e.$options[t],i=t+" hook";if(n)for(var r=0,o=n.length;r<o;r++)nt(n[r],e,null,e,i);e._hasHookEvent&&e.$emit("hook:"+t),ve()}var Hn=[],jn=[],Vn={},Kn=!1,qn=!1,zn=0;function Yn(){zn=Hn.length=jn.length=0,Vn={},Kn=qn=!1}var $n=0,Wn=Date.now;function Gn(){var e,t;for($n=Wn(),qn=!0,Hn.sort(function(e,t){return e.id-t.id}),zn=0;zn<Hn.length;zn++)e=Hn[zn],e.before&&e.before(),t=e.id,Vn[t]=null,e.run();var n=jn.slice(),i=Hn.slice();Yn(),Jn(n),Xn(i),ue&&V.devtools&&ue.emit("flush")}function Xn(e){var t=e.length;while(t--){var n=e[t],i=n.vm;i._watcher===n&&i._isMounted&&!i._isDestroyed&&Un(i,"updated")}}function Qn(e){e._inactive=!1,jn.push(e)}function Jn(e){for(var t=0;t<e.length;t++)e[t]._inactive=!0,kn(e[t],!0)}function Zn(e){var t=e.id;if(null==Vn[t]){if(Vn[t]=!0,qn){var n=Hn.length-1;while(n>zn&&Hn[n].id>e.id)n--;Hn.splice(n+1,0,e)}else Hn.push(e);Kn||(Kn=!0,pt(Gn))}}X&&window.performance&&"function"===typeof performance.now&&document.createEvent("Event").timeStamp<=performance.now()&&(Wn=function(){return performance.now()});var ei=0,ti=function(e,t,n,i,r){this.vm=e,r&&(e._watcher=this),e._watchers.push(this),i?(this.deep=!!i.deep,this.user=!!i.user,this.lazy=!!i.lazy,this.sync=!!i.sync,this.before=i.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=n,this.id=++ei,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new de,this.newDepIds=new de,this.expression="","function"===typeof t?this.getter=t:(this.getter=$(t),this.getter||(this.getter=C)),this.value=this.lazy?void 0:this.get()};ti.prototype.get=function(){var e;ye(this);var t=this.vm;try{e=this.getter.call(t,t)}catch(xs){if(!this.user)throw xs;tt(xs,t,'getter for watcher "'+this.expression+'"')}finally{this.deep&&gt(e),ve(),this.cleanupDeps()}return e},ti.prototype.addDep=function(e){var t=e.id;this.newDepIds.has(t)||(this.newDepIds.add(t),this.newDeps.push(e),this.depIds.has(t)||e.addSub(this))},ti.prototype.cleanupDeps=function(){var e=this.deps.length;while(e--){var t=this.deps[e];this.newDepIds.has(t.id)||t.removeSub(this)}var n=this.depIds;this.depIds=this.newDepIds,this.newDepIds=n,this.newDepIds.clear(),n=this.deps,this.deps=this.newDeps,this.newDeps=n,this.newDeps.length=0},ti.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():Zn(this)},ti.prototype.run=function(){if(this.active){var e=this.get();if(e!==this.value||l(e)||this.deep){var t=this.value;if(this.value=e,this.user)try{this.cb.call(this.vm,e,t)}catch(xs){tt(xs,this.vm,'callback for watcher "'+this.expression+'"')}else this.cb.call(this.vm,e,t)}}},ti.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},ti.prototype.depend=function(){var e=this.deps.length;while(e--)this.deps[e].depend()},ti.prototype.teardown=function(){if(this.active){this.vm._isBeingDestroyed||v(this.vm._watchers,this);var e=this.deps.length;while(e--)this.deps[e].removeSub(this);this.active=!1}};var ni={enumerable:!0,configurable:!0,get:C,set:C};function ii(e,t,n){ni.get=function(){return this[t][n]},ni.set=function(e){this[t][n]=e},Object.defineProperty(e,n,ni)}function ri(e){e._watchers=[];var t=e.$options;t.props&&oi(e,t.props),t.methods&&fi(e,t.methods),t.data?si(e):Ce(e._data={},!0),t.computed&&ui(e,t.computed),t.watch&&t.watch!==oe&&pi(e,t.watch)}function oi(e,t){var n=e.$options.propsData||{},i=e._props={},r=e.$options._propKeys=[],o=!e.$parent;o||Ae(!1);var s=function(o){r.push(o);var s=Xe(o,t,n,e);Ne(i,o,s),o in e||ii(e,"_props",o)};for(var a in t)s(a);Ae(!0)}function si(e){var t=e.$options.data;t=e._data="function"===typeof t?ai(t,e):t||{},c(t)||(t={});var n=Object.keys(t),i=e.$options.props,r=(e.$options.methods,n.length);while(r--){var o=n[r];0,i&&E(i,o)||q(o)||ii(e,"_data",o)}Ce(t,!0)}function ai(e,t){ye();try{return e.call(t,t)}catch(xs){return tt(xs,t,"data()"),{}}finally{ve()}}var li={lazy:!0};function ui(e,t){var n=e._computedWatchers=Object.create(null),i=le();for(var r in t){var o=t[r],s="function"===typeof o?o:o.get;0,i||(n[r]=new ti(e,s||C,C,li)),r in e||ci(e,r,o)}}function ci(e,t,n){var i=!le();"function"===typeof n?(ni.get=i?di(t):hi(n),ni.set=C):(ni.get=n.get?i&&!1!==n.cache?di(t):hi(n.get):C,ni.set=n.set||C),Object.defineProperty(e,t,ni)}function di(e){return function(){var t=this._computedWatchers&&this._computedWatchers[e];if(t)return t.dirty&&t.evaluate(),me.target&&t.depend(),t.value}}function hi(e){return function(){return e.call(this,this)}}function fi(e,t){e.$options.props;for(var n in t)e[n]="function"!==typeof t[n]?C:A(t[n],e)}function pi(e,t){for(var n in t){var i=t[n];if(Array.isArray(i))for(var r=0;r<i.length;r++)mi(e,n,i[r]);else mi(e,n,i)}}function mi(e,t,n,i){return c(n)&&(i=n,n=n.handler),"string"===typeof n&&(n=e[n]),e.$watch(t,n,i)}function gi(e){var t={get:function(){return this._data}},n={get:function(){return this._props}};Object.defineProperty(e.prototype,"$data",t),Object.defineProperty(e.prototype,"$props",n),e.prototype.$set=Be,e.prototype.$delete=Fe,e.prototype.$watch=function(e,t,n){var i=this;if(c(t))return mi(i,e,t,n);n=n||{},n.user=!0;var r=new ti(i,e,t,n);if(n.immediate)try{t.call(i,r.value)}catch(o){tt(o,i,'callback for immediate watcher "'+r.expression+'"')}return function(){r.teardown()}}}var yi=0;function vi(e){e.prototype._init=function(e){var t=this;t._uid=yi++,t._isVue=!0,e&&e._isComponent?bi(t,e):t.$options=We(Ei(t.constructor),e||{},t),t._renderProxy=t,t._self=t,Pn(t),Sn(t),mn(t),Un(t,"beforeCreate"),At(t),ri(t),Mt(t),Un(t,"created"),t.$options.el&&t.$mount(t.$options.el)}}function bi(e,t){var n=e.$options=Object.create(e.constructor.options),i=t._parentVnode;n.parent=t.parent,n._parentVnode=i;var r=i.componentOptions;n.propsData=r.propsData,n._parentListeners=r.listeners,n._renderChildren=r.children,n._componentTag=r.tag,t.render&&(n.render=t.render,n.staticRenderFns=t.staticRenderFns)}function Ei(e){var t=e.options;if(e.super){var n=Ei(e.super),i=e.superOptions;if(n!==i){e.superOptions=n;var r=_i(e);r&&R(e.extendOptions,r),t=e.options=We(n,e.extendOptions),t.name&&(t.components[t.name]=e)}}return t}function _i(e){var t,n=e.options,i=e.sealedOptions;for(var r in n)n[r]!==i[r]&&(t||(t={}),t[r]=n[r]);return t}function xi(e){this._init(e)}function Ti(e){e.use=function(e){var t=this._installedPlugins||(this._installedPlugins=[]);if(t.indexOf(e)>-1)return this;var n=L(arguments,1);return n.unshift(this),"function"===typeof e.install?e.install.apply(e,n):"function"===typeof e&&e.apply(null,n),t.push(e),this}}function Si(e){e.mixin=function(e){return this.options=We(this.options,e),this}}function wi(e){e.cid=0;var t=1;e.extend=function(e){e=e||{};var n=this,i=n.cid,r=e._Ctor||(e._Ctor={});if(r[i])return r[i];var o=e.name||n.options.name;var s=function(e){this._init(e)};return s.prototype=Object.create(n.prototype),s.prototype.constructor=s,s.cid=t++,s.options=We(n.options,e),s["super"]=n,s.options.props&&Ii(s),s.options.computed&&Di(s),s.extend=n.extend,s.mixin=n.mixin,s.use=n.use,H.forEach(function(e){s[e]=n[e]}),o&&(s.options.components[o]=s),s.superOptions=n.options,s.extendOptions=e,s.sealedOptions=R({},s.options),r[i]=s,s}}function Ii(e){var t=e.options.props;for(var n in t)ii(e.prototype,"_props",n)}function Di(e){var t=e.options.computed;for(var n in t)ci(e.prototype,n,t[n])}function Mi(e){H.forEach(function(t){e[t]=function(e,n){return n?("component"===t&&c(n)&&(n.name=n.name||e,n=this.options._base.extend(n)),"directive"===t&&"function"===typeof n&&(n={bind:n,update:n}),this.options[t+"s"][e]=n,n):this.options[t+"s"][e]}})}function Ai(e){return e&&(e.Ctor.options.name||e.tag)}function Li(e,t){return Array.isArray(e)?e.indexOf(t)>-1:"string"===typeof e?e.split(",").indexOf(t)>-1:!!d(e)&&e.test(t)}function Ri(e,t){var n=e.cache,i=e.keys,r=e._vnode;for(var o in n){var s=n[o];if(s){var a=Ai(s.componentOptions);a&&!t(a)&&Pi(n,o,i,r)}}}function Pi(e,t,n,i){var r=e[t];!r||i&&r.tag===i.tag||r.componentInstance.$destroy(),e[t]=null,v(n,t)}vi(xi),gi(xi),An(xi),Cn(xi),vn(xi);var Ci=[String,RegExp,Array],Ni={name:"keep-alive",abstract:!0,props:{include:Ci,exclude:Ci,max:[String,Number]},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var e in this.cache)Pi(this.cache,e,this.keys)},mounted:function(){var e=this;this.$watch("include",function(t){Ri(e,function(e){return Li(t,e)})}),this.$watch("exclude",function(t){Ri(e,function(e){return!Li(t,e)})})},render:function(){var e=this.$slots.default,t=Tn(e),n=t&&t.componentOptions;if(n){var i=Ai(n),r=this,o=r.include,s=r.exclude;if(o&&(!i||!Li(o,i))||s&&i&&Li(s,i))return t;var a=this,l=a.cache,u=a.keys,c=null==t.key?n.Ctor.cid+(n.tag?"::"+n.tag:""):t.key;l[c]?(t.componentInstance=l[c].componentInstance,v(u,c),u.push(c)):(l[c]=t,u.push(c),this.max&&u.length>parseInt(this.max)&&Pi(l,u[0],u,this._vnode)),t.data.keepAlive=!0}return t||e&&e[0]}},Bi={KeepAlive:Ni};function Fi(e){var t={get:function(){return V}};Object.defineProperty(e,"config",t),e.util={warn:fe,extend:R,mergeOptions:We,defineReactive:Ne},e.set=Be,e.delete=Fe,e.nextTick=pt,e.observable=function(e){return Ce(e),e},e.options=Object.create(null),H.forEach(function(t){e.options[t+"s"]=Object.create(null)}),e.options._base=e,R(e.options.components,Bi),Ti(e),Si(e),wi(e),Mi(e)}Fi(xi),Object.defineProperty(xi.prototype,"$isServer",{get:le}),Object.defineProperty(xi.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(xi,"FunctionalRenderContext",{value:Qt}),xi.version="2.6.9";var ki=g("style,class"),Oi=g("input,textarea,option,select,progress"),Ui=function(e,t,n){return"value"===n&&Oi(e)&&"button"!==t||"selected"===n&&"option"===e||"checked"===n&&"input"===e||"muted"===n&&"video"===e},Hi=g("contenteditable,draggable,spellcheck"),ji=g("events,caret,typing,plaintext-only"),Vi=function(e,t){return $i(t)||"false"===t?"false":"contenteditable"===e&&ji(t)?t:"true"},Ki=g("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,translate,truespeed,typemustmatch,visible"),qi="http://www.w3.org/1999/xlink",zi=function(e){return":"===e.charAt(5)&&"xlink"===e.slice(0,5)},Yi=function(e){return zi(e)?e.slice(6,e.length):""},$i=function(e){return null==e||!1===e};function Wi(e){var t=e.data,n=e,i=e;while(r(i.componentInstance))i=i.componentInstance._vnode,i&&i.data&&(t=Gi(i.data,t));while(r(n=n.parent))n&&n.data&&(t=Gi(t,n.data));return Xi(t.staticClass,t.class)}function Gi(e,t){return{staticClass:Qi(e.staticClass,t.staticClass),class:r(e.class)?[e.class,t.class]:t.class}}function Xi(e,t){return r(e)||r(t)?Qi(e,Ji(t)):""}function Qi(e,t){return e?t?e+" "+t:e:t||""}function Ji(e){return Array.isArray(e)?Zi(e):l(e)?er(e):"string"===typeof e?e:""}function Zi(e){for(var t,n="",i=0,o=e.length;i<o;i++)r(t=Ji(e[i]))&&""!==t&&(n&&(n+=" "),n+=t);return n}function er(e){var t="";for(var n in e)e[n]&&(t&&(t+=" "),t+=n);return t}var tr={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},nr=g("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),ir=g("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignObject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),rr=function(e){return nr(e)||ir(e)};function or(e){return ir(e)?"svg":"math"===e?"math":void 0}var sr=Object.create(null);function ar(e){if(!X)return!0;if(rr(e))return!1;if(e=e.toLowerCase(),null!=sr[e])return sr[e];var t=document.createElement(e);return e.indexOf("-")>-1?sr[e]=t.constructor===window.HTMLUnknownElement||t.constructor===window.HTMLElement:sr[e]=/HTMLUnknownElement/.test(t.toString())}var lr=g("text,number,password,search,email,tel,url");function ur(e){if("string"===typeof e){var t=document.querySelector(e);return t||document.createElement("div")}return e}function cr(e,t){var n=document.createElement(e);return"select"!==e?n:(t.data&&t.data.attrs&&void 0!==t.data.attrs.multiple&&n.setAttribute("multiple","multiple"),n)}function dr(e,t){return document.createElementNS(tr[e],t)}function hr(e){return document.createTextNode(e)}function fr(e){return document.createComment(e)}function pr(e,t,n){e.insertBefore(t,n)}function mr(e,t){e.removeChild(t)}function gr(e,t){e.appendChild(t)}function yr(e){return e.parentNode}function vr(e){return e.nextSibling}function br(e){return e.tagName}function Er(e,t){e.textContent=t}function _r(e,t){e.setAttribute(t,"")}var xr=Object.freeze({createElement:cr,createElementNS:dr,createTextNode:hr,createComment:fr,insertBefore:pr,removeChild:mr,appendChild:gr,parentNode:yr,nextSibling:vr,tagName:br,setTextContent:Er,setStyleScope:_r}),Tr={create:function(e,t){Sr(t)},update:function(e,t){e.data.ref!==t.data.ref&&(Sr(e,!0),Sr(t))},destroy:function(e){Sr(e,!0)}};function Sr(e,t){var n=e.data.ref;if(r(n)){var i=e.context,o=e.componentInstance||e.elm,s=i.$refs;t?Array.isArray(s[n])?v(s[n],o):s[n]===o&&(s[n]=void 0):e.data.refInFor?Array.isArray(s[n])?s[n].indexOf(o)<0&&s[n].push(o):s[n]=[o]:s[n]=o}}var wr=new be("",{},[]),Ir=["create","activate","update","remove","destroy"];function Dr(e,t){return e.key===t.key&&(e.tag===t.tag&&e.isComment===t.isComment&&r(e.data)===r(t.data)&&Mr(e,t)||o(e.isAsyncPlaceholder)&&e.asyncFactory===t.asyncFactory&&i(t.asyncFactory.error))}function Mr(e,t){if("input"!==e.tag)return!0;var n,i=r(n=e.data)&&r(n=n.attrs)&&n.type,o=r(n=t.data)&&r(n=n.attrs)&&n.type;return i===o||lr(i)&&lr(o)}function Ar(e,t,n){var i,o,s={};for(i=t;i<=n;++i)o=e[i].key,r(o)&&(s[o]=i);return s}function Lr(e){var t,n,s={},l=e.modules,u=e.nodeOps;for(t=0;t<Ir.length;++t)for(s[Ir[t]]=[],n=0;n<l.length;++n)r(l[n][Ir[t]])&&s[Ir[t]].push(l[n][Ir[t]]);function c(e){return new be(u.tagName(e).toLowerCase(),{},[],void 0,e)}function d(e,t){function n(){0===--n.listeners&&h(e)}return n.listeners=t,n}function h(e){var t=u.parentNode(e);r(t)&&u.removeChild(t,e)}function f(e,t,n,i,s,a,l){if(r(e.elm)&&r(a)&&(e=a[l]=Te(e)),e.isRootInsert=!s,!p(e,t,n,i)){var c=e.data,d=e.children,h=e.tag;r(h)?(e.elm=e.ns?u.createElementNS(e.ns,h):u.createElement(h,e),x(e),b(e,d,t),r(c)&&_(e,t),v(n,e.elm,i)):o(e.isComment)?(e.elm=u.createComment(e.text),v(n,e.elm,i)):(e.elm=u.createTextNode(e.text),v(n,e.elm,i))}}function p(e,t,n,i){var s=e.data;if(r(s)){var a=r(e.componentInstance)&&s.keepAlive;if(r(s=s.hook)&&r(s=s.init)&&s(e,!1),r(e.componentInstance))return m(e,t),v(n,e.elm,i),o(a)&&y(e,t,n,i),!0}}function m(e,t){r(e.data.pendingInsert)&&(t.push.apply(t,e.data.pendingInsert),e.data.pendingInsert=null),e.elm=e.componentInstance.$el,E(e)?(_(e,t),x(e)):(Sr(e),t.push(e))}function y(e,t,n,i){var o,a=e;while(a.componentInstance)if(a=a.componentInstance._vnode,r(o=a.data)&&r(o=o.transition)){for(o=0;o<s.activate.length;++o)s.activate[o](wr,a);t.push(a);break}v(n,e.elm,i)}function v(e,t,n){r(e)&&(r(n)?u.parentNode(n)===e&&u.insertBefore(e,t,n):u.appendChild(e,t))}function b(e,t,n){if(Array.isArray(t)){0;for(var i=0;i<t.length;++i)f(t[i],n,e.elm,null,!0,t,i)}else a(e.text)&&u.appendChild(e.elm,u.createTextNode(String(e.text)))}function E(e){while(e.componentInstance)e=e.componentInstance._vnode;return r(e.tag)}function _(e,n){for(var i=0;i<s.create.length;++i)s.create[i](wr,e);t=e.data.hook,r(t)&&(r(t.create)&&t.create(wr,e),r(t.insert)&&n.push(e))}function x(e){var t;if(r(t=e.fnScopeId))u.setStyleScope(e.elm,t);else{var n=e;while(n)r(t=n.context)&&r(t=t.$options._scopeId)&&u.setStyleScope(e.elm,t),n=n.parent}r(t=Ln)&&t!==e.context&&t!==e.fnContext&&r(t=t.$options._scopeId)&&u.setStyleScope(e.elm,t)}function T(e,t,n,i,r,o){for(;i<=r;++i)f(n[i],o,e,t,!1,n,i)}function S(e){var t,n,i=e.data;if(r(i))for(r(t=i.hook)&&r(t=t.destroy)&&t(e),t=0;t<s.destroy.length;++t)s.destroy[t](e);if(r(t=e.children))for(n=0;n<e.children.length;++n)S(e.children[n])}function w(e,t,n,i){for(;n<=i;++n){var o=t[n];r(o)&&(r(o.tag)?(I(o),S(o)):h(o.elm))}}function I(e,t){if(r(t)||r(e.data)){var n,i=s.remove.length+1;for(r(t)?t.listeners+=i:t=d(e.elm,i),r(n=e.componentInstance)&&r(n=n._vnode)&&r(n.data)&&I(n,t),n=0;n<s.remove.length;++n)s.remove[n](e,t);r(n=e.data.hook)&&r(n=n.remove)?n(e,t):t()}else h(e.elm)}function D(e,t,n,o,s){var a,l,c,d,h=0,p=0,m=t.length-1,g=t[0],y=t[m],v=n.length-1,b=n[0],E=n[v],_=!s;while(h<=m&&p<=v)i(g)?g=t[++h]:i(y)?y=t[--m]:Dr(g,b)?(A(g,b,o,n,p),g=t[++h],b=n[++p]):Dr(y,E)?(A(y,E,o,n,v),y=t[--m],E=n[--v]):Dr(g,E)?(A(g,E,o,n,v),_&&u.insertBefore(e,g.elm,u.nextSibling(y.elm)),g=t[++h],E=n[--v]):Dr(y,b)?(A(y,b,o,n,p),_&&u.insertBefore(e,y.elm,g.elm),y=t[--m],b=n[++p]):(i(a)&&(a=Ar(t,h,m)),l=r(b.key)?a[b.key]:M(b,t,h,m),i(l)?f(b,o,e,g.elm,!1,n,p):(c=t[l],Dr(c,b)?(A(c,b,o,n,p),t[l]=void 0,_&&u.insertBefore(e,c.elm,g.elm)):f(b,o,e,g.elm,!1,n,p)),b=n[++p]);h>m?(d=i(n[v+1])?null:n[v+1].elm,T(e,d,n,p,v,o)):p>v&&w(e,t,h,m)}function M(e,t,n,i){for(var o=n;o<i;o++){var s=t[o];if(r(s)&&Dr(e,s))return o}}function A(e,t,n,a,l,c){if(e!==t){r(t.elm)&&r(a)&&(t=a[l]=Te(t));var d=t.elm=e.elm;if(o(e.isAsyncPlaceholder))r(t.asyncFactory.resolved)?P(e.elm,t,n):t.isAsyncPlaceholder=!0;else if(o(t.isStatic)&&o(e.isStatic)&&t.key===e.key&&(o(t.isCloned)||o(t.isOnce)))t.componentInstance=e.componentInstance;else{var h,f=t.data;r(f)&&r(h=f.hook)&&r(h=h.prepatch)&&h(e,t);var p=e.children,m=t.children;if(r(f)&&E(t)){for(h=0;h<s.update.length;++h)s.update[h](e,t);r(h=f.hook)&&r(h=h.update)&&h(e,t)}i(t.text)?r(p)&&r(m)?p!==m&&D(d,p,m,n,c):r(m)?(r(e.text)&&u.setTextContent(d,""),T(d,null,m,0,m.length-1,n)):r(p)?w(d,p,0,p.length-1):r(e.text)&&u.setTextContent(d,""):e.text!==t.text&&u.setTextContent(d,t.text),r(f)&&r(h=f.hook)&&r(h=h.postpatch)&&h(e,t)}}}function L(e,t,n){if(o(n)&&r(e.parent))e.parent.data.pendingInsert=t;else for(var i=0;i<t.length;++i)t[i].data.hook.insert(t[i])}var R=g("attrs,class,staticClass,staticStyle,key");function P(e,t,n,i){var s,a=t.tag,l=t.data,u=t.children;if(i=i||l&&l.pre,t.elm=e,o(t.isComment)&&r(t.asyncFactory))return t.isAsyncPlaceholder=!0,!0;if(r(l)&&(r(s=l.hook)&&r(s=s.init)&&s(t,!0),r(s=t.componentInstance)))return m(t,n),!0;if(r(a)){if(r(u))if(e.hasChildNodes())if(r(s=l)&&r(s=s.domProps)&&r(s=s.innerHTML)){if(s!==e.innerHTML)return!1}else{for(var c=!0,d=e.firstChild,h=0;h<u.length;h++){if(!d||!P(d,u[h],n,i)){c=!1;break}d=d.nextSibling}if(!c||d)return!1}else b(t,u,n);if(r(l)){var f=!1;for(var p in l)if(!R(p)){f=!0,_(t,n);break}!f&&l["class"]&&gt(l["class"])}}else e.data!==t.text&&(e.data=t.text);return!0}return function(e,t,n,a){if(!i(t)){var l=!1,d=[];if(i(e))l=!0,f(t,d);else{var h=r(e.nodeType);if(!h&&Dr(e,t))A(e,t,d,null,null,a);else{if(h){if(1===e.nodeType&&e.hasAttribute(U)&&(e.removeAttribute(U),n=!0),o(n)&&P(e,t,d))return L(t,d,!0),e;e=c(e)}var p=e.elm,m=u.parentNode(p);if(f(t,d,p._leaveCb?null:m,u.nextSibling(p)),r(t.parent)){var g=t.parent,y=E(t);while(g){for(var v=0;v<s.destroy.length;++v)s.destroy[v](g);if(g.elm=t.elm,y){for(var b=0;b<s.create.length;++b)s.create[b](wr,g);var _=g.data.hook.insert;if(_.merged)for(var x=1;x<_.fns.length;x++)_.fns[x]()}else Sr(g);g=g.parent}}r(m)?w(m,[e],0,0):r(e.tag)&&S(e)}}return L(t,d,l),t.elm}r(e)&&S(e)}}var Rr={create:Pr,update:Pr,destroy:function(e){Pr(e,wr)}};function Pr(e,t){(e.data.directives||t.data.directives)&&Cr(e,t)}function Cr(e,t){var n,i,r,o=e===wr,s=t===wr,a=Br(e.data.directives,e.context),l=Br(t.data.directives,t.context),u=[],c=[];for(n in l)i=a[n],r=l[n],i?(r.oldValue=i.value,r.oldArg=i.arg,kr(r,"update",t,e),r.def&&r.def.componentUpdated&&c.push(r)):(kr(r,"bind",t,e),r.def&&r.def.inserted&&u.push(r));if(u.length){var d=function(){for(var n=0;n<u.length;n++)kr(u[n],"inserted",t,e)};o?_t(t,"insert",d):d()}if(c.length&&_t(t,"postpatch",function(){for(var n=0;n<c.length;n++)kr(c[n],"componentUpdated",t,e)}),!o)for(n in a)l[n]||kr(a[n],"unbind",e,e,s)}var Nr=Object.create(null);function Br(e,t){var n,i,r=Object.create(null);if(!e)return r;for(n=0;n<e.length;n++)i=e[n],i.modifiers||(i.modifiers=Nr),r[Fr(i)]=i,i.def=Ge(t.$options,"directives",i.name,!0);return r}function Fr(e){return e.rawName||e.name+"."+Object.keys(e.modifiers||{}).join(".")}function kr(e,t,n,i,r){var o=e.def&&e.def[t];if(o)try{o(n.elm,e,n,i,r)}catch(xs){tt(xs,n.context,"directive "+e.name+" "+t+" hook")}}var Or=[Tr,Rr];function Ur(e,t){var n=t.componentOptions;if((!r(n)||!1!==n.Ctor.options.inheritAttrs)&&(!i(e.data.attrs)||!i(t.data.attrs))){var o,s,a,l=t.elm,u=e.data.attrs||{},c=t.data.attrs||{};for(o in r(c.__ob__)&&(c=t.data.attrs=R({},c)),c)s=c[o],a=u[o],a!==s&&Hr(l,o,s);for(o in(ee||ne)&&c.value!==u.value&&Hr(l,"value",c.value),u)i(c[o])&&(zi(o)?l.removeAttributeNS(qi,Yi(o)):Hi(o)||l.removeAttribute(o))}}function Hr(e,t,n){e.tagName.indexOf("-")>-1?jr(e,t,n):Ki(t)?$i(n)?e.removeAttribute(t):(n="allowfullscreen"===t&&"EMBED"===e.tagName?"true":t,e.setAttribute(t,n)):Hi(t)?e.setAttribute(t,Vi(t,n)):zi(t)?$i(n)?e.removeAttributeNS(qi,Yi(t)):e.setAttributeNS(qi,t,n):jr(e,t,n)}function jr(e,t,n){if($i(n))e.removeAttribute(t);else{if(ee&&!te&&"TEXTAREA"===e.tagName&&"placeholder"===t&&""!==n&&!e.__ieph){var i=function(t){t.stopImmediatePropagation(),e.removeEventListener("input",i)};e.addEventListener("input",i),e.__ieph=!0}e.setAttribute(t,n)}}var Vr={create:Ur,update:Ur};function Kr(e,t){var n=t.elm,o=t.data,s=e.data;if(!(i(o.staticClass)&&i(o.class)&&(i(s)||i(s.staticClass)&&i(s.class)))){var a=Wi(t),l=n._transitionClasses;r(l)&&(a=Qi(a,Ji(l))),a!==n._prevClass&&(n.setAttribute("class",a),n._prevClass=a)}}var qr,zr={create:Kr,update:Kr},Yr="__r",$r="__c";function Wr(e){if(r(e[Yr])){var t=ee?"change":"input";e[t]=[].concat(e[Yr],e[t]||[]),delete e[Yr]}r(e[$r])&&(e.change=[].concat(e[$r],e.change||[]),delete e[$r])}function Gr(e,t,n){var i=qr;return function r(){var o=t.apply(null,arguments);null!==o&&Jr(e,r,n,i)}}var Xr=st&&!(re&&Number(re[1])<=53);function Qr(e,t,n,i){if(Xr){var r=$n,o=t;t=o._wrapper=function(e){if(e.target===e.currentTarget||e.timeStamp>=r||e.timeStamp<=0||e.target.ownerDocument!==document)return o.apply(this,arguments)}}qr.addEventListener(e,t,se?{capture:n,passive:i}:n)}function Jr(e,t,n,i){(i||qr).removeEventListener(e,t._wrapper||t,n)}function Zr(e,t){if(!i(e.data.on)||!i(t.data.on)){var n=t.data.on||{},r=e.data.on||{};qr=t.elm,Wr(n),Et(n,r,Qr,Jr,Gr,t.context),qr=void 0}}var eo,to={create:Zr,update:Zr};function no(e,t){if(!i(e.data.domProps)||!i(t.data.domProps)){var n,o,s=t.elm,a=e.data.domProps||{},l=t.data.domProps||{};for(n in r(l.__ob__)&&(l=t.data.domProps=R({},l)),a)i(l[n])&&(s[n]="");for(n in l){if(o=l[n],"textContent"===n||"innerHTML"===n){if(t.children&&(t.children.length=0),o===a[n])continue;1===s.childNodes.length&&s.removeChild(s.childNodes[0])}if("value"===n&&"PROGRESS"!==s.tagName){s._value=o;var u=i(o)?"":String(o);io(s,u)&&(s.value=u)}else if("innerHTML"===n&&ir(s.tagName)&&i(s.innerHTML)){eo=eo||document.createElement("div"),eo.innerHTML="<svg>"+o+"</svg>";var c=eo.firstChild;while(s.firstChild)s.removeChild(s.firstChild);while(c.firstChild)s.appendChild(c.firstChild)}else if(o!==a[n])try{s[n]=o}catch(xs){}}}}function io(e,t){return!e.composing&&("OPTION"===e.tagName||ro(e,t)||oo(e,t))}function ro(e,t){var n=!0;try{n=document.activeElement!==e}catch(xs){}return n&&e.value!==t}function oo(e,t){var n=e.value,i=e._vModifiers;if(r(i)){if(i.number)return m(n)!==m(t);if(i.trim)return n.trim()!==t.trim()}return n!==t}var so={create:no,update:no},ao=_(function(e){var t={},n=/;(?![^(]*\))/g,i=/:(.+)/;return e.split(n).forEach(function(e){if(e){var n=e.split(i);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t});function lo(e){var t=uo(e.style);return e.staticStyle?R(e.staticStyle,t):t}function uo(e){return Array.isArray(e)?P(e):"string"===typeof e?ao(e):e}function co(e,t){var n,i={};if(t){var r=e;while(r.componentInstance)r=r.componentInstance._vnode,r&&r.data&&(n=lo(r.data))&&R(i,n)}(n=lo(e.data))&&R(i,n);var o=e;while(o=o.parent)o.data&&(n=lo(o.data))&&R(i,n);return i}var ho,fo=/^--/,po=/\s*!important$/,mo=function(e,t,n){if(fo.test(t))e.style.setProperty(t,n);else if(po.test(n))e.style.setProperty(I(t),n.replace(po,""),"important");else{var i=yo(t);if(Array.isArray(n))for(var r=0,o=n.length;r<o;r++)e.style[i]=n[r];else e.style[i]=n}},go=["Webkit","Moz","ms"],yo=_(function(e){if(ho=ho||document.createElement("div").style,e=T(e),"filter"!==e&&e in ho)return e;for(var t=e.charAt(0).toUpperCase()+e.slice(1),n=0;n<go.length;n++){var i=go[n]+t;if(i in ho)return i}});function vo(e,t){var n=t.data,o=e.data;if(!(i(n.staticStyle)&&i(n.style)&&i(o.staticStyle)&&i(o.style))){var s,a,l=t.elm,u=o.staticStyle,c=o.normalizedStyle||o.style||{},d=u||c,h=uo(t.data.style)||{};t.data.normalizedStyle=r(h.__ob__)?R({},h):h;var f=co(t,!0);for(a in d)i(f[a])&&mo(l,a,"");for(a in f)s=f[a],s!==d[a]&&mo(l,a,null==s?"":s)}}var bo={create:vo,update:vo},Eo=/\s+/;function _o(e,t){if(t&&(t=t.trim()))if(e.classList)t.indexOf(" ")>-1?t.split(Eo).forEach(function(t){return e.classList.add(t)}):e.classList.add(t);else{var n=" "+(e.getAttribute("class")||"")+" ";n.indexOf(" "+t+" ")<0&&e.setAttribute("class",(n+t).trim())}}function xo(e,t){if(t&&(t=t.trim()))if(e.classList)t.indexOf(" ")>-1?t.split(Eo).forEach(function(t){return e.classList.remove(t)}):e.classList.remove(t),e.classList.length||e.removeAttribute("class");else{var n=" "+(e.getAttribute("class")||"")+" ",i=" "+t+" ";while(n.indexOf(i)>=0)n=n.replace(i," ");n=n.trim(),n?e.setAttribute("class",n):e.removeAttribute("class")}}function To(e){if(e){if("object"===typeof e){var t={};return!1!==e.css&&R(t,So(e.name||"v")),R(t,e),t}return"string"===typeof e?So(e):void 0}}var So=_(function(e){return{enterClass:e+"-enter",enterToClass:e+"-enter-to",enterActiveClass:e+"-enter-active",leaveClass:e+"-leave",leaveToClass:e+"-leave-to",leaveActiveClass:e+"-leave-active"}}),wo=X&&!te,Io="transition",Do="animation",Mo="transition",Ao="transitionend",Lo="animation",Ro="animationend";wo&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(Mo="WebkitTransition",Ao="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(Lo="WebkitAnimation",Ro="webkitAnimationEnd"));var Po=X?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(e){return e()};function Co(e){Po(function(){Po(e)})}function No(e,t){var n=e._transitionClasses||(e._transitionClasses=[]);n.indexOf(t)<0&&(n.push(t),_o(e,t))}function Bo(e,t){e._transitionClasses&&v(e._transitionClasses,t),xo(e,t)}function Fo(e,t,n){var i=Oo(e,t),r=i.type,o=i.timeout,s=i.propCount;if(!r)return n();var a=r===Io?Ao:Ro,l=0,u=function(){e.removeEventListener(a,c),n()},c=function(t){t.target===e&&++l>=s&&u()};setTimeout(function(){l<s&&u()},o+1),e.addEventListener(a,c)}var ko=/\b(transform|all)(,|$)/;function Oo(e,t){var n,i=window.getComputedStyle(e),r=(i[Mo+"Delay"]||"").split(", "),o=(i[Mo+"Duration"]||"").split(", "),s=Uo(r,o),a=(i[Lo+"Delay"]||"").split(", "),l=(i[Lo+"Duration"]||"").split(", "),u=Uo(a,l),c=0,d=0;t===Io?s>0&&(n=Io,c=s,d=o.length):t===Do?u>0&&(n=Do,c=u,d=l.length):(c=Math.max(s,u),n=c>0?s>u?Io:Do:null,d=n?n===Io?o.length:l.length:0);var h=n===Io&&ko.test(i[Mo+"Property"]);return{type:n,timeout:c,propCount:d,hasTransform:h}}function Uo(e,t){while(e.length<t.length)e=e.concat(e);return Math.max.apply(null,t.map(function(t,n){return Ho(t)+Ho(e[n])}))}function Ho(e){return 1e3*Number(e.slice(0,-1).replace(",","."))}function jo(e,t){var n=e.elm;r(n._leaveCb)&&(n._leaveCb.cancelled=!0,n._leaveCb());var o=To(e.data.transition);if(!i(o)&&!r(n._enterCb)&&1===n.nodeType){var s=o.css,a=o.type,u=o.enterClass,c=o.enterToClass,d=o.enterActiveClass,h=o.appearClass,f=o.appearToClass,p=o.appearActiveClass,g=o.beforeEnter,y=o.enter,v=o.afterEnter,b=o.enterCancelled,E=o.beforeAppear,_=o.appear,x=o.afterAppear,T=o.appearCancelled,S=o.duration,w=Ln,I=Ln.$vnode;while(I&&I.parent)w=I.context,I=I.parent;var D=!w._isMounted||!e.isRootInsert;if(!D||_||""===_){var M=D&&h?h:u,A=D&&p?p:d,L=D&&f?f:c,R=D&&E||g,P=D&&"function"===typeof _?_:y,C=D&&x||v,N=D&&T||b,B=m(l(S)?S.enter:S);0;var F=!1!==s&&!te,k=qo(P),U=n._enterCb=O(function(){F&&(Bo(n,L),Bo(n,A)),U.cancelled?(F&&Bo(n,M),N&&N(n)):C&&C(n),n._enterCb=null});e.data.show||_t(e,"insert",function(){var t=n.parentNode,i=t&&t._pending&&t._pending[e.key];i&&i.tag===e.tag&&i.elm._leaveCb&&i.elm._leaveCb(),P&&P(n,U)}),R&&R(n),F&&(No(n,M),No(n,A),Co(function(){Bo(n,M),U.cancelled||(No(n,L),k||(Ko(B)?setTimeout(U,B):Fo(n,a,U)))})),e.data.show&&(t&&t(),P&&P(n,U)),F||k||U()}}}function Vo(e,t){var n=e.elm;r(n._enterCb)&&(n._enterCb.cancelled=!0,n._enterCb());var o=To(e.data.transition);if(i(o)||1!==n.nodeType)return t();if(!r(n._leaveCb)){var s=o.css,a=o.type,u=o.leaveClass,c=o.leaveToClass,d=o.leaveActiveClass,h=o.beforeLeave,f=o.leave,p=o.afterLeave,g=o.leaveCancelled,y=o.delayLeave,v=o.duration,b=!1!==s&&!te,E=qo(f),_=m(l(v)?v.leave:v);0;var x=n._leaveCb=O(function(){n.parentNode&&n.parentNode._pending&&(n.parentNode._pending[e.key]=null),b&&(Bo(n,c),Bo(n,d)),x.cancelled?(b&&Bo(n,u),g&&g(n)):(t(),p&&p(n)),n._leaveCb=null});y?y(T):T()}function T(){x.cancelled||(!e.data.show&&n.parentNode&&((n.parentNode._pending||(n.parentNode._pending={}))[e.key]=e),h&&h(n),b&&(No(n,u),No(n,d),Co(function(){Bo(n,u),x.cancelled||(No(n,c),E||(Ko(_)?setTimeout(x,_):Fo(n,a,x)))})),f&&f(n,x),b||E||x())}}function Ko(e){return"number"===typeof e&&!isNaN(e)}function qo(e){if(i(e))return!1;var t=e.fns;return r(t)?qo(Array.isArray(t)?t[0]:t):(e._length||e.length)>1}function zo(e,t){!0!==t.data.show&&jo(t)}var Yo=X?{create:zo,activate:zo,remove:function(e,t){!0!==e.data.show?Vo(e,t):t()}}:{},$o=[Vr,zr,to,so,bo,Yo],Wo=$o.concat(Or),Go=Lr({nodeOps:xr,modules:Wo});te&&document.addEventListener("selectionchange",function(){var e=document.activeElement;e&&e.vmodel&&is(e,"input")});var Xo={inserted:function(e,t,n,i){"select"===n.tag?(i.elm&&!i.elm._vOptions?_t(n,"postpatch",function(){Xo.componentUpdated(e,t,n)}):Qo(e,t,n.context),e._vOptions=[].map.call(e.options,es)):("textarea"===n.tag||lr(e.type))&&(e._vModifiers=t.modifiers,t.modifiers.lazy||(e.addEventListener("compositionstart",ts),e.addEventListener("compositionend",ns),e.addEventListener("change",ns),te&&(e.vmodel=!0)))},componentUpdated:function(e,t,n){if("select"===n.tag){Qo(e,t,n.context);var i=e._vOptions,r=e._vOptions=[].map.call(e.options,es);if(r.some(function(e,t){return!F(e,i[t])})){var o=e.multiple?t.value.some(function(e){return Zo(e,r)}):t.value!==t.oldValue&&Zo(t.value,r);o&&is(e,"change")}}}};function Qo(e,t,n){Jo(e,t,n),(ee||ne)&&setTimeout(function(){Jo(e,t,n)},0)}function Jo(e,t,n){var i=t.value,r=e.multiple;if(!r||Array.isArray(i)){for(var o,s,a=0,l=e.options.length;a<l;a++)if(s=e.options[a],r)o=k(i,es(s))>-1,s.selected!==o&&(s.selected=o);else if(F(es(s),i))return void(e.selectedIndex!==a&&(e.selectedIndex=a));r||(e.selectedIndex=-1)}}function Zo(e,t){return t.every(function(t){return!F(t,e)})}function es(e){return"_value"in e?e._value:e.value}function ts(e){e.target.composing=!0}function ns(e){e.target.composing&&(e.target.composing=!1,is(e.target,"input"))}function is(e,t){var n=document.createEvent("HTMLEvents");n.initEvent(t,!0,!0),e.dispatchEvent(n)}function rs(e){return!e.componentInstance||e.data&&e.data.transition?e:rs(e.componentInstance._vnode)}var os={bind:function(e,t,n){var i=t.value;n=rs(n);var r=n.data&&n.data.transition,o=e.__vOriginalDisplay="none"===e.style.display?"":e.style.display;i&&r?(n.data.show=!0,jo(n,function(){e.style.display=o})):e.style.display=i?o:"none"},update:function(e,t,n){var i=t.value,r=t.oldValue;if(!i!==!r){n=rs(n);var o=n.data&&n.data.transition;o?(n.data.show=!0,i?jo(n,function(){e.style.display=e.__vOriginalDisplay}):Vo(n,function(){e.style.display="none"})):e.style.display=i?e.__vOriginalDisplay:"none"}},unbind:function(e,t,n,i,r){r||(e.style.display=e.__vOriginalDisplay)}},ss={model:Xo,show:os},as={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function ls(e){var t=e&&e.componentOptions;return t&&t.Ctor.options.abstract?ls(Tn(t.children)):e}function us(e){var t={},n=e.$options;for(var i in n.propsData)t[i]=e[i];var r=n._parentListeners;for(var o in r)t[T(o)]=r[o];return t}function cs(e,t){if(/\d-keep-alive$/.test(t.tag))return e("keep-alive",{props:t.componentOptions.propsData})}function ds(e){while(e=e.parent)if(e.data.transition)return!0}function hs(e,t){return t.key===e.key&&t.tag===e.tag}var fs=function(e){return e.tag||xn(e)},ps=function(e){return"show"===e.name},ms={name:"transition",props:as,abstract:!0,render:function(e){var t=this,n=this.$slots.default;if(n&&(n=n.filter(fs),n.length)){0;var i=this.mode;0;var r=n[0];if(ds(this.$vnode))return r;var o=ls(r);if(!o)return r;if(this._leaving)return cs(e,r);var s="__transition-"+this._uid+"-";o.key=null==o.key?o.isComment?s+"comment":s+o.tag:a(o.key)?0===String(o.key).indexOf(s)?o.key:s+o.key:o.key;var l=(o.data||(o.data={})).transition=us(this),u=this._vnode,c=ls(u);if(o.data.directives&&o.data.directives.some(ps)&&(o.data.show=!0),c&&c.data&&!hs(o,c)&&!xn(c)&&(!c.componentInstance||!c.componentInstance._vnode.isComment)){var d=c.data.transition=R({},l);if("out-in"===i)return this._leaving=!0,_t(d,"afterLeave",function(){t._leaving=!1,t.$forceUpdate()}),cs(e,r);if("in-out"===i){if(xn(o))return u;var h,f=function(){h()};_t(l,"afterEnter",f),_t(l,"enterCancelled",f),_t(d,"delayLeave",function(e){h=e})}}return r}}},gs=R({tag:String,moveClass:String},as);delete gs.mode;var ys={props:gs,beforeMount:function(){var e=this,t=this._update;this._update=function(n,i){var r=Rn(e);e.__patch__(e._vnode,e.kept,!1,!0),e._vnode=e.kept,r(),t.call(e,n,i)}},render:function(e){for(var t=this.tag||this.$vnode.data.tag||"span",n=Object.create(null),i=this.prevChildren=this.children,r=this.$slots.default||[],o=this.children=[],s=us(this),a=0;a<r.length;a++){var l=r[a];if(l.tag)if(null!=l.key&&0!==String(l.key).indexOf("__vlist"))o.push(l),n[l.key]=l,(l.data||(l.data={})).transition=s;else;}if(i){for(var u=[],c=[],d=0;d<i.length;d++){var h=i[d];h.data.transition=s,h.data.pos=h.elm.getBoundingClientRect(),n[h.key]?u.push(h):c.push(h)}this.kept=e(t,null,u),this.removed=c}return e(t,null,o)},updated:function(){var e=this.prevChildren,t=this.moveClass||(this.name||"v")+"-move";e.length&&this.hasMove(e[0].elm,t)&&(e.forEach(vs),e.forEach(bs),e.forEach(Es),this._reflow=document.body.offsetHeight,e.forEach(function(e){if(e.data.moved){var n=e.elm,i=n.style;No(n,t),i.transform=i.WebkitTransform=i.transitionDuration="",n.addEventListener(Ao,n._moveCb=function e(i){i&&i.target!==n||i&&!/transform$/.test(i.propertyName)||(n.removeEventListener(Ao,e),n._moveCb=null,Bo(n,t))})}}))},methods:{hasMove:function(e,t){if(!wo)return!1;if(this._hasMove)return this._hasMove;var n=e.cloneNode();e._transitionClasses&&e._transitionClasses.forEach(function(e){xo(n,e)}),_o(n,t),n.style.display="none",this.$el.appendChild(n);var i=Oo(n);return this.$el.removeChild(n),this._hasMove=i.hasTransform}}};function vs(e){e.elm._moveCb&&e.elm._moveCb(),e.elm._enterCb&&e.elm._enterCb()}function bs(e){e.data.newPos=e.elm.getBoundingClientRect()}function Es(e){var t=e.data.pos,n=e.data.newPos,i=t.left-n.left,r=t.top-n.top;if(i||r){e.data.moved=!0;var o=e.elm.style;o.transform=o.WebkitTransform="translate("+i+"px,"+r+"px)",o.transitionDuration="0s"}}var _s={Transition:ms,TransitionGroup:ys};xi.config.mustUseProp=Ui,xi.config.isReservedTag=rr,xi.config.isReservedAttr=ki,xi.config.getTagNamespace=or,xi.config.isUnknownElement=ar,R(xi.options.directives,ss),R(xi.options.components,_s),xi.prototype.__patch__=X?Go:C,xi.prototype.$mount=function(e,t){return e=e&&X?ur(e):void 0,Nn(this,e,t)},X&&setTimeout(function(){V.devtools&&ue&&ue.emit("init",xi)},0),t["a"]=xi}).call(this,n("c8ba"))},"2b4c":function(e,t,n){var i=n("5537")("wks"),r=n("ca5a"),o=n("7726").Symbol,s="function"==typeof o,a=e.exports=function(e){return i[e]||(i[e]=s&&o[e]||(s?o:r)("Symbol."+e))};a.store=i},"2d00":function(e,t){e.exports=!1},"2d95":function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},"2f21":function(e,t,n){"use strict";var i=n("79e5");e.exports=function(e,t){return!!e&&i(function(){t?e.call(null,function(){},1):e.call(null)})}},"31f4":function(e,t){e.exports=function(e,t,n){var i=void 0===n;switch(t.length){case 0:return i?e():e.call(n);case 1:return i?e(t[0]):e.call(n,t[0]);case 2:return i?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return i?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return i?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},"32e9":function(e,t,n){var i=n("86cc"),r=n("4630");e.exports=n("9e1e")?function(e,t,n){return i.f(e,t,r(1,n))}:function(e,t,n){return e[t]=n,e}},"33a4":function(e,t,n){var i=n("84f2"),r=n("2b4c")("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||o[r]===e)}},"35e8":function(e,t,n){var i=n("d9f6"),r=n("aebd");e.exports=n("8e60")?function(e,t,n){return i.f(e,t,r(1,n))}:function(e,t,n){return e[t]=n,e}},"38fd":function(e,t,n){var i=n("69a8"),r=n("4bf8"),o=n("613b")("IE_PROTO"),s=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=r(e),i(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?s:null}},"41a0":function(e,t,n){"use strict";var i=n("2aeb"),r=n("4630"),o=n("7f20"),s={};n("32e9")(s,n("2b4c")("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=i(s,{next:r(1,n)}),o(e,t+" Iterator")}},4362:function(e,t,n){t.nextTick=function(e){setTimeout(e,0)},t.platform=t.arch=t.execPath=t.title="browser",t.pid=1,t.browser=!0,t.env={},t.argv=[],t.binding=function(e){throw new Error("No such module. (Possibly not yet loaded)")},function(){var e,i="/";t.cwd=function(){return i},t.chdir=function(t){e||(e=n("df7c")),i=e.resolve(t,i)}}(),t.exit=t.kill=t.umask=t.dlopen=t.uptime=t.memoryUsage=t.uvCounters=function(){},t.features={}},"446e":function(e,t,n){(function(e){(function(){var n="undefined"!=typeof window?window:e,i={};for(var r in function(e,t){var n,i="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)},o="undefined"!=typeof e&&e===this?this:"undefined"!=typeof t&&null!=t?t:this;function s(){s=function(){},o.Symbol||(o.Symbol=a)}var a=function(){var e=0;return function(t){return"jscomp_symbol_"+(t||"")+e++}}();function l(){s();var e=o.Symbol.iterator;e||(e=o.Symbol.iterator=o.Symbol("iterator")),"function"!=typeof Array.prototype[e]&&i(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return u(this)}}),l=function(){}}function u(e){var t=0;return c(function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}})}function c(e){return l(),e={next:e},e[o.Symbol.iterator]=function(){return this},e}function d(e){l();var t=e[Symbol.iterator];return t?t.call(e):u(e)}function h(e,t){if(t){for(var n=o,r=e.split("."),s=0;s<r.length-1;s++){var a=r[s];a in n||(n[a]={}),n=n[a]}r=r[r.length-1],s=n[r],a=t(s),a!=s&&null!=a&&i(n,r,{configurable:!0,writable:!0,value:a})}}function f(e){function t(t){return e.next(t)}function n(t){return e["throw"](t)}return new Promise(function(i,r){function o(e){e.done?i(e.value):Promise.resolve(e.value).then(t,n).then(o,r)}o(e.next())})}function p(e){return f(e())}function m(){this.g=!1,this.c=null,this.J=void 0,this.u=1,this.b=this.f=0,this.i=this.a=null}function g(e){if(e.g)throw new TypeError("Generator is already running");e.g=!0}function y(e,t){e.a={rc:t,yc:!0},e.u=e.f||e.b}function v(e,t,n){return e.u=n,{value:t}}function b(e,t,n){e.f=t,void 0!=n&&(e.b=n)}function E(e){e.f=0,e.b=2}function _(e,t){e.u=t,e.f=0}function x(e){e.f=0;var t=e.a.rc;return e.a=null,t}function T(e){e.i=[e.a],e.f=0,e.b=0}function S(e,t){var n=e.i.splice(0)[0];(n=e.a=e.a||n)?n.yc?e.u=e.f||e.b:void 0!=n.N&&e.b<n.N?(e.u=n.N,e.a=null):e.u=e.b:e.u=t}function w(e){this.a=new m,this.b=e}function I(e,t){g(e.a);var n=e.a.c;return n?D(e,"return"in n?n["return"]:function(e){return{value:e,done:!0}},t,e.a["return"]):(e.a["return"](t),M(e))}function D(e,t,n,i){try{var r=t.call(e.a.c,n);if(!(r instanceof Object))throw new TypeError("Iterator result "+r+" is not an object");if(!r.done)return e.a.g=!1,r;var o=r.value}catch(s){return e.a.c=null,y(e.a,s),M(e)}return e.a.c=null,i.call(e.a,o),M(e)}function M(e){for(;e.a.u;)try{var t=e.b(e.a);if(t)return e.a.g=!1,{value:t.value,done:!1}}catch(n){e.a.J=void 0,y(e.a,n)}if(e.a.g=!1,e.a.a){if(t=e.a.a,e.a.a=null,t.yc)throw t.rc;return{value:t["return"],done:!0}}return{value:void 0,done:!0}}function A(e){this.next=function(t){return g(e.a),e.a.c?t=D(e,e.a.c.next,t,e.a.h):(e.a.h(t),t=M(e)),t},this["throw"]=function(t){return g(e.a),e.a.c?t=D(e,e.a.c["throw"],t,e.a.h):(y(e.a,t),t=M(e)),t},this["return"]=function(t){return I(e,t)},l(),this[Symbol.iterator]=function(){return this}}function L(e,t){return A.prototype=e.prototype,new A(new w(t))}function R(e,t){return Object.prototype.hasOwnProperty.call(e,t)}h("Promise",function(e){function t(e){this.b=0,this.g=void 0,this.a=[];var t=this.c();try{e(t.resolve,t.reject)}catch(n){t.reject(n)}}function n(){this.a=null}function i(e){return e instanceof t?e:new t(function(t){t(e)})}if(e)return e;n.prototype.b=function(e){null==this.a&&(this.a=[],this.f()),this.a.push(e)},n.prototype.f=function(){var e=this;this.c(function(){e.h()})};var r=o.setTimeout;n.prototype.c=function(e){r(e,0)},n.prototype.h=function(){for(;this.a&&this.a.length;){var e=this.a;this.a=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(i){this.g(i)}}}this.a=null},n.prototype.g=function(e){this.c(function(){throw e})},t.prototype.c=function(){function e(e){return function(i){n||(n=!0,e.call(t,i))}}var t=this,n=!1;return{resolve:e(this.m),reject:e(this.f)}},t.prototype.m=function(e){if(e===this)this.f(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.o(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.l(e):this.h(e)}},t.prototype.l=function(e){var t=void 0;try{t=e.then}catch(n){return void this.f(n)}"function"==typeof t?this.s(t,e):this.h(e)},t.prototype.f=function(e){this.i(2,e)},t.prototype.h=function(e){this.i(1,e)},t.prototype.i=function(e,t){if(0!=this.b)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.b);this.b=e,this.g=t,this.j()},t.prototype.j=function(){if(null!=this.a){for(var e=0;e<this.a.length;++e)s.b(this.a[e]);this.a=null}};var s=new n;return t.prototype.o=function(e){var t=this.c();e.sb(t.resolve,t.reject)},t.prototype.s=function(e,t){var n=this.c();try{e.call(t,n.resolve,n.reject)}catch(i){n.reject(i)}},t.prototype.then=function(e,n){function i(e,t){return"function"==typeof e?function(t){try{r(e(t))}catch(n){o(n)}}:t}var r,o,s=new t(function(e,t){r=e,o=t});return this.sb(i(e,r),i(n,o)),s},t.prototype["catch"]=function(e){return this.then(void 0,e)},t.prototype.sb=function(e,t){function n(){switch(i.b){case 1:e(i.g);break;case 2:t(i.g);break;default:throw Error("Unexpected state: "+i.b)}}var i=this;null==this.a?s.b(n):this.a.push(n)},t.resolve=i,t.reject=function(e){return new t(function(t,n){n(e)})},t.race=function(e){return new t(function(t,n){for(var r=d(e),o=r.next();!o.done;o=r.next())i(o.value).sb(t,n)})},t.all=function(e){var n=d(e),r=n.next();return r.done?i([]):new t(function(e,t){function o(t){return function(n){s[t]=n,a--,0==a&&e(s)}}var s=[],a=0;do{s.push(void 0),a++,i(r.value).sb(o(s.length-1),t),r=n.next()}while(!r.done)})},t}),h("Promise.prototype.finally",function(e){return e||function(e){return this.then(function(t){return Promise.resolve(e()).then(function(){return t})},function(t){return Promise.resolve(e()).then(function(){throw t})})}}),m.prototype.h=function(e){this.J=e},m.prototype["return"]=function(e){this.a={return:e},this.u=this.b},m.prototype.N=function(e){this.u=e},h("WeakMap",function(e){function t(e){if(this.a=(a+=Math.random()+1).toString(),e){s(),l(),e=d(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function n(e){R(e,o)||i(e,o,{value:{}})}function r(e){var t=Object[e];t&&(Object[e]=function(e){return n(e),t(e)})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),i=new e([[t,2],[n,3]]);return 2==i.get(t)&&3==i.get(n)&&(i["delete"](t),i.set(n,4),!i.has(t)&&4==i.get(n))}catch(r){return!1}}())return e;var o="$jscomp_hidden_"+Math.random();r("freeze"),r("preventExtensions"),r("seal");var a=0;return t.prototype.set=function(e,t){if(n(e),!R(e,o))throw Error("WeakMap key fail: "+e);return e[o][this.a]=t,this},t.prototype.get=function(e){return R(e,o)?e[o][this.a]:void 0},t.prototype.has=function(e){return R(e,o)&&R(e[o],this.a)},t.prototype["delete"]=function(e){return!(!R(e,o)||!R(e[o],this.a))&&delete e[o][this.a]},t}),h("Map",function(e){function t(){var e={};return e.pa=e.next=e.head=e}function n(e,t){var n=e.a;return c(function(){if(n){for(;n.head!=e.a;)n=n.pa;for(;n.next!=n.head;)return n=n.next,{done:!1,value:t(n)};n=null}return{done:!0,value:void 0}})}function i(e,t){var n=t&&typeof t;"object"==n||"function"==n?o.has(t)?n=o.get(t):(n=""+ ++a,o.set(t,n)):n="p_"+t;var i=e.b[n];if(i&&R(e.b,n))for(var r=0;r<i.length;r++){var s=i[r];if(t!==t&&s.key!==s.key||t===s.key)return{id:n,list:i,index:r,P:s}}return{id:n,list:i,index:-1,P:void 0}}function r(e){if(this.b={},this.a=t(),this.size=0,e){e=d(e);for(var n;!(n=e.next()).done;)n=n.value,this.set(n[0],n[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(d([[t,"s"]]));if("s"!=n.get(t)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var i=n.entries(),r=i.next();return!r.done&&r.value[0]==t&&"s"==r.value[1]&&(r=i.next(),!(r.done||4!=r.value[0].x||"t"!=r.value[1]||!i.next().done))}catch(o){return!1}}())return e;s(),l();var o=new WeakMap;r.prototype.set=function(e,t){var n=i(this,e);return n.list||(n.list=this.b[n.id]=[]),n.P?n.P.value=t:(n.P={next:this.a,pa:this.a.pa,head:this.a,key:e,value:t},n.list.push(n.P),this.a.pa.next=n.P,this.a.pa=n.P,this.size++),this},r.prototype["delete"]=function(e){return e=i(this,e),!(!e.P||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this.b[e.id],e.P.pa.next=e.P.next,e.P.next.pa=e.P.pa,e.P.head=null,this.size--,!0)},r.prototype.clear=function(){this.b={},this.a=this.a.pa=t(),this.size=0},r.prototype.has=function(e){return!!i(this,e).P},r.prototype.get=function(e){return(e=i(this,e).P)&&e.value},r.prototype.entries=function(){return n(this,function(e){return[e.key,e.value]})},r.prototype.keys=function(){return n(this,function(e){return e.key})},r.prototype.values=function(){return n(this,function(e){return e.value})},r.prototype.forEach=function(e,t){for(var n,i=this.entries();!(n=i.next()).done;)n=n.value,e.call(t,n[1],n[0],this)},r.prototype[Symbol.iterator]=r.prototype.entries;var a=0;return r}),h("Array.from",function(e){return e||function(e,t,n){l(),t=null!=t?t:function(e){return e};var i=[],r=e[Symbol.iterator];if("function"==typeof r)for(e=r.call(e);!(r=e.next()).done;)i.push(t.call(n,r.value));else{r=e.length;for(var o=0;o<r;o++)i.push(t.call(n,e[o]))}return i}}),h("Array.prototype.find",function(e){return e||function(e,t){e:{var n=this;n instanceof String&&(n=String(n));for(var i=n.length,r=0;r<i;r++){var o=n[r];if(e.call(t,o,r,n)){n=o;break e}}n=void 0}return n}}),h("Object.is",function(e){return e||function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t}}),h("Array.prototype.includes",function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var i=n.length,r=t||0;for(0>r&&(r=Math.max(r+i,0));r<i;r++){var o=n[r];if(o===e||Object.is(o,e))return!0}return!1}}),h("String.prototype.includes",function(e){return e||function(e,t){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==this.indexOf(e,t||0)}}),h("Set",function(e){function t(e){if(this.a=new Map,e){e=d(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.a.size}return function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(d([t]));if(!n.has(t)||1!=n.size||n.add(t)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var i=n.entries(),r=i.next();return!r.done&&r.value[0]==t&&r.value[1]==t&&(r=i.next(),!r.done&&r.value[0]!=t&&4==r.value[0].x&&r.value[1]==r.value[0]&&i.next().done)}catch(o){return!1}}()?e:(s(),l(),t.prototype.add=function(e){return this.a.set(e,e),this.size=this.a.size,this},t.prototype["delete"]=function(e){return e=this.a["delete"](e),this.size=this.a.size,e},t.prototype.clear=function(){this.a.clear(),this.size=0},t.prototype.has=function(e){return this.a.has(e)},t.prototype.entries=function(){return this.a.entries()},t.prototype.values=function(){return this.a.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var n=this;this.a.forEach(function(i){return e.call(t,i,i,n)})},t)}),h("Object.values",function(e){return e||function(e){var t,n=[];for(t in e)R(e,t)&&n.push(e[t]);return n}});var P=this;function C(e,t){var n,i=e.split("."),r=P;i[0]in r||!r.execScript||r.execScript("var "+i[0]);for(;i.length&&(n=i.shift());)i.length||void 0===t?r=r[n]?r[n]:r[n]={}:r[n]=t}function N(e,t){function n(){}n.prototype=t.prototype,e.jf=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.gf=function(e,n,i){return t.prototype[n].apply(e,Array.prototype.slice.call(arguments,2))}}function B(e){this.c=Math.exp(Math.log(.5)/e),this.b=this.a=0}function F(e,t,n){var i=Math.pow(e.c,t);n=n*(1-i)+i*e.a,isNaN(n)||(e.a=n,e.b+=t)}function k(e){return e.a/(1-Math.pow(e.c,e.b))}function O(){this.b=new B(2),this.c=new B(5),this.a=0}function U(){}function H(){}P.a=!0,O.prototype.getBandwidthEstimate=function(e){return 128e3>this.a?e:Math.min(k(this.b),k(this.c))},e.console&&e.console.log.bind&&(U=console.warn.bind(console));var j=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function V(e){var t;e instanceof V?(K(this,e.ja),this.Fa=e.Fa,this.ma=e.ma,q(this,e.Qa),this.$=e.$,z(this,te(e.a)),this.za=e.za):e&&(t=String(e).match(j))?(K(this,t[1]||"",!0),this.Fa=Y(t[2]||""),this.ma=Y(t[3]||"",!0),q(this,t[4]),this.$=Y(t[5]||"",!0),z(this,t[6]||"",!0),this.za=Y(t[7]||"")):this.a=new ee(null)}function K(e,t,n){e.ja=n?Y(t,!0):t,e.ja&&(e.ja=e.ja.replace(/:$/,""))}function q(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.Qa=t}else e.Qa=null}function z(e,t,n){t instanceof ee?e.a=t:(n||(t=$(t,J)),e.a=new ee(t))}function Y(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""}function $(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,W),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function W(e){return e=e.charCodeAt(0),"%"+(e>>4&15).toString(16)+(15&e).toString(16)}n=V.prototype,n.ja="",n.Fa="",n.ma="",n.Qa=null,n.$="",n.za="",n.toString=function(){var e=[],t=this.ja;if(t&&e.push($(t,G,!0),":"),t=this.ma){e.push("//");var n=this.Fa;n&&e.push($(n,G,!0),"@"),e.push(encodeURIComponent(t).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t=this.Qa,null!=t&&e.push(":",String(t))}return(t=this.$)&&(this.ma&&"/"!=t.charAt(0)&&e.push("/"),e.push($(t,"/"==t.charAt(0)?Q:X,!0))),(t=this.a.toString())&&e.push("?",t),(t=this.za)&&e.push("#",$(t,Z)),e.join("")},n.resolve=function(e){var t=new V(this);"data"===t.ja&&(t=new V);var n=!!e.ja;n?K(t,e.ja):n=!!e.Fa,n?t.Fa=e.Fa:n=!!e.ma,n?t.ma=e.ma:n=null!=e.Qa;var i=e.$;if(n)q(t,e.Qa);else if(n=!!e.$){if("/"!=i.charAt(0))if(this.ma&&!this.$)i="/"+i;else{var r=t.$.lastIndexOf("/");-1!=r&&(i=t.$.substr(0,r+1)+i)}if(".."==i||"."==i)i="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],s=0;s<i.length;){var a=i[s++];"."==a?r&&s==i.length&&o.push(""):".."==a?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&s==i.length&&o.push("")):(o.push(a),r=!0)}i=o.join("/")}}return n?t.$=i:n=""!==e.a.toString(),n?z(t,te(e.a)):n=!!e.za,n&&(t.za=e.za),t};var G=/[#\/\?@]/g,X=/[#\?:]/g,Q=/[#\?]/g,J=/[#\?@]/g,Z=/#/g;function ee(e){this.b=e||null}function te(e){var t=new ee;if(t.b=e.b,e.a){var n,i={};for(n in e.a)i[n]=e.a[n].concat();t.a=i,t.c=e.c}return t}function ne(){var e,t,n=new Promise(function(n,i){e=n,t=i});return n.resolve=e,n.reject=t,n}function ie(e,t){var n=oe();this.i=null==e.maxAttempts?n.maxAttempts:e.maxAttempts,this.f=null==e.baseDelay?n.baseDelay:e.baseDelay,this.h=null==e.fuzzFactor?n.fuzzFactor:e.fuzzFactor,this.g=null==e.backoffFactor?n.backoffFactor:e.backoffFactor,this.a=0,this.b=this.f,(this.c=t||!1)&&(this.a=1)}function re(t){if(t.a>=t.i){if(!t.c)return Promise.reject();t.a=1,t.b=t.f}var n=new ne;return t.a?(e.setTimeout(n.resolve,t.b*(1+(2*Math.random()-1)*t.h)),t.b*=t.g):n.resolve(),t.a++,n}function oe(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0}}function se(e,t,n,i){this.severity=e,this.category=t,this.code=n,this.data=Array.prototype.slice.call(arguments,3),this.handled=!1}function ae(e,t){this.promise=e,this.b=t,this.a=!1}function le(e){return new ae(Promise.reject(e),function(){return Promise.resolve()})}function ue(){var e=Promise.reject(new se(2,7,7001));return e["catch"](function(){}),new ae(e,function(){return Promise.resolve()})}function ce(e){return new ae(Promise.resolve(e),function(){return Promise.resolve()})}function de(e){return new ae(e,function(){return e["catch"](function(){})})}function he(e){return new ae(Promise.all(e.map(function(e){return e.promise})),function(){return Promise.all(e.map(function(e){return e.abort()}))})}function fe(e,t,n){try{var i=e(t);return i&&i.promise&&i.abort?(n.resolve(i.promise),function(){return i.abort()}):(n.resolve(i),function(){return Promise.resolve(i).then(function(){})["catch"](function(){})})}catch(r){return n.reject(r),function(){return Promise.resolve()}}}function pe(e,t){return!("number"!==typeof e||"number"!==typeof t||!isNaN(e)||!isNaN(t))||e===t}function me(e,t){t||(t=pe);for(var n=[],i=d(e),r=i.next();!r.done;r=i.next())r=r.value,-1==ge(n,r,t)&&n.push(r);return n}function ge(e,t,n){for(var i=0;i<e.length;++i)if(n(e[i],t))return i;return-1}function ye(e,t){var n=e.indexOf(t);-1<n&&e.splice(n,1)}function ve(e,t){var n=0;return e.forEach(function(e){n+=t(e)?1:0}),n}function be(e,t,n,i,r){var o,s=r in i,a=!0;for(o in t){var l=r+"."+o,u=s?i[r]:n[o];s||o in e?void 0===t[o]?void 0===u||s?delete e[o]:e[o]=Ee(u):u.constructor==Object&&t[o]&&t[o].constructor==Object?(e[o]||(e[o]=Ee(u)),l=be(e[o],t[o],u,i,l),a=a&&l):typeof t[o]!=typeof u||null==t[o]||t[o].constructor!=u.constructor?a=!1:e[o]=t[o]:a=!1}return a}function Ee(e){function t(e){switch(typeof e){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return e;default:if(!e||e.buffer&&e.buffer.constructor==ArrayBuffer)return e;if(0<=n.indexOf(e))return null;var i=e.constructor==Array;if(e.constructor!=Object&&!i)return null;n.push(e);var r,o=i?[]:{};for(r in e)o[r]=t(e[r]);return i&&(o.length=e.length),o}}var n=[];return t(e)}function _e(e,t){function n(){return Promise.all(e.map(function(e){return e.destroy()}))}return Promise.resolve(t()).then(function(e){return n().then(function(){return e})},function(e){return n().then(function(){throw e})})}function xe(){this.a=[]}function Te(e,t){e.a.push(t["finally"](function(){ye(e.a,t)}))}function Se(e){this.c=!1,this.g=new xe,this.a=[],this.b=[],this.f=e||null}ee.prototype.a=null,ee.prototype.c=null,ee.prototype.add=function(e,t){if(!this.a&&(this.a={},this.c=0,this.b))for(var n=this.b.split("&"),i=0;i<n.length;i++){var r=n[i].indexOf("="),o=null;if(0<=r){var s=n[i].substring(0,r);o=n[i].substring(r+1)}else s=n[i];s=decodeURIComponent(s.replace(/\+/g," ")),o=o||"",this.add(s,decodeURIComponent(o.replace(/\+/g," ")))}return this.b=null,(n=this.a.hasOwnProperty(e)&&this.a[e])||(this.a[e]=n=[]),n.push(t),this.c++,this},ee.prototype.toString=function(){if(this.b)return this.b;if(!this.a)return"";var e,t=[];for(e in this.a)for(var n=encodeURIComponent(e),i=this.a[e],r=0;r<i.length;r++){var o=n;""!==i[r]&&(o+="="+encodeURIComponent(i[r])),t.push(o)}return this.b=t.join("&")},ne.prototype.resolve=function(){},ne.prototype.reject=function(){},C("shaka.util.Error",se),se.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},se.Severity={RECOVERABLE:1,CRITICAL:2},se.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9},se.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,UNKNOWN_DATA_URI_ENCODING:1005,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013},C("shaka.util.AbortableOperation",ae),ae.failed=le,ae.aborted=ue,ae.completed=ce,ae.notAbortable=de,ae.prototype.abort=function(){return this.a=!0,this.b()},ae.prototype.abort=ae.prototype.abort,ae.all=he,ae.prototype["finally"]=function(e){return this.promise.then(function(){return e(!0)},function(){return e(!1)}),this},ae.prototype["finally"]=ae.prototype["finally"],ae.prototype.X=function(e,t){function n(){return r.reject(new se(2,7,7001)),i.abort()}var i=this,r=new ne;return this.promise.then(function(t){i.a?r.reject(new se(2,7,7001)):e?n=fe(e,t,r):r.resolve(t)},function(e){t?n=fe(t,e,r):r.reject(e)}),new ae(r,function(){return n()})},ae.prototype.chain=ae.prototype.X,xe.prototype.destroy=function(){var e=[];return this.a.forEach(function(t){t.promise["catch"](function(){}),e.push(t.abort())}),this.a=[],Promise.all(e)},C("shaka.net.NetworkingEngine",Se),Se.RequestType={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3},Se.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3};var we={};function Ie(e,t,n){n=n||3;var i=we[e];(!i||n>=i.priority)&&(we[e]={priority:n,ne:t})}function De(e,t){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t}}function Me(e){return e.then=function(t,n){return U("The network request interface has changed!  Please update your application to the new interface, which allows operations to be aborted.  Support for the old API will be removed in v2.5."),e.promise.then(t,n)},e["catch"]=function(t){return U("The network request interface has changed!  Please update your application to the new interface, which allows operations to be aborted.  Support for the old API will be removed in v2.5."),e.promise["catch"](t)},e}function Ae(e,t,n){var i=ce(void 0);return e.a.forEach(function(e){i=i.X(function(){return e(t,n)})}),i.X(void 0,function(e){if(e&&7001==e.code)throw e;throw new se(2,1,1006,e)})}function Le(e,t,n,i,r,o){var s=new V(n.uris[r]),a=s.ja;a||(a=location.protocol,a=a.slice(0,-1),K(s,a),n.uris[r]=s.toString());var l,u=(a=we[a])?a.ne:null;return u?de(re(i)).X(function(){if(e.c)return ue();l=Date.now();var i=u(n.uris[r],n,t);return void 0==i.promise&&(U("The scheme plugin interface has changed!  Please update your scheme plugins to the new interface to add support for abort().  Support for the old plugin interface will be removed in v2.5."),i=de(i)),i}).X(function(e){return void 0==e.timeMs&&(e.timeMs=Date.now()-l),e},function(s){if(s&&7001==s.code)throw s;if(e.c)return ue();if(s&&1==s.severity)return r=(r+1)%n.uris.length,Le(e,t,n,i,r,s);throw s||o}):le(new se(2,1,1e3,s))}function Re(e,t,n){var i=ce(void 0);return e.b.forEach(function(e){i=i.X(function(){return e(t,n)})}),i.X(function(){return n},function(e){if(e&&7001==e.code)throw e;var t=2;throw e instanceof se&&(t=e.severity),new se(t,1,1007,e)})}function Pe(){this.a={}}function Ce(){this.a=new Pe}function Ne(e,t,n,i){e.a&&(t=new ke(t,n,i),e.a.push(n,t))}function Be(e,t,n,i){Ne(e,t,n,function(e){this.qa(t,n),i(e)}.bind(e))}function Fe(e){if(e.a){var t,n=e.a,i=[];for(t in n.a)i.push.apply(i,n.a[t]);for(n=0;n<i.length;++n)i[n].qa();e.a.a={}}}function ke(e,t,n){this.target=e,this.type=t,this.a=n,this.target.addEventListener(t,n,!1)}function Oe(t,n){var i,r=n||{};for(i in r)this[i]=r[i];this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=e.performance&&e.performance.now?e.performance.now():Date.now(),this.type=t,this.isTrusted=!1,this.target=this.currentTarget=null,this.a=!1}function Ue(e,t){return e.reduce(function(e,t,n){return t["catch"](e.bind(null,n))}.bind(null,t),Promise.reject())}function He(e,t){return e.concat(t)}function je(){}function Ve(e){return null!=e}function Ke(e,t,n){return n.indexOf(e)==t}function qe(e,t){if(0==t.length)return e;var n=t.map(function(e){return new V(e)});return e.map(function(e){return new V(e)}).map(function(e){return n.map(e.resolve.bind(e))}).reduce(He,[]).map(function(e){return e.toString()})}function ze(e,t){return{keySystem:e,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:t||[],keyIds:[]}}Se.registerScheme=Ie,Se.unregisterScheme=function(e){delete we[e]},Se.prototype.qe=function(e){this.a.push(e)},Se.prototype.registerRequestFilter=Se.prototype.qe,Se.prototype.Ve=function(e){ye(this.a,e)},Se.prototype.unregisterRequestFilter=Se.prototype.Ve,Se.prototype.jd=function(){this.a=[]},Se.prototype.clearAllRequestFilters=Se.prototype.jd,Se.prototype.re=function(e){this.b.push(e)},Se.prototype.registerResponseFilter=Se.prototype.re,Se.prototype.We=function(e){ye(this.b,e)},Se.prototype.unregisterResponseFilter=Se.prototype.We,Se.prototype.kd=function(){this.b=[]},Se.prototype.clearAllResponseFilters=Se.prototype.kd,Se.prototype.destroy=function(){return this.c=!0,this.a=[],this.b=[],this.g.destroy()},Se.prototype.destroy=Se.prototype.destroy,Se.prototype.request=function(e,t){var n=this;if(this.c)return Me(ue());t.method=t.method||"GET",t.headers=t.headers||{},t.retryParameters=t.retryParameters?Ee(t.retryParameters):oe(),t.uris=Ee(t.uris);var i=Ae(this,e,t),r=i.X(function(){return Le(n,e,t,new ie(t.retryParameters,!1),0,null)}),o=r.X(function(t){return Re(n,e,t)}),s=Date.now(),a=0;i.promise.then(function(){a=Date.now()-s},function(){});var l=0;return r.promise.then(function(){l=Date.now()},function(){}),i=o.X(function(t){var i=Date.now()-l;return t.timeMs+=a,t.timeMs+=i,n.f&&!t.fromCache&&1==e&&n.f(t.timeMs,t.data.byteLength),t},function(e){throw e&&(e.severity=2),e}),Te(this.g,i),Me(i)},Se.prototype.request=Se.prototype.request,Pe.prototype.push=function(e,t){this.a.hasOwnProperty(e)?this.a[e].push(t):this.a[e]=[t]},Pe.prototype.get=function(e){return(e=this.a[e])?e.slice():null},Pe.prototype.remove=function(e,t){var n=this.a[e];if(n)for(var i=0;i<n.length;++i)n[i]==t&&(n.splice(i,1),--i)},Ce.prototype.destroy=function(){return Fe(this),this.a=null,Promise.resolve()},Ce.prototype.qa=function(e,t){if(this.a)for(var n=this.a.get(t)||[],i=0;i<n.length;++i){var r=n[i];r.target==e&&(r.qa(),this.a.remove(t,r))}},ke.prototype.qa=function(){this.target.removeEventListener(this.type,this.a,!1),this.a=this.target=null},Oe.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},Oe.prototype.stopImmediatePropagation=function(){this.a=!0},Oe.prototype.stopPropagation=function(){};var Ye=1/15,$e={empty:function(e){return!e||0==Object.keys(e).length},values:function(e){return Object.keys(e).map(function(t){return e[t]})},map:function(e,t){return Object.keys(e).reduce(function(n,i){return n[i]=t(e[i],i),n},{})},every:function(e,t){return Object.keys(e).every(function(n){return t(n,e[n])})},forEach:function(e,t){Object.keys(e).forEach(function(n){t(n,e[n])})},ef:function(e){var t=new Map;return Object.keys(e).forEach(function(n){t.set(n,e[n])}),t},ff:function(e){var t={};return e.forEach(function(e,n){t[n]=e}),t}};function We(e,t){var n=e;return t&&(n+='; codecs="'+t+'"'),n}function Ge(e){var t=[e.mimeType];return Xe.forEach(function(n,i){var r=e[i];r&&t.push(n+'="'+r+'"')}),t.join(";")}var Xe=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");function Qe(e){if(!e)return"";e=new Uint8Array(e),239==e[0]&&187==e[1]&&191==e[2]&&(e=e.subarray(3)),e=escape(tt(e));try{return decodeURIComponent(e)}catch(t){throw new se(2,2,2004)}}function Je(e,t,n){if(!e)return"";if(!n&&0!=e.byteLength%2)throw new se(2,2,2004);if(e instanceof ArrayBuffer)var i=e;else n=new Uint8Array(e.byteLength),n.set(new Uint8Array(e)),i=n.buffer;e=Math.floor(e.byteLength/2),n=new Uint16Array(e),i=new DataView(i);for(var r=0;r<e;r++)n[r]=i.getUint16(2*r,t);return tt(n)}function Ze(e){var t=new Uint8Array(e);if(239==t[0]&&187==t[1]&&191==t[2])return Qe(t);if(254==t[0]&&255==t[1])return Je(t.subarray(2),!1);if(255==t[0]&&254==t[1])return Je(t.subarray(2),!0);var n=function(e,t){return e.byteLength<=t||32<=e[t]&&126>=e[t]}.bind(null,t);if(0==t[0]&&0==t[2])return Je(e,!1);if(0==t[1]&&0==t[3])return Je(e,!0);if(n(0)&&n(1)&&n(2)&&n(3))return Qe(e);throw new se(2,2,2003)}function et(e){e=encodeURIComponent(e),e=unescape(e);for(var t=new Uint8Array(e.length),n=0;n<e.length;++n)t[n]=e.charCodeAt(n);return t.buffer}function tt(e){for(var t="",n=0;n<e.length;n+=16e3)t+=String.fromCharCode.apply(null,e.subarray(n,n+16e3));return t}function nt(e){this.a=null,this.b=function(){this.a=null,e()}.bind(this)}function it(e){var t=Nt;e.cancel(),e.a=setTimeout(e.b,1e3*t)}function rt(e,t){e.cancel();var n=function(){this.b(),this.a=setTimeout(n,1e3*t)}.bind(e);e.a=setTimeout(n,1e3*t)}function ot(t,n){var i=void 0==n||n,r=e.btoa(tt(t)).replace(/\+/g,"-").replace(/\//g,"_");return i?r:r.replace(/=*$/,"")}function st(t){t=e.atob(t.replace(/-/g,"+").replace(/_/g,"/"));for(var n=new Uint8Array(t.length),i=0;i<t.length;++i)n[i]=t.charCodeAt(i);return n}function at(t){for(var n=new Uint8Array(t.length/2),i=0;i<t.length;i+=2)n[i/2]=e.parseInt(t.substr(i,2),16);return n}function lt(e){for(var t="",n=0;n<e.length;++n){var i=e[n].toString(16);1==i.length&&(i="0"+i),t+=i}return t}function ut(e,t){if(!e&&!t)return!0;if(!e||!t||e.length!=t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!=t[n])return!1;return!0}function ct(e){for(var t=0,n=0;n<arguments.length;++n)t+=arguments[n].length;t=new Uint8Array(t);for(var i=n=0;i<arguments.length;++i)t.set(arguments[i],n),n+=arguments[i].length;return t}function dt(e){this.s=e,this.l=this.j=this.v=null,this.G=!1,this.b=null,this.h=new Ce,this.a=[],this.o=[],this.i=new ne,this.f=null,this.g=function(t){this.i.reject(t),e.onError(t)}.bind(this),this.M={},this.m={},this.T=new nt(this.pe.bind(this)),this.c=!1,this.fa=new ne,this.ha=!1,this.A=[],this.ga=!1,this.K=new nt(this.oe.bind(this)),rt(this.K,1),this.i["catch"](function(){})}function ht(e){return p(function t(){var n;return L(t,function(t){switch(t.u){case 1:return v(t,e.h.destroy(),2);case 2:return e.h=null,e.i.reject(),e.K.cancel(),e.K=null,e.T.cancel(),e.T=null,n=e.a,e.a=[],v(t,Promise.all(n.map(function(e){return Promise.resolve().then(function(){return p(function t(){return L(t,function(t){switch(t.u){case 1:return b(t,2),v(t,Rt(e.ka),4);case 4:_(t,0);break;case 2:x(t),t.u=0}})})})})),3);case 3:if(!e.l){t.N(4);break}return b(t,5),v(t,e.l.setMediaKeys(null),7);case 7:_(t,6);break;case 5:x(t);case 6:e.l=null;case 4:e.b=null,e.v=null,e.j=null,e.o=[],e.f=null,e.g=null,e.s=null,t.u=0}})})}function ft(e,t){return Promise.all(t.map(function(e){return St(this,e).then(function(e){if(e){for(var t=new ne,n=0;n<this.a.length;n++)if(this.a[n].ka==e){this.a[n].ra=t;break}return Promise.all([e.remove(),t])}}.bind(this))}.bind(e)))}function pt(e){var t=e.b?e.b.initData:[];return t.forEach(function(e){wt(this,e.initDataType,e.initData)}.bind(e)),e.o.forEach(function(e){St(this,e)}.bind(e)),t.length||e.o.length||e.i.resolve(),e.i}function mt(e,t,n){for(var i=d(e.a),r=i.next();!r.done;r=i.next())if(ut(n,r.value.initData))return;wt(e,t,n)}function gt(e){return e.a.map(function(e){return e.ka.sessionId})}function yt(t,n,i,r,o){var s=Et(t),a=_t(t,n);n.periods.forEach(function(t){t.variants.forEach(function(t){s&&(t.drmInfos=[s]),a&&(t.drmInfos=a),t.drmInfos.forEach(function(n){bt(this,n),e.cast&&e.cast.__platform__&&"com.microsoft.playready"==n.keySystem&&(n.keySystem="com.chromecast.playready");var s=r[n.keySystem];s||(s={audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:i?"required":"optional",sessionTypes:[i?"persistent-license":"temporary"],label:n.keySystem,drmInfos:[]},r[n.keySystem]=s,o.push(n.keySystem)),s.drmInfos.push(n),n.distinctiveIdentifierRequired&&(s.distinctiveIdentifier="required"),n.persistentStateRequired&&(s.persistentState="required");var a=[];t.video&&a.push(t.video),t.audio&&a.push(t.audio),a.forEach(function(e){("video"==e.type?s.videoCapabilities:s.audioCapabilities).push({robustness:("video"==e.type?n.videoRobustness:n.audioRobustness)||"",contentType:We(e.mimeType,e.codecs)})}.bind(this))}.bind(this))}.bind(this))}.bind(t))}function vt(e,t,n,i){if(1==n.length&&""==n[0])return Promise.reject(new se(2,6,6e3));var r=new ne,o=r;return[!0,!1].forEach(function(e){n.forEach(function(n){var i=t[n];i.drmInfos.some(function(e){return!!e.licenseServerUri})==e&&(0==i.audioCapabilities.length&&delete i.audioCapabilities,0==i.videoCapabilities.length&&delete i.videoCapabilities,o=o["catch"](function(){if(!this.c)return navigator.requestMediaKeySystemAccess(n,[i])}.bind(this)))}.bind(this))}.bind(e)),o=o["catch"](function(){return Promise.reject(new se(2,6,6001))}),o=o.then(function(e){if(this.c)return Promise.reject();var n=0<=navigator.userAgent.indexOf("Edge/"),i=e.getConfiguration();return this.v=(i.audioCapabilities||[]).concat(i.videoCapabilities||[]).map(function(e){return e.contentType}),n&&(this.v=null),n=t[e.keySystem],xt(this,e.keySystem,n,n.drmInfos),this.b.licenseServerUri?e.createMediaKeys():Promise.reject(new se(2,6,6012))}.bind(e)).then(function(e){if(this.c)return Promise.reject();this.j=e,this.G=!0}.bind(e))["catch"](function(e){if(!this.c)return this.v=this.b=null,e instanceof se?Promise.reject(e):Promise.reject(new se(2,6,6002,e.message))}.bind(e)),i||(o=o["catch"](function(){})),r.reject(),o}function bt(e,t){var n=t.keySystem;if(n){if(!t.licenseServerUri){var i=e.f.servers[n];i&&(t.licenseServerUri=i)}t.keyIds||(t.keyIds=[]),(n=e.f.advanced[n])&&(t.distinctiveIdentifierRequired||(t.distinctiveIdentifierRequired=n.distinctiveIdentifierRequired),t.persistentStateRequired||(t.persistentStateRequired=n.persistentStateRequired),t.videoRobustness||(t.videoRobustness=n.videoRobustness),t.audioRobustness||(t.audioRobustness=n.audioRobustness),t.serverCertificate||(t.serverCertificate=n.serverCertificate))}}function Et(t){if($e.empty(t.f.clearKeys))return null;var n,i=[],r=[];for(n in t.f.clearKeys){var o=t.f.clearKeys[n],s=at(n);o=at(o),s={kty:"oct",kid:ot(s,!1),k:ot(o,!1)},i.push(s),r.push(s.kid)}return t=JSON.stringify({keys:i}),r=JSON.stringify({kids:r}),r=[{initData:new Uint8Array(et(r)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+e.btoa(t),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:r,keyIds:[]}}function _t(e,t){var n=e.f,i=Object.keys(n.servers);return!i.length||t.periods.some(function(e){return e.variants.some(function(e){return e.drmInfos.length})})?null:i.map(function(e){return{keySystem:e,licenseServerUri:n.servers[e],distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:[]}})}function xt(e,t,n,i){var r=[],o=[],s=[],a=[];Tt(i,r,o,s,a),e.b={keySystem:t,licenseServerUri:r[0],distinctiveIdentifierRequired:"required"==n.distinctiveIdentifier,persistentStateRequired:"required"==n.persistentState,audioRobustness:n.audioCapabilities?n.audioCapabilities[0].robustness:"",videoRobustness:n.videoCapabilities?n.videoCapabilities[0].robustness:"",serverCertificate:o[0],initData:s,keyIds:a}}function Tt(e,t,n,i,r){function o(e,t){return!(!e.keyId||e.keyId!=t.keyId)||e.initDataType==t.initDataType&&ut(e.initData,t.initData)}e.forEach(function(e){if(-1==t.indexOf(e.licenseServerUri)&&t.push(e.licenseServerUri),e.serverCertificate&&-1==ge(n,e.serverCertificate,ut)&&n.push(e.serverCertificate),e.initData&&e.initData.forEach(function(e){-1==ge(i,e,o)&&i.push(e)}),e.keyIds)for(var s=0;s<e.keyIds.length;++s)-1==r.indexOf(e.keyIds[s])&&r.push(e.keyIds[s])})}function St(e,t){try{var n=e.j.createSession("persistent-license")}catch(o){var i=new se(2,6,6005,o.message);return e.g(i),Promise.reject(i)}Ne(e.h,n,"message",e.Ic.bind(e)),Ne(e.h,n,"keystatuseschange",e.Ec.bind(e));var r={initData:null,ka:n,loaded:!1,Ub:1/0,ra:null};return e.a.push(r),n.load(t).then(function(e){return this.c?Promise.reject():e?(r.loaded=!0,this.a.every(function(e){return e.loaded})&&this.i.resolve(),n):(this.a.splice(this.a.indexOf(r),1),void this.g(new se(2,6,6013)))}.bind(e),function(e){this.c||(this.a.splice(this.a.indexOf(r),1),this.g(new se(2,6,6005,e.message)))}.bind(e))}function wt(e,t,n){try{var i=e.ha?e.j.createSession("persistent-license"):e.j.createSession()}catch(r){return void e.g(new se(2,6,6005,r.message))}Ne(e.h,i,"message",e.Ic.bind(e)),Ne(e.h,i,"keystatuseschange",e.Ec.bind(e)),e.a.push({initData:n,ka:i,loaded:!1,Ub:1/0,ra:null}),i.generateRequest(t,n.buffer)["catch"](function(t){if(!e.c){for(var n=0;n<e.a.length;++n)if(e.a[n].ka==i){e.a.splice(n,1);break}if(t.errorCode&&t.errorCode.systemCode){var r=t.errorCode.systemCode;0>r&&(r+=Math.pow(2,32)),r="0x"+r.toString(16)}e.g(new se(2,6,6006,t.message,t,r))}})}function It(e,t){for(var n,i=t.target,r=0;r<e.a.length;r++)if(e.a[r].ka==i){n=e.a[r];break}r=De([e.b.licenseServerUri],e.f.retryParameters),r.body=t.message,r.method="POST","com.microsoft.playready"!=e.b.keySystem&&"com.chromecast.playready"!=e.b.keySystem||Dt(r),e.s.$a.request(2,r).promise.then(function(e){return this.c?Promise.reject():i.update(e.data).then(function(){this.s.onEvent(new Oe("drmsessionupdate")),n&&(n.ra&&n.ra.resolve(),setTimeout(function(){n.loaded=!0,this.a.every(function(e){return e.loaded})&&this.i.resolve()}.bind(this),1e3*Ct))}.bind(this))}.bind(e),function(e){this.c||(e=new se(2,6,6007,e),this.g(e),n&&n.ra&&n.ra.reject(e))}.bind(e))["catch"](function(e){this.c||(e=new se(2,6,6008,e.message),this.g(e),n&&n.ra&&n.ra.reject(e))}.bind(e))}function Dt(e){var t=Je(e.body,!0,!0);if(-1==t.indexOf("PlayReadyKeyMessage"))e.headers["Content-Type"]="text/xml; charset=utf-8";else{t=(new DOMParser).parseFromString(t,"application/xml");for(var n=t.getElementsByTagName("HttpHeader"),i=0;i<n.length;++i)e.headers[n[i].querySelector("name").textContent]=n[i].querySelector("value").textContent;e.body=st(t.querySelector("Challenge").textContent).buffer}}function Mt(){var e=[],t=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],n=[{videoCapabilities:t,persistentState:"required",sessionTypes:["persistent-license"]},{videoCapabilities:t}],i={};return"org.w3.clearkey com.widevine.alpha com.microsoft.playready com.apple.fps.2_0 com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" ").forEach(function(t){var r=navigator.requestMediaKeySystemAccess(t,n).then(function(e){var n=e.getConfiguration().sessionTypes;return n=!!n&&0<=n.indexOf("persistent-license"),0<=navigator.userAgent.indexOf("Tizen 3")&&(n=!1),i[t]={persistentState:n},e.createMediaKeys()})["catch"](function(){i[t]=null});e.push(r)}),Promise.all(e).then(function(){return i})}function At(e,t){var n=e.keySystem();return 0==t.drmInfos.length||t.drmInfos.some(function(e){return e.keySystem==n})}function Lt(e,t){if(!e.length)return t;if(!t.length)return e;for(var n=[],i=0;i<e.length;i++)for(var r=0;r<t.length;r++)if(e[i].keySystem==t[r].keySystem){var o=e[i];r=t[r];var s=[];s=s.concat(o.initData||[]),s=s.concat(r.initData||[]);var a=[];a=a.concat(o.keyIds),a=a.concat(r.keyIds),n.push({keySystem:o.keySystem,licenseServerUri:o.licenseServerUri||r.licenseServerUri,distinctiveIdentifierRequired:o.distinctiveIdentifierRequired||r.distinctiveIdentifierRequired,persistentStateRequired:o.persistentStateRequired||r.persistentStateRequired,videoRobustness:o.videoRobustness||r.videoRobustness,audioRobustness:o.audioRobustness||r.audioRobustness,serverCertificate:o.serverCertificate||r.serverCertificate,initData:s,keyIds:a});break}return n}function Rt(e){return p(function t(){var n,i;return L(t,function(t){switch(t.u){case 1:return n=e.close().then(function(){return!0}),i=new Promise(function(e){setTimeout(function(){e(!1)},1e3*Pt)}),v(t,Promise.race([n,i]),2);case 2:t.u=0}})})}C("shaka.util.StringUtils.fromUTF8",Qe),C("shaka.util.StringUtils.fromUTF16",Je),C("shaka.util.StringUtils.fromBytesAutoDetect",Ze),C("shaka.util.StringUtils.toUTF8",et),nt.prototype.cancel=function(){null!=this.a&&(clearTimeout(this.a),this.a=null)},C("shaka.util.Uint8ArrayUtils.toBase64",ot),C("shaka.util.Uint8ArrayUtils.fromBase64",st),C("shaka.util.Uint8ArrayUtils.fromHex",at),C("shaka.util.Uint8ArrayUtils.toHex",lt),C("shaka.util.Uint8ArrayUtils.equal",ut),C("shaka.util.Uint8ArrayUtils.concat",ct),n=dt.prototype,n.destroy=function(){var e=this;return p(function t(){return L(t,function(t){switch(t.u){case 1:return e.c?v(t,e.fa,0):(e.c=!0,v(t,ht(e),4));case 4:e.fa.resolve(),t.N(0)}})})},n.configure=function(e){this.f=e},n.init=function(e,t){var n={},i=[],r=e.periods.some(function(e){return e.variants.some(function(e){return e.drmInfos.length})});return this.ha=t,this.o=e.offlineSessionIds,yt(this,e,t||0<e.offlineSessionIds.length,n,i),i.length?vt(this,n,i,r):(this.G=!0,Promise.resolve())},n.rb=function(e){var t=this;if(!this.j)return Be(this.h,e,"encrypted",function(){this.g(new se(2,6,6010))}.bind(this)),Promise.resolve();this.l=e,Be(this.h,this.l,"play",this.Ud.bind(this)),e=this.l.setMediaKeys(this.j),e=e["catch"](function(e){return Promise.reject(new se(2,6,6003,e.message))});var n=null;return this.b.serverCertificate&&this.b.serverCertificate.length&&(n=this.j.setServerCertificate(this.b.serverCertificate).then(function(){})["catch"](function(e){return Promise.reject(new se(2,6,6004,e.message))})),Promise.all([e,n]).then(function(){if(t.c)return Promise.reject();pt(t),t.b.initData.length||t.o.length||Ne(t.h,t.l,"encrypted",function(e){return mt(t,e.initDataType,new Uint8Array(e.initData))})})["catch"](function(e){if(!t.c)return Promise.reject(e)})},n.keySystem=function(){return this.b?this.b.keySystem:""},n.vb=function(){var e=this.a.map(function(e){return e=e.ka.expiration,isNaN(e)?1/0:e});return Math.min.apply(Math,e)},n.Ic=function(e){this.f.delayLicenseRequestUntilPlayed&&this.l.paused&&!this.ga?this.A.push(e):It(this,e)},n.Ec=function(e){var t;for(e=e.target,t=0;t<this.a.length&&this.a[t].ka!=e;++t);var n=t<this.a.length,i=!1;e.keyStatuses.forEach(function(e,n){if("string"==typeof n){var r=n;n=e,e=r}if("com.microsoft.playready"==this.b.keySystem&&16==n.byteLength&&!/Tizen/.exec(navigator.userAgent)){r=new DataView(n);var o=r.getUint32(0,!0),s=r.getUint16(4,!0),a=r.getUint16(6,!0);r.setUint32(0,o,!1),r.setUint16(4,s,!1),r.setUint16(6,a,!1)}"com.microsoft.playready"==this.b.keySystem&&"status-pending"==e&&(e="usable"),"status-pending"!=e&&(this.a[t].loaded=!0),"expired"==e&&(i=!0),r=lt(new Uint8Array(n)),this.M[r]=e}.bind(this));var r=e.expiration-Date.now();(0>r||i&&1e3>r)&&n&&!this.a[t].ra&&(this.a.splice(t,1),e.close()["catch"](function(){})),this.a.every(function(e){return e.loaded})&&(this.i.resolve(),it(this.T))},n.pe=function(){function e(e,t){return"expired"==t}for(var t in this.m={},this.M)this.m[t]=this.M[t];!$e.empty(this.m)&&$e.every(this.m,e)&&this.g(new se(2,6,6014)),this.s.Vb(this.m)},n.Ud=function(){for(var e=0;e<this.A.length;e++)It(this,this.A[e]);this.ga=!0,this.A=[]},n.oe=function(){this.a.forEach(function(e){var t=e.Ub,n=e.ka.expiration;isNaN(n)&&(n=1/0),n!=t&&(this.s.onExpirationUpdated(e.ka.sessionId,n),e.Ub=n)}.bind(this))};var Pt=1,Ct=5,Nt=.5;function Bt(e){return!e||1==e.length&&1e-6>e.end(0)-e.start(0)?null:e.length?e.end(e.length-1):null}function Ft(e,t,n){return n=void 0===n?0:n,!(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0)||t>e.end(e.length-1))&&t+n>=e.start(0)}function kt(e,t){if(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0))return 0;for(var n=0,i=e.length-1;0<=i&&e.end(i)>t;--i)n+=e.end(i)-Math.max(e.start(i),t);return n}function Ot(e){if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}function Ut(e,t,n){this.startTime=e,this.endTime=t,this.payload=n,this.region=new Jt,this.position=null,this.positionAlign=Ht,this.size=100,this.textAlign=jt,this.writingDirection=zt,this.lineInterpretation=Yt,this.line=null,this.lineHeight="",this.lineAlign=$t,this.displayAlign=Kt,this.fontSize=this.backgroundColor=this.color="",this.fontWeight=Gt,this.fontStyle=Xt,this.fontFamily="",this.textDecoration=[],this.wrapLine=!0,this.id=""}C("shaka.text.Cue",Ut);var Ht="auto";Ut.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:Ht};var jt="center",Vt={LEFT:"left",RIGHT:"right",CENTER:jt,START:"start",END:"end"};Ut.textAlign=Vt;var Kt="before",qt={BEFORE:Kt,CENTER:"center",AFTER:"after"};Ut.displayAlign=qt;var zt=0;Ut.writingDirection={HORIZONTAL_LEFT_TO_RIGHT:zt,HORIZONTAL_RIGHT_TO_LEFT:1,VERTICAL_LEFT_TO_RIGHT:2,VERTICAL_RIGHT_TO_LEFT:3};var Yt=0;Ut.lineInterpretation={LINE_NUMBER:Yt,PERCENTAGE:1};var $t="center",Wt={CENTER:$t,START:"start",END:"end"};Ut.lineAlign=Wt;var Gt=400;Ut.fontWeight={NORMAL:Gt,BOLD:700};var Xt="normal",Qt={NORMAL:Xt,ITALIC:"italic",OBLIQUE:"oblique"};function Jt(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=Zt,this.scroll=en}Ut.fontStyle=Qt,Ut.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"},C("shaka.text.CueRegion",Jt);var Zt=1;Jt.units={PX:0,PERCENTAGE:Zt,LINES:2};var en="";function tn(){this.a=new muxjs.mp4.Transmuxer({keepOriginalTimestamps:!0}),this.b=null,this.g=[],this.c=[],this.f=!1,this.a.on("data",this.i.bind(this)),this.a.on("done",this.h.bind(this))}function nn(t,n){return!(!e.muxjs||"mp2t"!=t.split(";")[0].split("/")[1])&&(n?MediaSource.isTypeSupported(rn(n,t)):MediaSource.isTypeSupported(rn("audio",t))||MediaSource.isTypeSupported(rn("video",t)))}function rn(e,t){var n=t.replace("mp2t","mp4");"audio"==e&&(n=n.replace("video","audio"));var i=/avc1\.(66|77|100)\.(\d+)/.exec(n);if(i){var r="avc1.",o=i[1],s=Number(i[2]);r=("66"==o?r+"4200":"77"==o?r+"4d00":r+"6400")+(s>>4).toString(16),r+=(15&s).toString(16),n=n.replace(i[0],r)}return n}function on(e,t){e.f=!0,e.b=new ne,e.g=[],e.c=[];var n=new Uint8Array(t);return e.a.push(n),e.a.flush(),e.f&&e.b.reject(new se(2,3,3018)),e.b}function sn(e){this.f=null,this.c=e,this.h=this.i=0,this.g=1/0,this.b=this.a=null}Jt.scrollMode={NONE:en,UP:"up"},tn.prototype.destroy=function(){return this.a.dispose(),this.a=null,Promise.resolve()},tn.prototype.i=function(e){for(var t=0;t<e.captions.length;t++){var n=e.captions[t];this.c.push(new Ut(n.startTime,n.endTime,n.text))}t=new Uint8Array(e.data.byteLength+e.initSegment.byteLength),t.set(e.initSegment,0),t.set(e.data,e.initSegment.byteLength),this.g.push(t)},tn.prototype.h=function(){var e={data:ct.apply(null,this.g),cues:this.c};this.b.resolve(e),this.f=!1};var an={};function ln(e,t,n,i){return Promise.resolve().then(function(){if(this.f&&this.c)if(null==n||null==i)this.f.parseInit(new Uint8Array(t));else{var e={periodStart:this.i,segmentStart:n,segmentEnd:i};e=this.f.parseMedia(new Uint8Array(t),e).filter(function(e){return e.startTime>=this.h&&e.startTime<this.g}.bind(this)),this.c.append(e),null==this.a&&(this.a=Math.max(n,this.h)),this.b=Math.min(i,this.g)}}.bind(e))}function un(t){this.f=t,this.o=null,this.b={},this.a=null,this.c={},this.h=new Ce,this.m=!1,this.i={},this.l=!1,t=this.j=new ne;var n=new MediaSource;Be(this.h,n,"sourceopen",t.resolve),this.f.src=e.URL.createObjectURL(n),this.g=n}function cn(){var e={};return'video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",").forEach(function(t){e[t]=!!an[t]||MediaSource.isTypeSupported(t)||nn(t);var n=t.split(";")[0];e[n]=e[n]||e[t]}),e}function dn(e,t){e.a||(e.a=new sn(e.o)),e.a.f=new an[t]}function hn(e,t){if("text"==t)var n=e.a.a;else n=mn(e,t),n=!n||1==n.length&&1e-6>n.end(0)-n.start(0)?null:1==n.length&&0>n.start(0)?0:n.length?n.start(0):null;return n}function fn(e,t){return"text"==t?e.a.b:Bt(mn(e,t))}function pn(e,t,n){return"text"==t?(e=e.a,null==e.b||e.b<n?0:e.b-Math.max(n,e.a)):(e=mn(e,t),kt(e,n))}function mn(e,t){try{return e.b[t].buffered}catch(n){return null}}function gn(e,t,n,i,r){return"text"==t?ln(e.a,n,i,r):e.i[t]?on(e.i[t],n).then(function(e){return this.a||dn(this,"text/vtt"),this.l&&this.a.lc(e.cues),bn(this,t,this.Vc.bind(this,t,e.data.buffer))}.bind(e)):bn(e,t,e.Vc.bind(e,t,n))}function yn(e,t){return"text"==t?e.a?e.a.remove(0,1/0):Promise.resolve():bn(e,t,e.Wc.bind(e,t,0,e.g.duration))}function vn(e,t,n,i,r){return"text"==t?(e.a.i=n,e=e.a,e.h=i,e.g=r,Promise.resolve()):Promise.all([bn(e,t,e.cd.bind(e,t)),bn(e,t,e.He.bind(e,t,n)),bn(e,t,e.Ee.bind(e,t,i,r))])}function bn(e,t,n){if(e.m)return Promise.reject();if(n={start:n,p:new ne},e.c[t].push(n),1==e.c[t].length)try{n.start()}catch(i){"QuotaExceededError"==i.name?n.p.reject(new se(2,3,3017,t)):n.p.reject(new se(2,3,3015,i)),_n(e,t)}return n.p}function En(e,t){if(e.m)return Promise.reject();var n,i=[];for(n in e.b){var r=new ne,o={start:function(e){e.resolve()}.bind(null,r),p:r};e.c[n].push(o),i.push(r),1==e.c[n].length&&o.start()}return Promise.all(i).then(function(){try{t()}catch(i){var e=Promise.reject(new se(2,3,3015,i))}for(var n in this.b)_n(this,n);return e}.bind(e),function(){return Promise.reject()}.bind(e))}function _n(e,t){e.c[t].shift();var n=e.c[t][0];if(n)try{n.start()}catch(i){n.p.reject(new se(2,3,3015,i)),_n(e,t)}}function xn(e,t,n){return n==t||e>=Tn&&n==t.split("-")[0]||e>=Sn&&n.split("-")[0]==t.split("-")[0]}C("shaka.text.TextEngine.registerParser",function(e,t){an[e]=t}),C("shaka.text.TextEngine.unregisterParser",function(e){delete an[e]}),sn.prototype.destroy=function(){return this.c=this.f=null,Promise.resolve()},sn.prototype.Fe=function(e){this.c=e},sn.prototype.setDisplayer=sn.prototype.Fe,sn.prototype.Lb=function(e){var t={periodStart:0,segmentStart:null,segmentEnd:0};try{return this.f.parseMedia(new Uint8Array(e),t)[0].startTime}catch(n){throw new se(2,2,2009,n)}},sn.prototype.remove=function(e,t){return Promise.resolve().then(function(){!this.c||!this.c.remove(e,t)||null==this.a||t<=this.a||e>=this.b||(e<=this.a&&t>=this.b?this.a=this.b=null:e<=this.a&&t<this.b?this.a=t:e>this.a&&t>=this.b&&(this.b=e))}.bind(this))},sn.prototype.lc=function(e){this.c.append(e)},sn.prototype.appendCues=sn.prototype.lc,n=un.prototype,n.destroy=function(){this.m=!0;var e,t=[];for(e in this.c){var n=this.c[e],i=n[0];for(this.c[e]=n.slice(0,1),i&&t.push(i.p["catch"](je)),i=1;i<n.length;++i)n[i].p["catch"](je),n[i].p.reject()}for(var r in this.a&&t.push(this.a.destroy()),this.i)t.push(this.i[r].destroy());return Promise.all(t).then(function(){var e=this.h?this.h.destroy():null;return this.f&&(this.f.removeAttribute("src"),this.f.load()),this.o=this.a=this.g=this.f=this.h=null,this.b={},this.i={},this.c={},e}.bind(this))},n.init=function(e,t){var n=this;return this.j.then(function(){for(var i in e){var r=e[i];r=We(r.mimeType,r.codecs),"text"==i?dn(n,r):(!t&&MediaSource.isTypeSupported(r)||!nn(r,i)||(n.i[i]=new tn,r=rn(i,r)),r=n.g.addSourceBuffer(r),Ne(n.h,r,"error",n.Re.bind(n,i)),Ne(n.h,r,"updateend",n.Oa.bind(n,i)),n.b[i]=r,n.c[i]=[])}})},n.Hb=function(){var e=this.a&&null!=this.a.a?[{start:this.a.a,end:this.a.b}]:[];return{total:Ot(this.f.buffered),audio:Ot(mn(this,"audio")),video:Ot(mn(this,"video")),text:e}},n.remove=function(e,t,n){return"text"==e?this.a.remove(t,n):bn(this,e,this.Wc.bind(this,e,t,n))},n.flush=function(e){return"text"==e?Promise.resolve():bn(this,e,this.nd.bind(this,e))},n.endOfStream=function(e){return En(this,function(){e?this.g.endOfStream(e):this.g.endOfStream()}.bind(this))},n.la=function(e){return En(this,function(){this.g.duration=e}.bind(this))},n.U=function(){return this.g.duration},n.Vc=function(e,t){this.b[e].appendBuffer(t)},n.Wc=function(e,t,n){n<=t?this.Oa(e):this.b[e].remove(t,n)},n.cd=function(e){var t=this.b[e].appendWindowStart,n=this.b[e].appendWindowEnd;this.b[e].abort(),this.b[e].appendWindowStart=t,this.b[e].appendWindowEnd=n,this.Oa(e)},n.nd=function(e){this.f.currentTime-=.001,this.Oa(e)},n.He=function(e,t){0>t&&(t+=.001),this.b[e].timestampOffset=t,this.Oa(e)},n.Ee=function(e,t,n){this.b[e].appendWindowStart=0,this.b[e].appendWindowEnd=n,this.b[e].appendWindowStart=t,this.Oa(e)},n.Re=function(e){this.c[e][0].p.reject(new se(2,3,3014,this.f.error?this.f.error.code:0))},n.Oa=function(e){var t=this.c[e][0];t&&(t.p.resolve(),_n(this,e))};var Tn=1,Sn=2;function wn(e){e=e.toLowerCase().split("-");var t=In[e[0]];return t&&(e[0]=t),e.join("-")}var In={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"};function Dn(e,t,n){var i=e.video;return!(i&&(i.width<t.minWidth||i.width>t.maxWidth||i.width>n.width||i.height<t.minHeight||i.height>t.maxHeight||i.height>n.height||i.width*i.height<t.minPixels||i.width*i.height>t.maxPixels)||e.bandwidth<t.minBandwidth||e.bandwidth>t.maxBandwidth)}function Mn(e,t,n){var i=!1;return e.variants.forEach(function(e){var r=e.allowedByApplication;e.allowedByApplication=Dn(e,t,n),r!=e.allowedByApplication&&(i=!0)}),i}function An(e,t,n,i){i.variants=i.variants.filter(function(i){return!(e&&e.G&&!At(e,i))&&(Ln(i.audio,e,t)&&Ln(i.video,e,n))}),i.textStreams=i.textStreams.filter(function(e){return!!an[We(e.mimeType,e.codecs)]})}function Ln(e,t,n){if(!e)return!0;var i=null;t&&t.G&&(i=t.v),t=We(e.mimeType,e.codecs);var r=We(e.mimeType,e.codecs),o=Ge(e);return!(!(an[r]||MediaSource.isTypeSupported(o)||nn(r,e.type))||i&&e.encrypted&&0>i.indexOf(t)||n&&(e.mimeType!=n.mimeType||e.codecs.split(".")[0]!=n.codecs.split(".")[0]))}function Rn(e){var t=e.audio,n=e.video,i=t?t.codecs:null,r=n?n.codecs:null,o=[];r&&o.push(r),i&&o.push(i);var s=[];n&&s.push(n.mimeType),t&&s.push(t.mimeType),s=s[0]||null;var a=[];t&&a.push(t.kind),n&&a.push(n.kind),a=a[0]||null;var l=[];return t&&l.push.apply(l,t.roles),n&&l.push.apply(l,n.roles),l=me(l),e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:a,width:null,height:null,frameRate:null,mimeType:s,codecs:o.join(", "),audioCodec:i,videoCodec:r,primary:e.primary,roles:l,videoId:null,audioId:null,channelsCount:null,audioBandwidth:null,videoBandwidth:null},n&&(e.videoId=n.id,e.width=n.width||null,e.height=n.height||null,e.frameRate=n.frameRate||null,e.videoBandwidth=n.bandwidth||null),t&&(e.audioId=t.id,e.channelsCount=t.channelsCount,e.audioBandwidth=t.bandwidth||null,e.label=t.label),e}function Pn(e){return{id:e.id,active:!1,type:"text",bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,mimeType:e.mimeType,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,videoId:null,audioId:null,channelsCount:null,audioBandwidth:null,videoBandwidth:null}}function Cn(e){var t=[],n=On(e.variants);return e=e.textStreams,n.forEach(function(e){t.push(Rn(e))}),e.forEach(function(e){t.push(Pn(e))}),t}function Nn(e,t,n){return On(e.variants).map(function(e){var i=Rn(e);return e.video&&e.audio?i.active=n==e.video.id&&t==e.audio.id:e.video?i.active=n==e.video.id:e.audio&&(i.active=t==e.audio.id),i})}function Bn(e,t){return e.textStreams.map(function(e){var n=Pn(e);return n.active=t==e.id,n})}function Fn(e,t){for(var n=0;n<e.variants.length;n++)if(e.variants[n].id==t.id)return e.variants[n];return null}function kn(e){return e.allowedByApplication&&e.allowedByKeySystem}function On(e){return e.filter(function(e){return kn(e)})}function Un(e,t,n,i,r){return e=Hn(e,t,n,r),jn(e,i)}function Hn(e,t,n,i){var r=On(e),o=r;e=r.filter(function(e){return e.primary}),e.length&&(o=e);var s=o.length?o[0].language:"";if(o=o.filter(function(e){return e.language==s}),t){var a=wn(t);[Sn,Tn,0].forEach(function(e){var t=!1;r.forEach(function(n){a=wn(a);var r=wn(n.language);xn(e,a,r)&&(t?o.push(n):(o=[n],t=!0),i&&(i.audio=!0))})})}return n&&(t=Kn(o,n),t.length)?t:(t=o.map(function(e){return(e.audio?e.audio.roles:[]).concat(e.video?e.video.roles:[])}).reduce(He,[]),t.length?Kn(o,t[0]):o)}function jn(e,t){var n=e.filter(function(e){return e.audio&&e.audio.channelsCount}).reduce(function(e,t){var n=t.audio.channelsCount;return e[n]?e[n].push(t):e[n]=[t],e},{}),i=Object.keys(n);if(0==i.length)return e;var r=i.filter(function(e){return e<=t});return r.length?n[Math.max.apply(null,r)]:n[Math.min.apply(null,i)]}function Vn(e,t,n,i){var r=e,o=e.filter(function(e){return e.primary});o.length&&(r=o);var s=r.length?r[0].language:"";if(r=r.filter(function(e){return e.language==s}),t){var a=wn(t);[Sn,Tn,0].forEach(function(t){var n=!1;e.forEach(function(e){var o=wn(e.language);xn(t,a,o)&&(n?r.push(e):(r=[e],n=!0),i&&(i.text=!0))})})}if(n){if(t=qn(r,n),t.length)return t}else if(t=r.filter(function(e){return 0==e.roles.length}),t.length)return t;return t=r.map(function(e){return e.roles}).reduce(He,[]),t.length?qn(r,t[0]):r}function Kn(e,t){return e.filter(function(e){return e.audio&&0<=e.audio.roles.indexOf(t)||e.video&&0<=e.video.roles.indexOf(t)})}function qn(e,t){return e.filter(function(e){return 0<=e.roles.indexOf(t)})}function zn(e,t,n){for(var i=0;i<n.length;i++)if(n[i].audio==e&&n[i].video==t)return n[i];return null}function Yn(e,t,n){function i(e,t){return null==e?null==t:t.id==e}for(var r=0;r<n.length;r++)if(i(e,n[r].audio)&&i(t,n[r].video))return n[r];return null}function $n(e,t){for(var n=e.periods.length-1;0<n;--n)if(t+Ye>=e.periods[n].startTime)return n;return 0}function Wn(e,t){for(var n=0;n<e.periods.length;++n){var i=e.periods[n];if("text"==t.type){for(var r=0;r<i.textStreams.length;++r)if(i.textStreams[r]==t)return n}else for(r=0;r<i.variants.length;++r){var o=i.variants[r];if(o.audio==t||o.video==t||o.video&&o.video.trickModeVideo==t)return n}}return-1}function Gn(){this.h=null,this.f=!1,this.b=new O,this.c=[],this.i=!1,this.a=this.g=null}function Xn(e,t){return e&&(t=t.filter(function(t){return Dn(t,e,{width:1/0,height:1/0})})),t.sort(function(e,t){return e.bandwidth-t.bandwidth})}C("shaka.abr.SimpleAbrManager",Gn),Gn.prototype.stop=function(){this.h=null,this.f=!1,this.c=[],this.g=null},Gn.prototype.stop=Gn.prototype.stop,Gn.prototype.init=function(e){this.h=e},Gn.prototype.init=Gn.prototype.init,Gn.prototype.chooseVariant=function(){var e=Xn(this.a.restrictions,this.c),t=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);this.c.length&&!e.length&&(e=Xn(null,this.c),e=[e[0]]);for(var n=e[0]||null,i=0;i<e.length;++i){var r=e[i],o=(e[i+1]||{bandwidth:1/0}).bandwidth/this.a.bandwidthUpgradeTarget;t>=r.bandwidth/this.a.bandwidthDowngradeTarget&&t<=o&&(n=r)}return this.g=Date.now(),n},Gn.prototype.chooseVariant=Gn.prototype.chooseVariant,Gn.prototype.enable=function(){this.f=!0},Gn.prototype.enable=Gn.prototype.enable,Gn.prototype.disable=function(){this.f=!1},Gn.prototype.disable=Gn.prototype.disable,Gn.prototype.segmentDownloaded=function(e,t){var n=this.b;if(!(16e3>t)){var i=8e3*t/e,r=e/1e3;n.a+=t,F(n.b,r,i),F(n.c,r,i)}if(null!=this.g&&this.f)e:{if(this.i){if(Date.now()-this.g<1e3*this.a.switchInterval)break e}else{if(!(128e3<=this.b.a))break e;this.i=!0}n=this.chooseVariant(),this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate),this.h(n)}},Gn.prototype.segmentDownloaded=Gn.prototype.segmentDownloaded,Gn.prototype.getBandwidthEstimate=function(){return this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate)},Gn.prototype.getBandwidthEstimate=Gn.prototype.getBandwidthEstimate,Gn.prototype.setVariants=function(e){this.c=e},Gn.prototype.setVariants=Gn.prototype.setVariants,Gn.prototype.configure=function(e){this.a=e},Gn.prototype.configure=Gn.prototype.configure;var Qn="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),Jn="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),Zn=["loop","playbackRate"],ei=["pause","play"],ti="adaptation buffering emsg error loading streaming texttrackvisibility timelineregionadded timelineregionenter timelineregionexit trackschanged unloading".split(" "),ni={getAudioLanguages:2,getAudioLanguagesAndRoles:2,getBufferedInfo:2,getConfiguration:2,getExpiration:2,getManifestUri:2,getPlaybackRate:2,getTextLanguages:2,getTextLanguagesAndRoles:2,getTextTracks:2,getStats:5,usingEmbeddedTextTrack:2,getVariantTracks:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1},ii={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},ri=[["getConfiguration","configure"]],oi=[["isTextTrackVisible","setTextTrackVisibility"]],si="addTextTrack cancelTrickPlay configure resetConfiguration retryStreaming selectAudioLanguage selectEmbeddedTextTrack selectTextLanguage selectTextTrack selectVariantTrack setTextTrackVisibility trickPlay".split(" "),ai=["attach","detach","load","unload"];function li(e){return JSON.stringify(e,function(e,t){if("function"!=typeof t){if(t instanceof Event||t instanceof Oe){var n,i={};for(n in t){var r=t[n];r&&"object"==typeof r?"detail"==n&&(i[n]=r):n in Event||(i[n]=r)}return i}if(t instanceof TimeRanges)for(i={__type__:"TimeRanges",length:t.length,start:[],end:[]},n=0;n<t.length;++n)i.start.push(t.start(n)),i.end.push(t.end(n));else i=t instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(t)}:"number"==typeof t?isNaN(t)?"NaN":isFinite(t)?t:0>t?"-Infinity":"Infinity":t;return i}})}function ui(e){return JSON.parse(e,function(e,t){return"NaN"==t?NaN:"-Infinity"==t?-1/0:"Infinity"==t?1/0:t&&"object"==typeof t&&"TimeRanges"==t.__type__?ci(t):t&&"object"==typeof t&&"Uint8Array"==t.__type__?new Uint8Array(t.entries):t})}function ci(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}}function di(e,t,n,i,r,o){this.K=e,this.g=t,this.M=n,this.j=!1,this.A=i,this.G=r,this.s=o,this.b=this.h=!1,this.v="",this.i=null,this.l=this.Cc.bind(this),this.m=this.Qd.bind(this),this.a={video:{},player:{}},this.o=0,this.c={},this.f=null}var hi=!1,fi=null;function pi(e){var t=fi;t.removeUpdateListener(e.l),t.removeMessageListener("urn:x-cast:com.google.shaka.v2",e.m)}function mi(e){for(var t in e.c){var n=e.c[t];delete e.c[t],n.reject(new se(1,7,7e3))}}function gi(e){e=li(e),fi.sendMessage("urn:x-cast:com.google.shaka.v2",e,function(){},H)}function yi(){this.Cb=new Pe,this.jb=this}function vi(e,t,n){yi.call(this),this.c=e,this.b=t,this.i=this.g=this.f=this.j=this.h=null,this.a=new di(n,this.Me.bind(this),this.Ne.bind(this),this.Oe.bind(this),this.Pe.bind(this),this.tc.bind(this)),bi(this)}function bi(e){for(var t in e.a.init(),e.i=new Ce,Qn.forEach(function(e){Ne(this.i,this.c,e,this.af.bind(this))}.bind(e)),ti.forEach(function(e){Ne(this.i,this.b,e,this.me.bind(this))}.bind(e)),e.h={},e.c)Object.defineProperty(e.h,t,{configurable:!1,enumerable:!0,get:e.$e.bind(e,t),set:e.bf.bind(e,t)});for(var n in e.j={},e.b)Object.defineProperty(e.j,n,{configurable:!1,enumerable:!0,get:e.le.bind(e,n)});e.f=new yi,e.f.jb=e.h,e.g=new yi,e.g.jb=e.j}function Ei(e,t,n,i){yi.call(this),this.a=e,this.b=t,this.c=new Ce,this.s={video:e,player:t},this.v=n||function(){},this.A=i||function(e){return e},this.o=!1,this.h=!0,this.g=0,this.m=!1,this.j=!0,this.l=this.i=this.f=null,_i(this)}function _i(t){var n=cast.receiver.CastReceiverManager.getInstance();n.onSenderConnected=t.Hc.bind(t),n.onSenderDisconnected=t.Hc.bind(t),n.onSystemVolumeChanged=t.md.bind(t),t.i=n.getCastMessageBus("urn:x-cast:com.google.cast.media"),t.i.onMessage=t.Ld.bind(t),t.f=n.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),t.f.onMessage=t.$d.bind(t),n.start(),Qn.forEach(function(e){Ne(this.c,this.a,e,this.Kc.bind(this,"video"))}.bind(t)),ti.forEach(function(e){Ne(this.c,this.b,e,this.Kc.bind(this,"player"))}.bind(t)),cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?t.b.cc(3840,2160):t.b.cc(1920,1080),Ne(t.c,t.a,"loadeddata",function(){this.m=!0}.bind(t)),Ne(t.c,t.b,"loading",function(){this.h=!1,xi(this)}.bind(t)),Ne(t.c,t.a,"playing",function(){this.h=!1,xi(this)}.bind(t)),Ne(t.c,t.a,"pause",function(){xi(this)}.bind(t)),Ne(t.c,t.b,"unloading",function(){this.h=!0,xi(this)}.bind(t)),Ne(t.c,t.a,"ended",function(){e.setTimeout(function(){this.a&&this.a.ended&&(this.h=!0,xi(this))}.bind(this),5e3)}.bind(t))}function xi(e){Promise.resolve().then(function(){this.b&&(this.dispatchEvent(new Oe("caststatuschanged")),Si(this)||Di(this,0))}.bind(e))}function Ti(e,t,n){for(var i in t.player)e.b[i](t.player[i]);e.v(n),n=Promise.resolve();var r=e.a.autoplay;t.manifest&&(e.a.autoplay=!1,n=e.b.load(t.manifest,t.startTime)),n.then(function(){if(e.b){for(var n in t.video)e.a[n]=t.video[n];for(var i in t.playerAfterLoad)e.b[i](t.playerAfterLoad[i]);e.a.autoplay=r,t.manifest&&(e.a.play(),Di(e,0))}},function(t){e.b.dispatchEvent(new Oe("error",{detail:t}))})}function Si(e){return!(!e.j||!e.a.duration&&!e.b.R())&&(wi(e),e.j=!1,!0)}function wi(e){var t={contentId:e.b.Jb(),streamType:e.b.R()?"LIVE":"BUFFERED",duration:e.a.duration,contentType:""};Di(e,0,t)}function Ii(e,t,n,i){e.o&&(e=li(t),i?n.getCastChannel(i).send(e):n.broadcast(e))}function Di(e,t,n){var i=e.a.playbackRate,r=Mi;r=e.h?r.IDLE:e.b.xc()?r.Yc:e.a.paused?r.$c:r.ad,i={mediaSessionId:0,playbackRate:i,playerState:r,currentTime:e.a.currentTime,supportedMediaCommands:15,volume:{level:e.a.volume,muted:e.a.muted}},n&&(i.media=n),Ii(e,{requestId:t,type:"MEDIA_STATUS",status:[i]},e.i)}n=di.prototype,n.destroy=function(){return mi(this),fi&&pi(this),this.G=this.A=this.g=null,this.b=this.h=!1,this.m=this.l=this.f=this.c=this.a=this.i=null,Promise.resolve()},n.Z=function(){return this.b},n.Zb=function(){return this.v},n.init=function(){if(e.chrome&&chrome.cast&&chrome.cast.isAvailable){delete e.__onGCastApiAvailable,this.h=!0,this.g();var t=new chrome.cast.SessionRequest(this.K);t=new chrome.cast.ApiConfig(t,this.Dc.bind(this),this.Xd.bind(this),"origin_scoped"),chrome.cast.initialize(t,function(){},function(){}),hi&&setTimeout(this.g.bind(this),20),(t=fi)&&t.status!=chrome.cast.SessionStatus.STOPPED?this.Dc(t):fi=null}else e.__onGCastApiAvailable=function(e){e&&this.init()}.bind(this)},n.bc=function(e){this.i=e,this.b&&gi({type:"appData",appData:this.i})},n.cast=function(e){return this.h?hi?this.b?Promise.reject(new se(1,8,8002)):(this.f=new ne,chrome.cast.requestSession(this.Wb.bind(this,e),this.Bc.bind(this)),this.f):Promise.reject(new se(1,8,8001)):Promise.reject(new se(1,8,8e3))},n.ub=function(){this.b&&(mi(this),fi&&(pi(this),fi.stop(function(){},function(){}),fi=null))},n.get=function(e,t){if("video"==e){if(0<=ei.indexOf(t))return this.Mc.bind(this,e,t)}else if("player"==e){if(ii[t]&&!this.get("player","isLive")())return function(){};if(0<=si.indexOf(t))return this.Mc.bind(this,e,t);if(0<=ai.indexOf(t))return this.te.bind(this,e,t);if(ni[t])return this.Jc.bind(this,e,t)}return this.Jc(e,t)},n.set=function(e,t,n){this.a[e][t]=n,gi({type:"set",targetName:e,property:t,value:n})},n.Wb=function(e,t){fi=t,t.addUpdateListener(this.l),t.addMessageListener("urn:x-cast:com.google.shaka.v2",this.m),this.Cc(),gi({type:"init",initState:e,appData:this.i}),this.f.resolve()},n.Bc=function(e){var t=8003;switch(e.code){case"cancel":t=8004;break;case"timeout":t=8005;break;case"receiver_unavailable":t=8006}this.f.reject(new se(2,8,t,e))},n.Jc=function(e,t){return this.a[e][t]},n.Mc=function(e,t){gi({type:"call",targetName:e,methodName:t,args:Array.prototype.slice.call(arguments,2)})},n.te=function(e,t){var n=Array.prototype.slice.call(arguments,2),i=new ne,r=this.o.toString();return this.o++,this.c[r]=i,gi({type:"asyncCall",targetName:e,methodName:t,args:n,id:r}),i},n.Dc=function(e){var t=this.s();this.f=new ne,this.j=!0,this.Wb(t,e)},n.Xd=function(e){hi="available"==e,this.g()},n.Cc=function(){var e=!!fi&&"connected"==fi.status;if(this.b&&!e){for(var t in this.G(),this.a)this.a[t]={};mi(this)}this.v=(this.b=e)?fi.receiver.friendlyName:"",this.g()},n.Qd=function(e,t){var n=ui(t);switch(n.type){case"event":var i=n.event;this.A(n.targetName,new Oe(i.type,i));break;case"update":for(var r in i=n.update,i)for(var o in n=this.a[r]||{},i[r])n[o]=i[r][o];this.j&&(this.M(),this.j=!1);break;case"asyncComplete":if(r=n.id,n=n.error,o=this.c[r],delete this.c[r],o)if(n){for(i in r=new se(n.severity,n.category,n.code),n)r[i]=n[i];o.reject(r)}else o.resolve()}},yi.prototype.addEventListener=function(e,t){this.Cb.push(e,t)},yi.prototype.removeEventListener=function(e,t){this.Cb.remove(e,t)},yi.prototype.dispatchEvent=function(e){for(var t=this.Cb.get(e.type)||[],n=0;n<t.length;++n){e.target=this.jb,e.currentTarget=this.jb;var i=t[n];try{i.handleEvent?i.handleEvent(e):i.call(this,e)}catch(r){}if(e.a)break}return e.defaultPrevented},N(vi,yi),C("shaka.cast.CastProxy",vi),vi.prototype.destroy=function(e){return e&&this.a&&this.a.ub(),e=[this.i?this.i.destroy():null,this.b?this.b.destroy():null,this.a?this.a.destroy():null],this.a=this.i=this.j=this.h=this.b=this.c=null,Promise.all(e)},vi.prototype.destroy=vi.prototype.destroy,vi.prototype.Cd=function(){return this.h},vi.prototype.getVideo=vi.prototype.Cd,vi.prototype.ud=function(){return this.j},vi.prototype.getPlayer=vi.prototype.ud,vi.prototype.fd=function(){return!!this.a&&(this.a.h&&hi)},vi.prototype.canCast=vi.prototype.fd,vi.prototype.Z=function(){return!!this.a&&this.a.Z()},vi.prototype.isCasting=vi.prototype.Z,vi.prototype.Zb=function(){return this.a?this.a.Zb():""},vi.prototype.receiverName=vi.prototype.Zb,vi.prototype.cast=function(){var e=this.tc();return this.a.cast(e).then(function(){if(this.b)return this.b.hb()}.bind(this))},vi.prototype.cast=vi.prototype.cast,vi.prototype.bc=function(e){this.a.bc(e)},vi.prototype.setAppData=vi.prototype.bc,vi.prototype.Te=function(){var e=this.a;if(e.b){var t=e.s();chrome.cast.requestSession(e.Wb.bind(e,t),e.Bc.bind(e))}},vi.prototype.suggestDisconnect=vi.prototype.Te,vi.prototype.ub=function(){this.a.ub()},vi.prototype.forceDisconnect=vi.prototype.ub,n=vi.prototype,n.tc=function(){var e={video:{},player:{},playerAfterLoad:{},manifest:this.b.Jb(),startTime:null};return this.c.pause(),Zn.forEach(function(t){e.video[t]=this.c[t]}.bind(this)),this.c.ended||(e.startTime=this.c.currentTime),ri.forEach(function(t){var n=t[1];t=this.b[t[0]](),e.player[n]=t}.bind(this)),oi.forEach(function(t){var n=t[1];t=this.b[t[0]](),e.playerAfterLoad[n]=t}.bind(this)),e},n.Me=function(){this.dispatchEvent(new Oe("caststatuschanged"))},n.Ne=function(){this.f.dispatchEvent(new Oe(this.h.paused?"pause":"play"))},n.Pe=function(){var e=this;ri.forEach(function(e){var t=e[1];e=this.a.get("player",e[0])(),this.b[t](e)}.bind(this));var t=this.a.get("player","getManifestUri")(),n=this.a.get("video","ended"),i=Promise.resolve(),r=this.c.autoplay,o=null;n||(o=this.a.get("video","currentTime")),t&&(this.c.autoplay=!1,i=this.b.load(t,o));var s={};Zn.forEach(function(e){s[e]=this.a.get("video",e)}.bind(this)),i.then(function(){e.c&&(Zn.forEach(function(e){this.c[e]=s[e]}.bind(e)),oi.forEach(function(e){var t=e[1];e=this.a.get("player",e[0])(),this.b[t](e)}.bind(e)),e.c.autoplay=r,t&&e.c.play())},function(t){e.b.dispatchEvent(new Oe("error",{detail:t}))})},n.$e=function(e){if("addEventListener"==e)return this.f.addEventListener.bind(this.f);if("removeEventListener"==e)return this.f.removeEventListener.bind(this.f);if(this.a.Z()&&0==Object.keys(this.a.a.video).length){var t=this.c[e];if("function"!=typeof t)return t}return this.a.Z()?this.a.get("video",e):(e=this.c[e],"function"==typeof e&&(e=e.bind(this.c)),e)},n.bf=function(e,t){this.a.Z()?this.a.set("video",e,t):this.c[e]=t},n.af=function(e){this.a.Z()||this.f.dispatchEvent(new Oe(e.type,e))},n.le=function(e){if("addEventListener"==e)return this.g.addEventListener.bind(this.g);if("removeEventListener"==e)return this.g.removeEventListener.bind(this.g);if("getMediaElement"==e)return function(){return this.h}.bind(this);if("getNetworkingEngine"==e)return this.b.uc.bind(this.b);if(this.a.Z()){if("getManifest"==e||"drmInfo"==e)return function(){return U(e+"() does not work while casting!"),null};if("attach"==e||"detach"==e)return function(){return U(e+"() does not work while casting!"),Promise.resolve()}}return this.a.Z()&&0==Object.keys(this.a.a.video).length&&ni[e]||!this.a.Z()?this.b[e].bind(this.b):this.a.get("player",e)},n.me=function(e){this.a.Z()||this.g.dispatchEvent(e)},n.Oe=function(e,t){this.a.Z()&&("video"==e?this.f.dispatchEvent(t):"player"==e&&this.g.dispatchEvent(t))},N(Ei,yi),C("shaka.cast.CastReceiver",Ei),Ei.prototype.isConnected=function(){return this.o},Ei.prototype.isConnected=Ei.prototype.isConnected,Ei.prototype.Fd=function(){return this.h},Ei.prototype.isIdle=Ei.prototype.Fd,Ei.prototype.destroy=function(){var t=[this.c?this.c.destroy():null,this.b?this.b.destroy():null];return null!=this.l&&e.clearTimeout(this.l),this.v=this.s=this.c=this.b=this.a=null,this.o=!1,this.h=!0,this.l=this.i=this.f=null,Promise.all(t).then(function(){cast.receiver.CastReceiverManager.getInstance().stop()})},Ei.prototype.destroy=Ei.prototype.destroy,n=Ei.prototype,n.Hc=function(){this.g=0,this.j=!0,this.o=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,xi(this)},n.Kc=function(e,t){this.b&&(this.Xb(),Ii(this,{type:"event",targetName:e,event:t},this.f))},n.Xb=function(){null!=this.l&&e.clearTimeout(this.l),this.l=e.setTimeout(this.Xb.bind(this),500);var t={video:{},player:{}};if(Jn.forEach(function(e){t.video[e]=this.a[e]}.bind(this)),this.b.R())for(var n in ii)0==this.g%ii[n]&&(t.player[n]=this.b[n]());for(var i in ni)0==this.g%ni[i]&&(t.player[i]=this.b[i]());(n=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(t.video.volume=n.level,t.video.muted=n.muted),this.m&&(this.g+=1),Ii(this,{type:"update",update:t},this.f),Si(this)},n.md=function(){var e=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();e&&Ii(this,{type:"update",update:{video:{volume:e.level,muted:e.muted}}},this.f),Ii(this,{type:"event",targetName:"video",event:{type:"volumechange"}},this.f)},n.$d=function(e){var t=ui(e.data);switch(t.type){case"init":this.g=0,this.m=!1,this.j=!0,Ti(this,t.initState,t.appData),this.Xb();break;case"appData":this.v(t.appData);break;case"set":var n=t.targetName,i=t.property;if(t=t.value,"video"==n){var r=cast.receiver.CastReceiverManager.getInstance();if("volume"==i){r.setSystemVolumeLevel(t);break}if("muted"==i){r.setSystemVolumeMuted(t);break}}this.s[n][i]=t;break;case"call":n=this.s[t.targetName],n[t.methodName].apply(n,t.args);break;case"asyncCall":n=t.targetName,i=t.methodName,"player"==n&&"load"==i&&(this.g=0,this.m=!1),r=t.id,e=e.senderId;var o=this.s[n];t=o[i].apply(o,t.args),"player"==n&&"load"==i&&(t=t.then(function(){this.j=!0}.bind(this))),t.then(this.Qc.bind(this,e,r,null),this.Qc.bind(this,e,r))}},n.Ld=function(e){var t=ui(e.data);switch(t.type){case"PLAY":this.a.play(),Di(this,0);break;case"PAUSE":this.a.pause(),Di(this,0);break;case"SEEK":e=t.currentTime;var n=t.resumeState;null!=e&&(this.a.currentTime=Number(e)),n&&"PLAYBACK_START"==n?(this.a.play(),Di(this,0)):n&&"PLAYBACK_PAUSE"==n&&(this.a.pause(),Di(this,0));break;case"STOP":this.b.hb().then(function(){this.b&&Di(this,0)}.bind(this));break;case"GET_STATUS":Di(this,Number(t.requestId));break;case"VOLUME":n=t.volume,e=n.level,n=n.muted;var i=this.a.volume,r=this.a.muted;null!=e&&(this.a.volume=Number(e)),null!=n&&(this.a.muted=n),i==this.a.volume&&r==this.a.muted||Di(this,0);break;case"LOAD":this.g=0,this.j=this.m=!1,e=t.currentTime,n=this.A(t.media.contentId),this.a.autoplay=!0,this.b.load(n,e).then(function(){this.b&&wi(this)}.bind(this))["catch"](function(e){var n="LOAD_FAILED";7==e.category&&7e3==e.code&&(n="LOAD_CANCELLED"),Ii(this,{requestId:Number(t.requestId),type:n},this.i)}.bind(this));break;default:Ii(this,{requestId:Number(t.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},this.i)}},n.Qc=function(e,t,n){this.b&&Ii(this,{type:"asyncComplete",id:t,error:n},this.f,e)};var Mi={IDLE:"IDLE",ad:"PLAYING",Yc:"BUFFERING",$c:"PAUSED"};function Ai(e,t){var n=Li(e,t);return 1!=n.length?null:n[0]}function Li(e,t){return Array.prototype.filter.call(e.childNodes,function(e){return e instanceof Element&&e.tagName==t})}function Ri(e){return Array.prototype.filter.call(e.childNodes,function(e){return e instanceof Element&&"pssh"==e.localName&&"urn:mpeg:cenc:2013"==e.namespaceURI})}function Pi(e,t,n){return e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}function Ci(e){return Array.prototype.every.call(e.childNodes,function(e){return e.nodeType==Node.TEXT_NODE||e.nodeType==Node.CDATA_SECTION_NODE})?e.textContent.trim():null}function Ni(e,t,n,i){var r=null;return e=e.getAttribute(t),null!=e&&(r=n(e)),null==r?void 0!=i?i:null:r}function Bi(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:Math.floor(e/1e3)):null}function Fi(e){return e?(e=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(e),e?(e=31536e3*Number(e[1]||null)+2592e3*Number(e[2]||null)+86400*Number(e[3]||null)+3600*Number(e[4]||null)+60*Number(e[5]||null)+Number(e[6]||null),isFinite(e)?e:null):null):null}function ki(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return t?(e=Number(t[1]),isFinite(e)?(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null):null):null}function Oi(e){return e=Number(e),0===e%1?e:null}function Ui(e){return e=Number(e),0===e%1&&0<e?e:null}function Hi(e){return e=Number(e),0===e%1&&0<=e?e:null}function ji(e){var t;return e=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1]/t[2]):Number(e),isNaN(e)?null:e}var Vi={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"};function Ki(e,t,n){e=Yi(e);var i=null,r=[],o=[],s=e.map(function(e){return e.keyId}).filter(Ve);if(s.length&&1<s.filter(Ke).length)throw new se(2,4,4010);n||(o=e.filter(function(e){return"urn:mpeg:dash:mp4protection:2011"!=e.Pc||(i=e.init||i,!1)}),o.length&&(r=zi(i,t,o),0==r.length&&(r=[ze("",i)]))),!e.length||!n&&o.length||(r=$e.values(Vi).filter(function(e){return"org.w3.clearkey"!=e}).map(function(e){return ze(e,i)}));var a=s[0]||null;return a&&r.forEach(function(e){e.initData.forEach(function(e){e.keyId=a})}),{nc:a,hf:i,drmInfos:r,sc:!0}}function qi(e,t,n,i){var r=Ki(e,t,i);if(n.sc)e=1==n.drmInfos.length&&!n.drmInfos[0].keySystem,t=0==r.drmInfos.length,(0==n.drmInfos.length||e&&!t)&&(n.drmInfos=r.drmInfos),n.sc=!1;else if(0<r.drmInfos.length&&(n.drmInfos=n.drmInfos.filter(function(e){return r.drmInfos.some(function(t){return t.keySystem==e.keySystem})}),0==n.drmInfos.length))throw new se(2,4,4008);return r.nc||n.nc}function zi(e,t,n){return n.map(function(n){var i=Vi[n.Pc];return i?[ze(i,n.init||e)]:t(n.node)||[]}).reduce(He,[])}function Yi(e){return e.map(function(e){var t=e.getAttribute("schemeIdUri"),n=Pi(e,"urn:mpeg:cenc:2013","default_KID"),i=Ri(e).map(Ci);if(!t)return null;if(t=t.toLowerCase(),n&&(n=n.replace(/-/g,"").toLowerCase(),0<=n.indexOf(" ")))throw new se(2,4,4009);var r=[];try{r=i.map(function(e){return{initDataType:"cenc",initData:st(e),keyId:null}})}catch(o){throw new se(2,4,4007)}return{node:e,Pc:t,keyId:n,init:0<r.length?r:null}}).filter(Ve)}function $i(t,n,i,r,o){var s={RepresentationID:n,Number:i,Bandwidth:r,Time:o};return t.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(t,n,i,r){if("$$"==t)return"$";var o=s[n];if(null==o)return t;switch("RepresentationID"==n&&i&&(i=void 0),"Time"==n&&(o=Math.round(o)),r){case void 0:case"d":case"i":case"u":t=o.toString();break;case"o":t=o.toString(8);break;case"x":t=o.toString(16);break;case"X":t=o.toString(16).toUpperCase();break;default:t=o.toString()}return i=e.parseInt(i,10)||1,Array(Math.max(0,i-t.length)+1).join("0")+t})}function Wi(e,t){var n=Gi(e,t,"timescale"),i=1;n&&(i=Ui(n)||1),n=Gi(e,t,"duration"),(n=Ui(n||""))&&(n/=i);var r=Gi(e,t,"startNumber"),o=Number(Gi(e,t,"presentationTimeOffset"))||0,s=Hi(r||"");null!=r&&null!=s||(s=1);var a=Xi(e,t,"SegmentTimeline");if(r=null,a){r=i;var l=e.L.duration||1/0;a=Li(a,"S");for(var u=[],c=0,d=0;d<a.length;++d){var h=a[d],f=Ni(h,"t",Hi),p=Ni(h,"d",Hi);if(h=Ni(h,"r",Oi),null!=f&&(f-=o),!p)break;if(f=null!=f?f:c,h=h||0,0>h)if(d+1<a.length){if(h=Ni(a[d+1],"t",Hi),null==h)break;if(f>=h)break;h=Math.ceil((h-f)/p)-1}else{if(1/0==l)break;if(f/r>=l)break;h=Math.ceil((l*r-f)/p)-1}0<u.length&&f!=c&&(u[u.length-1].end=f/r);for(var m=0;m<=h;++m)c=f+p,u.push({start:f/r,end:c/r,Xe:f}),f=c}r=u}return{timescale:i,S:n,Ea:s,ca:o/i||0,ic:o,H:r}}function Gi(e,t,n){return[t(e.w),t(e.W),t(e.aa)].filter(Ve).map(function(e){return e.getAttribute(n)}).reduce(function(e,t){return e||t})}function Xi(e,t,n){return[t(e.w),t(e.W),t(e.aa)].filter(Ve).map(function(e){return Ai(e,n)}).reduce(function(e,t){return e||t})}function Qi(e,t){var n=new DOMParser;try{var i=Qe(e),r=n.parseFromString(i,"text/xml")}catch(s){}if(r&&r.documentElement.tagName==t)var o=r.documentElement;return o&&0<o.getElementsByTagName("parsererror").length?null:o}function Ji(e,t,n,i,r,o){for(var s=Pi(e,"http://www.w3.org/1999/xlink","href"),a=Pi(e,"http://www.w3.org/1999/xlink","actuate")||"onRequest",l=0;l<e.attributes.length;l++){var u=e.attributes[l];"http://www.w3.org/1999/xlink"==u.namespaceURI&&(e.removeAttributeNS(u.namespaceURI,u.localName),--l)}if(5<=o)return le(new se(2,4,4028));if("onLoad"!=a)return le(new se(2,4,4027));var c=qe([i],[s]);return r.request(0,De(c,t)).X(function(i){if(i=Qi(i.data,e.tagName),!i)return le(new se(2,4,4001,s));for(;e.childNodes.length;)e.removeChild(e.childNodes[0]);for(;i.childNodes.length;){var a=i.childNodes[0];i.removeChild(a),e.appendChild(a)}for(a=0;a<i.attributes.length;a++){var l=i.attributes[a].nodeName,u=i.getAttribute(l);e.setAttribute(l,u)}return Zi(e,t,n,c[0],r,o+1)})}function Zi(e,t,n,i,r,o){if(o=o||0,Pi(e,"http://www.w3.org/1999/xlink","href")){var s=Ji(e,t,n,i,r,o);return n&&(s=s.X(void 0,function(){return Zi(e,t,n,i,r,o)})),s}s=[];for(var a=0;a<e.childNodes.length;a++){var l=e.childNodes[a];l instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==Pi(l,"http://www.w3.org/1999/xlink","href")?(e.removeChild(l),--a):"SegmentTimeline"!=l.tagName&&s.push(Zi(l,t,n,i,r,o)))}return he(s).X(function(){return e})}function er(e,t,n){this.c=e,this.b=t,this.a=n}function tr(e,t,n,i,r,o){this.position=e,this.startTime=t,this.endTime=n,this.c=i,this.b=r,this.a=o}function nr(e,t){this.D=e,this.b=t==rr,this.a=0}C("shaka.media.InitSegmentReference",er),er.prototype.Eb=function(){return this.c()},er.prototype.createUris=er.prototype.Eb,er.prototype.Kb=function(){return this.b},er.prototype.getStartByte=er.prototype.Kb,er.prototype.Ib=function(){return this.a},er.prototype.getEndByte=er.prototype.Ib,C("shaka.media.SegmentReference",tr),tr.prototype.V=function(){return this.position},tr.prototype.getPosition=tr.prototype.V,tr.prototype.Lb=function(){return this.startTime},tr.prototype.getStartTime=tr.prototype.Lb,tr.prototype.qd=function(){return this.endTime},tr.prototype.getEndTime=tr.prototype.qd,tr.prototype.Eb=function(){return this.c()},tr.prototype.createUris=tr.prototype.Eb,tr.prototype.Kb=function(){return this.b},tr.prototype.getStartByte=tr.prototype.Kb,tr.prototype.Ib=function(){return this.a},tr.prototype.getEndByte=tr.prototype.Ib,C("shaka.util.DataViewReader",nr);var ir,rr=1;function or(){throw new se(2,3,3e3)}function sr(){this.c=[],this.b=[],this.a=!1}function ar(e){for(;e.reader.ia()&&!e.parser.a;)e.parser.xb(e.start,e.reader,e.partialOkay)}function lr(e){for(var t=e.reader.B();0<t&&!e.parser.a;--t)e.parser.xb(e.start,e.reader,e.partialOkay)}function ur(e){return function(t){e(t.reader.Da(t.reader.D.byteLength-t.reader.V()))}}function cr(e){for(var t=0,n=0;n<e.length;n++)t=t<<8|e.charCodeAt(n);return t}function dr(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}function hr(e,t,n,i){var r,o=(new sr).Y("sidx",function(e){r=fr(t,i,n,e)});if(e&&o.parse(e),r)return r;throw new se(2,3,3004)}function fr(e,t,n,i){var r=[];i.reader.F(4);var o=i.reader.B();if(0==o)throw new se(2,3,3005);if(0==i.version)var s=i.reader.B(),a=i.reader.B();else s=i.reader.Ra(),a=i.reader.Ra();i.reader.F(2);var l=i.reader.bb();for(e=e+i.size+a,a=0;a<l;a++){var u=i.reader.B(),c=(2147483648&u)>>>31;u&=2147483647;var d=i.reader.B();if(i.reader.F(4),1==c)throw new se(2,3,3006);r.push(new tr(r.length,s/o-t,(s+d)/o-t,function(){return n},e,e+u-1)),s+=d,e+=u}return i.parser.stop(),r}function pr(e){this.a=e}function mr(e,t){for(;e.a.length;){if(!(e.a[e.a.length-1].startTime>=t))break;e.a.pop()}for(;e.a.length;){if(!(0>=e.a[0].endTime))break;e.a.shift()}if(0!=e.a.length){var n=e.a[e.a.length-1];e.a[e.a.length-1]=new tr(n.position,n.startTime,t,n.c,n.b,n.a)}}function gr(e){this.b=e,this.a=new nr(e,0),ir||(ir=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}function yr(e){var t=vr(e);if(7<t.length)throw new se(2,3,3002);for(var n=0,i=0;i<t.length;i++)n=256*n+t[i];t=n,n=vr(e);e:{for(i=0;i<ir.length;i++)if(ut(n,ir[i])){i=!0;break e}i=!1}if(i)n=e.b.byteLength-e.a.V();else{if(8==n.length&&224&n[1])throw new se(2,3,3001);i=n[0]&(1<<8-n.length)-1;for(var r=1;r<n.length;r++)i=256*i+n[r];n=i}return n=e.a.V()+n<=e.b.byteLength?n:e.b.byteLength-e.a.V(),i=new DataView(e.b.buffer,e.b.byteOffset+e.a.V(),n),e.a.F(n),new br(t,i)}function vr(e){var t,n=e.a.ba();for(t=1;8>=t&&!(n&1<<8-t);t++);if(8<t)throw new se(2,3,3002);var i=new Uint8Array(t);for(i[0]=n,n=1;n<t;n++)i[n]=e.a.ba();return i}function br(e,t){this.id=e,this.a=t}function Er(e){if(8<e.a.byteLength)throw new se(2,3,3002);if(8==e.a.byteLength&&224&e.a.getUint8(0))throw new se(2,3,3001);for(var t=0,n=0;n<e.a.byteLength;n++){var i=e.a.getUint8(n);t=256*t+i}return t}function _r(){}function xr(e,t,n,i,r,o){function s(){return r}var a=[];e=new gr(e.a);for(var l=null,u=null;e.ia();){var c=yr(e);if(187==c.id){var d=Tr(c);d&&(c=n*d.Ye,d=t+d.se,null!=l&&a.push(new tr(a.length,l-o,c-o,s,u,d-1)),l=c,u=d)}}return null!=l&&a.push(new tr(a.length,l-o,i-o,s,u,null)),a}function Tr(e){var t=new gr(e.a);if(e=yr(t),179!=e.id)throw new se(2,3,3013);if(e=Er(e),t=yr(t),183!=t.id)throw new se(2,3,3012);t=new gr(t.a);for(var n=0;t.ia();){var i=yr(t);if(241==i.id){n=Er(i);break}}return{Ye:e,se:n}}function Sr(e,t){var n=Xi(e,t,"Initialization");if(!n)return null;var i=e.w.da,r=n.getAttribute("sourceURL");r&&(i=qe(e.w.da,[r])),r=0;var o=null;return(n=Ni(n,"range",ki))&&(r=n.start,o=n.end),new er(function(){return i},r,o)}function wr(e,t){var n=Number(Gi(e,Dr,"presentationTimeOffset"))||0,i=Gi(e,Dr,"timescale"),r=1;i&&(r=Ui(i)||1),n=n/r||0,i=Sr(e,Dr);var o=e.w.contentType;if(r=e.w.mimeType.split("/")[1],"text"!=o&&"mp4"!=r&&"webm"!=r)throw new se(2,4,4006);if("webm"==r&&!i)throw new se(2,4,4005);o=Xi(e,Dr,"RepresentationIndex");var s=Gi(e,Dr,"indexRange"),a=e.w.da;if(s=ki(s||""),o){var l=o.getAttribute("sourceURL");l&&(a=qe(e.w.da,[l])),s=Ni(o,"range",ki,s)}if(!s)throw new se(2,4,4002);return r=Ir(e,t,i,a,s.start,s.end,r,n),{createSegmentIndex:r.createSegmentIndex,findSegmentPosition:r.findSegmentPosition,getSegmentReference:r.getSegmentReference,initSegmentReference:i,ca:n}}function Ir(e,t,n,i,r,o,s,a){var l=e.presentationTimeline,u=!e.Ia||!e.L.Mb,c=e.L.index,d=e.L.duration,h=t,f=null;return{createSegmentIndex:function(){var e=[h(i,r,o),"webm"==s?h(n.c(),n.b,n.a):null];return h=null,Promise.all(e).then(function(e){var t=e[0];e=e[1]||null,t="mp4"==s?hr(t,r,i,a):(new _r).parse(t,e,i,a),l.Na(t,0==c),f=new pr(t),u&&mr(f,d)})},findSegmentPosition:function(e){return f.find(e)},getSegmentReference:function(e){return f.get(e)}}}function Dr(e){return e.cb}function Mr(e,t){var n=Sr(e,Ar),i=Rr(e),r=Wi(e,Ar),o=r.Ea;0==o&&(o=1);var s=0;if(r.S?s=r.S*(o-1):r.H&&0<r.H.length&&(s=r.H[0].start),i={S:r.S,startTime:s,Ea:o,ca:r.ca,H:r.H,Ma:i},!i.S&&!i.H&&1<i.Ma.length)throw new se(2,4,4002);if(!i.S&&!e.L.duration&&!i.H&&1==i.Ma.length)throw new se(2,4,4002);if(i.H&&0==i.H.length)throw new se(2,4,4002);return o=r=null,e.aa.id&&e.w.id&&(o=e.aa.id+","+e.w.id,r=t[o]),s=Lr(e.L.duration,i.Ea,e.w.da,i),r?(r.Qb(s),o=e.presentationTimeline.Xa(),r.Gb(o-e.L.start)):(e.presentationTimeline.Na(s,0==e.L.index),r=new pr(s),o&&e.Ia&&(t[o]=r)),e.Ia&&e.L.Mb||mr(r,e.L.duration),{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:r.find.bind(r),getSegmentReference:r.get.bind(r),initSegmentReference:n,ca:i.ca}}function Ar(e){return e.ua}function Lr(e,t,n,i){var r=i.Ma.length;i.H&&i.H.length!=i.Ma.length&&(r=Math.min(i.H.length,i.Ma.length));for(var o=[],s=i.startTime,a=0;a<r;a++){var l=i.Ma[a],u=qe(n,[l.Hd]),c=void 0;c=null!=i.S?s+i.S:i.H?i.H[a].end:s+e,o.push(new tr(a+t,s,c,function(e){return e}.bind(null,u),l.start,l.end)),s=c}return o}function Rr(e){return[e.w.ua,e.W.ua,e.aa.ua].filter(Ve).map(function(e){return Li(e,"SegmentURL")}).reduce(function(e,t){return 0<e.length?e:t}).map(function(t){t.getAttribute("indexRange")&&!e.wc&&(e.wc=!0);var n=t.getAttribute("media");return t=Ni(t,"mediaRange",ki,{start:0,end:null}),{Hd:n,start:t.start,end:t.end}})}function Pr(e,t,n,i){var r=Fr(e),o=Wi(e,Cr),s=Gi(e,Cr,"media"),a=Gi(e,Cr,"index");if(o={S:o.S,timescale:o.timescale,Ea:o.Ea,ca:o.ca,ic:o.ic,H:o.H,Pb:s,Za:a},s=o.Za?1:0,s+=o.H?1:0,s+=o.S?1:0,0==s)throw new se(2,4,4002);if(1!=s&&(o.Za&&(o.H=null),o.S=null),!o.Za&&!o.Pb)throw new se(2,4,4002);if(o.Za){if(n=e.w.mimeType.split("/")[1],"mp4"!=n&&"webm"!=n)throw new se(2,4,4006);if("webm"==n&&!r)throw new se(2,4,4005);i=$i(o.Za,e.w.id,null,e.bandwidth||null,null),i=qe(e.w.da,[i]),e=Ir(e,t,r,i,0,null,n,o.ca)}else o.S?(i||e.presentationTimeline.Sb(o.S),e=Nr(e,o)):(s=t=null,e.aa.id&&e.w.id&&(s=e.aa.id+","+e.w.id,t=n[s]),a=Br(e,o),i=!e.Ia||!e.L.Mb,t?(i&&mr(new pr(a),e.L.duration),t.Qb(a),n=e.presentationTimeline.Xa(),t.Gb(n-e.L.start)):(e.presentationTimeline.Na(a,0==e.L.index),t=new pr(a),s&&e.Ia&&(n[s]=t)),i&&mr(t,e.L.duration),e={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:t.find.bind(t),getSegmentReference:t.get.bind(t)});return{createSegmentIndex:e.createSegmentIndex,findSegmentPosition:e.findSegmentPosition,getSegmentReference:e.getSegmentReference,initSegmentReference:r,ca:o.ca}}function Cr(e){return e.fb}function Nr(e,t){var n=e.L.duration,i=t.S,r=t.Ea,o=t.timescale,s=t.Pb,a=e.bandwidth||null,l=e.w.id,u=e.w.da;return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(e){return 0>e||n&&e>=n?null:Math.floor(e/i)},getSegmentReference:function(e){var t=e*i,c=t+i;return n&&(c=Math.min(c,n)),0>c||n&&t>=n?null:new tr(e,t,c,function(){var n=$i(s,l,e+r,a,t*o);return qe(u,[n])},0,null)}}}function Br(e,t){for(var n=[],i=0;i<t.H.length;i++){var r=i+t.Ea;n.push(new tr(r,t.H[i].start,t.H[i].end,function(e,t,n,i,r,o){return e=$i(e,t,r,n,o),qe(i,[e]).map(function(e){return e.toString()})}.bind(null,t.Pb,e.w.id,e.bandwidth||null,e.w.da,r,t.H[i].Xe+t.ic),0,null))}return n}function Fr(e){var t=Gi(e,Cr,"initialization");if(!t)return null;var n=e.w.id,i=e.bandwidth||null,r=e.w.da;return new er(function(){var e=$i(t,n,null,i,null);return qe(r,[e])},0,null)}nr.Endianness={cf:0,df:rr},nr.prototype.ia=function(){return this.a<this.D.byteLength},nr.prototype.hasMoreData=nr.prototype.ia,nr.prototype.V=function(){return this.a},nr.prototype.getPosition=nr.prototype.V,nr.prototype.rd=function(){return this.D.byteLength},nr.prototype.getLength=nr.prototype.rd,nr.prototype.ba=function(){try{var e=this.D.getUint8(this.a);return this.a+=1,e}catch(t){or()}},nr.prototype.readUint8=nr.prototype.ba,nr.prototype.bb=function(){try{var e=this.D.getUint16(this.a,this.b);return this.a+=2,e}catch(t){or()}},nr.prototype.readUint16=nr.prototype.bb,nr.prototype.B=function(){try{var e=this.D.getUint32(this.a,this.b);return this.a+=4,e}catch(t){or()}},nr.prototype.readUint32=nr.prototype.B,nr.prototype.Lc=function(){try{var e=this.D.getInt32(this.a,this.b);return this.a+=4,e}catch(t){or()}},nr.prototype.readInt32=nr.prototype.Lc,nr.prototype.Ra=function(){try{if(this.b)var e=this.D.getUint32(this.a,!0),t=this.D.getUint32(this.a+4,!0);else t=this.D.getUint32(this.a,!1),e=this.D.getUint32(this.a+4,!1)}catch(n){or()}if(2097151<t)throw new se(2,3,3001);return this.a+=8,t*Math.pow(2,32)+e},nr.prototype.readUint64=nr.prototype.Ra,nr.prototype.Da=function(e){this.a+e>this.D.byteLength&&or();var t=new Uint8Array(this.D.buffer,this.D.byteOffset+this.a,e);return this.a+=e,new Uint8Array(t)},nr.prototype.readBytes=nr.prototype.Da,nr.prototype.F=function(e){this.a+e>this.D.byteLength&&or(),this.a+=e},nr.prototype.skip=nr.prototype.F,nr.prototype.Oc=function(e){this.a<e&&or(),this.a-=e},nr.prototype.rewind=nr.prototype.Oc,nr.prototype.seek=function(e){(0>e||e>this.D.byteLength)&&or(),this.a=e},nr.prototype.seek=nr.prototype.seek,nr.prototype.Yb=function(){for(var e=this.a;this.ia()&&0!=this.D.getUint8(this.a);)this.a+=1;return e=new Uint8Array(this.D.buffer,this.D.byteOffset+e,this.a-e),this.a+=1,Qe(e)},nr.prototype.readTerminatedString=nr.prototype.Yb,C("shaka.util.Mp4Parser",sr),sr.prototype.C=function(e,t){var n=cr(e);return this.c[n]=0,this.b[n]=t,this},sr.prototype.box=sr.prototype.C,sr.prototype.Y=function(e,t){var n=cr(e);return this.c[n]=1,this.b[n]=t,this},sr.prototype.fullBox=sr.prototype.Y,sr.prototype.stop=function(){this.a=!0},sr.prototype.stop=sr.prototype.stop,sr.prototype.parse=function(e,t){var n=new Uint8Array(e);for(n=new nr(new DataView(n.buffer,n.byteOffset,n.byteLength),0),this.a=!1;n.ia()&&!this.a;)this.xb(0,n,t)},sr.prototype.parse=sr.prototype.parse,sr.prototype.xb=function(e,t,n){var i=t.V(),r=t.B(),o=t.B();switch(r){case 0:r=t.D.byteLength-i;break;case 1:r=t.Ra()}var s=this.b[o];if(s){var a=null,l=null;1==this.c[o]&&(l=t.B(),a=l>>>24,l&=16777215),o=i+r,n&&o>t.D.byteLength&&(o=t.D.byteLength),o-=t.V(),t=0<o?t.Da(o):new Uint8Array(0),t=new nr(new DataView(t.buffer,t.byteOffset,t.byteLength),0),s({parser:this,partialOkay:n||!1,version:a,flags:l,reader:t,size:r,start:i+e})}else t.F(Math.min(i+r-t.V(),t.D.byteLength-t.V()))},sr.prototype.parseNext=sr.prototype.xb,sr.children=ar,sr.sampleDescription=lr,sr.allData=ur,sr.typeToString=dr,C("shaka.media.SegmentIndex",pr),pr.prototype.destroy=function(){return this.a=null,Promise.resolve()},pr.prototype.destroy=pr.prototype.destroy,pr.prototype.find=function(e){for(var t=this.a.length-1;0<=t;--t){var n=this.a[t];if(e>=n.startTime&&e<n.endTime)return n.position}return this.a.length&&e<this.a[0].startTime?this.a[0].position:null},pr.prototype.find=pr.prototype.find,pr.prototype.get=function(e){return 0==this.a.length?null:(e-=this.a[0].position,0>e||e>=this.a.length?null:this.a[e])},pr.prototype.get=pr.prototype.get,pr.prototype.offset=function(e){for(var t=0;t<this.a.length;++t)this.a[t].startTime+=e,this.a[t].endTime+=e},pr.prototype.offset=pr.prototype.offset,pr.prototype.Qb=function(e){for(var t=[],n=0,i=0;n<this.a.length&&i<e.length;){var r=this.a[n],o=e[i];r.startTime<o.startTime?(t.push(r),n++):(r.startTime>o.startTime?0==n&&t.push(o):(.1<Math.abs(r.endTime-o.endTime)?t.push(new tr(r.position,o.startTime,o.endTime,o.c,o.b,o.a)):t.push(r),n++),i++)}for(;n<this.a.length;)t.push(this.a[n++]);if(t.length)for(n=t[t.length-1].position+1;i<e.length;)r=e[i++],r=new tr(n++,r.startTime,r.endTime,r.c,r.b,r.a),t.push(r);else t=e;this.a=t},pr.prototype.merge=pr.prototype.Qb,pr.prototype.Gb=function(e){for(var t=0;t<this.a.length;++t)if(this.a[t].endTime>e)return void this.a.splice(0,t);this.a=[]},pr.prototype.evict=pr.prototype.Gb,gr.prototype.ia=function(){return this.a.ia()},_r.prototype.parse=function(e,t,n,i){var r;if(t=new gr(new DataView(t)),440786851!=yr(t).id)throw new se(2,3,3008);var o=yr(t);if(408125543!=o.id)throw new se(2,3,3009);for(t=o.a.byteOffset,o=new gr(o.a),r=null;o.ia();){var s=yr(o);if(357149030==s.id){r=s;break}}if(!r)throw new se(2,3,3010);for(o=new gr(r.a),r=1e6,s=null;o.ia();){var a=yr(o);if(2807729==a.id)r=Er(a);else if(17545==a.id)if(s=a,4==s.a.byteLength)s=s.a.getFloat32(0);else{if(8!=s.a.byteLength)throw new se(2,3,3003);s=s.a.getFloat64(0)}}if(null==s)throw new se(2,3,3011);if(o=r/1e9,r=s*o,e=yr(new gr(new DataView(e))),475249515!=e.id)throw new se(2,3,3007);return xr(e,t,o,r,n,i)};var kr={},Or={};function Ur(){var e,t={};for(e in kr)t[e]=!0;for(var n in Or)t[n]=!0;return["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"].forEach(function(e){t[e]=!!kr[e]}),["mpd","m3u8","ism"].forEach(function(e){t[e]=!!Or[e]}),t}function Hr(e,t,n,i){var r=i;return r||(i=new V(e).$.split("/").pop().split("."),1<i.length&&(i=i.pop().toLowerCase(),r=Or[i])),r?Promise.resolve(r):(n=De([e],n),n.method="HEAD",t.request(0,n).promise.then(function(t){return(t=t.headers["content-type"])&&(t=t.toLowerCase()),(r=kr[t])?r:Promise.reject(new se(2,4,4e3,e))},function(e){return e.severity=2,Promise.reject(e)}))}function jr(e,t){this.g=e,this.l=t,this.f=this.b=1/0,this.a=1,this.j=this.c=0,this.i=!0,this.h=0}function Vr(){this.a=this.b=null,this.h=[],this.c=null,this.j=[],this.i=1,this.l={},this.m=0,this.o=new B(5),this.g=null,this.f=new xe}function Kr(e){var t=Date.now(),n=e.a.networkingEngine.request(0,De(e.h,e.b.retryParameters));return Te(e.f,n),n.promise.then(function(t){if(e.a)return qr(e,t.data,t.uri)}).then(function(){var n=(Date.now()-t)/1e3;return F(e.o,1,n),n})}function qr(e,t,n){if(t=Qi(t,"MPD"),!t)throw new se(2,4,4001,n);return t=Zi(t,e.b.retryParameters,e.b.dash.xlinkFailGracefully,n,e.a.networkingEngine),Te(e.f,t),t.promise.then(function(t){return zr(e,t,n)})}function zr(e,t,n){n=[n];var i=Li(t,"Location").map(Ci).filter(Ve);0<i.length&&(n=qe(n,i),e.h=n),i=Li(t,"BaseURL").map(Ci),n=qe(n,i);var r=Ni(t,"minBufferTime",Fi);e.m=Ni(t,"minimumUpdatePeriod",Fi,-1);var o=Ni(t,"availabilityStartTime",Bi);i=Ni(t,"timeShiftBufferDepth",Fi);var s=Ni(t,"suggestedPresentationDelay",Fi),a=Ni(t,"maxSegmentDuration",Fi),l=t.getAttribute("type")||"static";if(e.c)var u=e.c.presentationTimeline;else{var c=Math.max(e.b.dash.defaultPresentationDelay,1.5*r);u=new jr(o,null!=s?s:c)}o=Yr(e,{Ia:"static"!=l,presentationTimeline:u,aa:null,L:null,W:null,w:null,bandwidth:0,wc:!1},n,t),s=o.duration;var d=o.periods;return u.yb("static"==l),"static"!=l&&o.oc||u.la(s||1/0),(l=u.R())&&!isNaN(e.b.availabilityWindowOverride)&&(i=e.b.availabilityWindowOverride),null==i&&(i=1/0),u.dc(i),u.Sb(a||1),e.c?Promise.resolve():(t=Li(t,"UTCTiming"),to(e,n,t,l).then(function(e){this.a&&(u.Rc(e),this.c={presentationTimeline:u,periods:d,offlineSessionIds:[],minBufferTime:r||0})}.bind(e)))}function Yr(e,t,n,i){var r=Ni(i,"mediaPresentationDuration",Fi),o=[],s=0;i=Li(i,"Period");for(var a=0;a<i.length;a++){var l=i[a];s=Ni(l,"start",Fi,s);var u=Ni(l,"duration",Fi),c=null;if(a!=i.length-1){var d=Ni(i[a+1],"start",Fi);null!=d&&(c=d-s)}else null!=r&&(c=r-s);if(null==c&&(c=u),l=$r(e,t,n,{start:s,duration:c,node:l,index:a,Mb:null==c||a==i.length-1}),o.push(l),u=t.aa.id,-1==e.j.indexOf(u)&&(e.j.push(u),e.c&&(e.a.filterNewPeriod(l),e.c.periods.push(l))),null==c){s=null;break}s+=c}return null==e.c&&e.a.filterAllPeriods(o),null!=r?{periods:o,duration:r,oc:!1}:{periods:o,duration:s,oc:!0}}function $r(e,t,n,i){t.aa=Qr(i.node,null,n),t.L=i,t.aa.id||(t.aa.id="__shaka_period_"+i.start),Li(i.node,"EventStream").forEach(e.je.bind(e,i.start,i.duration)),n=Li(i.node,"AdaptationSet").map(e.he.bind(e,t)).filter(Ve);var r=n.map(function(e){return e.ue}).reduce(He,[]),o=r.filter(Ke);if(t.Ia&&r.length!=o.length)throw new se(2,4,4018);var s=n.filter(function(e){return!e.hc});if(n.filter(function(e){return e.hc}).forEach(function(e){var t=e.streams[0],n=e.hc;s.forEach(function(e){e.id==n&&e.streams.forEach(function(e){e.trickModeVideo=t})})}),n=Wr(s,"video"),r=Wr(s,"audio"),!n.length&&!r.length)throw new se(2,4,4004);for(r.length||(r=[null]),n.length||(n=[null]),t=[],o=0;o<r.length;o++)for(var a=0;a<n.length;a++)Gr(e,r[o],n[a],t);for(e=Wr(s,"text"),n=[],r=0;r<e.length;r++)n.push.apply(n,e[r].streams);return{startTime:i.start,textStreams:n,variants:t}}function Wr(e,t){return e.filter(function(e){return e.contentType==t})}function Gr(e,t,n,i){if(t||n)if(t&&n){var r=t.drmInfos,o=n.drmInfos;if(!r.length||!o.length||0<Lt(r,o).length){o=Lt(t.drmInfos,n.drmInfos);for(var s=0;s<t.streams.length;s++)for(var a=0;a<n.streams.length;a++)r=(n.streams[a].bandwidth||0)+(t.streams[s].bandwidth||0),r={id:e.i++,language:t.language,primary:t.Ob||n.Ob,audio:t.streams[s],video:n.streams[a],bandwidth:r,drmInfos:o,allowedByApplication:!0,allowedByKeySystem:!0},i.push(r)}}else for(o=t||n,s=0;s<o.streams.length;s++)r=o.streams[s].bandwidth||0,r={id:e.i++,language:o.language||"und",primary:o.Ob,audio:t?o.streams[s]:null,video:n?o.streams[s]:null,bandwidth:r,drmInfos:o.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0},i.push(r)}function Xr(t,n){0>t.m||(t.g=e.setTimeout(t.Qe.bind(t),1e3*Math.max(3,t.m-n,k(t.o))))}function Qr(e,t,n){t=t||{contentType:"",mimeType:"",codecs:"",containsEmsgBoxes:!1,frameRate:void 0,Tb:null},n=n||t.da;var i=Li(e,"BaseURL").map(Ci),r=e.getAttribute("contentType")||t.contentType,o=e.getAttribute("mimeType")||t.mimeType,s=e.getAttribute("codecs")||t.codecs,a=Ni(e,"frameRate",ji)||t.frameRate,l=!!Li(e,"InbandEventStream").length,u=Li(e,"AudioChannelConfiguration");return u=Jr(u)||t.Tb,r||(r=no(o,s)),{da:qe(n,i),cb:Ai(e,"SegmentBase")||t.cb,ua:Ai(e,"SegmentList")||t.ua,fb:Ai(e,"SegmentTemplate")||t.fb,width:Ni(e,"width",Hi)||t.width,height:Ni(e,"height",Hi)||t.height,contentType:r,mimeType:o,codecs:s,frameRate:a,containsEmsgBoxes:l||t.containsEmsgBoxes,id:e.getAttribute("id"),Tb:u}}function Jr(e){for(var t=0;t<e.length;++t){var n=e[t],i=n.getAttribute("schemeIdUri");if(i&&(n=n.getAttribute("value")))switch(i){case"urn:mpeg:dash:outputChannelPositionList:2012":return n.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":if(i=parseInt(n,10),!i)continue;return i;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(i=parseInt(n,16)){for(e=0;i;)1&i&&++e,i>>=1;return e}}}return null}function Zr(e){var t=e.cb?1:0;return t+=e.ua?1:0,t+=e.fb?1:0,0==t?"text"==e.contentType||"application"==e.contentType:(1!=t&&(e.cb&&(e.ua=null),e.fb=null),!0)}function eo(e,t,n,i){return t=qe(t,[n]),t=De(t,e.b.retryParameters),t.method=i,t=e.a.networkingEngine.request(0,t),Te(e.f,t),t.promise.then(function(e){if("HEAD"==i){if(!e.headers||!e.headers.date)return 0;e=e.headers.date}else e=Qe(e.data);return e=Date.parse(e),isNaN(e)?0:e-Date.now()})}function to(e,t,n,i){n=n.map(function(e){return{scheme:e.getAttribute("schemeIdUri"),value:e.getAttribute("value")}});var r=e.b.dash.clockSyncUri;return i&&!n.length&&r&&n.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:r}),Ue(n,function(e){var n=e.value;switch(e.scheme){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return eo(this,t,n,"HEAD");case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return eo(this,t,n,"GET");case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return e=Date.parse(n),isNaN(e)?0:e-Date.now();case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":return Promise.reject();default:return Promise.reject()}}.bind(e))["catch"](function(){return 0})}function no(e,t){return an[We(e,t)]?"text":e.split("/")[0]}function io(e,t,n,i){this.b=e,this.type=t,this.a=n,this.segments=i||null}function ro(e,t,n,i){this.id=e,this.name=t,this.a=n,this.value=i||null}function oo(e,t){this.name=e,this.value=t}function so(e,t,n){return n=n||null,(e=e.getAttribute(t))?e.value:n}function ao(e,t){this.b=t,this.a=e}function lo(e,t){return e.filter(function(e){return e.name==t})}function uo(e,t){var n=lo(e,t);return n.length?n[0]:null}function co(e,t,n){return e.filter(function(e){var i=e.getAttribute("TYPE");return e=e.getAttribute("GROUP-ID"),i.value==t&&e.value==n})}function ho(e){this.b=e,this.a=0}function fo(e){po(e,/[ \t]+/gm)}function po(e,t){t.lastIndex=e.a;var n=t.exec(e.b);return n=null==n?null:{position:n.index,length:n[0].length,xe:n},e.a==e.b.length||null==n||n.position!=e.a?null:(e.a+=n.length,n.xe)}function mo(e){return e.a==e.b.length?null:(e=po(e,/[^ \t\n]*/gm))?e[0]:null}function go(){this.a=0}function yo(e,t,n){t=Qe(t),t=t.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim();var i=t.split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(i[0]))throw new se(2,4,4015);t=0;for(var r=1;r<i.length;r++)if(!/^#(?!EXT)/m.test(i[r])){var o=bo(e,i[r]);if(--e.a,0<=Eo.indexOf(o.name)){t=1;break}"EXT-X-STREAM-INF"==o.name&&(r+=1)}for(r=[],o=1;o<i.length;)if(/^#(?!EXT)/m.test(i[o]))o+=1;else{var s=bo(e,i[o]);if(_o.includes(s.name)){if(1!=t)throw new se(2,4,4017);return i=i.splice(o,i.length-o),e=vo(e,n,i,r),new io(n,t,r,e)}r.push(s),o+=1,"EXT-X-STREAM-INF"==s.name&&(s.a.push(new oo("URI",i[o])),o+=1)}return new io(n,t,r)}function vo(e,t,n,i){var r=[],o=[];return n.forEach(function(n){if(/^(#EXT)/.test(n))n=bo(e,n),0<=Eo.indexOf(n.name)?i.push(n):o.push(n);else{if(/^#(?!EXT)/m.test(n))return[];n=qe([t],[n.trim()])[0],r.push(new ao(n,o)),o=[]}}),r}function bo(e,t){e:{var n=e.a++,i=t.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!i)throw new se(2,4,4016,t);var r=i[1],o=i[2];if(i=[],o&&0<=o.indexOf("=")){o=new ho(o);for(var s,a=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;s=po(o,a);)i.push(new oo(s[1],s[2]||s[3]))}else if(o){n=new ro(n,r,i,o);break e}n=new ro(n,r,i)}return n}C("shaka.media.ManifestParser.registerParserByExtension",function(e,t){Or[e]=t}),C("shaka.media.ManifestParser.registerParserByMime",function(e,t){kr[e]=t}),C("shaka.media.PresentationTimeline",jr),jr.prototype.U=function(){return this.b},jr.prototype.getDuration=jr.prototype.U,jr.prototype.la=function(e){this.b=e},jr.prototype.setDuration=jr.prototype.la,jr.prototype.wd=function(){return this.g},jr.prototype.getPresentationStartTime=jr.prototype.wd,jr.prototype.Rc=function(e){this.j=e},jr.prototype.setClockOffset=jr.prototype.Rc,jr.prototype.yb=function(e){this.i=e},jr.prototype.setStatic=jr.prototype.yb,jr.prototype.dc=function(e){this.f=e},jr.prototype.setSegmentAvailabilityDuration=jr.prototype.dc,jr.prototype.Sc=function(e){this.l=e},jr.prototype.setDelay=jr.prototype.Sc,jr.prototype.Na=function(e,t){0!=e.length&&(t&&(this.c=Math.max(this.c,e[0].startTime)),this.a=e.reduce(function(e,t){return Math.max(e,t.endTime-t.startTime)},this.a))},jr.prototype.notifySegments=jr.prototype.Na,jr.prototype.Sb=function(e){this.a=Math.max(this.a,e)},jr.prototype.notifyMaxSegmentDuration=jr.prototype.Sb,jr.prototype.offset=function(e){this.c+=e},jr.prototype.offset=jr.prototype.offset,jr.prototype.R=function(){return 1/0==this.b&&!this.i},jr.prototype.isLive=jr.prototype.R,jr.prototype.Aa=function(){return 1/0!=this.b&&!this.i},jr.prototype.isInProgress=jr.prototype.Aa,jr.prototype.Xa=function(){if(1/0==this.f)return this.h;var e=this.Ka()-this.f;return Math.max(this.h,e)},jr.prototype.getSegmentAvailabilityStart=jr.prototype.Xa,jr.prototype.Tc=function(e){this.h=e},jr.prototype.setUserSeekStart=jr.prototype.Tc,jr.prototype.Ka=function(){return this.R()||this.Aa()?Math.min(Math.max(0,(Date.now()+this.j)/1e3-this.a-this.g),this.b):this.b},jr.prototype.getSegmentAvailabilityEnd=jr.prototype.Ka,jr.prototype.Wa=function(e){var t=Math.max(this.c,this.h);if(1/0==this.f)return t;var n=this.Ka()-this.f;return e=Math.min(n+e,this.na()),Math.max(t,e)},jr.prototype.getSafeSeekRangeStart=jr.prototype.Wa,jr.prototype.Ja=function(){return this.Wa(0)},jr.prototype.getSeekRangeStart=jr.prototype.Ja,jr.prototype.na=function(){var e=this.R()||this.Aa()?this.l:0;return Math.max(0,this.Ka()-e)},jr.prototype.getSeekRangeEnd=jr.prototype.na,C("shaka.dash.DashParser",Vr),n=Vr.prototype,n.configure=function(e){this.b=e},n.start=function(e,t){return this.h=[e],this.a=t,Kr(this).then(function(e){return this.a&&Xr(this,e),this.c}.bind(this))},n.stop=function(){return this.b=this.a=null,this.h=[],this.c=null,this.j=[],this.l={},null!=this.g&&(e.clearTimeout(this.g),this.g=null),this.f.destroy()},n.update=function(){Kr(this)["catch"](function(e){this.a&&this.a.onError(e)}.bind(this))},n.onExpirationUpdated=function(){},n.he=function(e,t){e.W=Qr(t,e.aa,null);var n=!1,i=Li(t,"Role"),r=i.map(function(e){return e.getAttribute("value")}).filter(Ve),o=void 0,s="text"==e.W.contentType;s&&(o="subtitle");for(var a=0;a<i.length;a++){var l=i[a].getAttribute("schemeIdUri");if(null==l||"urn:mpeg:dash:role:2011"==l)switch(l=i[a].getAttribute("value"),l){case"main":n=!0;break;case"caption":case"subtitle":o=l}}var u=null,c=!1;if(Li(t,"EssentialProperty").forEach(function(e){"http://dashif.org/guidelines/trickmode"==e.getAttribute("schemeIdUri")?u=e.getAttribute("value"):c=!0}),c)return null;i=Li(t,"ContentProtection");var d=Ki(i,this.b.dash.customScheme,this.b.dash.ignoreDrmInfo);if(i=wn(t.getAttribute("lang")||"und"),l=t.getAttribute("label"),a=Li(t,"Representation"),r=a.map(this.ke.bind(this,e,d,o,i,l,n,r)).filter(function(e){return!!e}),0==r.length){if(s)return null;throw new se(2,4,4003)}return e.W.contentType&&"application"!=e.W.contentType||(e.W.contentType=no(r[0].mimeType,r[0].codecs),r.forEach(function(t){t.type=e.W.contentType})),r.forEach(function(e){d.drmInfos.forEach(function(t){e.keyId&&t.keyIds.push(e.keyId)})}),s=a.map(function(e){return e.getAttribute("id")}).filter(Ve),{id:e.W.id||"__fake__"+this.i++,contentType:e.W.contentType,language:i,Ob:n,streams:r,drmInfos:d.drmInfos,hc:u,ue:s}},n.ke=function(e,t,n,i,r,o,s,a){if(e.w=Qr(a,e.W,null),!Zr(e.w))return null;e.bandwidth=Ni(a,"bandwidth",Ui)||0;var l=e.w.contentType;l="text"==l||"application"==l;try{var u=this.ve.bind(this);if(e.w.cb)var c=wr(e,u);else if(e.w.ua)c=Mr(e,this.l);else if(e.w.fb)c=Pr(e,u,this.l,!!this.c);else{var d=e.w.da,h=e.L.duration||0;c={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(e){return 0<=e&&e<h?1:null},getSegmentReference:function(e){return 1!=e?null:new tr(1,0,h,function(){return d},0,null)},initSegmentReference:null,ca:0}}}catch(f){if(l&&4002==f.code)return null;throw f}return a=Li(a,"ContentProtection"),a=qi(a,this.b.dash.customScheme,t,this.b.dash.ignoreDrmInfo),{id:this.i++,createSegmentIndex:c.createSegmentIndex,findSegmentPosition:c.findSegmentPosition,getSegmentReference:c.getSegmentReference,initSegmentReference:c.initSegmentReference,presentationTimeOffset:c.ca,mimeType:e.w.mimeType,codecs:e.w.codecs,frameRate:e.w.frameRate,bandwidth:e.bandwidth,width:e.w.width,height:e.w.height,kind:n,encrypted:0<t.drmInfos.length,keyId:a,language:i,label:r,type:e.W.contentType,primary:o,trickModeVideo:null,containsEmsgBoxes:e.w.containsEmsgBoxes,roles:s,channelsCount:e.w.Tb}},n.Qe=function(){this.g=null,Kr(this).then(function(e){this.a&&Xr(this,e)}.bind(this))["catch"](function(e){this.a&&(e.severity=1,this.a.onError(e),Xr(this,0))}.bind(this))},n.je=function(e,t,n){var i=n.getAttribute("schemeIdUri")||"",r=n.getAttribute("value")||"",o=Ni(n,"timescale",Hi)||1;Li(n,"Event").forEach(function(n){var s=Ni(n,"presentationTime",Hi)||0,a=Ni(n,"duration",Hi)||0;s=s/o+e,a=s+a/o,null!=t&&(s=Math.min(s,e+t),a=Math.min(a,e+t)),n={schemeIdUri:i,value:r,startTime:s,endTime:a,id:n.getAttribute("id")||"",eventElement:n},this.a.onTimelineRegionAdded(n)}.bind(this))},n.ve=function(e,t,n){return e=De(e,this.b.retryParameters),null!=t&&(e.headers.Range="bytes="+t+"-"+(null!=n?n:"")),t=this.a.networkingEngine.request(1,e),Te(this.f,t),t.promise.then(function(e){return e.data})},Or.mpd=Vr,kr["application/dash+xml"]=Vr,ro.prototype.toString=function(){function e(e){return e.name+'="'+e.value+'"'}return this.value?"#"+this.name+":"+this.value:0<this.a.length?"#"+this.name+":"+this.a.map(e).join(","):"#"+this.name},ro.prototype.getAttribute=function(e){var t=this.a.filter(function(t){return t.name==e});return t.length?t[0]:null};var Eo="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-MAP EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST".split(" "),_o="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE".split(" ");function xo(e){try{var t=xo.parse(e);return ce({uri:e,data:t.data,headers:{"content-type":t.contentType}})}catch(n){return le(n)}}function To(){this.g=this.c=null,this.M=1,this.v=new Map,this.K=new Set,this.a=new Map,this.b=null,this.s="",this.o=new go,this.j=this.i=null,this.f=es,this.m=null,this.l=0,this.A=1/0,this.h=new xe,this.G=[]}function So(e,t){Wo(e,t.dd).then(function(e){var n=ts,i=yo(this.o,e.data,e.uri);if(1!=i.type)throw new se(2,4,4017);e=uo(i.a,"EXT-X-MEDIA-SEQUENCE");var r=t.stream;Uo(this,t.zb,i,e?Number(e.value):0,r.mimeType,r.codecs).then(function(e){t.eb.a=e,e=e[e.length-1],uo(i.a,"EXT-X-ENDLIST")&&(Jo(this,n.sa),this.b.la(e.endTime))}.bind(this))}.bind(e))}function wo(e,t){var n=yo(e.o,t,e.s);if(0!=n.type)throw new se(2,4,4022);return Io(e,n).then(function(e){this.c.filterAllPeriods([e]);for(var t=1/0,n=0,i=0,r=1/0,o=d(this.a.values()),s=o.next();!s.done;s=o.next())s=s.value,t=Math.min(t,s.Rb),n=Math.max(n,s.Rb),i=Math.max(i,s.Gd),"text"!=s.stream.type&&(r=Math.min(r,s.duration));if(s=null,o=0,this.f!=ts.sa&&(s=Date.now()/1e3-i,o=3*this.l),this.b=new jr(s,o),this.b.yb(this.f==ts.sa),Oo(this),this.f!=ts.sa){for(t=3*this.l,this.b.Sc(t),this.i=this.A,this.f==ts.jc&&(isNaN(this.g.availabilityWindowOverride)||(t=this.g.availabilityWindowOverride),this.b.dc(t)),t=0;95443.7176888889<=n;)t+=95443.7176888889,n-=95443.7176888889;if(t)for(n=d(this.a.values()),s=n.next();!s.done;s=n.next())r=s.value,95443.7176888889>r.Rb&&(r.stream.presentationTimeOffset=-t,r.eb.offset(t))}else for(this.b.la(r),this.b.offset(-t),n=d(this.a.values()),s=n.next();!s.done;s=n.next())i=s.value,i.stream.presentationTimeOffset=t,i.eb.offset(-t),mr(i.eb,r);this.m={presentationTimeline:this.b,periods:[e],offlineSessionIds:[],minBufferTime:0}}.bind(e))}function Io(e,t){var n=t.a,i=lo(t.a,"EXT-X-MEDIA").filter(function(e){return"SUBTITLES"==Yo(e,"TYPE")}.bind(e)).map(function(e){return Ro(this,e)}.bind(e));return Promise.all(i).then(function(e){var i=lo(n,"EXT-X-STREAM-INF").map(function(e){return Do(this,e,t)}.bind(this));return Promise.all(i).then(function(t){return{startTime:0,variants:t.reduce(He,[]),textStreams:e}}.bind(this))}.bind(e))}function Do(e,t,n){var i=so(t,"CODECS","avc1.42E01E,mp4a.40.2").split(/\s*,\s*/),r=t.getAttribute("RESOLUTION"),o=null,s=null,a=so(t,"FRAME-RATE"),l=Number(Yo(t,"BANDWIDTH"));if(r){var u=r.value.split("x");o=u[0],s=u[1]}n=lo(n.a,"EXT-X-MEDIA"),n=n.filter(function(e){return"CLOSED-CAPTIONS"!=Yo(e,"TYPE")}),n=n.filter(function(e){var t=so(e,"URI")||"";return"SUBTITLES"==(so(e,"TYPE")||"")||""!=t});var c=so(t,"AUDIO"),d=so(t,"VIDEO");if(c?n=co(n,"AUDIO",c):d&&(n=co(n,"VIDEO",d)),u=qo("text",i)){var h=so(t,"SUBTITLES");h&&(h=co(n,"SUBTITLES",h),h.length&&(e.v.get(h[0].id).stream.codecs=u)),i.splice(i.indexOf(u),1)}n=n.map(function(e){return Po(this,e,i)}.bind(e));var f=[],p=[];return Promise.all(n).then(function(e){if(c?f=e:d&&(p=e),e=!1,f.length||p.length)if(f.length)if(Yo(t,"URI")==f[0].zb){var n="audio";e=!0}else n="video";else n="audio";else 1==i.length?(n=qo("video",i),n=r||a||n?"video":"audio"):(n="video",i=[i.join(",")]);return e?Promise.resolve():No(this,t,i,n)}.bind(e)).then(function(e){return e&&("audio"==e.stream.type?f=[e]:p=[e]),p&&Mo(p),f&&Mo(f),Ao(this,f,p,l,o,s,a)}.bind(e))}function Mo(e){e.forEach(function(e){var t=e.stream.codecs.split(",");t=t.filter(function(e){return"mp4a.40.34"!=e}),e.stream.codecs=t.join(",")})}function Ao(e,t,n,i,r,o,s){n.forEach(function(e){(e=e.stream)&&(e.width=Number(r)||void 0,e.height=Number(o)||void 0,e.frameRate=Number(s)||void 0)}.bind(e)),t.length||(t=[null]),n.length||(n=[null]);for(var a=[],l=0;l<t.length;l++)for(var u=0;u<n.length;u++){var c=t[l]?t[l].stream:null,d=n[u]?n[u].stream:null,h=t[l]?t[l].drmInfos:null,f=n[u]?n[u].drmInfos:null,p=void 0;if(c&&d){if(h.length&&f.length&&!(0<Lt(h,f).length))continue;p=Lt(h,f)}else c?p=h:d&&(p=f);h=(n[l]?n[l].zb:"")+" - "+(t[l]?t[l].zb:""),e.K.has(h)||(c=Lo(e,c,d,i,p),a.push(c),e.K.add(h))}return a}function Lo(e,t,n,i,r){return{id:e.M++,language:t?t.language:"und",primary:!!t&&t.primary||!!n&&n.primary,audio:t,video:n,bandwidth:i,drmInfos:r,allowedByApplication:!0,allowedByKeySystem:!0}}function Ro(e,t){return Yo(t,"TYPE"),Po(e,t,[]).then(function(e){return e.stream})}function Po(e,t,n){var i=Yo(t,"URI");if(e.a.has(i))return Promise.resolve(e.a.get(i));var r=Yo(t,"TYPE").toLowerCase();"subtitles"==r&&(r="text");var o=wn(so(t,"LANGUAGE","und")),s=so(t,"NAME"),a=t.getAttribute("DEFAULT"),l=t.getAttribute("AUTOSELECT"),u=so(t,"CHANNELS");return Bo(e,i,n,r,o,!!a||!!l,s,"audio"==r?Co(u):null).then(function(e){return this.a.has(i)?this.a.get(i):(this.v.set(t.id,e),this.a.set(i,e),e)}.bind(e))}function Co(e){return e?(e=e.split("/")[0],parseInt(e,10)):null}function No(e,t,n,i){var r=Yo(t,"URI");return e.a.has(r)?Promise.resolve(e.a.get(r)):Bo(e,r,n,i,"und",!1,null,null).then(function(e){return this.a.has(r)?this.a.get(r):(this.a.set(r,e),e)}.bind(e))}function Bo(e,t,n,i,r,o,s,a){var l,u,c=qe([e.s],[t])[0],d="";return Wo(e,c).then(function(t){if(c=t.uri,l=yo(e.o,t.data,c),1!=l.type)throw new se(2,4,4017);t=l;var r=ts,o=uo(t.a,"EXT-X-PLAYLIST-TYPE"),s=uo(t.a,"EXT-X-ENDLIST");if(s=o&&"VOD"==o.value||s,o=o&&"EVENT"==o.value&&!s,o=!s&&!o,s?Jo(e,r.sa):(Jo(e,o?r.jc:r.Zc),t=$o(t.a,"EXT-X-TARGETDURATION"),t=Number(t.value),e.l=Math.max(t,e.l),e.A=Math.min(t,e.A)),1==n.length)d=n[0];else{if(t=qo(i,n),null==t)throw new se(2,4,4025,n);d=t}return zo(e,i,d,l)}).then(function(n){return u=n,n=uo(l.a,"EXT-X-MEDIA-SEQUENCE"),Uo(e,t,l,n?Number(n.value):0,u,d)}).then(function(n){var h=n[0].startTime,f=n[n.length-1].endTime,p=f-h;n=new pr(n);var m=Fo(l),g=void 0;"text"==i&&(g="subtitle");var y=[];l.segments.forEach(function(e){e=lo(e.b,"EXT-X-KEY"),y.push.apply(y,e)});var v=!1,b=[],E=null;if(y.forEach(function(e){if("NONE"!=Yo(e,"METHOD")){v=!0;var t=Yo(e,"KEYFORMAT");(e=(t=Zo[t])?t(e):null)&&(e.keyIds.length&&(E=e.keyIds[0]),b.push(e))}}),v&&!b.length)throw new se(2,4,4026);return{stream:{id:e.M++,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:n.find.bind(n),getSegmentReference:n.get.bind(n),initSegmentReference:m,presentationTimeOffset:0,mimeType:u,codecs:d,kind:g,encrypted:v,keyId:E,language:r,label:s||null,type:i,primary:o,trickModeVideo:null,containsEmsgBoxes:!1,frameRate:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:[],channelsCount:a},eb:n,drmInfos:b,zb:t,dd:c,Rb:h,Gd:f,duration:p}})}function Fo(e){var t=lo(e.a,"EXT-X-MAP");if(!t.length)return null;if(1<t.length)throw new se(2,4,4020);t=t[0];var n=Yo(t,"URI"),i=qe([e.b],[n])[0];return e=0,n=null,(t=so(t,"BYTERANGE"))&&(e=t.split("@"),t=Number(e[0]),e=Number(e[1]),n=e+t-1),new er(function(){return[i]},e,n)}function ko(e,t,n,i){var r=t.b,o=t.a;t=$o(r,"EXTINF").value.split(","),t=i+Number(t[0]);var s=0,a=null;return(r=uo(r,"EXT-X-BYTERANGE"))&&(s=r.value.split("@"),r=Number(s[0]),s=s[1]?Number(s[1]):e.a+1,a=s+r-1),new tr(n,i,t,function(){return[o]},s,a)}function Oo(e){e.b&&(e.G.forEach(function(t){e.b.Na(t,!0)}),e.G=[])}function Uo(e,t,n,i,r,o){var s=n.segments,a=[],l=s[0].a,u=ko(null,s[0],i,0);return n=Fo(n),jo(e,t,n,u,r,o).then(function(e){l.split("/").pop();for(var t=0;t<s.length;++t){var n=a[a.length-1];n=ko(n,s[t],i+t,0==t?e:n.endTime),a.push(n)}return this.G.push(a),Oo(this),a}.bind(e))}function Ho(e,t){var n=e.c.networkingEngine,i=De(t.c(),e.g.retryParameters),r={},o=t.b;r.Range="bytes="+o+"-"+(o+2048-1);var s={};return 0==o&&null==t.a||(o="bytes="+o+"-",null!=t.a&&(o+=t.a),s.Range=o),i.headers=r,r=n.request(1,i),Te(e.h,r),r.promise["catch"](function(){U("Unable to fetch a partial HLS segment! Falling back to a full segment request, which is expensive!  Your server should support Range requests and CORS preflights.",i.uris[0]),i.headers=s;var t=n.request(1,i);return Te(e.h,t),t.promise})}function jo(e,t,n,i,r,o){return e.m&&(t=e.a.get(t).eb.get(i.position))?Promise.resolve(t.startTime):(i=[Ho(e,i)],"video/mp4"!=r&&"audio/mp4"!=r||(n?i.push(Ho(e,n)):i.push(i[0])),Promise.all(i).then(function(e){if("video/mp4"==r||"audio/mp4"==r)return Vo(e[0].data,e[1].data);if("audio/mpeg"==r)return 0;if("video/mp2t"==r)return Ko(e[0].data);if("application/mp4"==r||0==r.indexOf("text/")){e=e[0].data;var t=We(r,o);if(an[t]){var n=new sn(null);n.f=new an[t],e=n.Lb(e)}else e=0;return e}throw new se(2,4,4030)}.bind(e)))}function Vo(e,t){var n=0;if((new sr).C("moov",ar).C("trak",ar).C("mdia",ar).Y("mdhd",function(e){e.reader.F(0==e.version?8:16),n=e.reader.B(),e.parser.stop()}).parse(t,!0),!n)throw new se(2,4,4030);var i=0,r=!1;if((new sr).C("moof",ar).C("traf",ar).Y("tfdt",function(e){i=(0==e.version?e.reader.B():e.reader.Ra())/n,r=!0,e.parser.stop()}).parse(e,!0),!r)throw new se(2,4,4030);return i}function Ko(e){function t(){throw new se(2,4,4030)}e=new nr(new DataView(e),0);for(var n=0,i=0;;){if(n=e.V(),i=e.ba(),71!=i&&t(),16384&e.bb()||t(),i=(48&e.ba())>>4,0!=i&&2!=i||t(),3==i&&(i=e.ba(),e.F(i)),1==e.B()>>8)return e.F(3),n=e.ba()>>6,0!=n&&1!=n||t(),0==e.ba()&&t(),n=e.ba(),i=e.bb(),e=e.bb(),(1073741824*((14&n)>>1)+((65534&i)<<14|(65534&e)>>1))/9e4;e.seek(n+188),i=e.ba(),71!=i&&(e.seek(n+192),i=e.ba()),71!=i&&(e.seek(n+204),i=e.ba()),71!=i&&t(),e.Oc(1)}}function qo(e,t){for(var n=Go[e],i=0;i<n.length;i++)for(var r=0;r<t.length;r++)if(n[i].test(t[r].trim()))return t[r].trim();return"text"==e?"":null}function zo(e,t,n,i){i=i.segments[0].a;var r=new V(i).$.split(".").pop(),o=Xo[t][r];return o?Promise.resolve(o):"text"==t?n&&"vtt"!=n?Promise.resolve("application/mp4"):Promise.resolve("text/vtt"):(t=De([i],e.g.retryParameters),t.method="HEAD",t=e.c.networkingEngine.request(1,t),Te(e.h,t),t.promise.then(function(e){if(e=e.headers["content-type"],!e)throw new se(2,4,4021,r);return e.split(";")[0]}))}function Yo(e,t){var n=e.getAttribute(t);if(!n)throw new se(2,4,4023,t);return n.value}function $o(e,t){var n=uo(e,t);if(!n)throw new se(2,4,4024,t);return n}function Wo(e,t){var n=e.c.networkingEngine.request(0,De([t],e.g.retryParameters));return Te(e.h,n),n.promise}C("shaka.net.DataUriPlugin",xo),xo.parse=function(t){var n=t.split(":");if(2>n.length||"data"!=n[0])throw new se(2,1,1004,t);if(n=n.slice(1).join(":").split(","),2>n.length)throw new se(2,1,1004,t);var i=n[0];n=e.decodeURIComponent(n.slice(1).join(",")),i=i.split(";");var r=null;if(1<i.length&&(r=i[1]),"base64"==r)t=st(n).buffer;else{if(r)throw new se(2,1,1005,t);t=et(n)}return{data:t,contentType:i[0]}},Ie("data",xo),C("shaka.hls.HlsParser",To),n=To.prototype,n.configure=function(e){this.g=e},n.start=function(e,t){return this.c=t,Wo(this,e).then(function(e){return this.s=e.uri,wo(this,e.data).then(function(){return Qo(this,this.i),this.m}.bind(this))}.bind(this))},n.stop=function(){return this.g=this.c=null,this.v.clear(),this.K.clear(),this.a.clear(),this.m=null,this.h.destroy()},n.update=function(){if(this.f!=ts.sa){for(var e=[],t=d(this.a.values()),n=t.next();!n.done;n=t.next())e.push(So(this,n.value));return Promise.all(e)}},n.onExpirationUpdated=function(){};var Go={audio:[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],text:[/^vtt$/,/^wvtt/,/^stpp/]},Xo={audio:{mp4:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",ts:"video/mp2t"},video:{mp4:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",ts:"video/mp2t"},text:{mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",vtt:"text/vtt",ttml:"application/ttml+xml"}};function Qo(t,n){null!=t.i&&null!=n&&(t.j=e.setTimeout(t.T.bind(t),1e3*n))}function Jo(t,n){t.f=n,t.b&&t.b.yb(t.f==ts.sa),t.f==ts.sa&&null!=t.j&&(e.clearTimeout(t.j),t.j=null,t.i=null)}To.prototype.T=function(){this.c&&(this.j=null,this.update().then(function(){Qo(this,this.i)}.bind(this))["catch"](function(e){this.c&&(e.severity=1,this.c.onError(e),Qo(this,0))}.bind(this)))};var Zo={"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(e){var t=Yo(e,"METHOD");return"SAMPLE-AES-CENC"!=t&&"SAMPLE-AES-CTR"!=t?null:(t=Yo(e,"URI"),t=xo.parse(t),t=new Uint8Array(t.data),t=ze("com.widevine.alpha",[{initDataType:"cenc",initData:t}]),(e=so(e,"KEYID"))&&(t.keyIds=[e.substr(2).toLowerCase()]),t)}},es="VOD",ts={sa:es,Zc:"EVENT",jc:"LIVE"};function ns(e,t,n,i){this.a=e,this.s=t,this.o=n,this.v=i,this.h=new Ce,this.b=null,this.g=!1,this.m=e.readyState,this.c=!1,this.j=this.A=-1,this.f=this.i=!1,t=this.l.bind(this),Ne(this.h,e,"waiting",t),this.b=new nt(t),rt(this.b,.25)}function is(e,t,n){this.a=e,this.i=t,this.h=n,this.c=new Ce,this.f=1,this.g=!1,this.b=null,0<e.readyState?this.Fc():Be(this.c,e,"loadedmetadata",this.Fc.bind(this)),Ne(this.c,e,"ratechange",this.Wd.bind(this))}function rs(e){return 0<e.a.readyState?e.a.currentTime:e.h}function os(e,t){0<e.a.readyState?as(e,e.a.currentTime,t):(e.h=t,setTimeout(e.i,0))}function ss(e,t){null!=e.b&&(e.b.cancel(),e.b=null),e.f=t,e.a.playbackRate=e.g||0>t?0:t,!e.g&&0>t&&(e.b=new nt(function(){e.a.currentTime+=t/4}),rt(e.b,.25))}function as(e,t,n){function i(){!e.a||10<=r++||e.a.currentTime!=t||(e.a.currentTime=n,setTimeout(i,100))}e.a.currentTime=n;var r=0;setTimeout(i,100)}function ls(e,t,n,i,r,o){this.c=e,this.b=t,this.h=n,this.j=r,this.f=null,this.g=new ns(e,t,n,o),t=this.Yd.bind(this),n=this.b.presentationTimeline,null==i?i=1/0>n.U()?n.Ja():n.na():0>i&&(i=n.na()+i),i=cs(this,hs(this,i)),this.a=new is(e,t,i),this.f=new nt(this.Vd.bind(this)),rt(this.f,.25)}function us(e){var t=rs(e.a);return 0<e.c.readyState&&(e.c.paused||(t=hs(e,t))),t}function cs(e,t){var n=e.b.presentationTimeline.U();return t>=n?n-e.h.durationBackoff:t}function ds(e,t){var n=Ft.bind(null,e.c.buffered),i=Math.max(e.b.minBufferTime||0,e.h.rebufferingGoal),r=e.b.presentationTimeline,o=r.Ja(),s=r.na(),a=r.U();3>s-o&&(o=s-3);var l=r.Wa(i),u=r.Wa(5);return i=r.Wa(i+5),t>=a?cs(e,t):t>s?s:t<o?n(u)?u:i:t>=l||n(t)?t:i}function hs(e,t){var n=e.b.presentationTimeline.Ja();return t<n?n:(n=e.b.presentationTimeline.na(),t>n?n:t)}function fs(e,t,n,i,r,o,s){this.a=e,this.v=t,this.g=n,this.s=i,this.l=r,this.h=o,this.A=s,this.c=[],this.j=new Ce,this.b=!1,this.i=-1,this.f=null,ms(this)}function ps(e){var t=Ee(e);return t.eventElement=e.eventElement,t}function ms(t){gs(t),t.f=e.setTimeout(t.G.bind(t),250)}function gs(t){t.f&&(e.clearTimeout(t.f),t.f=null)}function ys(e,t){this.a=t,this.b=e,this.g=null,this.j=1,this.m=Promise.resolve(),this.h=[],this.i={},this.c={},this.o=!1,this.A=null,this.v=this.f=this.l=!1,this.s=0}function vs(e){var t=us(e.a.Pa);return e.b.periods[$n(e.b,t)]}function bs(e){var t=e.c.video||e.c.audio;return t?e.b.periods[t.Ba]:null}function Es(e){return xs(e,"audio")}function _s(e){return xs(e,"video")}function xs(e,t){var n=e.c[t];return n?n.ta||n.stream:null}function Ts(e,t){yn(e.a.I,"text"),e.s++,e.v=!1;var n=e.s;return e.a.I.init({text:t},!1).then(function(){return Cs(e,[t])}).then(function(){if(!e.f&&e.s==n&&!e.c.text&&!e.v){var i=us(e.a.Pa);e.c.text=Rs(t,$n(e.b,i)),Ws(e,e.c.text,0)}})}function Ss(e){e.v=!0,e.c.text&&(Gs(e.c.text),delete e.c.text)}function ws(e,t){var n=e.c.video;if(n){var i=n.stream;if(i)if(t){var r=i.trickModeVideo;r&&!n.ta&&(Ds(e,r,!1),n.ta=i)}else(i=n.ta)&&(n.ta=null,Ds(e,i,!0))}}function Is(e,t,n){t.video&&Ds(e,t.video,n),t.audio&&Ds(e,t.audio,n)}function Ds(e,t,n){var i=e.c[t.type];if(!i&&"text"==t.type&&e.g.ignoreTextStreamFailures)Ts(e,t);else if(i){var r=Wn(e.b,t);n&&r!=i.Ba?As(e):(i.ta&&(t.trickModeVideo?(i.ta=t,t=t.trickModeVideo):i.ta=null),(r=e.h[r])&&r.Sa&&(r=e.i[t.id])&&r.Sa&&i.stream!=t&&("text"==t.type&&dn(e.a.I,We(t.mimeType,t.codecs)),i.stream=t,i.wb=!0,n&&(i.ya?i.Ab=!0:i.Ca?(i.wa=!0,i.Ab=!0):(Gs(i),$s(e,i,!0)))))}}function Ms(e){var t=us(e.a.Pa),n=e.g.smallGapLimit;Object.keys(e.c).every(function(e){var i=this.a.I;return"text"==e?(e=i.a,e=t>=e.a&&t<e.b):(e=mn(i,e),e=Ft(e,t,n)),e}.bind(e))||As(e)}function As(e){for(var t in e.c){var n=e.c[t];n.ya||n.wa||(n.Ca?n.wa=!0:null==hn(e.a.I,t)?null==n.va&&Ws(e,n,0):(Gs(n),$s(e,n,!1)))}}function Ls(e,t,n){var i=us(e.a.Pa),r=$n(e.b,i),o={},s=[];return t.variant&&t.variant.audio&&(o.audio=t.variant.audio,s.push(t.variant.audio)),t.variant&&t.variant.video&&(o.video=t.variant.video,s.push(t.variant.video)),t.text&&(o.text=t.text,s.push(t.text)),e.a.I.init(o,e.g.forceTransmuxTS).then(function(){if(!e.f){var t=e.b.presentationTimeline.U();return 1/0>t?e.a.I.la(t):e.a.I.la(Math.pow(2,32)),Cs(e,s)}}).then(function(){if(!e.f)for(var t in o){var i=o[t];e.c[t]||(e.c[t]=Rs(i,r,n),Ws(e,e.c[t],0))}})}function Rs(e,t,n){return{stream:e,type:e.type,La:null,oa:null,ta:null,wb:!0,Ba:t,endOfStream:!1,Ca:!1,va:null,wa:!1,Ab:!1,ya:!1,$b:!1,Ya:!1,Nc:n||0}}function Ps(e,t){var n=e.h[t];if(n)return n.promise;n={promise:new ne,Sa:!1},e.h[t]=n;var i=e.b.periods[t].variants.map(function(e){var t=[];return e.audio&&t.push(e.audio),e.video&&t.push(e.video),e.video&&e.video.trickModeVideo&&t.push(e.video.trickModeVideo),t}).reduce(He,[]).filter(Ke);return i.push.apply(i,e.b.periods[t].textStreams),e.m=e.m.then(function(){if(!this.f)return Cs(this,i)}.bind(e)).then(function(){this.f||(this.h[t].promise.resolve(),this.h[t].Sa=!0)}.bind(e))["catch"](function(e){this.f||(this.h[t].promise["catch"](function(){}),this.h[t].promise.reject(),delete this.h[t],this.a.onError(e))}.bind(e)),n.promise}function Cs(e,t){t.map(function(e){return e.id}).filter(Ke);for(var n=[],i=0;i<t.length;++i){var r=t[i],o=e.i[r.id];o?n.push(o.promise):(e.i[r.id]={promise:new ne,Sa:!1},n.push(r.createSegmentIndex()))}return Promise.all(n).then(function(){if(!this.f)for(var e=0;e<t.length;++e){var n=this.i[t[e].id];n.Sa||(n.promise.resolve(),n.Sa=!0)}}.bind(e))["catch"](function(e){if(!this.f){for(var n=0;n<t.length;n++)this.i[t[n].id].promise["catch"](function(){}),this.i[t[n].id].promise.reject(),delete this.i[t[n].id];return Promise.reject(e)}}.bind(e))}function Ns(e,t){var n=us(e.a.Pa),i=Bs(e,t,n),r=Wn(e.b,t.stream),o=$n(e.b,i),s=pn(e.a.I,t.type,n),a=Math.max(e.j*Math.max(e.b.minBufferTime||0,e.g.rebufferingGoal),e.j*e.g.bufferingGoal);if(i>=e.b.presentationTimeline.U())return t.endOfStream=!0,null;if(t.endOfStream=!1,t.Ba=o,o!=r)return null;if(s>=a)return.5;if(o=fn(e.a.I,t.type),o=Fs(e,t,n,o,r),!o)return 1;var l=1/0;return $e.values(e.c).forEach(function(t){l=Math.min(l,Bs(e,t,n))}),i>=l+e.b.presentationTimeline.a?1:(t.Nc=0,Os(e,t,n,r,o),null)}function Bs(e,t,n){return t.La&&t.oa?e.b.periods[Wn(e.b,t.La)].startTime+t.oa.endTime:Math.max(n,t.Nc)}function Fs(e,t,n,i,r){if(t.oa&&t.stream==t.La)return ks(e,t,r,t.oa.position+1);if(n=t.oa?t.stream.findSegmentPosition(Math.max(0,e.b.periods[Wn(e.b,t.La)].startTime+t.oa.endTime-e.b.periods[r].startTime)):t.stream.findSegmentPosition(Math.max(0,(i||n)-e.b.periods[r].startTime)),null==n)return null;var o=null;return null==i&&(o=ks(e,t,r,Math.max(0,n-1))),o||ks(e,t,r,n)}function ks(e,t,n,i){return n=e.b.periods[n],t=t.stream.getSegmentReference(i),t?(i=e.b.presentationTimeline,e=i.Xa(),i=i.Ka(),n.startTime+t.endTime<e||n.startTime+t.startTime>i?null:t):null}function Os(e,t,n,i,r){var o=e.b.periods[i],s=t.stream,a=e.b.presentationTimeline.U(),l=e.b.periods[i+1];i=Hs(e,t,i,Math.max(0,o.startTime-.1),l?l.startTime+.01:a),t.Ca=!0,t.wb=!1,a=Ys(e,r),Promise.all([i,a]).then(function(e){if(!this.f&&!this.l)return js(this,t,n,o,s,r,e[1])}.bind(e)).then(function(){this.f||this.l||(t.Ca=!1,t.$b=!1,t.wa||this.a.ab(),Ws(this,t,0),Ks(this,s))}.bind(e))["catch"](function(e){this.f||this.l||(t.Ca=!1,"text"==t.type&&this.g.ignoreTextStreamFailures?delete this.c.text:3017==e.code?Us(this,t,e):(t.Ya=!0,e.severity=2,Xs(this,e)))}.bind(e))}function Us(e,t,n){if(!$e.values(e.c).some(function(e){return e!=t&&e.$b})){var i=Math.round(100*e.j);if(20<i)e.j-=.2;else{if(!(4<i))return t.Ya=!0,e.l=!0,void e.a.onError(n);e.j-=.04}t.$b=!0}Ws(e,t,4)}function Hs(e,t,n,i,r){return t.wb?(n=vn(e.a.I,t.type,e.b.periods[n].startTime-t.stream.presentationTimeOffset,i,r),t.stream.initSegmentReference?(e=Ys(e,t.stream.initSegmentReference).then(function(e){if(!this.f)return gn(this.a.I,t.type,e,null,null)}.bind(e))["catch"](function(e){return t.wb=!0,Promise.reject(e)}),Promise.all([n,e])):n):Promise.resolve()}function js(e,t,n,i,r,o,s){return r.containsEmsgBoxes&&(new sr).Y("emsg",e.ie.bind(e,i,o)).parse(s),Vs(e,t,n).then(function(){if(!this.f)return gn(this.a.I,t.type,s,o.startTime+i.startTime,o.endTime+i.startTime)}.bind(e)).then(function(){if(!this.f)return t.La=r,t.oa=o,Promise.resolve()}.bind(e))}function Vs(e,t,n){var i=Math.max(e.g.bufferBehind,e.b.presentationTimeline.a),r=hn(e.a.I,t.type);return null==r?Promise.resolve():(n=n-r-i,0>=n?Promise.resolve():e.a.I.remove(t.type,r,r+n).then(function(){}.bind(e)))}function Ks(e,t){if(!e.o&&(e.o=$e.values(e.c).every(function(e){return"text"==e.type||!e.wa&&!e.ya&&e.oa}),e.o)){var n=Wn(e.b,t);for(e.h[n]||Ps(e,n).then(function(){this.f||this.a.zc()}.bind(e))["catch"](je),n=0;n<e.b.periods.length;++n)Ps(e,n)["catch"](je);e.a.ae&&e.a.ae()}}function qs(e,t){if(t.Ba!=Wn(e.b,t.stream)){var n=t.Ba,i=$e.values(e.c);i.every(function(e){return e.Ba==n})&&i.every(zs)&&Ps(e,n).then(function(){if(!this.f&&i.every(function(e){var t=Wn(this.b,e.stream);return zs(e)&&e.Ba==n&&t!=n}.bind(this))){var e=this.b.periods[n],t=this.a.Ac(e),r={};for(var o in t.variant&&t.variant.video&&(r.video=t.variant.video),t.variant&&t.variant.audio&&(r.audio=t.variant.audio),t.text&&(r.text=t.text),this.c)if(!r[o]&&"text"!=o)return void this.a.onError(new se(2,5,5005));for(var s in r)if(!this.c[s]){if("text"!=s)return void this.a.onError(new se(2,5,5005));Ls(this,{text:r.text},e.startTime),delete r[s]}for(var a in this.c)(e=r[a])?(Ds(this,e,!1),Ws(this,this.c[a],0)):delete this.c[a];this.a.zc()}}.bind(e))["catch"](je)}}function zs(e){return!e.Ca&&null==e.va&&!e.wa&&!e.ya}function Ys(e,t){var n=De(t.c(),e.g.retryParameters);if(0!=t.b||null!=t.a){var i="bytes="+t.b+"-";null!=t.a&&(i+=t.a),n.headers.Range=i}return e.a.$a.request(1,n).promise.then(function(e){return e.data})}function $s(e,t,n){t.wa=!1,t.Ab=!1,t.ya=!0,yn(e.a.I,t.type).then(function(){if(!this.f&&n)return this.a.I.flush(t.type)}.bind(e)).then(function(){this.f||(t.La=null,t.oa=null,t.ya=!1,t.endOfStream=!1,Ws(this,t,0))}.bind(e))}function Ws(t,n,i){n.va=e.setTimeout(t.Se.bind(t,n),1e3*i)}function Gs(t){null!=t.va&&(e.clearTimeout(t.va),t.va=null)}function Xs(e,t){re(e.A).then(function(){this.f||(this.a.onError(t),t.handled||this.g.failureCallback(t))}.bind(e))}function Qs(e,t,n,i,r,o){if(200<=n&&299>=n&&202!=n)return r&&(i=r),{uri:i,data:t,headers:e,fromCache:!!e["x-shaka-from-cache"]};r=null;try{r=Ze(t)}catch(s){}throw new se(401==n||403==n?2:1,1,1001,i,n,r,e,o)}function Js(e,t,n){var i=new Js.b;$e.forEach(t.headers,function(e,t){i.append(e,t)});var r,o=new Js.a,s={body:t.body||void 0,headers:i,method:t.method,signal:o.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},a={mc:!1,Xc:!1};return t.retryParameters.timeout&&(r=setTimeout(function(){a.Xc=!0,o.abort()},t.retryParameters.timeout)),e=Js.f(e,n,s,a,r),new ae(e,function(){return a.mc=!0,o.abort(),Promise.resolve()})}function Zs(e,t,n){var i=new Zs.g,r=new Promise(function(r,o){for(var s in i.open(t.method,e,!0),i.responseType="arraybuffer",i.timeout=t.retryParameters.timeout,i.withCredentials=t.allowCrossSiteCredentials,i.onabort=function(){o(new se(1,1,7001,e,n))},i.onload=function(t){t=t.target;var i=t.getAllResponseHeaders().trim().split("\r\n").reduce(function(e,t){var n=t.split(": ");return e[n[0].toLowerCase()]=n.slice(1).join(": "),e},{});try{var s=Qs(i,t.response,t.status,e,t.responseURL,n);r(s)}catch(a){o(a)}},i.onerror=function(t){o(new se(1,1,1002,e,t,n))},i.ontimeout=function(){o(new se(1,1,1003,e,n))},t.headers)i.setRequestHeader(s.toLowerCase(),t.headers[s]);i.send(t.body)});return new ae(r,function(){return i.abort(),Promise.resolve()})}function ea(e){this.a={},this.c=Promise.resolve(),this.h=!1,this.i=e,this.f=this.b=this.g=0}function ta(e,t,n,i,r){e.a[t]=e.a[t]||[],e.a[t].push({request:n,pc:i,Jd:r})}function na(e,t){var n=$e.values(e.a);e.a={},n.forEach(function(t){t.forEach(function(t){e.b+=t.pc})});var i=Promise.resolve().then(function(){return oa(e),Promise.all(n.map(function(n){return ia(e,t,n)}))});return e.c=e.c.then(function(){return i}),i}function ia(e,t,n){var i=Promise.resolve();return n.forEach(function(n){i=i.then(function(){return oa(e),ra(e,t,n)})}),i}function ra(e,t,n){return Promise.resolve().then(function(){return oa(e),t.request(1,n.request).promise}).then(function(t){return oa(e),e.g+=n.pc,e.f+=t.data.byteLength,e.i(e.b?e.g/e.b:0,e.f),n.Jd(t.data)})}function oa(e){if(e.h)throw new se(2,9,7001)}function sa(e,t){var n=this;this.c=e,this.b=e.objectStore(t),this.a=new ne,e.onabort=function(e){e.preventDefault(),n.a.reject()},e.onerror=function(e){e.preventDefault(),n.a.reject()},e.oncomplete=function(){n.a.resolve()}}function aa(e){this.b=e,this.a=[]}function la(e,t){return ua(e,t,"readwrite")}function ua(e,t,n){n=e.b.transaction([t],n);var i=new sa(n,t);return e.a.push(i),i.promise().then(function(){ye(e.a,i)},function(){ye(e.a,i)}),i}function ca(){this.a={}}function da(e){var t=null;if($e.forEach(e.a,function(e,n){$e.forEach(n.getCells(),function(n,i){i.hasFixedKeySpace()||t||(t={path:{ea:e,O:n},O:i})})}),t)return t;throw new se(2,9,9013,"Could not find a cell that supports add-operations")}function ha(e,t){$e.forEach(e.a,function(e,n){$e.forEach(n.getCells(),function(n,i){t({ea:e,O:n},i)})})}function fa(e,t,n){if(e=e.a[t],!e)throw new se(2,9,9013,"Could not find mechanism with name "+t);if(t=e.getCells()[n],!t)throw new se(2,9,9013,"Could not find cell with name "+n);return t}function pa(e){return p(function t(){var n,i,r,o;return L(t,function(t){switch(t.u){case 1:return n=$e,i=Object.values(e.a),r=0<i.length,r||(o=ga,n.forEach(o,function(e,t){var n=t();n&&i.push(n)})),v(t,Promise.all(i.map(function(e){return e.erase()})),2);case 2:if(!r)return v(t,Promise.all(i.map(function(e){return e.destroy()})),0);t.N(0)}})})}function ma(){return $e.values(ga).some(function(e){return!!(e=e())&&(e.destroy(),!0)})}Or.m3u8=To,kr["application/x-mpegurl"]=To,kr["application/vnd.apple.mpegurl"]=To,ns.prototype.destroy=function(){var e=this.h.destroy();return this.v=this.s=this.a=this.h=null,null!=this.b&&(this.b.cancel(),this.b=null),e},ns.prototype.ab=function(){this.f=!0,this.l()},ns.prototype.l=function(){if(0!=this.a.readyState){if(this.a.seeking){if(!this.g)return}else this.g=!1;if(!this.a.paused){this.a.readyState!=this.m&&(this.c=!1,this.m=this.a.readyState);var e=this.o.smallGapLimit,t=this.a.currentTime,n=this.a.buffered;e:{if(n&&n.length&&!(1==n.length&&1e-6>n.end(0)-n.start(0))){var i=.1;/(Edge\/|Trident\/|Tizen|CrKey)/.test(navigator.userAgent)&&(i=.5);for(var r=0;r<n.length;r++)if(n.start(r)>t&&(0==r||n.end(r-1)-t<=i)){i=r;break e}}i=null}if(null==i){if(n=this.a.currentTime,t=this.a.buffered,!this.a.paused&&0<this.a.playbackRate)if(this.j!=n)this.j=n,this.A=Date.now(),this.i=!1;else if(!this.i&&this.A<Date.now()-1e3)for(i=0;i<t.length;i++)if(n>=t.start(i)&&n<t.end(i)-.5){this.a.currentTime+=.1,this.j=this.a.currentTime,this.i=!0;break}}else if(0!=i||this.f){r=n.start(i);var o=this.s.presentationTimeline.na();if(!(r>=o)){o=r-t,e=o<=e;var s=!1;.001>o||(e||this.c||(this.c=!0,t=new Oe("largegap",{currentTime:t,gapSize:o}),t.cancelable=!0,this.v(t),this.o.jumpLargeGaps&&!t.defaultPrevented&&(s=!0)),!e&&!s)||(0!=i&&n.end(i-1),this.a.currentTime=r)}}}}},n=is.prototype,n.destroy=function(){var e=this.c.destroy();return this.c=null,null!=this.b&&(this.b.cancel(),this.b=null),this.i=this.a=null,e},n.Va=function(){return this.f},n.Wd=function(){var e=this.g||0>this.f?0:this.f;this.a.playbackRate&&this.a.playbackRate!=e&&ss(this,this.a.playbackRate)},n.Fc=function(){.001>Math.abs(this.a.currentTime-this.h)?this.Gc():(Be(this.c,this.a,"seeking",this.Gc.bind(this)),this.a.currentTime=0==this.a.currentTime?this.h:this.a.currentTime)},n.Gc=function(){var e=this;Ne(this.c,this.a,"seeking",function(){return e.i()})},n=ls.prototype,n.destroy=function(){var e=Promise.all([this.a.destroy(),this.g.destroy()]);return this.g=this.a=null,null!=this.f&&(this.f.cancel(),this.f=null),this.j=this.h=this.b=this.c=null,e},n.Va=function(){return this.a.Va()},n.ab=function(){this.g.ab()},n.Vd=function(){if(0!=this.c.readyState&&!this.c.paused){var e=this.c.currentTime,t=this.b.presentationTimeline,n=t.Ja();t=t.na(),3>t-n&&(n=t-3),e<n&&(e=ds(this,e),this.c.currentTime=e)}},n.Yd=function(){var e=this.g;e.g=!0,e.f=!1,e.c=!1;var t=rs(this.a);if(e=ds(this,t),.001<Math.abs(e-t)&&(t=(new Date).getTime()/1e3,!this.i||this.i<t-1))return this.i=t,void os(this.a,e);this.j()},fs.prototype.destroy=function(){var e=this.j?this.j.destroy():Promise.resolve();return this.j=null,gs(this),this.A=this.h=this.l=this.s=this.g=this.v=this.a=null,this.c=[],e},fs.prototype.o=function(e){if(!this.c.some(function(t){return t.info.schemeIdUri==e.schemeIdUri&&t.info.startTime==e.startTime&&t.info.endTime==e.endTime})){var t={info:e,status:1};this.c.push(t);var n=new Oe("timelineregionadded",{detail:ps(e)});this.h(n),this.m(!0,t)}},fs.prototype.m=function(e,t){var n=t.info.startTime>this.a.currentTime?1:t.info.endTime<this.a.currentTime?3:2,i=2==t.status,r=2==n;n!=t.status&&((!e||i||r)&&(i||this.h(new Oe("timelineregionenter",{detail:ps(t.info)})),r||this.h(new Oe("timelineregionexit",{detail:ps(t.info)}))),t.status=n)},fs.prototype.G=function(){this.f=null,ms(this);var e=$n(this.g,this.a.currentTime);e!=this.i&&(-1!=this.i&&this.A(),this.i=e),e=kt(this.a.buffered,this.a.currentTime);var t=Bt(this.a.buffered),n=this.g.presentationTimeline,i=n.Ka();t=n.R()&&t>=i,n=this.v,n=!n.g||"ended"==n.g.readyState,t=t||this.a.ended||n,this.b?(n=Math.max(this.g.minBufferTime||0,this.s.rebufferingGoal),(t||e>=n)&&0!=this.b&&(this.b=!1,this.l(!1))):!t&&.5>e&&1!=this.b&&(this.b=!0,this.l(!0)),this.c.forEach(this.m.bind(this,!1))},n=ys.prototype,n.destroy=function(){for(var e in this.c)Gs(this.c[e]);return this.g=this.c=this.i=this.h=this.m=this.b=this.a=null,this.f=!0,Promise.resolve()},n.configure=function(e){this.g=e,this.A=new ie({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0},!0)},n.init=function(){var e=us(this.a.Pa);return e=this.a.Ac(this.b.periods[$n(this.b,e)]),e.variant||e.text?Ls(this,e).then(function(){!this.f&&this.a&&this.a.Md&&this.a.Md()}.bind(this)):Promise.reject(new se(2,5,5005))},n.Se=function(e){if(!this.f&&!e.Ca&&null!=e.va&&!e.ya)if(e.va=null,e.wa)$s(this,e,e.Ab);else{try{var t=Ns(this,e);null!=t&&(Ws(this,e,t),e.Ya=!1)}catch(n){return void Xs(this,n)}t=$e.values(this.c),qs(this,e),t.every(function(e){return e.endOfStream})&&this.a.I.endOfStream().then(function(){if(!this.f){var e=this.a.I.U();e<this.b.presentationTimeline.U()&&this.b.presentationTimeline.la(e)}}.bind(this))}},n.ie=function(e,t,n){var i=n.reader.Yb(),r=n.reader.Yb(),o=n.reader.B(),s=n.reader.B(),a=n.reader.B(),l=n.reader.B();n=n.reader.Da(n.reader.D.byteLength-n.reader.V()),e=e.startTime+t.startTime+s/o,"urn:mpeg:dash:event:2012"==i?this.a.Od():this.a.onEvent(new Oe("emsg",{detail:{startTime:e,endTime:e+a/o,schemeIdUri:i,value:r,timescale:o,presentationTimeDelta:s,eventDuration:a,id:l,messageData:n}}))},C("shaka.net.HttpFetchPlugin",Js),Js.f=function(e,t,n,i,r){return p(function o(){var s,a,l,u,c,d;return L(o,function(o){switch(o.u){case 1:return s=Js.c,b(o,2,3),v(o,s(e,n),5);case 5:return a=o.J,v(o,a.arrayBuffer(),6);case 6:l=o.J;case 3:T(o),clearTimeout(r),S(o,4);break;case 2:if(u=x(o),i.mc)throw new se(1,1,7001,e,t);if(i.Xc)throw new se(1,1,1003,e,t);throw new se(1,1,1002,e,u,t);case 4:return c={},d=a.headers,d.forEach(function(e,t){c[t.trim()]=e}),o["return"](Qs(c,l,a.status,e,a.url,t))}})})},Js.isSupported=function(){return!(!e.fetch||!e.AbortController)},Js.isSupported=Js.isSupported,Js.c=e.fetch,Js.a=e.AbortController,Js.b=e.Headers,Js.isSupported()&&(Ie("http",Js,2),Ie("https",Js,2)),C("shaka.net.HttpXHRPlugin",Zs),Zs.g=e.XMLHttpRequest,Ie("http",Zs,1),Ie("https",Zs,1),ea.prototype.destroy=function(){this.h=!0;var e=this.c["catch"](function(){});return this.c=Promise.resolve(),e},sa.prototype.abort=function(){try{this.c.abort()}catch(e){}return this.a["catch"](function(){})},sa.prototype.store=function(){return this.b},sa.prototype.promise=function(){return this.a},aa.prototype.destroy=function(){return Promise.all(this.a.map(function(e){return e.abort()}))},ca.prototype.destroy=function(){var e=$e.values(this.a).map(function(e){return e.destroy()});return this.a={},Promise.all(e)},ca.prototype.init=function(){var e=this;$e.forEach(ga,function(t,n){var i=n();i&&(e.a[t]=i)});var t=$e.values(this.a).map(function(e){return e.init()});return Promise.all(t)},C("shaka.offline.StorageMuxer.register",function(e,t){ga[e]=t}),C("shaka.offline.StorageMuxer.unregister",function(e){delete ga[e]});var ga={};function ya(e){this.a=new aa(e)}function va(e){return Promise.reject(new se(2,9,9011,"Cannot add new value to "+e))}function ba(e,t,n,i){e=la(e.a,t);var r=e.store();return n.forEach(function(e){r["delete"](e).onsuccess=function(){return i(e)}}),e.promise()}function Ea(e,t,n){e=ua(e.a,t,"readonly");var i=e.store(),r={},o=[];return n.forEach(function(e){i.get(e).onsuccess=function(t){t=t.target.result,void 0==t&&o.push(e),r[e]=t}}),e.promise().then(function(){return o.length?Promise.reject(new se(2,9,9012,"Could not find values for "+o)):n.map(function(e){return r[e]})})}function _a(e){return{originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:null==e.expiration?1/0:e.expiration,periods:e.periods.map(xa),sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata}}function xa(e){return Da(e),e.streams.forEach(function(){}),{startTime:e.startTime,streams:e.streams.map(Ta)}}function Ta(e){var t=e.Dd?Ia(e.Dd):null;return{id:e.id,primary:e.primary,presentationTimeOffset:e.presentationTimeOffset,contentType:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,kind:e.kind,language:e.language,label:e.label,width:e.width,height:e.height,initSegmentKey:t,encrypted:e.encrypted,keyId:e.keyId,segments:e.segments.map(Sa),variantIds:e.variantIds}}function Sa(e){var t=Ia(e.uri);return{startTime:e.startTime,endTime:e.endTime,dataKey:t}}function wa(e){return{data:e.data}}function Ia(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new se(2,9,9004,"Could not parse uri "+e)}function Da(e){var t=e.streams.filter(function(e){return"audio"==e.contentType}),n=e.streams.filter(function(e){return"video"==e.contentType});if(!t.every(function(e){return e.variantIds})||!n.every(function(e){return e.variantIds})){t.forEach(function(e){e.variantIds=[]}),n.forEach(function(e){e.variantIds=[]});var i=0;if(n.length&&!t.length){var r=i++;n.forEach(function(e){e.variantIds.push(r)})}if(!n.length&&t.length){var o=i++;t.forEach(function(e){e.variantIds.push(o)})}n.length&&t.length&&t.forEach(function(e){n.forEach(function(t){var n=i++;e.variantIds.push(n),t.variantIds.push(n)})})}}function Ma(e,t,n,i){this.a=new aa(e),this.c=t,this.b=n,this.f=i}function Aa(e,t,n){if(e.f)return Promise.reject(new se(1,9,9011,"Cannot add new value to "+t));e=la(e.a,t);var i=e.store(),r=[];return n.forEach(function(e){i.add(e).onsuccess=function(e){r.push(e.target.result)}}),e.promise().then(function(){return r})}function La(e,t,n,i){e=la(e.a,t);var r=e.store();return n.forEach(function(e){r["delete"](e).onsuccess=function(){return i(e)}}),e.promise()}function Ra(e,t,n){e=ua(e.a,t,"readonly");var i=e.store(),r={},o=[];return n.forEach(function(e){var t=i.get(e);t.onsuccess=function(){void 0==t.result&&o.push(e),r[e]=t.result}}),e.promise().then(function(){return o.length?Promise.reject(new se(1,9,9012,"Could not find values for "+o)):n.map(function(e){return r[e]})})}function Pa(){this.c=this.b=this.a=this.f=null}function Ca(){var t=new ne,n=e.indexedDB.deleteDatabase("shaka_offline_db");return n.onblocked=function(){},n.onsuccess=function(){t.resolve()},n.onerror=function(e){t.reject(new se(2,9,9001,n.error)),e.preventDefault()},t}function Na(e,t,n,i){this.a=e,this.g=t,this.f=n,this.c=i,this.b=["offline:",e,"/",t,"/",n,"/",i].join("")}function Ba(e){if(e=/^offline:([a-z]+)\/([^\/]+)\/([^\/]+)\/([0-9]+)$/.exec(e),null==e)return null;var t=e[1];if("manifest"!=t&&"segment"!=t)return null;var n=e[2];if(!n)return null;var i=e[3];return i&&null!=t?new Na(t,n,i,Number(e[4])):null}function Fa(e,t){this.b=e,this.a=t}function ka(e,t){var n=new jr(null,0);n.la(t.duration);var i=t.periods.map(function(t){return Oa(e,t,n)}),r=t.drmInfo?[t.drmInfo]:[];return t.drmInfo&&i.forEach(function(e){e.variants.forEach(function(e){e.drmInfos=r})}),{presentationTimeline:n,minBufferTime:2,offlineSessionIds:t.sessionIds,periods:i}}function Oa(e,t,n){var i=t.streams.filter(function(e){return"audio"==e.contentType}),r=t.streams.filter(function(e){return"video"==e.contentType});return i=Ua(e,i,r),r=t.streams.filter(function(e){return"text"==e.contentType}).map(function(t){return Ha(e,t)}),t.streams.forEach(function(t,i){var r=t.segments.map(function(t,n){return ja(e,n,t)});n.Na(r,0==i)}),{startTime:t.startTime,variants:i,textStreams:r}}function Ua(e,t,n){var i={},r=[];return r.push.apply(r,t),r.push.apply(r,n),r.forEach(function(e){e.variantIds.forEach(function(e){i[e]=i[e]||{id:e,language:"",primary:!1,audio:null,video:null,bandwidth:0,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0}})}),t.forEach(function(t){var n=Ha(e,t);t.variantIds.forEach(function(e){e=i[e],e.language=n.language,e.primary=e.primary||n.primary,e.audio=n})}),n.forEach(function(t){var n=Ha(e,t);t.variantIds.forEach(function(e){e=i[e],e.primary=e.primary||n.primary,e.video=n})}),$e.values(i)}function Ha(e,t){var n=t.segments.map(function(t,n){return ja(e,n,t)}),i=new pr(n);return n={id:t.id,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return i.find(e)},getSegmentReference:function(e){return i.get(e)},initSegmentReference:null,presentationTimeOffset:t.presentationTimeOffset,mimeType:t.mimeType,codecs:t.codecs,width:t.width||void 0,height:t.height||void 0,frameRate:t.frameRate||void 0,kind:t.kind,encrypted:t.encrypted,keyId:t.keyId,language:t.language,label:t.label||null,type:t.contentType,primary:t.primary,trickModeVideo:null,containsEmsgBoxes:!1,roles:[],channelsCount:null},null!=t.initSegmentKey&&(n.initSegmentReference=Va(e,t.initSegmentKey)),n}function ja(e,t,n){var i=new Na("segment",e.b,e.a,n.dataKey);return new tr(t,n.startTime,n.endTime,function(){return[i.toString()]},0,null)}function Va(e,t){var n=new Na("segment",e.b,e.a,t);return new er(function(){return[n.toString()]},0,null)}function Ka(){this.a=null}function qa(e){var t=Ba(e);return t&&"manifest"==t.a?qa.a(e):t&&"segment"==t.a?qa.b(t.key(),t):le(new se(2,1,9004,e))}function za(e){this.a=null;for(var t=0;t<e.textTracks.length;++t){var n=e.textTracks[t];n.mode="disabled","Shaka Player TextTrack"==n.label&&(this.a=n)}this.a||(this.a=e.addTextTrack("subtitles","Shaka Player TextTrack")),this.a.mode="hidden"}function Ya(e){if(e.startTime>=e.endTime)return null;var t=new VTTCue(e.startTime,e.endTime,e.payload);t.lineAlign=e.lineAlign,t.positionAlign=e.positionAlign,t.size=e.size;try{t.align=e.textAlign}catch(n){}return"center"==e.textAlign&&"center"!=t.align&&(t.align="middle"),2==e.writingDirection?t.vertical="lr":3==e.writingDirection&&(t.vertical="rl"),1==e.lineInterpretation&&(t.snapToLines=!1),null!=e.line&&(t.line=e.line),null!=e.position&&(t.position=e.position),t}function $a(e,t){var n=e.mode;e.mode="showing"==n?"showing":"hidden";for(var i=e.cues,r=i.length-1;0<=r;r--){var o=i[r];o&&t(o)&&e.removeCue(o)}e.mode=n}function Wa(t,n){var i=this;yi.call(this),this.ha=!1,this.f=null,this.pb=!1,this.v=null,this.o=new Ce,this.Bb=this.h=this.Db=this.b=this.m=this.a=this.A=this.g=this.j=this.i=this.s=null,this.bd=1e9,this.lb=[],this.ob=!1,this.xa=!0,this.T=this.qb=this.Ha=null,this.kc=!1,this.G=null,this.nb=[],this.K={},this.c=ll(this),this.mb={width:1/0,height:1/0},this.l=ul(),this.kb=0,this.M=this.c.preferredAudioLanguage,this.ga=this.c.preferredTextLanguage,this.Ga=this.c.preferredVariantRole,this.Ua=this.c.preferredTextRole,this.fa=this.c.preferredAudioChannelCount,n&&n(this),this.s=new Se(this.Ke.bind(this)),t&&this.rb(t,!0),Ne(this.o,e,"online",function(){i.ac()})}function Ga(e){if(!e.Ha)return Promise.resolve();var t=Promise.resolve();return e.m&&(t=e.m.stop(),e.m=null),Promise.all([t,e.Ha()])}n=ya.prototype,n.destroy=function(){return this.a.destroy()},n.hasFixedKeySpace=function(){return!0},n.addSegments=function(){return va("segment")},n.removeSegments=function(e,t){return ba(this,"segment",e,t)},n.getSegments=function(e){return Ea(this,"segment",e).then(function(e){return e.map(wa)})},n.addManifests=function(){return va("manifest")},n.updateManifestExpiration=function(e,t){var n=la(this.a,"manifest"),i=n.store(),r=new ne;return i.get(e).onsuccess=function(n){(n=n.target.result)?(n.expiration=t,i.put(n),r.resolve()):r.reject(new se(2,9,9012,"Could not find values for "+e))},n.promise().then(function(){return r})},n.removeManifests=function(e,t){return ba(this,"manifest",e,t)},n.getManifests=function(e){return Ea(this,"manifest",e).then(function(e){return e.map(_a)})},n.getAllManifests=function(){var e=ua(this.a,"manifest","readonly"),t={};return e.store().openCursor().onsuccess=function(e){(e=e.target.result)&&(t[e.key]=_a(e.value),e["continue"]())},e.promise().then(function(){return t})},n=Ma.prototype,n.destroy=function(){return this.a.destroy()},n.hasFixedKeySpace=function(){return this.f},n.addSegments=function(e){return Aa(this,this.c,e)},n.removeSegments=function(e,t){return La(this,this.c,e,t)},n.getSegments=function(e){return Ra(this,this.c,e)},n.addManifests=function(e){return Aa(this,this.b,e)},n.updateManifestExpiration=function(e,t){var n=la(this.a,this.b),i=n.store();return i.get(e).onsuccess=function(n){(n=n.target.result)&&(n.expiration=t,i.put(n,e))},n.promise()},n.removeManifests=function(e,t){return La(this,this.b,e,t)},n.getManifests=function(e){return Ra(this,this.b,e)},n.getAllManifests=function(){var e=ua(this.a,this.b,"readonly"),t={};return e.store().openCursor().onsuccess=function(e){(e=e.target.result)&&(t[e.key]=e.value,e["continue"]())},e.promise().then(function(){return t})},Pa.prototype.init=function(){var t=this,n=new ne,i=e.indexedDB.open("shaka_offline_db",3);return i.onsuccess=function(e){e=e.target.result,t.f=e;var i=e.objectStoreNames;i=i.contains("manifest")&&i.contains("segment")?new ya(e):null,t.a=i,i=e.objectStoreNames,i=i.contains("manifest-v2")&&i.contains("segment-v2")?new Ma(e,"segment-v2","manifest-v2",!0):null,t.b=i,i=e.objectStoreNames,e=i.contains("manifest-v3")&&i.contains("segment-v3")?new Ma(e,"segment-v3","manifest-v3",!1):null,t.c=e,n.resolve()},i.onupgradeneeded=function(e){e=e.target.result;var t={autoIncrement:!0};e.createObjectStore("manifest-v3",t),e.createObjectStore("segment-v3",t)},i.onerror=function(e){n.reject(new se(2,9,9001,i.error)),e.preventDefault()},n},Pa.prototype.destroy=function(){var e=this;return p(function t(){return L(t,function(t){switch(t.u){case 1:if(!e.a){t.N(2);break}return v(t,e.a.destroy(),2);case 2:if(!e.b){t.N(4);break}return v(t,e.b.destroy(),4);case 4:if(!e.c){t.N(6);break}return v(t,e.c.destroy(),6);case 6:e.f&&e.f.close(),t.u=0}})})},Pa.prototype.getCells=function(){var e={};return this.a&&(e.v1=this.a),this.b&&(e.v2=this.b),this.c&&(e.v3=this.c),e},Pa.prototype.erase=function(){var e=this;return p(function t(){return L(t,function(t){switch(t.u){case 1:if(!e.a){t.N(2);break}return v(t,e.a.destroy(),2);case 2:if(!e.b){t.N(4);break}return v(t,e.b.destroy(),4);case 4:if(!e.c){t.N(6);break}return v(t,e.c.destroy(),6);case 6:return e.f&&e.f.close(),v(t,Ca(),8);case 8:return e.f=null,e.a=null,e.b=null,e.c=null,v(t,e.init(),0)}})})},ga.idb=function(){return e.indexedDB?new Pa:null},Na.prototype.ea=function(){return this.g},Na.prototype.O=function(){return this.f},Na.prototype.key=function(){return this.c},Na.prototype.toString=function(){return this.b},n=Ka.prototype,n.configure=function(){},n.start=function(e){var t=Ba(e);if(this.a=t,null==t||"manifest"!=t.a)return Promise.reject(new se(2,1,9004,t));var n=new ca;return _e([n],function(){return p(function e(){var i,r,o,s;return L(e,function(e){switch(e.u){case 1:return v(e,n.init(),2);case 2:return v(e,fa(n,t.ea(),t.O()),3);case 3:return i=e.J,v(e,i.getManifests([t.key()]),4);case 4:return r=e.J,o=r[0],s=new Fa(t.ea(),t.O()),e["return"](ka(s,o))}})})})},n.stop=function(){return Promise.resolve()},n.update=function(){},n.onExpirationUpdated=function(e,t){var n=this.a,i=new ca;return _e([i],function(){return p(function r(){var o,s,a,l,u;return L(r,function(r){switch(r.u){case 1:return v(r,i.init(),2);case 2:return v(r,fa(i,n.ea(),n.O()),3);case 3:return o=r.J,v(r,o.getManifests([n.key()]),4);case 4:if(s=r.J,a=s[0],l=0<=a.sessionIds.indexOf(e),u=void 0==a.expiration||a.expiration>t,l&&u)return v(r,o.updateManifestExpiration(n.key(),t),0);r.N(0)}})})})["catch"](function(){})},kr["application/x-offline-manifest"]=Ka,C("shaka.offline.OfflineScheme",qa),qa.a=function(e){return e={uri:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}},ce(e)},qa.b=function(e,t){var n=new ca,i=_e([n],function(){return p(function e(){var i,r,o;return L(e,function(e){switch(e.u){case 1:return v(e,n.init(),2);case 2:return v(e,fa(n,t.ea(),t.O()),3);case 3:return i=e.J,v(e,i.getSegments([t.key()]),4);case 4:return r=e.J,o=r[0],e["return"]({uri:t,data:o.data,headers:{}})}})})});return de(i)},Ie("offline",qa),C("shaka.text.SimpleTextDisplayer",za),za.prototype.remove=function(e,t){return!!this.a&&($a(this.a,function(n){return!(n.startTime>=t||n.endTime<=e)}),!0)},za.prototype.remove=za.prototype.remove,za.prototype.append=function(e){for(var t=Ya,n=[],i=0;i<e.length;i++){var r=t(e[i]);r&&n.push(r)}n.slice().sort(function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:n.indexOf(t)-n.indexOf(e)}).forEach(function(e){this.a.addCue(e)}.bind(this))},za.prototype.append=za.prototype.append,za.prototype.destroy=function(){return this.a&&$a(this.a,function(){return!0}),this.a=null,Promise.resolve()},za.prototype.destroy=za.prototype.destroy,za.prototype.isTextVisible=function(){return"showing"==this.a.mode},za.prototype.isTextVisible=za.prototype.isTextVisible,za.prototype.setTextVisibility=function(e){this.a.mode=e?"showing":"hidden"},za.prototype.setTextVisibility=za.prototype.setTextVisibility,N(Wa,yi),C("shaka.Player",Wa),Wa.prototype.destroy=function(){var e=this;return p(function t(){var n;return L(t,function(t){switch(t.u){case 1:return v(t,e.detach(),2);case 2:return e.ha=!0,n=Promise.all([e.o?e.o.destroy():null,e.s?e.s.destroy():null]),e.pb=!1,e.o=null,e.h=null,e.Bb=null,e.s=null,e.c=null,v(t,n,0)}})})},Wa.prototype.destroy=Wa.prototype.destroy,Wa.version="v2.4.7";var Xa={};function Qa(e,t,n){return p(function i(){var r,o;return L(i,function(i){switch(i.u){case 1:return v(i,Hr(t,e.s,e.c.manifest.retryParameters,n),2);case 2:return r=i.J,e.m=new r,e.m.configure(e.c.manifest),o={networkingEngine:e.s,filterNewPeriod:e.tb.bind(e),filterAllPeriods:e.ec.bind(e),onTimelineRegionAdded:e.be.bind(e),onEvent:e.gb.bind(e),onError:e.Ta.bind(e)},i["return"](e.m.start(t,o))}})})}function Ja(e){function t(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")}if(e.b.periods.some(function(e){return e.variants.some(t)})&&e.b.periods.forEach(function(e){e.variants=e.variants.filter(t)}),0==e.b.periods.length)throw new se(2,4,4014)}function Za(e){var t=e.b.presentationTimeline.U(),n=e.c.playRangeEnd,i=e.c.playRangeStart;0<i&&(e.R()||e.b.presentationTimeline.Tc(i)),n<t&&(e.R()||e.b.presentationTimeline.la(n))}function el(e){function t(e){return(e.video?e.video.codecs.split(".")[0]:"")+"-"+(e.audio?e.audio.codecs.split(".")[0]:"")}var n=e.b.periods.reduce(function(e,t){return e.concat(t.variants)},[]);n=jn(n,e.c.preferredAudioChannelCount);var i={};n.forEach(function(e){var n=t(e);n in i||(i[n]=[]),i[n].push(e)});var r=null,o=1/0;$e.forEach(i,function(e,t){var n=0,i=0;t.forEach(function(e){n+=e.bandwidth||0,++i});var s=n/i;s<o&&(r=e,o=s)}),e.b.periods.forEach(function(e){e.variants=e.variants.filter(function(e){return t(e)==r})})}function tl(e){if(e.m&&e.m.configure(e.c.manifest),e.i&&e.i.configure(e.c.drm),e.a){e.a.configure(e.c.streaming);try{e.b.periods.forEach(e.tb.bind(e))}catch(r){e.Ta(r)}var t=Es(e.a),n=_s(e.a),i=vs(e.a);(t=zn(t,n,i.variants))&&t.allowedByApplication&&t.allowedByKeySystem||pl(e,i)}e.h&&(e.h.configure(e.c.abr),e.c.abr.enabled&&!e.xa?e.h.enable():e.h.disable())}function nl(e){var t=[];return e.forEach(function(e){if(e){var n=e.language;e.roles.length?e.roles.forEach(function(e){t.push({language:n,role:e})}):t.push({language:n,role:""})}else t.push({language:"und",role:""})}),me(t,function(e,t){return e.language==t.language&&e.role==t.role})}function il(e,t,n){t.video&&ol(e,t.video),t.audio&&ol(e,t.audio);var i=bs(e.a);t!=zn(Es(e.a),_s(e.a),i?i.variants:[])&&e.l.switchHistory.push({timestamp:Date.now()/1e3,id:t.id,type:"variant",fromAdaptation:n,bandwidth:t.bandwidth})}function rl(e,t,n){ol(e,t),e.l.switchHistory.push({timestamp:Date.now()/1e3,id:t.id,type:"text",fromAdaptation:n,bandwidth:null})}function ol(e,t){var n=Wn(e.b,t);e.K[n]||(e.K[n]={}),e.K[n][t.type]=t.id}function sl(e){e.o&&(e.o.qa(e.f,"loadeddata"),e.o.qa(e.f,"playing"),e.o.qa(e.f,"pause"),e.o.qa(e.f,"ended"));var t=e.i,n=Promise.all([e.h?e.h.stop():null,e.j?e.j.destroy():null,e.g?e.g.destroy():null,e.A?e.A.destroy():null,e.a?e.a.destroy():null,e.m?e.m.stop():null,e.v?e.v.destroy():null]).then(function(){return t?t.destroy():null});return e.xa=!0,e.i=null,e.j=null,e.g=null,e.A=null,e.a=null,e.m=null,e.v=null,e.b=null,e.Db=null,e.nb=[],e.K={},e.l=ul(),n}function al(){return{".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",serverCertificate:new Uint8Array(0)}}}function ll(e){var t=5e5,n=1/0;return navigator.connection&&navigator.connection.type&&(t=1e6*navigator.connection.downlink,navigator.connection.saveData&&(n=360)),{drm:{retryParameters:oe(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1},manifest:{retryParameters:oe(),availabilityWindowOverride:NaN,dash:{customScheme:function(e){if(e)return null},clockSyncUri:"",ignoreDrmInfo:!1,xlinkFailGracefully:!1,defaultPresentationDelay:10}},streaming:{retryParameters:oe(),failureCallback:e.ld.bind(e),rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,forceTransmuxTS:!1},abrFactory:Gn,textDisplayFactory:function(){return new za(e.f)},abr:{enabled:!0,defaultBandwidthEstimate:t,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:n,minPixels:0,maxPixels:1/0,minBandwidth:0,maxBandwidth:1/0}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minBandwidth:0,maxBandwidth:1/0},playRangeStart:0,playRangeEnd:1/0}}function ul(){return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,estimatedBandwidth:NaN,loadLatency:NaN,playTime:0,bufferingTime:0,switchHistory:[],stateHistory:[]}}function cl(e,t,n){e.xa?(e.T=t,e.kc=n||!1):Is(e.a,t,n||!1)}function dl(e){if(e.b){var t=Date.now()/1e3;e.ob?e.l.bufferingTime+=t-e.kb:e.l.playTime+=t-e.kb,e.kb=t}}function hl(e,t){function n(e,t){if(!e)return null;var n=e.findSegmentPosition(t-o.startTime);return null==n?null:(n=e.getSegmentReference(n))?n.startTime+o.startTime:null}var i=Es(e.a),r=_s(e.a),o=vs(e.a);return i=n(i,t),r=n(r,t),null!=r&&null!=i?Math.max(r,i):null!=r?r:null!=i?i:t}function fl(e,t){return t&&t.length?(e.h.setVariants(t),e.h.chooseVariant()):(e.Ta(new se(2,4,4012)),null)}function pl(e,t){var n=Un(t.variants,e.M,e.Ga,e.fa),i=Vn(t.textStreams,e.ga,e.Ua);(n=fl(e,n))&&(il(e,n,!0),cl(e,n,!0)),(i=i[0])&&(e.c.streaming.alwaysStreamText||e.Nb())&&(rl(e,i,!0),e.xa?e.G=i:Ds(e.a,i,!0)),ml(e)}function ml(e){Promise.resolve().then(function(){this.ha||this.dispatchEvent(new Oe("adaptation"))}.bind(e))}function gl(e){Promise.resolve().then(function(){this.ha||this.dispatchEvent(new Oe("trackschanged"))}.bind(e))}function yl(e){e.dispatchEvent(new Oe("texttrackvisibility"))}function vl(e,t,n){var i=void 0==t.expiration?1/0:t.expiration,r=t.presentationTimeline.U();return t=Cn(t.periods[0]),{offlineUri:null,originalManifestUri:e,duration:r,size:0,expiration:i,tracks:t,appMetadata:n}}function bl(e,t){var n=Oa(new Fa(e.ea(),e.O()),t.periods[0],new jr(null,0)),i=t.appMetadata||{};return n=Cn(n),{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:n,appMetadata:i}}function El(){this.a={}}function _l(e,t,n){return n=n.endTime-n.startTime,xl(e,t)*n}function xl(e,t){var n=e.a[t];return null==n&&(n=0),n}function Tl(e){if(!e||e.constructor!=Wa)throw new se(2,9,9008);this.a=e,this.b=Ll(this),this.g=!1,this.c=null,this.f=[]}function Sl(){return ma()}function wl(e,t,n,i,r,o){var s,a=vl(r,i,o),l=new ea(function(t,n){a.size=n,e.b.progressCallback(a,t)});return _e([l],function(){return s=Nl(e,l,t,n,i,r,o),na(l,e.a.s)}).then(function(){return s.size=a.size,s})}function Il(e,t,n){var i,r=new dt({$a:e.a.s,onError:function(e){6013!=e.code&&(i=e)},Vb:function(){},onExpirationUpdated:function(){},onEvent:function(){}});r.configure(e.a.getConfiguration().drm);var o=ka(new Fa(t.ea(),t.O()),n);return _e([r],function(){return p(function t(){return L(t,function(t){switch(t.u){case 1:return v(t,r.init(o,e.b.usePersistentLicense),2);case 2:return v(t,ft(r,n.sessionIds),0)}})})}).then(function(){if(i)throw i})}function Dl(e,t,n,i){function r(){a+=1,e.b.progressCallback(l,a/s)}var o=jl(i),s=o.length+1,a=0,l=bl(n,i);return Promise.all([t.removeSegments(o,r),t.removeManifests([n.key()],r)])}function Ml(e,t,n,i){function r(){}var o,s,a,l=e.a.s,u=e.a.getConfiguration();return Hr(t,l,u.manifest.retryParameters,i).then(function(e){var i=this;Ol(this),s=new dt({$a:l,onError:n,Vb:r,onExpirationUpdated:function(){},onEvent:function(){}}),s.configure(u.drm);var o={networkingEngine:l,filterAllPeriods:function(e){Rl(i,s,e)},filterNewPeriod:function(e){Pl(i,s,e)},onTimelineRegionAdded:function(){},onEvent:function(){},onError:n};return a=new e,a.configure(u.manifest),a.start(t,o)}.bind(e)).then(function(e){return Ol(this),o=e,s.init(o,this.b.usePersistentLicense)}.bind(e)).then(function(){return Ol(this),Cl(o)}.bind(e)).then(function(){return Ol(this),pt(s)}.bind(e)).then(function(){return Ol(this),a.stop()}.bind(e)).then(function(){return Ol(this),{manifest:o,Fb:s}}.bind(e))["catch"](function(e){if(a)return a.stop().then(function(){throw e});throw e})}function Al(e,t){var n=[],i=wn(e),r=[0,Tn,Sn],o=t.filter(function(e){return"variant"==e.type});r=r.map(function(e){return o.filter(function(t){return t=wn(t.language),xn(e,i,t)})});for(var s,a=0;a<r.length;a++)if(r[a].length){s=r[a];break}s||(r=o.filter(function(e){return e.primary}),r.length&&(s=r)),s||(s=o,o.map(function(e){return e.language}).filter(Ke));var l=s.filter(function(e){return e.height&&480>=e.height});return l.length&&(l.sort(function(e,t){return t.height-e.height}),s=l.filter(function(e){return e.height==l[0].height})),s.sort(function(e,t){return e.bandwidth-t.bandwidth}),s.length&&n.push(s[Math.floor(s.length/2)]),n.push.apply(n,t.filter(function(e){return"text"==e.type})),n}function Ll(e){return{trackSelectionCallback:function(t){var n=e.a.getConfiguration();return Al(n.preferredAudioLanguage,t)},progressCallback:function(e,t){if(e||t)return null},usePersistentLicense:!0}}function Rl(e,t,n){n.forEach(function(n){return Pl(e,t,n)})}function Pl(e,t,n){var i=null;if(e.c){var r=e.c.filter(function(e){return"variant"==e.type})[0];r&&(i=Fn(n,r))}var o=r=null;i&&(i.audio&&(r=i.audio),i.video&&(o=i.video)),An(t,r,o,n),Mn(n,e.a.getConfiguration().restrictions,{width:1/0,height:1/0})}function Cl(e){var t=e.periods.map(function(e){return e.variants}).reduce(He,[]).map(function(e){var t=[];return e.audio&&t.push(e.audio),e.video&&t.push(e.video),t}).reduce(He,[]).filter(Ke);return e=e.periods.map(function(e){return e.textStreams}).reduce(He,[]),t.push.apply(t,e),Promise.all(t.map(function(e){return e.createSegmentIndex()}))}function Nl(e,t,n,i,r,o,s){var a=new El,l=r.periods.map(function(o){return Bl(e,t,n,a,i,r,o)}),u=i.b,c=gt(i);if(u&&e.b.usePersistentLicense){if(!c.length)throw new se(2,9,9007,o);u.initData=[]}return{originalManifestUri:o,duration:r.presentationTimeline.U(),size:0,expiration:i.vb(),periods:l,sessionIds:e.b.usePersistentLicense?c:[],drmInfo:u,appMetadata:s}}function Bl(e,t,n,i,r,o,s){var a=Nn(s,null,null),l=Bn(s,null);a=e.b.trackSelectionCallback(a.concat(l)),null==e.c&&(e.c=a,Rl(e,r,o.periods)),Vl(a),o.periods.forEach(function(e){e.variants.forEach(function(e){var t=e.audio,n=e.video;if(t&&!n&&(i.a[t.id]=t.bandwidth||e.bandwidth),!t&&n&&(i.a[n.id]=n.bandwidth||e.bandwidth),t&&n){var r=t.bandwidth||393216,o=n.bandwidth||e.bandwidth-r;0>=o&&(o=e.bandwidth),i.a[t.id]=r,i.a[n.id]=o}}),e.textStreams.forEach(function(e){i.a[e.id]=52})});var u={};a.forEach(function(e){"variant"==e.type&&null!=e.audioId&&(u[e.audioId]=!0),"variant"==e.type&&null!=e.videoId&&(u[e.videoId]=!0),"text"==e.type&&(u[e.id]=!0)});var c={};return Kl(o).filter(function(e){return!!u[e.id]}).forEach(function(r){c[r.id]=Fl(e,t,n,i,o,r)}),a.forEach(function(e){"variant"==e.type&&null!=e.audioId&&c[e.audioId].variantIds.push(e.id),"variant"==e.type&&null!=e.videoId&&c[e.videoId].variantIds.push(e.id)}),{startTime:s.startTime,streams:$e.values(c)}}function Fl(e,t,n,i,r,o){var s={id:o.id,primary:o.primary,presentationTimeOffset:o.presentationTimeOffset||0,contentType:o.type,mimeType:o.mimeType,codecs:o.codecs,frameRate:o.frameRate,kind:o.kind,language:o.language,label:o.label,width:o.width||null,height:o.height||null,initSegmentKey:null,encrypted:o.encrypted,keyId:o.keyId,segments:[],variantIds:[]};r=r.presentationTimeline.Xa();var a=o.id;return kl(o,r,function(r){ta(t,a,Hl(e,r),_l(i,o.id,r),function(t){return n.addSegments([{data:t}]).then(function(t){e.f.push(t[0]),s.segments.push({startTime:r.startTime,endTime:r.endTime,dataKey:t[0]})})})}),(r=o.initSegmentReference)&&ta(t,a,Hl(e,r),.5*xl(i,o.id),function(t){return n.addSegments([{data:t}]).then(function(t){e.f.push(t[0]),s.initSegmentKey=t[0]})}),s}function kl(e,t,n){t=e.findSegmentPosition(t);for(var i=null==t?null:e.getSegmentReference(t);i;)n(i),i=e.getSegmentReference(++t)}function Ol(e){if(!e.a)throw new se(2,9,7001)}function Ul(){if(!ma())throw new se(2,9,9e3)}function Hl(e,t){var n=e.a.getConfiguration().streaming.retryParameters;return n=De(t.c(),n),0==t.b&&null==t.a||(n.headers.Range="bytes="+t.b+"-"+(null==t.a?"":t.a)),n}function jl(e){var t=[];return e.periods.forEach(function(e){e.streams.forEach(function(e){null!=e.initSegmentKey&&t.push(e.initSegmentKey),e.segments.forEach(function(e){t.push(e.dataKey)})})}),t}function Vl(e){e.some(function(t){return e.some(function(e){return t!=e&&t.type==e.type&&t.kind==e.kind&&t.language==e.language})})}function Kl(e){var t={};return e.periods.forEach(function(e){e.textStreams.forEach(function(e){t[e.id]=e}),e.variants.forEach(function(e){e.audio&&(t[e.audio.id]=e.audio),e.video&&(t[e.video.id]=e.video)})}),$e.values(t)}Wa.registerSupportPlugin=function(e,t){Xa[e]=t},Wa.isBrowserSupported=function(){return!!e.Promise&&!!e.Uint8Array&&!!Array.prototype.forEach&&!!e.MediaSource&&!!MediaSource.isTypeSupported&&!!e.MediaKeys&&!!e.navigator&&!!e.navigator.requestMediaKeySystemAccess&&!!e.MediaKeySystemAccess&&!!e.MediaKeySystemAccess.prototype.getConfiguration},Wa.probeSupport=function(){return Mt().then(function(e){var t=Ur(),n=cn();for(var i in e={manifest:t,media:n,drm:e},Xa)e[i]=Xa[i]();return e})},Wa.prototype.rb=function(e,t){var n=this;return p(function i(){return L(i,function(i){switch(i.u){case 1:if(void 0===t&&(t=!0),!n.f){i.N(2);break}return v(i,n.detach(),2);case 2:if(n.f=e,Ne(n.o,n.f,"error",n.ce.bind(n)),t)return n.j=new un(n.f),v(i,n.j.j,0);i.N(0)}})})},Wa.prototype.attach=Wa.prototype.rb,Wa.prototype.detach=function(){var e=this;return p(function t(){return L(t,function(t){switch(t.u){case 1:return e.f?v(t,e.hb(!1),2):t["return"]();case 2:e.o.qa(e.f,"error"),e.f=null,t.u=0}})})},Wa.prototype.detach=Wa.prototype.detach,Wa.prototype.load=function(e,t,n){var i=this;return p(function r(){var o,s,a,l,u,c,d,h,f,p,m;return L(r,function(r){switch(r.u){case 1:if(!i.f)throw new se(2,7,7002);return s=new ne,a=function(){return o=new se(2,7,7e3),s},i.dispatchEvent(new Oe("loading")),l=Date.now(),b(r,2),u=i.hb(),i.Ha=a,v(r,u,4);case 4:if(i.l=ul(),Ne(i.o,i.f,"playing",i.ib.bind(i)),Ne(i.o,i.f,"pause",i.ib.bind(i)),Ne(i.o,i.f,"ended",i.ib.bind(i)),c=i.c.abrFactory,i.h&&i.Bb==c||(i.Bb=c,i.h=new c,i.h.configure(i.c.abr)),i.v=new i.c.textDisplayFactory,i.v.setTextVisibility(i.pb),o)throw o;return d=i,v(r,Qa(i,e,n),5);case 5:if(d.b=r.J,i.Db=e,o)throw o;return Ja(i),i.i=new dt({$a:i.s,onError:i.Ta.bind(i),Vb:i.Nd.bind(i),onExpirationUpdated:i.Kd.bind(i),onEvent:i.gb.bind(i)}),i.i.configure(i.c.drm),v(r,i.i.init(i.b,!1),6);case 6:if(o)throw o;return i.ec(i.b.periods),i.kb=Date.now()/1e3,i.M=i.c.preferredAudioLanguage,i.ga=i.c.preferredTextLanguage,i.fa=i.c.preferredAudioChannelCount,Za(i),v(r,i.i.rb(i.f),7);case 7:if(o)throw o;return i.h.init(i.Le.bind(i)),i.j||(i.j=new un(i.f)),i.j.o=i.v,i.g=new ls(i.f,i.b,i.c.streaming,void 0==t?null:t,i.Je.bind(i),i.gb.bind(i)),i.A=new fs(i.f,i.j,i.b,i.c.streaming,i.Uc.bind(i),i.gb.bind(i),i.Ie.bind(i)),i.a=new ys(i.b,{Pa:i.g,I:i.j,$a:i.s,Ac:i.Id.bind(i),zc:i.gd.bind(i),onError:i.Ta.bind(i),onEvent:i.gb.bind(i),Od:i.Pd.bind(i),ab:i.Zd.bind(i),filterNewPeriod:i.tb.bind(i),filterAllPeriods:i.ec.bind(i)}),i.a.configure(i.c.streaming),el(i),i.dispatchEvent(new Oe("streaming")),v(r,i.a.init(),8);case 8:if(o)throw o;if(i.c.streaming.startAtSegmentBoundary&&(h=hl(i,us(i.g)),os(i.g.a,h)),i.b.periods.forEach(i.tb.bind(i)),gl(i),ml(i),f=vs(i.a),p=Un(f.variants,i.M,i.Ga,i.fa),i.h.setVariants(p),f.variants.some(function(e){return e.primary}),i.nb.forEach(i.A.o.bind(i.A)),i.nb=[],Be(i.o,i.f,"loadeddata",function(){this.l.loadLatency=(Date.now()-l)/1e3}.bind(i)),o)throw o;i.Ha=null,_(r,0);break;case 2:return m=x(r),s.resolve(),i.Ha==a&&(i.Ha=null,i.dispatchEvent(new Oe("unloading"))),o?r["return"](Promise.reject(o)):r["return"](Promise.reject(m))}})})},Wa.prototype.load=Wa.prototype.load,Wa.prototype.configure=function(e,t){if(2==arguments.length&&"string"==typeof e){for(var n=e,i={},r=i,o=0,s=0;;){if(o=n.indexOf(".",o),0>o)break;0!=o&&"\\"==n[o-1]||(s=n.substring(s,o).replace(/\\\./g,"."),r[s]={},r=r[s],s=o+1),o+=1}r[n.substring(s).replace(/\\\./g,".")]=t,e=i}return n=be(this.c,e,ll(this),al(),""),tl(this),n},Wa.prototype.configure=Wa.prototype.configure,Wa.prototype.getConfiguration=function(){var e=ll(this);return be(e,this.c,ll(this),al(),""),e},Wa.prototype.getConfiguration=Wa.prototype.getConfiguration,Wa.prototype.we=function(){this.c=ll(this),tl(this)},Wa.prototype.resetConfiguration=Wa.prototype.we,Wa.prototype.td=function(){return this.f},Wa.prototype.getMediaElement=Wa.prototype.td,Wa.prototype.uc=function(){return this.s},Wa.prototype.getNetworkingEngine=Wa.prototype.uc,Wa.prototype.Jb=function(){return this.Db},Wa.prototype.getManifestUri=Wa.prototype.Jb,Wa.prototype.R=function(){return!!this.b&&this.b.presentationTimeline.R()},Wa.prototype.isLive=Wa.prototype.R,Wa.prototype.Aa=function(){return!!this.b&&this.b.presentationTimeline.Aa()},Wa.prototype.isInProgress=Wa.prototype.Aa,Wa.prototype.Ed=function(){if(!this.b||!this.b.periods.length)return!1;var e=this.b.periods[0].variants;return!!e.length&&!e[0].video},Wa.prototype.isAudioOnly=Wa.prototype.Ed,Wa.prototype.ye=function(){var e=0,t=0;return this.b&&(t=this.b.presentationTimeline,e=t.Ja(),t=t.na()),{start:e,end:t}},Wa.prototype.seekRange=Wa.prototype.ye,Wa.prototype.keySystem=function(){return this.i?this.i.keySystem():""},Wa.prototype.keySystem=Wa.prototype.keySystem,Wa.prototype.drmInfo=function(){return this.i?this.i.b:null},Wa.prototype.drmInfo=Wa.prototype.drmInfo,Wa.prototype.vb=function(){return this.i?this.i.vb():1/0},Wa.prototype.getExpiration=Wa.prototype.vb,Wa.prototype.xc=function(){return this.ob},Wa.prototype.isBuffering=Wa.prototype.xc,Wa.prototype.hb=function(e){var t=this;return p(function n(){return L(n,function(n){switch(n.u){case 1:return t.ha?n["return"]():(void 0===e&&(e=!0),t.dispatchEvent(new Oe("unloading")),v(n,Ga(t),2));case 2:return t.qb||(t.qb=sl(t).then(function(){t.Uc(!1),t.qb=null})),v(n,t.qb,3);case 3:if(e)return t.j=new un(t.f),v(n,t.j.j,0);n.N(0)}})})},Wa.prototype.unload=Wa.prototype.hb,Wa.prototype.Va=function(){return this.g?this.g.Va():0},Wa.prototype.getPlaybackRate=Wa.prototype.Va,Wa.prototype.Ue=function(e){this.g&&ss(this.g.a,e),this.a&&ws(this.a,1!=e)},Wa.prototype.trickPlay=Wa.prototype.Ue,Wa.prototype.hd=function(){this.g&&ss(this.g.a,1),this.a&&ws(this.a,!1)},Wa.prototype.cancelTrickPlay=Wa.prototype.hd,Wa.prototype.Bd=function(){if(!this.b||!this.g)return[];var e=$n(this.b,us(this.g)),t=this.K[e]||{};return Nn(this.b.periods[e],t.audio,t.video)},Wa.prototype.getVariantTracks=Wa.prototype.Bd,Wa.prototype.Ad=function(){if(!this.b||!this.g)return[];var e=$n(this.b,us(this.g)),t=this.K[e]||{};if(!t.text){var n=Vn(this.b.periods[e].textStreams,this.ga,this.Ua);n.length&&(t.text=n[0].id)}return Bn(this.b.periods[e],t.text).filter(function(e){return 0>this.lb.indexOf(e.id)}.bind(this))},Wa.prototype.getTextTracks=Wa.prototype.Ad,Wa.prototype.Ce=function(e){if(this.a){var t=vs(this.a);e:{for(var n=0;n<t.textStreams.length;n++)if(t.textStreams[n].id==e.id){e=t.textStreams[n];break e}e=null}e&&(this.j.l=!1,rl(this,e,!1),t=e,this.xa?this.G=t:Ds(this.a,t,!0),this.ga=e.language)}},Wa.prototype.selectTextTrack=Wa.prototype.Ce,Wa.prototype.Ae=function(){this.j.l=!0,Ss(this.a)},Wa.prototype.selectEmbeddedTextTrack=Wa.prototype.Ae,Wa.prototype.Ze=function(){return!!this.j&&this.j.l},Wa.prototype.usingEmbeddedTextTrack=Wa.prototype.Ze,Wa.prototype.De=function(e,t){if(this.a){this.c.abr.enabled&&U("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var n=vs(this.a),i=Fn(n,e);i&&kn(i)&&(il(this,i,!1),cl(this,i,t),this.M=i.language,i.audio&&i.audio.channelsCount&&(this.fa=i.audio.channelsCount),n=Un(n.variants,this.M,this.Ga,this.fa),this.h.setVariants(n))}},Wa.prototype.selectVariantTrack=Wa.prototype.De,Wa.prototype.pd=function(){if(!this.a)return[];var e=vs(this.a);return e=On(e.variants).map(function(e){return e.audio}).filter(Ke),nl(e)},Wa.prototype.getAudioLanguagesAndRoles=Wa.prototype.pd,Wa.prototype.zd=function(){if(!this.a)return[];var e=vs(this.a);return nl(e.textStreams)},Wa.prototype.getTextLanguagesAndRoles=Wa.prototype.zd,Wa.prototype.od=function(){if(!this.a)return[];var e=vs(this.a);return On(e.variants).map(function(e){return e.language}).filter(Ke)},Wa.prototype.getAudioLanguages=Wa.prototype.od,Wa.prototype.yd=function(){return this.a?vs(this.a).textStreams.map(function(e){return e.language}).filter(Ke):[]},Wa.prototype.getTextLanguages=Wa.prototype.yd,Wa.prototype.ze=function(e,t){if(this.a){var n=vs(this.a);this.M=e,this.Ga=t||"",pl(this,n)}},Wa.prototype.selectAudioLanguage=Wa.prototype.ze,Wa.prototype.Be=function(e,t){if(this.a){var n=vs(this.a);this.ga=e,this.Ua=t||"",pl(this,n)}},Wa.prototype.selectTextLanguage=Wa.prototype.Be,Wa.prototype.Nb=function(){return this.v?this.v.isTextVisible():this.pb},Wa.prototype.isTextTrackVisible=Wa.prototype.Nb,Wa.prototype.Ge=function(e){this.v&&this.v.setTextVisibility(e),this.pb=e,yl(this),!this.c.streaming.alwaysStreamText&&this.a&&(e?(e=vs(this.a),(e=Vn(e.textStreams,this.ga,this.Ua)[0])&&Ts(this.a,e)):Ss(this.a))},Wa.prototype.setTextTrackVisibility=Wa.prototype.Ge,Wa.prototype.vd=function(){return this.b?new Date(1e3*this.b.presentationTimeline.g+1e3*this.f.currentTime):null},Wa.prototype.getPlayheadTimeAsDate=Wa.prototype.vd,Wa.prototype.xd=function(){return this.b?new Date(1e3*this.b.presentationTimeline.g):null},Wa.prototype.getPresentationStartTimeAsDate=Wa.prototype.xd,Wa.prototype.Hb=function(){return this.j?this.j.Hb():{total:[],audio:[],video:[],text:[]}},Wa.prototype.getBufferedInfo=Wa.prototype.Hb,Wa.prototype.getStats=function(){dl(this),this.ib();var e=null,t=null,n=this.f;if(n=n&&n.getVideoPlaybackQuality?n.getVideoPlaybackQuality():{},this.g&&this.b){var i=$n(this.b,us(this.g)),r=this.b.periods[i];(i=this.K[i])&&(e=(t=Yn(i.audio,i.video,r.variants))?t.video:null)}return e||(e={}),t||(t={}),{width:e.width||0,height:e.height||0,streamBandwidth:t.bandwidth||0,decodedFrames:Number(n.totalVideoFrames),droppedFrames:Number(n.droppedVideoFrames),estimatedBandwidth:this.h?this.h.getBandwidthEstimate():NaN,loadLatency:this.l.loadLatency,playTime:this.l.playTime,bufferingTime:this.l.bufferingTime,switchHistory:Ee(this.l.switchHistory),stateHistory:Ee(this.l.stateHistory)}},Wa.prototype.getStats=Wa.prototype.getStats,Wa.prototype.addTextTrack=function(e,t,n,i,r,o){if(!this.a)return Promise.reject();var s=vs(this.a),a=this.b.periods.indexOf(s)+1,l=(a>=this.b.periods.length?this.b.presentationTimeline.U():this.b.periods[a].startTime)-s.startTime;if(1/0==l)return Promise.reject(new se(1,4,4033));var u={id:this.bd++,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return 1},getSegmentReference:function(t){return 1!=t?null:new tr(1,0,l,function(){return[e]},0,null)},initSegmentReference:null,presentationTimeOffset:0,mimeType:i,codecs:r||"",kind:n,encrypted:!1,keyId:null,language:t,label:o||null,type:"text",primary:!1,trickModeVideo:null,containsEmsgBoxes:!1,roles:[],channelsCount:null};return this.lb.push(u.id),s.textStreams.push(u),Ts(this.a,u).then(function(){if(!this.ha){var e=this.b.periods.indexOf(s),i=xs(this.a,"text");return i&&(this.K[e].text=i.id),this.lb.splice(this.lb.indexOf(u.id),1),pl(this,s),gl(this),{id:u.id,active:!1,type:"text",bandwidth:0,language:t,label:o||null,kind:n,width:null,height:null}}}.bind(this))},Wa.prototype.addTextTrack=Wa.prototype.addTextTrack,Wa.prototype.cc=function(e,t){this.mb.width=e,this.mb.height=t},Wa.prototype.setMaxHardwareResolution=Wa.prototype.cc,Wa.prototype.ac=function(){if(this.a){var e=this.a;if(e.f)e=!1;else if(e.l)e=!1;else{for(var t in e.c){var n=e.c[t];n.Ya&&(n.Ya=!1,Ws(e,n,.1))}e=!0}}else e=!1;return e},Wa.prototype.retryStreaming=Wa.prototype.ac,Wa.prototype.sd=function(){return this.b},Wa.prototype.getManifest=Wa.prototype.sd,n=Wa.prototype,n.ld=function(e){var t=[1001,1002,1003];this.R()&&0<=t.indexOf(e.code)&&(e.severity=1,this.ac())},n.ec=function(e){e.forEach(An.bind(null,this.i,this.a?Es(this.a):null,this.a?_s(this.a):null));var t=ve(e,function(e){return e.variants.some(kn)});if(0==t)throw new se(2,4,4032);if(t<e.length)throw new se(2,4,4011);e.forEach(function(e){if(Mn(e,this.c.restrictions,this.mb)&&this.a&&vs(this.a)==e&&gl(this),!e.variants.some(kn))throw new se(2,4,4012)}.bind(this))},n.tb=function(e){An(this.i,this.a?Es(this.a):null,this.a?_s(this.a):null,e);var t=e.variants,n=t.some(kn);if(Mn(e,this.c.restrictions,this.mb)&&this.a&&vs(this.a)==e&&gl(this),e=t.some(kn),!n)throw new se(2,4,4011);if(!e)throw new se(2,4,4012);if(n=this.i?this.i.b:null)for(t=d(t),e=t.next();!e.done;e=t.next()){e=d(e.value.drmInfos);for(var i=e.next();!i.done;i=e.next())if(i=i.value,i.keySystem==n.keySystem){i=d(i.initData||[]);for(var r=i.next();!r.done;r=i.next())r=r.value,mt(this.i,r.initDataType,r.initData)}}},n.Ke=function(e,t){this.h&&this.h.segmentDownloaded(e,t)},n.Uc=function(e){if(dl(this),this.ob=e,this.ib(),this.g){var t=this.g.a;e!=t.g&&(t.g=e,ss(t,t.f))}this.dispatchEvent(new Oe("buffering",{buffering:e}))},n.Ie=function(){gl(this)},n.ib=function(){if(!this.ha){var e=this.ob?"buffering":this.f.ended?"ended":this.f.paused?"paused":"playing",t=Date.now()/1e3;if(this.l.stateHistory.length){var n=this.l.stateHistory[this.l.stateHistory.length-1];if(n.duration=t-n.timestamp,e==n.state)return}this.l.stateHistory.push({timestamp:t,state:e,duration:0})}},n.Je=function(){if(this.A){var e=this.A;e.c.forEach(e.m.bind(e,!0))}this.a&&Ms(this.a)},n.Id=function(e){this.xa=!0,this.h.disable();var t={audio:!1,text:!1},n=Un(e.variants,this.M,this.Ga,this.fa,t),i=Vn(e.textStreams,this.ga,this.Ua,t);if(n=fl(this,n),i=i[0]||null,this.T){e:{for(var r=this.b,o=0;o<r.periods.length;++o)for(var s=r.periods[o],a=0;a<s.variants.length;++a)if(s.variants[a]==this.T){r=o;break e}r=-1}this.b.periods[r]==e&&(n=this.T),this.T=null}return this.G&&(this.b.periods[Wn(this.b,this.G)]==e&&(i=this.G),this.G=null),n&&il(this,n,!0),i&&(rl(this,i,!0),!bs(this.a)&&n&&n.audio&&t.text&&i.language!=n.audio.language&&(this.v.setTextVisibility(!0),yl(this))),this.c.streaming.alwaysStreamText||this.Nb()?{variant:n,text:i}:{variant:n,text:null}},n.gd=function(){this.xa=!1,this.c.abr.enabled&&this.h.enable(),this.T&&(Is(this.a,this.T,this.kc),this.T=null),this.G&&(Ds(this.a,this.G,!0),this.G=null)},n.Pd=function(){this.m&&this.m.update&&this.m.update()},n.Zd=function(){this.g&&this.g.ab()},n.Le=function(e,t){il(this,e,!0),this.a&&(Is(this.a,e,t||!1),ml(this))},n.Ta=function(e){if(!this.ha){var t=new Oe("error",{detail:e});this.dispatchEvent(t),t.defaultPrevented&&(e.handled=!0)}},n.be=function(e){this.A?this.A.o(e):this.nb.push(e)},n.gb=function(e){this.dispatchEvent(e)},n.ce=function(){if(this.f.error){var e=this.f.error.code;if(1!=e){var t=this.f.error.msExtendedCode;t&&(0>t&&(t+=Math.pow(2,32)),t=t.toString(16)),this.Ta(new se(2,3,3016,e,t,this.f.error.message))}}},n.Nd=function(e){var t=["output-restricted","internal-error"],n=vs(this.a),i=!1,r=Object.keys(e),o=1==r.length&&"00"==r[0];r.length&&n.variants.forEach(function(n){var r=[];n.audio&&r.push(n.audio),n.video&&r.push(n.video),r.forEach(function(r){var s=n.allowedByKeySystem;r.keyId&&(r=e[o?"00":r.keyId],n.allowedByKeySystem=!!r&&0>t.indexOf(r)),s!=n.allowedByKeySystem&&(i=!0)})}),(r=zn(Es(this.a),_s(this.a),n.variants))&&!r.allowedByKeySystem&&pl(this,n),i&&(gl(this),n=Un(n.variants,this.M,this.Ga,this.fa),this.h.setVariants(n))},n.Kd=function(e,t){this.m&&this.m.onExpirationUpdated&&this.m.onExpirationUpdated(e,t),this.dispatchEvent(new Oe("expirationupdated"))},C("shaka.offline.Storage",Tl),Tl.support=Sl,Tl.prototype.destroy=function(){return this.a=this.b=null,Promise.resolve()},Tl.prototype.destroy=Tl.prototype.destroy,Tl.prototype.configure=function(e){be(this.b,e,Ll(this),{},"")},Tl.prototype.configure=Tl.prototype.configure,Tl.prototype.store=function(e,t,n){var i=this;return p(function r(){var o,s,a,l,u,c;return L(r,function(r){switch(r.u){case 1:return Ul(),i.g?r["return"](Promise.reject(new se(2,9,9006))):(i.g=!0,o=t||{},s=null,a=function(e){s=s||e},v(r,Ml(i,e,a,n),2));case 2:if(l=r.J,u=!l.manifest.presentationTimeline.R()&&!l.manifest.presentationTimeline.Aa(),!u)throw new se(2,9,9005,e);if(Ol(i),s)throw s;return c=new ca,r["return"](_e([c,l.Fb],function(){return p(function t(){var n,r,a,u,d,h,f;return L(t,function(t){switch(t.u){case 1:return E(t),v(t,c.init(),4);case 4:return Ol(i),Rl(i,l.Fb,l.manifest.periods),v(t,da(c),5);case 5:return n=t.J,Ol(i),b(t,6),v(t,wl(i,n.O,l.Fb,l.manifest,e,o||{}),8);case 8:return r=t.J,Ol(i),v(t,n.O.addManifests([r]),9);case 9:return a=t.J,Ol(i),u=new Na("manifest",n.path.ea,n.path.O,a[0]),t["return"](bl(u,r));case 6:return d=x(t),h=i.f,f=function(){},v(t,n.O.removeSegments(h,f),10);case 10:throw s||d;case 2:T(t),i.g=!1,i.c=null,i.f=[],S(t,0)}})})}))}})})},Tl.prototype.store=Tl.prototype.store,Tl.prototype.remove=function(e){var t=this;Ul();var n=Ba(e);if(null==n||"manifest"!=n.a)return Promise.reject(new se(2,9,9004,e));var i=new ca;return _e([i],function(){return p(function e(){var r,o,s;return L(e,function(e){switch(e.u){case 1:return v(e,i.init(),2);case 2:return v(e,fa(i,n.ea(),n.O()),3);case 3:return r=e.J,v(e,r.getManifests([n.key()]),4);case 4:return o=e.J,s=o[0],v(e,Promise.all([Il(t,n,s),Dl(t,r,n,s)]),0)}})})})},Tl.prototype.remove=Tl.prototype.remove,Tl.prototype.list=function(){function e(e,n){return p(function i(){var r;return L(i,function(i){switch(i.u){case 1:return v(i,n.getAllManifests(),2);case 2:r=i.J,$e.forEach(r,function(n,i){var r=bl(new Na("manifest",e.ea,e.O,n),i);t.push(r)}),i.u=0}})})}Ul();var t=[],n=new ca;return _e([n],function(){return p(function t(){var i;return L(t,function(t){switch(t.u){case 1:return v(t,n.init(),2);case 2:return i=Promise.resolve(),ha(n,function(t,n){i=i.then(function(){return e(t,n)})}),v(t,i,0)}})})}).then(function(){return t})},Tl.prototype.list=Tl.prototype.list,Tl.deleteAll=function(){return p(function e(){var t;return L(e,function(e){switch(e.u){case 1:return t=new ca,E(e),v(e,pa(t),2);case 2:return T(e),v(e,t.destroy(),5);case 5:S(e,0)}})})},Xa.offline=Sl,C("shaka.polyfill.installAll",function(){for(var e=0;e<Yl.length;++e)Yl[e].ed()});var ql,zl,Yl=[];function $l(e,t){t=t||0;for(var n={priority:t,ed:e},i=0;i<Yl.length;i++)if(Yl[i].priority<t)return void Yl.splice(i,0,n);Yl.push(n)}function Wl(e){var t=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase();if("function"===typeof Event)var n=new Event(t,e);else n=document.createEvent("Event"),n.initEvent(t,e.bubbles,e.cancelable);e.target.dispatchEvent(n)}function Gl(e,t,n){if("input"==e)switch(this.type){case"range":e="change"}ql.call(this,e,t,n)}function Xl(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(){var t=e.apply(this,arguments);return t.abort=function(){},t}}function Ql(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,n){return e.call(this,t,n-.001)}}function Jl(){var e=MediaSource.prototype.endOfStream;MediaSource.prototype.endOfStream=function(){for(var t=0,n=0;n<this.sourceBuffers.length;++n){var i=this.sourceBuffers[n];i=i.buffered.end(i.buffered.length-1),t=Math.max(t,i)}if(!isNaN(this.duration)&&t<this.duration)for(this.vc=!0,t=0;t<this.sourceBuffers.length;++t)this.sourceBuffers[t].qc=!1;return e.apply(this,arguments)};var t=!1,n=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(){var e=n.apply(this,arguments);return e.mediaSource_=this,e.addEventListener("updateend",Zl,!1),t||(this.addEventListener("sourceclose",eu,!1),t=!0),e}}function Zl(e){var t=e.target,n=t.mediaSource_;if(n.vc){for(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),t.qc=!0,e=0;e<n.sourceBuffers.length;++e)if(0==n.sourceBuffers[e].qc)return;n.vc=!1}}function eu(e){e=e.target;for(var t=0;t<e.sourceBuffers.length;++t)e.sourceBuffers[t].removeEventListener("updateend",Zl,!1);e.removeEventListener("sourceclose",eu,!1)}function tu(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){return"mp2t"!=t.split(/ *; */)[0].split("/")[1]&&e(t)}}function nu(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){var n=t.split("."),i=n[0];return n.pop(),"opus"!=i&&e(t)}}function iu(){var e=MediaSource.isTypeSupported,t=/^dv(?:he|av)\./;MediaSource.isTypeSupported=function(n){for(var i=n.split(/ *; */),r=i[0],o={},s=1;s<i.length;++s){var a=i[s].split("="),l=a[0];a=a[1].replace(/"(.*)"/,"$1"),o[l]=a}if(i=o.codecs,!i)return e(n);var u=!1,c=!1;for(var d in n=i.split(",").filter(function(e){return t.test(e)?(c=!0,!1):(/^(hev|hvc)1\.2/.test(e)&&(u=!0),!0)}),c&&(u=!1),o.codecs=n.join(","),u&&(o.eotf="smpte2084"),o)r+="; "+d+'="'+o[d]+'"';return cast.__platform__.canDisplayType(r)}}function ru(e){this.f=[],this.b=[],this.a=[],(new sr).Y("pssh",this.c.bind(this)).parse(e.buffer)}function ou(e,t){try{var n=new su(e,t);return Promise.resolve(n)}catch(i){return Promise.reject(i)}}function su(e,t){this.keySystem=e;for(var n=!1,i=0;i<t.length;++i){var r=t[i],o={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:r.initDataTypes,sessionTypes:["temporary"],label:r.label},s=!1;if(r.audioCapabilities)for(var a=0;a<r.audioCapabilities.length;++a){var l=r.audioCapabilities[a];if(l.contentType){s=!0;var u=l.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,u)&&(o.audioCapabilities.push(l),n=!0)}}if(r.videoCapabilities)for(a=0;a<r.videoCapabilities.length;++a)l=r.videoCapabilities[a],l.contentType&&(s=!0,u=l.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,u)&&(o.videoCapabilities.push(l),n=!0));if(s||(n=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),"required"==r.persistentState&&(n=!1),n)return void(this.a=o)}throw n=Error("Unsupported keySystem"),n.name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function au(e){var t=this.mediaKeys;return t&&t!=e&&uu(t,null),delete this.mediaKeys,(this.mediaKeys=e)?uu(e,this):Promise.resolve()}function lu(e){this.a=new MSMediaKeys(e),this.b=new Ce}function uu(e,t){function n(){t.msSetMediaKeys(i.a),t.removeEventListener("loadedmetadata",n)}if(Fe(e.b),!t)return Promise.resolve();Ne(e.b,t,"msneedkey",du);var i=e;try{return 1<=t.readyState?t.msSetMediaKeys(e.a):t.addEventListener("loadedmetadata",n),Promise.resolve()}catch(r){return Promise.reject(r)}}function cu(e){yi.call(this),this.c=null,this.g=e,this.b=this.a=null,this.f=new Ce,this.sessionId="",this.expiration=NaN,this.closed=new ne,this.keyStatuses=new pu}function du(e){if(e.initData){var t=document.createEvent("CustomEvent");if(t.initCustomEvent("encrypted",!1,!1,null),t.initDataType="cenc",e=e.initData){var n=new ru(e);if(!(1>=n.a.length)){for(var i=[],r=0;r<n.a.length;r++)i.push(e.subarray(n.a[r].start,n.a[r].end+1));for(e=me(i,hu),i=n=0;i<e.length;i++)n+=e[i].length;for(n=new Uint8Array(n),r=i=0;r<e.length;r++)n.set(e[r],i),i+=e[r].length;e=n}}t.initData=e,this.dispatchEvent(t)}}function hu(e,t){return ut(e,t)}function fu(e,t){var n=e.keyStatuses;n.size=void 0==t?0:1,n.a=t,e.dispatchEvent(new Oe("keystatuseschange"))}function pu(){this.size=0,this.a=void 0}function mu(){return Promise.reject(Error("The key system specified is not supported."))}function gu(e){return null==e?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function yu(){throw new TypeError("Illegal constructor.")}function vu(){throw new TypeError("Illegal constructor.")}C("shaka.polyfill.register",$l),$l(function(){if(e.Document){var t=Element.prototype;t.requestFullscreen=t.requestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen||t.webkitRequestFullscreen,t=Document.prototype,t.exitFullscreen=t.exitFullscreen||t.mozCancelFullScreen||t.msExitFullscreen||t.webkitExitFullscreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",Wl),document.addEventListener("webkitfullscreenerror",Wl),document.addEventListener("mozfullscreenchange",Wl),document.addEventListener("mozfullscreenerror",Wl),document.addEventListener("MSFullscreenChange",Wl),document.addEventListener("MSFullscreenError",Wl)}}),$l(function(){var t=navigator.userAgent;t&&0<=t.indexOf("CrKey")&&delete e.indexedDB}),$l(function(){0>navigator.userAgent.indexOf("Trident/")||HTMLInputElement.prototype.addEventListener==Gl||(ql=HTMLInputElement.prototype.addEventListener,HTMLInputElement.prototype.addEventListener=Gl)}),$l(function(){}),$l(function(){if(e.MediaSource)if(e.cast&&cast.__platform__&&cast.__platform__.canDisplayType)iu();else if(navigator.vendor&&0<=navigator.vendor.indexOf("Apple")){var t=navigator.appVersion;tu(),0<=t.indexOf("Version/8")?e.MediaSource=null:0<=t.indexOf("Version/9")?Xl():0<=t.indexOf("Version/10")?(Xl(),Jl()):(t.includes("Version/11")||t.includes("Version/12"))&&(Xl(),Ql())}else(navigator.userAgent||"").includes("Tizen")&&nu()}),ru.prototype.c=function(e){if(!(1<e.version)){var t=lt(e.reader.Da(16)),n=[];if(0<e.version)for(var i=e.reader.B(),r=0;r<i;++r){var o=lt(e.reader.Da(16));n.push(o)}i=e.reader.B(),e.reader.F(i),this.b.push.apply(this.b,n),this.f.push(t),this.a.push({start:e.start,end:e.start+e.size-1})}},su.prototype.createMediaKeys=function(){var e=new lu(this.keySystem);return Promise.resolve(e)},su.prototype.getConfiguration=function(){return this.a},lu.prototype.createSession=function(e){var t=e||"temporary";if("temporary"!=t)throw new TypeError("Session type "+e+" is unsupported on this platform.");return new cu(this.a,t)},lu.prototype.setServerCertificate=function(){return Promise.resolve(!1)},N(cu,yi),n=cu.prototype,n.generateRequest=function(e,t){this.a=new ne;try{this.c=this.g.createSession("video/mp4",new Uint8Array(t),null),Ne(this.f,this.c,"mskeymessage",this.Td.bind(this)),Ne(this.f,this.c,"mskeyadded",this.Rd.bind(this)),Ne(this.f,this.c,"mskeyerror",this.Sd.bind(this)),fu(this,"status-pending")}catch(n){this.a.reject(n)}return this.a},n.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},n.update=function(e){this.b=new ne;try{this.c.update(new Uint8Array(e))}catch(t){this.b.reject(t)}return this.b},n.close=function(){try{this.c.close(),this.closed.resolve(),Fe(this.f)}catch(e){this.closed.reject(e)}return this.closed},n.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},n.Td=function(e){this.a&&(this.a.resolve(),this.a=null),this.dispatchEvent(new Oe("message",{messageType:void 0==this.keyStatuses.a?"license-request":"license-renewal",message:e.message.buffer}))},n.Rd=function(){this.a?(fu(this,"usable"),this.a.resolve(),this.a=null):this.b&&(fu(this,"usable"),this.b.resolve(),this.b=null)},n.Sd=function(){var e=Error("EME PatchedMediaKeysMs key error");if(e.errorCode=this.c.error,null!=this.a)this.a.reject(e),this.a=null;else if(null!=this.b)this.b.reject(e),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:fu(this,"output-not-allowed");break;default:fu(this,"internal-error")}},n=pu.prototype,n.forEach=function(e){this.a&&e(this.a,zl)},n.get=function(e){if(this.has(e))return this.a},n.has=function(e){var t=zl;return!(!this.a||!ut(new Uint8Array(e),new Uint8Array(t)))},n.entries=function(){},n.keys=function(){},n.values=function(){},$l(function(){!e.HTMLVideoElement||!e.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(zl=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=au,e.MediaKeys=lu,e.MediaKeySystemAccess=su,navigator.requestMediaKeySystemAccess=ou)}),yu.prototype.createSession=function(){},yu.prototype.setServerCertificate=function(){},vu.prototype.getConfiguration=function(){},vu.prototype.createMediaKeys=function(){},$l(function(){!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(navigator.requestMediaKeySystemAccess=mu,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=gu,e.MediaKeys=yu,e.MediaKeySystemAccess=vu)},-10);var bu,Eu="";function _u(e){var t=Eu;return t?t+e.charAt(0).toUpperCase()+e.slice(1):e}function xu(e,t){try{var n=new Su(e,t);return Promise.resolve(n)}catch(i){return Promise.reject(i)}}function Tu(e){var t=this.mediaKeys;return t&&t!=e&&Iu(t,null),delete this.mediaKeys,(this.mediaKeys=e)&&Iu(e,this),Promise.resolve()}function Su(e,t){this.a=this.keySystem=e;var n=!1;"org.w3.clearkey"==e&&(this.a="webkit-org.w3.clearkey",n=!1);var i=!1,r=document.getElementsByTagName("video");r=r.length?r[0]:document.createElement("video");for(var o=0;o<t.length;++o){var s=t[o],a={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:s.initDataTypes,sessionTypes:["temporary"],label:s.label},l=!1;if(s.audioCapabilities)for(var u=0;u<s.audioCapabilities.length;++u){var c=s.audioCapabilities[u];if(c.contentType){l=!0;var d=c.contentType.split(";")[0];r.canPlayType(d,this.a)&&(a.audioCapabilities.push(c),i=!0)}}if(s.videoCapabilities)for(u=0;u<s.videoCapabilities.length;++u)c=s.videoCapabilities[u],c.contentType&&(l=!0,r.canPlayType(c.contentType,this.a)&&(a.videoCapabilities.push(c),i=!0));if(l||(i=r.canPlayType("video/mp4",this.a)||r.canPlayType("video/webm",this.a)),"required"==s.persistentState&&(n?(a.persistentState="required",a.sessionTypes=["persistent-license"]):i=!1),i)return void(this.b=a)}throw n="Unsupported keySystem","org.w3.clearkey"!=e&&"com.widevine.alpha"!=e||(n="None of the requested configurations were supported."),n=Error(n),n.name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function wu(e){this.g=e,this.b=null,this.a=new Ce,this.c=[],this.f={}}function Iu(e,t){e.b=t,Fe(e.a);var n=Eu;t&&(Ne(e.a,t,n+"needkey",e.ge.bind(e)),Ne(e.a,t,n+"keymessage",e.fe.bind(e)),Ne(e.a,t,n+"keyadded",e.de.bind(e)),Ne(e.a,t,n+"keyerror",e.ee.bind(e)))}function Du(e,t){var n=e.f[t];return n||((n=e.c.shift())?(n.sessionId=t,e.f[t]=n):null)}function Mu(e,t,n){yi.call(this),this.f=e,this.h=!1,this.a=this.b=null,this.c=t,this.g=n,this.sessionId="",this.expiration=NaN,this.closed=new ne,this.keyStatuses=new Ru}function Au(e,t,n){if(e.h)return Promise.reject(Error("The session is already initialized."));e.h=!0;try{if("persistent-license"==e.g)if(n)var i=new Uint8Array(et("LOAD_SESSION|"+n));else{var o=et("PERSISTENT|"),s=new Uint8Array(o.byteLength+t.byteLength);s.set(new Uint8Array(o),0),s.set(new Uint8Array(t),o.byteLength),i=s}else i=new Uint8Array(t)}catch(r){return Promise.reject(r)}e.b=new ne;var a=_u("generateKeyRequest");try{e.f[a](e.c,i)}catch(r){if("InvalidStateError"!=r.name)return e.b=null,Promise.reject(r);setTimeout(function(){try{this.f[a](this.c,i)}catch(e){this.b.reject(e),this.b=null}}.bind(e),10)}return e.b}function Lu(e,t){var n=e.keyStatuses;n.size=void 0==t?0:1,n.a=t,e.dispatchEvent(new Oe("keystatuseschange"))}function Ru(){this.size=0,this.a=void 0}function Pu(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function Cu(t,n,i){return new e.TextTrackCue(t,n,i)}function Nu(t,n,i){return new e.TextTrackCue(t+"-"+n+"-"+i,t,n,i)}function Bu(){}Su.prototype.createMediaKeys=function(){var e=new wu(this.a);return Promise.resolve(e)},Su.prototype.getConfiguration=function(){return this.b},n=wu.prototype,n.createSession=function(e){var t=e||"temporary";if("temporary"!=t&&"persistent-license"!=t)throw new TypeError("Session type "+e+" is unsupported on this platform.");return e=this.b||document.createElement("video"),e.src||(e.src="about:blank"),t=new Mu(e,this.g,t),this.c.push(t),t},n.setServerCertificate=function(){return Promise.resolve(!1)},n.ge=function(e){var t=document.createEvent("CustomEvent");t.initCustomEvent("encrypted",!1,!1,null),t.initDataType="webm",t.initData=e.initData,this.b.dispatchEvent(t)},n.fe=function(e){var t=Du(this,e.sessionId);t&&(e=new Oe("message",{messageType:void 0==t.keyStatuses.a?"licenserequest":"licenserenewal",message:e.message}),t.b&&(t.b.resolve(),t.b=null),t.dispatchEvent(e))},n.de=function(e){(e=Du(this,e.sessionId))&&(Lu(e,"usable"),e.a&&e.a.resolve(),e.a=null)},n.ee=function(e){var t=Du(this,e.sessionId);if(t){var n=Error("EME v0.1b key error");n.errorCode=e.errorCode,n.errorCode.systemCode=e.systemCode,!e.sessionId&&t.b?(n.method="generateRequest",45==e.systemCode&&(n.message="Unsupported session type."),t.b.reject(n),t.b=null):e.sessionId&&t.a?(n.method="update",t.a.reject(n),t.a=null):(n=e.systemCode,e.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Lu(t,"output-restricted"):Lu(t,1==n?"expired":"internal-error"))}},N(Mu,yi),n=Mu.prototype,n.fc=function(e,t){if(this.a)this.a.then(this.fc.bind(this,e,t))["catch"](this.fc.bind(this,e,t));else{if(this.a=e,"webkit-org.w3.clearkey"==this.c){var n=Qe(t),i=JSON.parse(n);"oct"!=i.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),n=st(i.keys[0].k),i=st(i.keys[0].kid)}else n=new Uint8Array(t),i=null;var r=_u("addKey");try{this.f[r](this.c,n,i,this.sessionId)}catch(o){this.a.reject(o),this.a=null}}},n.generateRequest=function(e,t){return Au(this,t,null)},n.load=function(e){return"persistent-license"==this.g?Au(this,null,e):Promise.reject(Error("Not a persistent session."))},n.update=function(e){var t=new ne;return this.fc(t,e),t},n.close=function(){if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var e=_u("cancelKeyRequest");try{this.f[e](this.c,this.sessionId)}catch(t){}}return this.closed.resolve(),this.closed},n.remove=function(){return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()},n=Ru.prototype,n.forEach=function(e){this.a&&e(this.a,bu)},n.get=function(e){if(this.has(e))return this.a},n.has=function(e){var t=bu;return!(!this.a||!ut(new Uint8Array(e),new Uint8Array(t)))},n.entries=function(){},n.keys=function(){},n.values=function(){},$l(function(){if(!(!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)Eu="webkit";else if(!HTMLMediaElement.prototype.generateKeyRequest)return;bu=new Uint8Array([0]).buffer,navigator.requestMediaKeySystemAccess=xu,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Tu,e.MediaKeys=wu,e.MediaKeySystemAccess=Su}}),$l(function(){if(e.HTMLMediaElement){var t=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var e=t.apply(this,arguments);return e&&e["catch"](function(){}),e}}}),$l(function(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;!t.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in t&&(t.getVideoPlaybackQuality=Pu)}}),$l(function(){if(!e.VTTCue&&e.TextTrackCue){var t=TextTrackCue.length;if(3==t)e.VTTCue=Cu;else if(6==t)e.VTTCue=Nu;else{try{var n=!!Cu(1,2,"")}catch(i){n=!1}n&&(e.VTTCue=Cu)}}}),Bu.prototype.parseInit=function(){},Bu.prototype.parseMedia=function(e,t){var n=Qe(e),i=[],r=new DOMParser,o=null;try{o=r.parseFromString(n,"text/xml")}catch(m){throw new se(2,2,2005)}if(o){if(!(r=o.getElementsByTagName("tt")[0]))throw new se(2,2,2005);o=Pi(r,"http://www.w3.org/ns/ttml#parameter","frameRate");var s=Pi(r,"http://www.w3.org/ns/ttml#parameter","subFrameRate"),a=Pi(r,"http://www.w3.org/ns/ttml#parameter","frameRateMultiplier"),l=Pi(r,"http://www.w3.org/ns/ttml#parameter","tickRate");if(n=r.getAttribute("xml:space")||"default","default"!=n&&"preserve"!=n)throw new se(2,2,2005);n="default"==n,o=new rc(o,s,a,l),s=$u(r.getElementsByTagName("styling")[0]),a=$u(r.getElementsByTagName("layout")[0]),l=[];for(var u=0;u<a.length;u++){var c,d=a[u],h=s,f=new Jt,p=d.getAttribute("xml:id");if(p)f.id=p,(c=Zu(d,h,"extent"))&&(c=(p=Fu.exec(c))||Ou.exec(c),null!=c&&(f.width=Number(c[1]),f.height=Number(c[2]),f.widthUnits=p?Zt:0,f.heightUnits=p?Zt:0)),(d=Zu(d,h,"origin"))&&(c=(p=Fu.exec(d))||Ou.exec(d),null!=c&&(f.viewportAnchorX=Number(c[1]),f.viewportAnchorY=Number(c[2]),f.viewportAnchorUnits=p?Zt:0));else f=null;f&&l.push(f)}for(r=$u(r.getElementsByTagName("body")[0]),u=0;u<r.length;u++)(f=Gu(r[u],t.periodStart,o,s,a,l,n))&&i.push(f)}return i};var Fu=/^(\d{1,2}|100)% (\d{1,2}|100)%$/,ku=/^(\d+px|\d+em)$/,Ou=/^(\d+)px (\d+)px$/,Uu=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Hu=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,ju=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,Vu=/^(\d*(?:\.\d*)?)f$/,Ku=/^(\d*(?:\.\d*)?)t$/,qu=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,zu={left:"start",center:$t,right:"end",start:"start",end:"end"},Yu={left:"line-left",center:"center",right:"line-right"};function $u(e){var t=[];if(!e)return t;for(var n=e.childNodes,i=0;i<n.length;i++){var r="span"==n[i].nodeName&&"p"==e.nodeName;n[i].nodeType!=Node.ELEMENT_NODE||"br"==n[i].nodeName||r||(r=$u(n[i]),t=t.concat(r))}return t.length||t.push(e),t}function Wu(e,t){for(var n=e.childNodes,i=0;i<n.length;i++)if("br"==n[i].nodeName&&0<i)n[i-1].textContent+="\n";else if(0<n[i].childNodes.length)Wu(n[i],t);else if(t){var r=n[i].textContent.trim();r=r.replace(/\s+/g," "),n[i].textContent=r}}function Gu(e,t,n,i,r,o,s){if(!e.hasAttribute("begin")&&!e.hasAttribute("end")&&/^\s*$/.test(e.textContent))return null;Wu(e,s),s=nc(e.getAttribute("begin"),n);var a=nc(e.getAttribute("end"),n);n=nc(e.getAttribute("dur"),n);var l=e.textContent;if(null==a&&null!=n&&(a=s+n),null==s||null==a)throw new se(2,2,2001);if(t=new Ut(s+t,a+t,l),(r=tc(e,"region",r))&&r.getAttribute("xml:id")){var u=r.getAttribute("xml:id");o=o.filter(function(e){return e.id==u}),t.region=o[0]}return Xu(t,e,r,i),t}function Xu(e,t,n,i){"rtl"==Ju(t,n,i,"direction")&&(e.writingDirection=1);var r=Ju(t,n,i,"writingMode");"tb"==r||"tblr"==r?e.writingDirection=2:"tbrl"==r?e.writingDirection=3:"rltb"==r||"rl"==r?e.writingDirection=1:r&&(e.writingDirection=zt),(r=Ju(t,n,i,"textAlign"))&&(e.positionAlign=Yu[r],e.lineAlign=zu[r],e.textAlign=Vt[r.toUpperCase()]),(r=Ju(t,n,i,"displayAlign"))&&(e.displayAlign=qt[r.toUpperCase()]),(r=Ju(t,n,i,"color"))&&(e.color=r),(r=Ju(t,n,i,"backgroundColor"))&&(e.backgroundColor=r),(r=Ju(t,n,i,"fontFamily"))&&(e.fontFamily=r),(r=Ju(t,n,i,"fontWeight"))&&"bold"==r&&(e.fontWeight=700),(r=Ju(t,n,i,"wrapOption"))&&"noWrap"==r&&(e.wrapLine=!1),(r=Ju(t,n,i,"lineHeight"))&&r.match(ku)&&(e.lineHeight=r),(r=Ju(t,n,i,"fontSize"))&&r.match(ku)&&(e.fontSize=r),(r=Ju(t,n,i,"fontStyle"))&&(e.fontStyle=Qt[r.toUpperCase()]),(n=Zu(n,i,"textDecoration"))&&Qu(e,n),(t=ec(t,i,"textDecoration"))&&Qu(e,t)}function Qu(e,t){for(var n=t.split(" "),i=0;i<n.length;i++)switch(n[i]){case"underline":0>e.textDecoration.indexOf("underline")&&e.textDecoration.push("underline");break;case"noUnderline":0<=e.textDecoration.indexOf("underline")&&ye(e.textDecoration,"underline");break;case"lineThrough":0>e.textDecoration.indexOf("lineThrough")&&e.textDecoration.push("lineThrough");break;case"noLineThrough":0<=e.textDecoration.indexOf("lineThrough")&&ye(e.textDecoration,"lineThrough");break;case"overline":0>e.textDecoration.indexOf("overline")&&e.textDecoration.push("overline");break;case"noOverline":0<=e.textDecoration.indexOf("overline")&&ye(e.textDecoration,"overline")}}function Ju(e,t,n,i){return(e=ec(e,n,i))?e:Zu(t,n,i)}function Zu(e,t,n){for(var i=$u(e),r=0;r<i.length;r++){var o=Pi(i[r],"http://www.w3.org/ns/ttml#styling",n);if(o)return o}return(e=tc(e,"style",t))?Pi(e,"http://www.w3.org/ns/ttml#styling",n):null}function ec(e,t,n){return(e=tc(e,"style",t))?Pi(e,"http://www.w3.org/ns/ttml#styling",n):null}function tc(e,t,n){if(!e||1>n.length)return null;var i=null,r=e;for(e=null;r&&!(e=r.getAttribute(t))&&(r=r.parentNode,r instanceof Element););if(t=e)for(e=0;e<n.length;e++)if(n[e].getAttribute("xml:id")==t){i=n[e];break}return i}function nc(e,t){var n=null;if(Uu.test(e)){n=Uu.exec(e);var i=Number(n[1]),r=Number(n[2]),o=Number(n[3]),s=Number(n[4]);s+=(Number(n[5])||0)/t.b,o+=s/t.frameRate,n=o+60*r+3600*i}else Hu.test(e)?n=ic(Hu,e):ju.test(e)?n=ic(ju,e):Vu.test(e)?(n=Vu.exec(e),n=Number(n[1])/t.frameRate):Ku.test(e)?(n=Ku.exec(e),n=Number(n[1])/t.a):qu.test(e)&&(n=ic(qu,e));return n}function ic(e,t){var n=e.exec(t);return null==n||""==n[0]?null:(Number(n[4])||0)/1e3+(Number(n[3])||0)+60*(Number(n[2])||0)+3600*(Number(n[1])||0)}function rc(e,t,n,i){this.frameRate=Number(e)||30,this.b=Number(t)||1,this.a=Number(i),0==this.a&&(this.a=e?this.frameRate*this.b:1),n&&(e=/^(\d+) (\d+)$/g.exec(n))&&(this.frameRate*=e[1]/e[2])}function oc(){this.a=new Bu}function sc(){}function ac(e,t,n){var i;(i=/^align:(start|middle|center|end|left|right)$/.exec(t))?(t=i[1],e.textAlign="middle"==t?jt:Vt[t.toUpperCase()]):(i=/^vertical:(lr|rl)$/.exec(t))?e.writingDirection="lr"==i[1]?2:3:(i=/^size:([\d.]+)%$/.exec(t))?e.size=Number(i[1]):(i=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(t))?(e.position=Number(i[1]),i[2]&&(t=i[2],e.positionAlign="line-left"==t||"start"==t?"line-left":"line-right"==t||"end"==t?"line-right":"center")):(i=/^region:(.*)$/.exec(t))?(t=lc(n,i[1]))&&(e.region=t):(n=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))?(e.lineInterpretation=1,e.line=Number(n[1]),n[2]&&(e.lineAlign=Wt[n[2].toUpperCase()])):(n=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t))&&(e.lineInterpretation=Yt,e.line=Number(n[1]),n[2]&&(e.lineAlign=Wt[n[2].toUpperCase()]))}function lc(e,t){var n=e.filter(function(e){return e.id==t});return n.length?n[0]:null}function uc(e){if(e=po(e,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g),null==e)return null;var t=Number(e[2]),n=Number(e[3]);return 59<t||59<n?null:Number(e[4])/1e3+n+60*t+3600*(Number(e[1])||0)}function cc(){this.a=null}function dc(e,t,n){var i,r,o;return(new sr).C("payl",ur(function(e){i=Qe(e)})).C("iden",ur(function(e){r=Qe(e)})).C("sttg",ur(function(e){o=Qe(e)})).parse(e),i?hc(i,r,o,t,n):null}function hc(e,t,n,i,r){if(e=new Ut(i,r,e),t&&(e.id=t),n)for(t=new ho(n),n=mo(t);n;)ac(e,n,[]),fo(t),n=mo(t);return e}an["application/ttml+xml"]=Bu,oc.prototype.parseInit=function(e){var t=!1;if((new sr).C("moov",ar).C("trak",ar).C("mdia",ar).C("minf",ar).C("stbl",ar).Y("stsd",lr).C("stpp",function(e){t=!0,e.parser.stop()}).parse(e),!t)throw new se(2,2,2007)},oc.prototype.parseMedia=function(e,t){var n=!1,i=[];if((new sr).C("mdat",ur(function(e){n=!0,i=i.concat(this.a.parseMedia(e,t))}.bind(this))).parse(e),!n)throw new se(2,2,2007);return i},an['application/mp4; codecs="stpp"']=oc,an['application/mp4; codecs="stpp.TTML.im1t"']=oc,sc.prototype.parseInit=function(){},sc.prototype.parseMedia=function(e,t){var n=Qe(e);if(n=n.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n"),n=n.split(/\n{2,}/m),!/^WEBVTT($|[ \t\n])/m.test(n[0]))throw new se(2,2,2e3);var i=t.segmentStart;if(null==i&&(i=0,0<=n[0].indexOf("X-TIMESTAMP-MAP"))){var r=n[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),o=n[0].match(/MPEGTS:(\d+)/m);r&&o&&(i=uc(new ho(r[1])),i=t.periodStart+(Number(o[1])/9e4-i))}o=[];var s=n[0].split("\n");for(r=1;r<s.length;r++)if(/^Region:/.test(s[r])){var a=new ho(s[r]),l=new Jt;mo(a),fo(a);for(var u=mo(a);u;){var c=l,d=u;(u=/^id=(.*)$/.exec(d))?c.id=u[1]:(u=/^width=(\d{1,2}|100)%$/.exec(d))?c.width=Number(u[1]):(u=/^lines=(\d+)$/.exec(d))?(c.height=Number(u[1]),c.heightUnits=2):(u=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(d))?(c.regionAnchorX=Number(u[1]),c.regionAnchorY=Number(u[2])):(u=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(d))?(c.viewportAnchorX=Number(u[1]),c.viewportAnchorY=Number(u[2])):/^scroll=up$/.exec(d)&&(c.scroll="up"),fo(a),u=mo(a)}o.push(l)}for(r=[],a=1;a<n.length;a++){if(s=n[a].split("\n"),u=s,d=i,s=o,1==u.length&&!u[0]||/^NOTE($|[ \t])/.test(u[0])||"STYLE"==u[0])s=null;else{l=null,0>u[0].indexOf("--\x3e")&&(l=u[0],u.splice(0,1)),c=new ho(u[0]);var h=uc(c),f=po(c,/[ \t]+--\x3e[ \t]+/g),p=uc(c);if(null==h||null==f||null==p)throw new se(2,2,2001);for(u=new Ut(h+d,p+d,u.slice(1).join("\n").trim()),fo(c),d=mo(c);d;)ac(u,d,s),fo(c),d=mo(c);null!=l&&(u.id=l),s=u}s&&r.push(s)}return r},an["text/vtt"]=sc,an['text/vtt; codecs="vtt"']=sc,cc.prototype.parseInit=function(e){var t=!1;if((new sr).C("moov",ar).C("trak",ar).C("mdia",ar).Y("mdhd",function(e){0==e.version?(e.reader.F(4),e.reader.F(4),this.a=e.reader.B(),e.reader.F(4)):(e.reader.F(8),e.reader.F(8),this.a=e.reader.B(),e.reader.F(8)),e.reader.F(4)}.bind(this)).C("minf",ar).C("stbl",ar).Y("stsd",lr).C("wvtt",function(){t=!0}).parse(e),!this.a)throw new se(2,2,2008);if(!t)throw new se(2,2,2008)},cc.prototype.parseMedia=function(e,t){var n=this;if(!this.a)throw new se(2,2,2008);var i,r=0,o=[],s=[],a=!1,l=!1,u=!1,c=null;if((new sr).C("moof",ar).C("traf",ar).Y("tfdt",function(e){a=!0,r=0==e.version?e.reader.B():e.reader.Ra()}).Y("tfhd",function(e){var t=e.flags;e=e.reader,e.F(4),1&t&&e.F(8),2&t&&e.F(4),c=8&t?e.B():null}).Y("trun",function(e){l=!0;var t=e.version,n=e.flags;e=e.reader;var i=e.B();1&n&&e.F(4),4&n&&e.F(4);for(var r=[],s=0;s<i;s++){var a={duration:null,sampleSize:null,gc:null};256&n&&(a.duration=e.B()),512&n&&(a.sampleSize=e.B()),1024&n&&e.F(4),2048&n&&(a.gc=0==t?e.B():e.Lc()),r.push(a)}o=r}).C("mdat",ur(function(e){u=!0,i=e})).parse(e),!u&&!a&&!l)throw new se(2,2,2008);var d=r,h=new DataView(i.buffer,i.byteOffset,i.byteLength),f=new nr(h,0);return o.forEach(function(e){var i=e.duration||c,o=e.gc?r+e.gc:d;d=o+(i||0);var a=0;do{var l=f.B();a+=l;var u=f.B(),h=null;"vttc"==dr(u)?8<l&&(h=f.Da(l-8)):f.F(l-8),i&&h&&s.push(dc(h,t.periodStart+o/n.a,t.periodStart+d/n.a))}while(e.sampleSize&&a<e.sampleSize)}),s.filter(Ve)},an['application/mp4; codecs="wvtt"']=cc}.call(i,n,n),i.shaka)t[r]=i.shaka[r]})()}).call(this,n("c8ba"))},4588:function(e,t){var n=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)}},4630:function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},"4a59":function(e,t,n){var i=n("9b43"),r=n("1fa8"),o=n("33a4"),s=n("cb7c"),a=n("9def"),l=n("27ee"),u={},c={};t=e.exports=function(e,t,n,d,h){var f,p,m,g,y=h?function(){return e}:l(e),v=i(n,d,t?2:1),b=0;if("function"!=typeof y)throw TypeError(e+" is not iterable!");if(o(y)){for(f=a(e.length);f>b;b++)if(g=t?v(s(p=e[b])[0],p[1]):v(e[b]),g===u||g===c)return g}else for(m=y.call(e);!(p=m.next()).done;)if(g=r(m,v,p.value,t),g===u||g===c)return g};t.BREAK=u,t.RETURN=c},"4bf8":function(e,t,n){var i=n("be13");e.exports=function(e){return Object(i(e))}},5058:function(e,t,n){(function(n){var r,o;(function(n,i){r=[],o=function(){return n["MediaPlayer"]=i()}.apply(t,r),void 0===o||(e.exports=o)})(this,function(){var t,r,o,l={},u={},c={},d={};d=function(){var e,n="1.2.0",i="1.15.1",r="b21165b9",s="2019-2-13_11:37:25",a=new d.di.Context,l=new o.System,u=!1,c=null,h=null,f=null,p=[],m=[],g=null,y=null,v="und",b="und",E=!1,T={video:-1,audio:-1},S=null,w=!1,I=!1,D=!0,M=null,A=!1,L="Safari"===_().name,R={},P=function(){if(!u)throw new Error("MediaPlayer not initialized !!!")},C=function(){if(!e.getElement())throw new Error("MediaPlayer.play(): Video element not attached to MediaPlayer")},N=function(){if(!M)throw new Error("MediaPlayer.play(): Source not attached to MediaPlayer")},B=function(){var n,i=[],r=[];if(P(),C(),N(),L&&"HLS"===M.protocol||d.hasMediaSourceExtension()){for(var o in R)i.push(R[o].deferInit.promise);t.all(i).then(function(){for(var i in R)n=R[i],n.deferLoad=t.defer(),r.push(n.deferLoad.promise),n.load(M,function(){this.deferLoad.resolve()}.bind(n));t.all(r).then(function(){I=!0,this.metricsModel.addSession(null,M.url,e.getElement().loop,null,"MediaPlayer.js_"+this.getVersion()),this.debug.log("[MediaPlayer] Version: "+this.getVersionFull()+" - "+this.getBuildDate()),this.debug.log("[MediaPlayer] user-agent: "+navigator.userAgent),this.debug.log("[MediaPlayer] Load stream:\n",JSON.stringify(M,null,"  ")),S||(S=l.getObject("streamController"),S.setVideoModel(e),S.setAutoPlay(D)),S.setDefaultAudioLang(v),S.setDefaultSubtitleLang(b),S.enableSubtitles(E),S.load(M),l.mapValue("scheduleWhilePaused",A),l.mapOutlet("scheduleWhilePaused","stream")}.bind(this))}.bind(this))}else this.errHandler.sendError(d.dependencies.ErrorHandler.prototype.CAPABILITY_ERR_MEDIASOURCE,"MediaSource extension not supported by the browser")},F=function(){return u&&e.getElement()&&M&&!w},k=function(){F()&&B.call(this)},O=function(t,n){var i=document.createEvent("CustomEvent");i.initCustomEvent(t,!1,!1,{type:n.streamType,bitrate:n.switchedQuality,representationId:n.representationId,time:e.getCurrentTime(),width:n.width,height:n.height}),e.getElement().dispatchEvent(i)},U=function(t){var n;switch(t.data.metric){case"ManifestReady":P(),this.debug.log("[MediaPlayer] ManifestReady"),h=this.metricsExt.getBitratesForType("video"),this.debug.log("[MediaPlayer] video bitrates: "+JSON.stringify(h)),n=document.createEvent("CustomEvent"),n.initCustomEvent("manifest_loaded",!1,!1,{}),e.getElement().dispatchEvent(n);break;case"RepresentationSwitch":P(),"video"==t.data.stream?(h=this.metricsExt.getBitratesForType(t.data.stream),h&&(O("download_bitrate",{streamType:t.data.stream,switchedQuality:h[t.data.value.lto],representationId:t.data.value.to,width:this.metricsExt.getVideoWidthForRepresentation(t.data.value.to),height:this.metricsExt.getVideoHeightForRepresentation(t.data.value.to)}),this.debug.log("[MediaPlayer]["+t.data.stream+"] send download_bitrate - b="+h[t.data.value.lto]))):"audio"==t.data.stream&&(f=this.metricsExt.getBitratesForType(t.data.stream),f&&(O("download_bitrate",{streamType:t.data.stream,switchedQuality:f[t.data.value.lto],representationId:t.data.value.to,width:this.metricsExt.getVideoWidthForRepresentation(t.data.value.to),height:this.metricsExt.getVideoHeightForRepresentation(t.data.value.to)}),this.debug.log("[MediaPlayer]["+t.data.stream+"] send download_bitrate - b="+h[t.data.value.lto])));break;case"BufferedSwitch":P(),"video"==t.data.stream?p.push({streamType:t.data.stream,mediaStartTime:t.data.value.mt,switchedQuality:h[t.data.value.lto],representationId:t.data.value.to,width:this.metricsExt.getVideoWidthForRepresentation(t.data.value.to),height:this.metricsExt.getVideoHeightForRepresentation(t.data.value.to)}):"audio"==t.data.stream&&m.push({streamType:t.data.stream,mediaStartTime:t.data.value.mt,switchedQuality:f[t.data.value.lto],representationId:t.data.value.to,width:this.metricsExt.getVideoWidthForRepresentation(t.data.value.to),height:this.metricsExt.getVideoHeightForRepresentation(t.data.value.to)});break;case"BufferLevel":n=document.createEvent("CustomEvent"),n.initCustomEvent("bufferLevel_updated",!1,!1,{type:t.data.stream,level:t.data.value.level}),e.getElement().dispatchEvent(n);break;case"State":n=document.createEvent("CustomEvent"),n.initCustomEvent("state_changed",!1,!1,{type:t.data.stream,state:t.data.value.current}),e.getElement().dispatchEvent(n);break}},H=function(e){g=e.data,this.reset(2)},j=function(e){y=e.data},V=function(e,t){var n=0;for(n=t.length-1;n>=0;n-=1)e.splice(n,1)},K=function(t){var n=e.getCurrentTime(),i=null,r=[],o=0;for(o=0;o<t.length;o+=1)i=t[o],n>=i.mediaStartTime&&(O("play_bitrate",i),this.debug.log("[MediaPlayer]["+i.streamType+"] send play_bitrate - b="+i.switchedQuality+", t="+i.mediaStartTime+"("+e.getPlaybackRate()+")"),r.push(o));V(t,r)},q=function(){0!==e.getPlaybackRate()&&(K.call(this,p),K.call(this,m))},z=function(){this.addEventListener("metricAdded",U.bind(this)),this.addEventListener("error",H.bind(this)),this.addEventListener("warning",j.bind(this)),this.addEventListener("timeupdate",q.bind(this))},Y=function(e){if(!0===e.altKey&&!0===e.ctrlKey&&!0===e.shiftKey&&86===e.keyCode)for(var t in console.log("[MediaPlayer] Version: "+this.getVersion()+" - "+this.getBuildDate()),R)console.log("["+R[t].getName()+"] Version: "+R[t].getVersion()+" - "+R[t].getBuildDate())},$=function(e){if(I&&S){if(!w){w=!0;var t={};t[d.dependencies.StreamController.eventList.ENAME_TEARDOWN_COMPLETE]=function(){for(var e in R)R[e].reset();S=null,I=!1,w=!1,this.debug.log("[MediaPlayer] Player is stopped"),F.call(this)&&k.call(this)}.bind(this),S.subscribe(d.dependencies.StreamController.eventList.ENAME_TEARDOWN_COMPLETE,t,void 0,!0),S.reset(e)}}else F.call(this)&&k.call(this)},W=function(e){if(!e)return null;var t={};return e.id&&(t.id=e.id),e.lang&&(t.lang=e.lang),e.subType&&(t.subType=e.subType),t},G=function(e){if(!S)return null;switch(e){case d.TRACKS_TYPE.AUDIO:return S.getAudioTracks();case d.TRACKS_TYPE.TEXT:return S.getSubtitleTracks()}return null},X=function(e){if(!S)return null;switch(e){case d.TRACKS_TYPE.AUDIO:return S.getSelectedAudioTrack();case d.TRACKS_TYPE.TEXT:return S.getSelectedSubtitleTrack()}return null},Q=function(e,t){if(!S)return null;switch(e){case d.TRACKS_TYPE.AUDIO:S.setAudioTrack(t);break;case d.TRACKS_TYPE.TEXT:S.setSubtitleTrack(t);break}return null},J=function(e,t){return!e&&!t||e===t},Z=function(e,t){return J(e.id,t.id)&&J(e.lang,t.lang)&&J(e.subType,t.subType)},ee=function(){if(arguments&&arguments.length>0){var e={};return"string"===typeof arguments[0]&&(e.url=arguments[0]),arguments[1]&&(e.protData=arguments[1]),e}},te=function(){var e=this.metricsModel.getReadOnlyMetricsFor("video"),t=e?this.metricsExt.getCurrentDVRInfo(e):null;return t};return l.mapValue("system",l),l.mapOutlet("system"),l.injectInto(a),{notifier:void 0,debug:void 0,eventBus:void 0,metricsExt:void 0,abrController:void 0,metricsModel:void 0,errHandler:void 0,config:void 0,getVersion:function(){return i},getVersionFull:function(){return-1===r.indexOf("@@")?i+"_"+r:i},getVersionDashJS:function(){return n},getBuildDate:function(){return-1===s.indexOf("@@")?s:"Not a builded version"},init:function(t){if(!t)throw new Error("MediaPlayer.init(): Invalid Argument");u||(l.injectInto(this),u=!0,this.debug.log("[MediaPlayer] Version: "+this.getVersionFull()+" - "+this.getBuildDate()),this.debug.log("[MediaPlayer] user-agent: "+navigator.userAgent)),e=l.getObject("videoModel"),e.setElement(t),z.call(this),c=l.getObject("debugController"),c.init(i),window.addEventListener("keydown",Y.bind(this))},addEventListener:function(t,n,i){P(),"hasplayer"===d.PUBLIC_EVENTS[t]?this.eventBus.addEventListener(t,n,i):e.listen(t,n,i)},removeEventListener:function(t,n){P(),"hasplayer"===d.PUBLIC_EVENTS[t]?this.eventBus.removeEventListener(t,n):e.unlisten(t,n)},getVideoModel:function(){return e},getDebug:function(){return this.debug},getMetricsExt:function(){return this.metricsExt},setConfig:function(e){this.config&&e&&(this.debug.log("[MediaPlayer] set config: "+JSON.stringify(e,null,"\t")),this.config.setParams(e))},setParams:function(e){this.setConfig(e)},setDebug:function(e){if(P(),"boolean"!==typeof e)throw new Error("MediaPlayer.setDebug(): Invalid Arguments");!0===e?this.debug.setLevel(4):this.debug.setLevel(0)},getAutoPlay:function(){return D},setAutoPlay:function(e){D=e},setInitialQualityFor:function(e,t){T[e]=t},getQualityFor:function(e){return P(),this.abrController.getQualityFor(e)},setQualityFor:function(e,t){if(P(),"number"!==typeof t)throw new Error("MediaPlayer.setQualityFor(): Invalid Arguments");this.abrController.setQualityFor(e,t)},getAutoSwitchQuality:function(){return P(),this.abrController.getAutoSwitchBitrate()},setAutoSwitchQuality:function(e){if(P(),"boolean"!==typeof e)throw new Error("MediaPlayer.setAutoSwitchQuality(): Invalid Arguments");this.abrController.setAutoSwitchBitrate(e)},getScheduleWhilePaused:function(){return A},setScheduleWhilePaused:function(e){if("boolean"!==typeof e)throw new Error("MediaPlayer.setScheduleWhilePaused(): Invalid Arguments");A=e},setDefaultAudioLang:function(e){if("string"!==typeof e)throw new Error("MediaPlayer.setDefaultAudioLang(): Invalid Arguments");v=e},getDefaultAudioLang:function(){return v},setDefaultSubtitleLang:function(e){if("string"!==typeof e)throw new Error("MediaPlayer.setDefaultSubtitleLang(): Invalid Arguments");b=e},getDefaultSubtitleLang:function(){return b},load:function(e){var t={video:{"ABR.keepBandwidthCondition":!0},audio:{"ABR.keepBandwidthCondition":!0}};if(arguments&&arguments.length>0&&"object"!==typeof arguments[0]&&(console.warn('You are using "deprecated" call of the method load, please refer to the documentation to change prameters call'),e=ee.apply(null,arguments)),!e||!e.url)throw new Error("MediaPlayer.load(): stream has no url.");p=[],m=[],P(),this.reset(0),T.video>=0&&(this.abrController.setQualityFor("video",T.video),t.video["ABR.keepBandwidthCondition"]=!1,T.video=-1),T.audio>=0&&(this.abrController.setQualityFor("audio",T.audio),t.audio["ABR.keepBandwidthCondition"]=!1,T.audio=-1),this.setConfig(t),g=null,y=null,M=e,$.call(this,0)},play:function(){P(),e.play()},seek:function(t){var n=null,i=0;if(P(),"number"!==typeof t||isNaN(t))throw new Error("MediaPlayer.seek(): Invalid Arguments");if(this.isLive()){if(n=this.getDVRWindowRange(),i=S.getLiveDelay(),null===n)throw new Error("MediaPlayer.seek(): impossible for live stream");if(t<n.start||t>n.end)throw new Error("MediaPlayer.seek(): seek value outside available time range");t>n.end-i&&(t=n.end-i),S.seek(t,!0)}else{if(t<0||t>e.getDuration())throw new Error("MediaPlayer.seek(): seek value outside available time range");e.setCurrentTime(t)}},pause:function(){P(),e.pause()},stop:function(){for(var t in P(),e.pause(),this.isLive()||e.setCurrentTime(0),R)R[t].stop()},reset:function(e){P(),this.setQualityFor("video",0),this.setQualityFor("audio",0),M=null,$.call(this,e)},refreshManifest:function(e){P(),S.refreshManifest(e)},getDuration:function(){return P(),e.getDuration()},isLive:function(){return P(),e.getDuration()===Number.POSITIVE_INFINITY},getPosition:function(){return P(),e.getCurrentTime()},getDVRWindowRange:function(){if(P(),!this.isLive())return null;var e=te.call(this);return e?e.range:null},getDVRWindowSize:function(){return P(),this.isLive(),null},getDVRSeekOffset:function(e){if(P(),!this.isLive())return null;var t=te.call(this),n=t?t.range.start+e:null;return n&&n>t.range.end&&(n=t.range.end),n},getVideoBitrates:function(){return P(),h?h.slice():[]},getMetricsFor:function(e){var t=this.metricsModel.getReadOnlyMetricsFor(e);return t},getTrickModeSpeed:function(){return S?S.getTrickModeSpeed():0},setTrickModeSpeed:function(e){P(),S&&S.setTrickModeSpeed(e)},getError:function(){return g},getWarning:function(){return y},getTracks:function(e){if(P(),!e||e!==d.TRACKS_TYPE.AUDIO&&e!==d.TRACKS_TYPE.TEXT)throw new Error('MediaPlayer Invalid Argument - "type" should be defined and shoud be kind of MediaPlayer.TRACKS_TYPE');var t=G(e);if(!t)return[];for(var n=[],i=0;i<t.length;i+=1)n.push(W(t[i]));return n},selectTrack:function(e,t){if(P(),!e||e!==d.TRACKS_TYPE.AUDIO&&e!==d.TRACKS_TYPE.TEXT)throw new Error('MediaPlayer Invalid Argument - "type" should be defined and shoud be kind of MediaPlayer.TRACKS_TYPE');if(!t||!(t.id||t.lang||t.subType))throw new Error("MediaPlayer.selectTrack(): track parameter is not in valid");var n=G(e);if(n){var i=X(e);if(i&&Z(i,t))this.debug.log("[MediaPlayer] "+e+" track ["+t.id+" - "+t.lang+"] is already selected");else for(var r=0;r<n.length;r+=1)if(Z(n[r],t))return void Q(e,n[r])}else this.debug.error("[MediaPlayer] No available track for type "+e)},getSelectedTrack:function(e){if(P(),!e||e!==d.TRACKS_TYPE.AUDIO&&e!==d.TRACKS_TYPE.TEXT)throw new Error('MediaPlayer Invalid Argument - "type" should be defined and shoud be kind of MediaPlayer.TRACKS_TYPE');return W(X(e))},enableSubtitles:function(e){if(P(),"boolean"!==typeof e)throw new Error("MediaPlayer.enableSubtitles(): Invalid Arguments");E=e,S&&S.enableSubtitles(E)},isSubtitlesEnabled:function(){return P(),E},enableSubtitleExternDisplay:function(e){if("boolean"!==typeof e)throw new Error("MediaPlayer.enableSubtitleExternDisplay(): Invalid Arguments");this.config.setParams({"TextTrackExtensions.displayModeExtern":e})},getTTMLRenderingDiv:function(){return e?e.getTTMLRenderingDiv():null},attachTTMLRenderingDiv:function(t){P(),e.setTTMLRenderingDiv(t)},getMute:function(){return P(),e.getMute()},setMute:function(t){if(P(),"boolean"!==typeof t)throw new Error("MediaPlayer.setMute(): Invalid Arguments");e.setMute(t)},getVolume:function(){return P(),e.getVolume()},setVolume:function(t){if(P(),"number"!==typeof t||t<0||t>1)throw new Error("MediaPlayer.setVolume(): Invalid Arguments");e.setVolume(t)},getTerminalId:function(){var e=_(),t=x();return t.name+"-"+t.bits+"-"+e.name},addPlugin:function(e){if(P(),void 0===e)throw new Error("MediaPlayer.addPlugin(): plugin undefined");if("function"!==typeof e.getName||"function"!==typeof e.getVersion||"function"!==typeof e.init||"function"!==typeof e.load||"function"!==typeof e.stop||"function"!==typeof e.reset)throw new Error("MediaPlayer.addPlugin(): plugin API not compliant");R[e.getName()]&&R[e.getName()].destroy(),this.debug.log("[MediaPlayer] Add plugin '"+e.getName()+"' (v"+e.getVersion()+")"),R[e.getName()]=e,e.deferInit=t.defer(),u&&e.init(this,function(){this.deferInit.resolve()}.bind(e))},removePlugin:function(e){var t;if(void 0===e)throw new Error("MediaPlayer.removePlugin(): plugin undefined");if("string"===typeof e)t=e;else{if("function"!==typeof e.getName)throw new Error("MediaPlayer.removePlugin(): plugin API not compliant");t=e.getName()}R[t]&&(this.debug.log("[MediaPlayer] Remove plugin '"+t),R[t].destroy(),R[t]=null,delete R[t])}}},d.prototype={constructor:d},d.dependencies={},d.dependencies.protection={},d.dependencies.protection.servers={},d.utils={},d.models={},d.modules={},d.vo={},d.vo.metrics={},d.vo.protection={},d.rules={},d.rules.o={},d.di={},d.PUBLIC_EVENTS={error:"hasplayer",warning:"hasplayer",manifestUrlUpdate:"hasplayer",metricAdded:"hasplayer",metricChanged:"hasplayer",cueEnter:"hasplayer",cueExit:"hasplayer",play_bitrate:"video",download_bitrate:"video",bufferLevel_updated:"video",state_changed:"video"},d.TRACKS_TYPE={AUDIO:"audio",TEXT:"text"},d.hasMediaSourceExtension=function(){return(new d.utils.Capabilities).supportsMediaSource()},d.hasMediaKeysExtension=function(){return(new d.utils.Capabilities).supportsMediaKeys()},d.dependencies.AbrController=function(){"use strict";var e=!0,t={},n={},i={},r={},o="",s=function(e){return t.hasOwnProperty(e)||(t[e]=!0),t[e]},a=function(e,n){t[e]=n},l=function(e){var t;return n.hasOwnProperty(e)||(n[e]=0),t=n[e],t},u=function(e,t){n[e]=t},c=function(e){var t;return r.hasOwnProperty(e)||(r[e]=0),t=r[e],t},h=function(e,t){r[e]=t},f=function(t,n){var r,a,u,h,f,p,m=this,g=s(t),y=l(t),v=c(t),b=d.rules.SwitchRequest.prototype.NO_CHANGE,E=d.rules.SwitchRequest.prototype.NO_CHANGE,_=d.rules.SwitchRequest.prototype.NO_CHANGE,x=[],T={};if(!e||!g)return m.debug.log("[AbrController]["+t+"] ABR disabled"),{quality:y,confidence:v};for(m.debug.log("[AbrController]["+t+"] Check rules...."),u=m.getMetricsFor(n),f=m.abrRulesCollection.getRules(d.rules.BaseRulesCollection.prototype.QUALITY_SWITCH_RULES),r=0,a=f.length;r<a;r+=1)x.push(f[r].checkIndex(y,u,n,o));for(T[d.rules.SwitchRequest.prototype.STRONG]=d.rules.SwitchRequest.prototype.NO_CHANGE,T[d.rules.SwitchRequest.prototype.WEAK]=d.rules.SwitchRequest.prototype.NO_CHANGE,T[d.rules.SwitchRequest.prototype.DEFAULT]=d.rules.SwitchRequest.prototype.NO_CHANGE,r=0,a=x.length;r<a;r+=1)h=x[r],h.quality!==d.rules.SwitchRequest.prototype.NO_CHANGE&&(m.debug.log("[AbrController]["+t+"] Request for quality "+h.quality+", priority = "+h.priority+" ("+f[r].name+")"),T[h.priority]=Math.min(T[h.priority],h.quality)),!0===h.max&&(_=Math.min(_,h.quality));return T[d.rules.SwitchRequest.prototype.WEAK]!==d.rules.SwitchRequest.prototype.NO_CHANGE&&(E=d.rules.SwitchRequest.prototype.WEAK,b=T[d.rules.SwitchRequest.prototype.WEAK]),T[d.rules.SwitchRequest.prototype.DEFAULT]!==d.rules.SwitchRequest.prototype.NO_CHANGE&&(E=d.rules.SwitchRequest.prototype.DEFAULT,b=T[d.rules.SwitchRequest.prototype.DEFAULT]),T[d.rules.SwitchRequest.prototype.STRONG]!==d.rules.SwitchRequest.prototype.NO_CHANGE&&(E=d.rules.SwitchRequest.prototype.STRONG,b=T[d.rules.SwitchRequest.prototype.STRONG]),b!==d.rules.SwitchRequest.prototype.NO_CHANGE&&void 0!==b&&(y=b),E!==d.rules.SwitchRequest.prototype.NO_CHANGE&&void 0!==E&&(v=E),_!==d.rules.SwitchRequest.prototype.NO_CHANGE&&(i[t]=_),p=m.manifestExt.getRepresentationCount(n),y<0&&(y=0),y>=p&&(y=p-1),v!==d.rules.SwitchRequest.prototype.STRONG&&v!==d.rules.SwitchRequest.prototype.WEAK&&(v=d.rules.SwitchRequest.prototype.DEFAULT),m.debug.info("[AbrController]["+t+"] Request quality: "+y),{quality:y,confidence:v}},p=function(e,t){var n,i=this.metricsExt.getBitratesForType(e,t),r=this.config.getParamFor(e,"ABR.minQuality","number",-1),o=this.config.getParamFor(e,"ABR.maxQuality","number",-1),s=this.config.getParamFor(e,"ABR.minBandwidth","number",-1),a=this.config.getParamFor(e,"ABR.maxBandwidth","number",-1),l=i.length;if(-1!==s)for(n=0;n<i.length;n++)if(i[n]>=s){r=-1===r?n:Math.max(n,r);break}if(-1!==a)for(n=i.length-1;n>=0;n--)if(i[n]<=a){o=-1===o?n:Math.min(n,o);break}return r=r>=l?l-1:r,r=r<0?0:r,o=o>=l||o<0?l-1:o,{min:r,max:o}};return{debug:void 0,abrRulesCollection:void 0,manifestExt:void 0,metricsModel:void 0,metricsExt:void 0,config:void 0,getAutoSwitchBitrate:function(){return e},setAutoSwitchBitrate:function(t){this.debug.log("[AbrController] Set auto switch: "+t),e=t},getMetricsFor:function(e){var t,n;return t=this.manifestExt.getIsVideo(e),t?this.metricsModel.getMetricsFor("video"):(n=this.manifestExt.getIsAudio(e),n?this.metricsModel.getMetricsFor("audio"):this.metricsModel.getMetricsFor("stream"))},getPlaybackQuality:function(e,t){var n,r,o,s=this,a=this.getQualityFor(e),l=-1,c=-1,d=this.config.getParamFor(e,"ABR.switchUpIncrementally","boolean",!1);if(o=f.call(this,e,t),n=o.quality,r=o.confidence,s.getAutoSwitchBitrate()){d&&n>a&&(s.debug.log("[AbrController]["+e+"] Incremental switch => quality: "+n),n=a+1);var m=p.call(s,e,t);l=m.min,c=m.max,n<l&&(n=l,s.debug.log("[AbrController]["+e+"] New quality < min => "+n)),n>c&&(n=c,s.debug.log("[AbrController]["+e+"] New quality > max => "+n)),n>i[e]&&(n=i[e],s.debug.log("[AbrController]["+e+"] Max allowed quality = "+n))}return u.call(s,e,n),h.call(s,e,r),s.debug.info("[AbrController]["+e+"] Set quality: "+n),{quality:n,confidence:r}},getAutoSwitchFor:function(e){return s(e)},setAutoSwitchFor:function(e,t){var n=s(e);t!==n&&(this.debug.log("[AbrController]["+e+"] Set auto switch: "+t),a(e,t))},getQualityFor:function(e){return l(e)},setQualityFor:function(e,t){var n=l(e);t!==n&&(this.debug.log("[AbrController]["+e+"] Set playback quality: "+t),u(e,t))},isMinQuality:function(e,t,n){var i=p.call(this,e,t);return n<=i.min},setPlayerState:function(e){o=e}}},d.dependencies.AbrController.prototype={constructor:d.dependencies.AbrController},d.dependencies.AbrController.BANDWIDTH_SAFETY=.9,d.dependencies.BufferController=function(){"use strict";var e,n,i,r,o,s,a,l,u,h,f="READY",p=f,m=!1,g=!1,y=!1,v=[],E=!1,x=-1,T=!0,S=!1,w=!1,I=-1,D=-1,M=!1,A=!1,L=!1,R=null,P=null,C=null,N=0,B=!1,F=null,k=null,O=!1,U=0,H=!0,j=!1,V=null,K=null,q=!0,z=!1,Y=-1,$=0,W=1,G=Y,X=-1,Q=null,J=3,Z=0,ee=null,te=-1,ne=null,ie=NaN,re="Safari"===_().name,oe="WebKit"===_().name,se="Firefox"===_().name,ae=function(){we.call(this)&&null!==C&&this.fragmentController.onBufferControllerStateChange()},le=function(e,t){var n=0,i=null;!1===q&&(i=K.start,n=e.getTime()-i.getTime(),K.duration=n,K.stopreason=t,q=!0)},ue=function(e){"text"!==r&&(this.debug.info("[BufferController]["+r+"] stalled = "+e),M=e,this.videoModel.stallStream(r,M),this.abrController.setPlayerState(M?"buffering":"playing"))},ce=function(){m&&g&&(this.debug.info("[BufferController]["+r+"] startPlayback"),Ue.call(this))},de=function(){var e;if(!0!==g&&null===Q){if(!1===E&&(e=new Date,le(e,d.vo.metrics.PlayList.Trace.USER_REQUEST_STOP_REASON),V=this.metricsModel.addPlayList(r,e,0,d.vo.metrics.PlayList.INITIAL_PLAY_START_REASON)),L){if("application/ttml+xml"===F.mimeType)return;L=!1}g=!0,this.debug.info("[BufferController]["+r+"] START"),y=!0,G===Y&&this.metricsModel.addState(r,"buffering",this.videoModel.getCurrentTime()),G=$,X=-1,ee=null,this.fragmentController.clearExecutedRequests(C),ce.call(this)}},he=function(e){var n=this;!0===E&&x===e||(this.debug.info("[BufferController]["+r+"] SEEK: "+e),!0===g&&pe.call(this),E=!0,x=e,t.when(!Q||Q.promise).then(function(){ue.call(n,!0),de.call(n)}))},fe=function(){this.debug.info("[BufferController]["+r+"] SEEKED"),E=!1,x=-1},pe=function(){g&&(this.debug.info("[BufferController]["+r+"] STOP"),clearTimeout(u),clearTimeout(h),g=!1,y=!1,E=!1,x=-1,le(new Date,d.vo.metrics.PlayList.Trace.USER_REQUEST_STOP_REASON),this.fragmentController.abortRequestsForModel(C))},me=function(t){return e[t]},ge=function(e){this.debug.info("[BufferController]["+r+"] Load request ",null!==e.url?e.url:e.quality)},ye=function(e,t){void 0!==e.sequenceNumber&&(te=e.sequenceNumber),this.fragmentController.isInitializationRequest(e)?ve.call(this,e,t):be.call(this,e,t)},ve=function(e,t){if(we.call(this)){var n=t.data,i=e.quality,o=this;this.debug.log("[BufferController]["+r+"] Initialization loaded ",i);try{this.fragmentController.process(n).then(function(t){t?(v[i]=t,o.debug.info("[BufferController]["+r+"] Buffer initialization segment ",null!==e.url?e.url:e.quality),Ee.call(o,t,e.quality).then(function(){we.call(o)&&Pe.call(o)})):Pe.call(o)},function(e){Ie.call(o),e.name?o.errHandler.sendError(e.name,e.message,e.data):o.errHandler.sendError(d.dependencies.ErrorHandler.prototype.INTERNAL_ERROR,"Internal error while processing media segment",e.message)})}catch(s){Ie.call(o),s.name?o.errHandler.sendError(s.name,s.message,s.data):o.errHandler.sendError(d.dependencies.ErrorHandler.prototype.INTERNAL_ERROR,"Internal error while processing media segment",s.message)}}},be=function(e,i){if(we.call(this)){var o,s=this.manifestExt.getEventStreamForAdaptationSet(this.getData()),a=this.manifestExt.getEventStreamForRepresentation(this.getData(),n),l=this;ie=e.duration,Z=0,this.debug.log("[BufferController]["+r+"] Media loaded ",e.url),!0===this.chunkAborted&&(this.chunkAborted=!1),1===this.chunkMissingCount&&(this.chunkMissingCount=0);try{this.fragmentController.process(i.data,e,n).then(function(i){i?((s.length>0||a.length>0)&&(o=Te.call(l,i,e,s,a),l.eventController.addInbandEvents(o)),l.debug.info("[BufferController]["+r+"] Buffer segment from url ",e.url),i=Se.call(l,i),t.when(!w||Me.call(l)).then(function(){w=!1,se&&(k.timestampOffset=-xe(i,e)),Ee.call(l,i,e.quality,e).then(function(){I!==e.quality&&(l.debug.log("[BufferController]["+r+"] Buffered quality changed: "+e.quality),l.metricsModel.addBufferedSwitch(r,e.startTime,n.id,e.quality),I=e.quality),Ie.call(l),Ue.call(l)})})):(l.debug.error("[BufferController]["+r+"] Error with segment data, no bytes to push"),Ie.call(l),Ue.call(l))},function(e){Ie.call(l),e.name?l.errHandler.sendError(e.name,e.message,e.data):l.errHandler.sendError(d.dependencies.ErrorHandler.prototype.INTERNAL_ERROR,"Internal error while processing media segment",e.message)})}catch(u){Ie.call(l),u.name?l.errHandler.sendError(u.name,u.message,u.data):l.errHandler.sendError(d.dependencies.ErrorHandler.prototype.INTERNAL_ERROR,"Internal error while processing media segment",u.message)}}},Ee=function(e,i,o){var s=t.defer(),l=this.videoModel.getCurrentTime(),u=new Date,c=this;if(!0===q&&(q=!1,K=this.metricsModel.appendPlayListTrace(V,n.id,null,u,l,null,1,null)),Ne())return De.call(this).then(function(){Ne()&&(c.debug.log("[BufferController]["+r+"] Buffering segment"),c.sourceBufferExt.append(k,e,o).then(function(){if(c.debug.log("[BufferController]["+r+"] Segment buffered"),B=!1,N>1&&!re&&!oe)Me.call(c,-1,Fe.call(c)-a).then(function(){_e.call(c),s.resolve()});else if(O){var e=j?-1:Fe.call(c)+ie,t=j?Fe.call(c)-ie:-1;Me.call(c,e,t).then(function(){_e.call(c),s.resolve()})}else _e.call(c),s.resolve();c.system.notify("bufferUpdated")},function(t){"text"===r?(c.debug.error("[BufferController]["+r+"] Failed to append data in source buffer : "+t.err.message),s.resolve()):(c.errHandler.sendError(d.dependencies.ErrorHandler.prototype.MEDIA_ERR_APPEND_SOURCEBUFFER,"Failed to append data into "+r+" source buffer",new d.vo.Error(t.err.code,t.err.name,t.err.message)),t.err.code===d.dependencies.ErrorHandler.prototype.DOM_ERR_QUOTA_EXCEEDED?({data:e,quality:i},R=s,B=!0,0,pe.call(c)):s.resolve())}))}),s.promise},_e=function(){var e,t,n=null;if(this.debug.getLevel()>=this.debug.INFO&&k){if(n=this.sourceBufferExt.getAllRanges(k),null===n||0===n.length)return;for(e=0,t=n.length;e<t;e+=1)this.debug.info("[BufferController]["+r+"] Buffered range ["+e+"]: "+n.start(e)+" - "+n.end(e)+" ("+this.getVideoModel().getCurrentTime()+")")}},xe=function(e,t){var n,i,r=b.deserialize(e),o=r.getBoxByType("moov"),s=r.getBoxByType("moof"),a=null===s?null:s.getBoxByType("traf"),l=null===a?null:a.getBoxByType("trun");if(null===l||0===l.samples_table.length)return 0;if(n=l.samples_table[0].sample_composition_time_offset,void 0===n)return 0;if(o){var u=o.getBoxByType("mvhd");i=u.timescale}else i=t.timescale;return n/i},Te=function(e,t,n,i){var r,o,s,a=[],l=0,u=Math.pow(256,2),d=Math.pow(256,3),h=Math.max(isNaN(t.startTime)?0:t.startTime,0),f=[];z=!1,s=n.concat(i);for(var p=0;p<s.length;p++)f[s[p].schemeIdUri]=s[p];while(l<e.length){if(r=String.fromCharCode(e[l+4],e[l+5],e[l+6],e[l+7]),o=e[l]*d+e[l+1]*u+256*e[l+2]+1*e[l+3],"moov"===r||"moof"===r)break;if("emsg"===r){z=!0;var m=["","",0,0,0,0,""],g=0,y=l+12;while(y<o+l)0===g||1===g||6===g?(0!==e[y]?m[g]+=String.fromCharCode(e[y]):g+=1,y+=1):(m[g]=e[y]*d+e[y+1]*u+256*e[y+2]+1*e[y+3],y+=4,g+=1);var v=m[0],b=m[1],E=m[2],_=m[3],x=m[4],T=m[5],S=m[6],w=h*E+_;if(f[v]){var I=new c.vo.Event;I.eventStream=f[v],I.eventStream.value=b,I.eventStream.timescale=E,I.duration=x,I.id=T,I.presentationTime=w,I.messageData=S,I.presentationTimeDelta=_,a.push(I)}}l+=o}return a},Se=function(e){if(!z)return e;var t,n,i=e.length,r=0,o=0,s=0,a=Math.pow(256,2),l=Math.pow(256,3),u=new Uint8Array(e.length);while(r<i){if(t=String.fromCharCode(e[r+4],e[r+5],e[r+6],e[r+7]),n=e[r]*l+e[r+1]*a+256*e[r+2]+1*e[r+3],"emsg"!==t)for(s=r;s<r+n;s++)u[o]=e[s],o+=1;r+=n}return u.subarray(0,o)},we=function(){return!!g||(Ie.call(this),!1)},Ie=function(){Q&&(Q.resolve(),Q=null)},De=function(){var e,n,i=t.defer(),r=0;return B?(n=function(){var t,o,s=this.videoModel.getCurrentTime(),a=0;o=this.fragmentController.getExecutedRequestForTime(C,s),t=o&&!isNaN(o.startTime)?o.startTime:Math.floor(s),e=o&&!isNaN(o.duration)?o.duration:1,Me.call(this,a,t).then(function(t){r+=t,r>=e?i.resolve():setTimeout(n,1e3*e)})},n.call(this),i.promise):t.when(!0)},Me=function(e,n){var o,s,a=t.defer(),l=this;return 0===k.buffered.length?(a.resolve(0),a.promise):(o=void 0!==e&&-1!==e?e:k.buffered.start(0),s=void 0!==n&&-1!==n?n:k.buffered.end(k.buffered.length-1),s<=o?(a.resolve(0),a.promise):(this.debug.info("[BufferController]["+r+"] Remove from "+o+" to "+s+" ("+this.getVideoModel().getCurrentTime()+")"),"text"!==r&&this.sourceBufferExt.abort(i,k),this.sourceBufferExt.remove(k,o,s,P.duration,i).then(function(){l.fragmentController.removeExecutedRequestsBeforeTime(C,s+1),l.fragmentController.cancelPendingRequestsForModel(C),a.resolve(s-o)},function(e){l.errHandler.sendWarning(d.dependencies.ErrorHandler.prototype.MEDIA_ERR_REMOVE_SOURCEBUFFER,"Failed to remove data from "+r+" source buffer",new d.vo.Error(e.code,e.name,e.message)),a.resolve(0)}),a.promise))},Ae=function(e){we.call(this)&&(Ie.call(this),e.aborted?je.call(this):"text"!==r?(Z+=1,Z===J?this.errHandler.sendError(d.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_CONTENT,"Failed to download media segment",{url:e.url,status:e.status}):(this.errHandler.sendWarning(d.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_CONTENT,"Failed to download media segment",{url:e.url,status:e.status}),ee=e,G===$&&Ye.call(this))):this.errHandler.sendWarning(d.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_CONTENT,"Failed to download media segment",{url:e.url,status:e.status}))},Le=function(){this.debug.log("[BufferController]["+r+"] Stream is complete."),L=!0,le(new Date,d.vo.metrics.PlayList.Trace.END_OF_CONTENT_STOP_REASON),Ie.call(this),pe.call(this),this.system.notify("bufferingCompleted")},Re=function(n){if(!we.call(this))return t.when(null);var i=this;return v[n]?(this.debug.info("[BufferController]["+r+"] Buffer initialization segment, quality = ",n),Ee.call(this,v[n],n).then(function(){i.debug.log("[BufferController]["+r+"] Initialization segment buffered"),we.call(i)&&Pe.call(i)}),t.when(null)):this.indexHandler.getInitRequest(e[n])},Pe=function(){if(we.call(this)){var e,t,i=Fe.call(this),o=this;w?t=i:(e=this.sourceBufferExt.getBufferRange(k,i),t=e?e.end:i),-1===te||E||w?(this.debug.log("[BufferController]["+r+"] loadNextFragment for time: "+t),this.indexHandler.getSegmentRequestForTime(n,t).then(Ce.bind(this),function(){D=-1,Le.call(o)})):(this.debug.log("[BufferController]["+r+"] loadNextFragment for sequence number: "+te),this.indexHandler.getNextSegmentRequestFromSN(n,te).then(Ce.bind(this)))}},Ce=function(e){if(we.call(this)){var t=this.manifestModel.getValue();null===e||e.action!==e.ACTION_COMPLETE?null!==e?(O&&(e=this.indexHandler.getIFrameRequest(e)),this.fragmentController.isFragmentLoadedOrPending(this,e)?(this.debug.log("[BufferController]["+r+"] new fragment request => already loaded or pending "+e.url),this.indexHandler.getNextSegmentRequest(n).then(Ce.bind(this))):(this.fragmentController.prepareFragmentForLoading(this,e,ge,ye,Ae,null),ae.call(this))):(this.debug.log("[BufferController]["+r+"] loadNextFragment failed"),Ie.call(this),A?"M3U"===t.name&&He.call(this):Le.call(this)):Le.call(this)}},Ne=function(){return!!F&&!!k},Be=function(){var e=this.videoModel.getCurrentTime();return P.start+P.duration-e},Fe=function(){var e=-1,t=this.videoModel.getCurrentTime();return e=E?x:t,e},ke=function(){var e,i=t.defer(),o=n.segmentAvailabilityRange.end,s=this;return this.debug.log("[BufferController]["+r+"] Manifest live edge = "+o),e=Math.max(o-l,n.segmentAvailabilityRange.start),this.indexHandler.getSegmentRequestForTime(n,e).then(function(e){P.liveEdge=e.startTime,s.debug.log("[BufferController]["+r+"] Live edge = "+P.liveEdge),i.resolve(P.liveEdge)}),i.promise},Oe=function(e){if(Ne()){var t=Fe.call(this);N=this.sourceBufferExt.getBufferLength(k,t),this.debug.log("[BufferController]["+r+"] Working time = "+t+", Buffer level = "+N.toFixed(3)),e&&this.metricsModel.addBufferLevel(r,new Date,N),this.updateBufferState()}},Ue=function(){var e,t;we.call(this)&&(this.debug.log("[BufferController]["+r+"] Check buffer..."),Oe.call(this,!0),M&&N>s&&ue.call(this,!1),e=Be.call(this),this.debug.log("[BufferController]["+r+"] time to end = "+e),O?N<1&&je.call(this):S||w||N<o&&(o<e||o>=e&&!L)?je.call(this):(t=N-o+.5,He.call(this,t)))},He=function(e){var t=this;e=e||1,this.debug.log("[BufferController]["+r+"] Check buffer in = "+e.toFixed(3)+" ms (bufferLevel = "+N+")"),clearTimeout(u),u=setTimeout(function(){u=null,Ue.call(t)},1e3*e)},je=function(){var e,i=new Date,o=this.videoModel.getCurrentTime(),s=this.manifestModel.getValue(),a=!1,l=null,u=this;null!==Q&&this.debug.error("[BufferController]["+r+"] deferredFragmentBuffered has not been resolved, create a new one is not correct."),Q=t.defer(),this.debug.log("[BufferController]["+r+"] Start buffering process..."),qe.call(this),a=0===v.length&&"M3U"!==s.name,e=this.abrController.getPlaybackQuality(r,F).quality,n=me.call(this,e),e!==D&&(this.debug.log("[BufferController]["+r+"] currentDownloadQuality changed : "+e),D=e,a=!0,le(new Date,d.vo.metrics.PlayList.Trace.REPRESENTATION_SWITCH_STOP_REASON),this.debug.log("[BufferController]["+r+"] Send RepresentationSwitch with quality = "+e),this.metricsModel.addRepresentationSwitch(r,i,o,n.id,e),l=Ve.call(this)),t.when(l||!0).then(function(){!0===a?Re.call(u,e).then(function(e){null!==e&&(u.fragmentController.prepareFragmentForLoading(u,e,ge,ye,Ae,null),ae.call(u))},function(e){Ie.call(u),e.name===d.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED?u.errHandler.sendError(e.name,e.message,e.data):u.errHandler.sendError(d.dependencies.ErrorHandler.prototype.INTERNAL_ERROR,"Internal error while processing initialization segment",e.message)}):Pe.call(u)},function(e){Ie.call(u),e&&u.errHandler.sendError(e.name,e.message,e.data)})},Ve=function(){var i,o,s,a=this.manifestModel.getValue(),l=this;return"M3U"!==a.name?t.when(!0):A||"SegmentList"!==n.segmentInfoType?(ne&&(clearTimeout(ne),ne=null),i=t.defer(),s=this.manifestExt.getDataIndex(F,a,P.index),o=a.Period_asArray[P.index].AdaptationSet_asArray[s].Representation_asArray[D],this.debug.log("[BufferController]["+r+"] Update playlist for representation "+o.id),this.parser.hlsParser.updatePlaylist(o,F).then(function(){e=Ke.call(l,F,P),n=me.call(l,D),o=a.Period_asArray[P.index].AdaptationSet_asArray[s].Representation_asArray[D];var t=o.SegmentList.SegmentURL_asArray;t>0&&(ie=t[t.length-1]-1),ne=setTimeout(function(){Ve.call(l)},1e3*ie),i.resolve()},function(e){e&&l.errHandler.sendWarning(e.name,e.message,e.data),i.reject(e)}),i.promise):t.when(!0)},Ke=function(e,t){var n,i,r=this.manifestModel.getValue();return n=this.manifestExt.getDataIndex(e,r,t.index),i=this.manifestExt.getAdaptationsForPeriod(r,t),this.manifestExt.getRepresentationsForAdaptation(r,i[n])},qe=function(){if(!1===T)return!1;this.debug.log("[BufferController]["+r+"] Data changed"),e=Ke.call(this,F,P),n=me.call(this,this.abrController.getPlaybackQuality(r,F).quality),this.bufferExt.updateData(F,r),S&&(v=[],this.fragmentController.clearExecutedRequests(C),w=!0,"text"===r&&(k.UpdateLang(F.id,F.lang),"application/ttml+xml"===F.mimeType&&Me.call(this))),T=!1,S=!1},ze=function(e){var t,n,i=this.abrController.getQualityFor(r);if(!this.abrController.isMinQuality(r,F,i)){n=this.abrRulesCollection.getRules(d.rules.BaseRulesCollection.prototype.ABANDON_FRAGMENT_RULES);var o=function(e){e.quality<i&&(this.fragmentController.abortRequestsForModel(C),this.debug.info("[BufferController]["+r+"] Abandon current segment download"))};for(t=0;t<n.length;t++)n[t].execute(e.data.request,o.bind(this))}},Ye=function(){null!==ee&&(this.debug.log("[BufferController]["+r+"] Signal segment loading failed"),this.system.notify("segmentLoadingFailed",ee),ee=null)};return{videoModel:void 0,metricsModel:void 0,manifestExt:void 0,manifestModel:void 0,bufferExt:void 0,sourceBufferExt:void 0,abrController:void 0,parser:void 0,fragmentExt:void 0,indexHandler:void 0,debug:void 0,system:void 0,errHandler:void 0,config:void 0,abrRulesCollection:void 0,initialize:function(e,t,n,i,r,u,c){var h=this.manifestModel.getValue();this.debug.log("[BufferController]["+e+"] Initialize"),this[d.dependencies.FragmentLoader.eventList.ENAME_LOADING_PROGRESS]=ze,A=this.manifestExt.getIsDynamic(h),this.setMediaSource(u),this.setType(e),this.setBuffer(i),this.setFragmentController(r),this.setEventController(c),o=this.config.getParamFor(e,"BufferController.minBufferTime","number",-1),s=this.config.getParamFor(e,"BufferController.minBufferTimeForPlaying","number",d.dependencies.BufferExtensions.BUFFER_TIME_AT_STARTUP),a=this.config.getParamFor(e,"BufferController.bufferToKeep","number",d.dependencies.BufferExtensions.DEFAULT_BUFFER_TO_KEEP),l=this.config.getParamFor(e,"BufferController.liveDelay","number",-1),this.updateData(n,t),this.load(),m=!0},load:function(){var e=this.manifestModel.getValue(),t=this;qe.call(this),n=me.call(this,this.abrController.getPlaybackQuality(r,F).quality),D=-1,Me.call(this).then(function(){n&&(t.indexHandler.setIsDynamic(A),-1===o&&(o=t.bufferExt.decideBufferLength(e.minBufferTime,P.duration,y)),(-1===l||l<o)&&(l=o),e.minBufferTime=o,"video"===r&&(A?t.indexHandler.updateSegmentList(n).then(function(){ke.call(t).then(function(e){t.system.notify("startTimeFound",e)})}):t.indexHandler.getCurrentTime(n).then(function(e){e<n.segmentAvailabilityRange.start&&(e=n.segmentAvailabilityRange.start),t.system.notify("startTimeFound",e)})))})},getIndexHandler:function(){return this.indexHandler},getType:function(){return r},setType:function(e){r=e,void 0!==this.indexHandler&&this.indexHandler.setType(e)},getPeriodInfo:function(){return P},getVideoModel:function(){return this.videoModel},setVideoModel:function(e){this.videoModel=e},getFragmentController:function(){return this.fragmentController},setFragmentController:function(e){e&&(this.fragmentController=e,C=this.fragmentController.attachBufferController(this),C.fragmentLoader.subscribe(d.dependencies.FragmentLoader.eventList.ENAME_LOADING_PROGRESS,this),C.setType(r))},setEventController:function(e){this.eventController=e},getData:function(){return F},updateData:function(e,t){this.debug.log("[BufferController]["+r+"] Update data"),S=null!==F&&(F.id!==e.id||F.lang!==e.lang||F.subType!==e.subType),F=e,P=t,T=!0,S&&(this.debug.log("[BufferController]["+r+"] Track changed"),clearTimeout(u),u=null,L=!1,de.call(this),null===Q&&Ue.call(this))},getHtmlVideoState:function(){return G},getAvailableRepresentations:function(){return e},getCurrentRepresentation:function(){return n},getBuffer:function(){return k},setBuffer:function(e){k=e},getMinBufferTime:function(){return o},setMinBufferTime:function(e){o=e},getLiveDelay:function(){return l},setMediaSource:function(e){i=e},isReady:function(){return p===f},isBufferingCompleted:function(){return L},updateManifest:function(){this.system.notify("manifestUpdate")},updateBufferState:function(){var e,t=this.videoModel.getCurrentTime(),n=-1===X?t:X,i=t-n,o=this;if(clearTimeout(h),h=null,!1!==g&&"text"!==r&&!O){switch(G){case Y:G=$,this.debug.info("[BufferController]["+r+"] BUFFERING - "+t+" - "+N),this.metricsModel.addState(r,"buffering",t);break;case $:!this.getVideoModel().isPaused()&&i>0&&N>=1?(G=W,this.debug.info("[BufferController]["+r+"] PLAYING - "+t),this.metricsModel.addState(r,"playing",t),E=!1,x=-1,Z=0):this.getVideoModel().isStalled()||(e=this.sourceBufferExt.getAllRanges(k));break;case W:if(!this.getVideoModel().isPaused()&&!this.getVideoModel().isSeeking()&&(i<=0&&N<=1||0===N))if(G=$,this.debug.info("[BufferController]["+r+"] BUFFERING - "+t+" - "+N),this.metricsModel.addState(r,"buffering",t),ee)Ye.call(this);else{var s;for(e=this.sourceBufferExt.getAllRanges(k),s=0;s<e.length;s++)if(t<e.start(s)&&(!A||e.start(s)-t<ie))break;s<e.length&&(this.debug.info("[BufferController]["+r+"] BUFFERING => skip buffer discontinuity, seek to "+e.start(s)),this.videoModel.setCurrentTime(e.start(s)))}h=setTimeout(function(){h=null,Oe.call(o,!1)},1e3);break}t>0&&(X=t)}},updateStalledState:function(){M=this.videoModel.isStalled()},reset:function(e){var n=function(e){e&&(e.reject(),e=null)},o=t.defer(),s=this;return pe.call(this),this.sourceBufferExt.abort(i,k),ne&&(clearTimeout(ne),ne=null),t.when(!Q||Q.promise).then(function(){n(R),n(Q),C&&(C.fragmentLoader.unsubscribe(d.dependencies.FragmentLoader.eventList.ENAME_LOADING_PROGRESS,s.abrController),s.fragmentController.abortRequestsForModel(C),s.fragmentController.detachBufferController(C),C=null),v=[],!0,B=!1,null,!1,O&&(s.abrController.setAutoSwitchFor(r,H),s.abrController.setQualityFor(r,U)),e||s.sourceBufferExt.removeSourceBuffer(i,k),F=null,k=null,o.resolve()},function(){o.reject()}),o.promise},getSegmentDuration:function(){return ie},setTrickMode:function(e,n){var i=t.defer();return this.debug.log("[BufferController]["+r+"] setTrickMode - enabled = "+e),O===e?(i.resolve(),i.promise):(O=e,O?(j=n,U=this.abrController.getQualityFor(r),H=this.abrController.getAutoSwitchFor(r),this.abrController.setAutoSwitchFor(r,!1),this.abrController.setQualityFor(r,0),i.resolve()):(this.abrController.setAutoSwitchFor(r,H),this.abrController.setQualityFor(r,U),Me.call(this).then(function(){i.resolve()})),i.promise)},start:de,seek:he,stop:pe,seeked:fe,updateBufferLevel:Oe}},d.dependencies.BufferController.prototype={constructor:d.dependencies.BufferController},d.dependencies.BufferExtensions=function(){"use strict";var e,n,i=0,r=0,o=null,s=null,a=function(e){var t=this.metricsExt.getCurrentHttpRequest(e);return null!==t?(t.tresponse.getTime()-t.trequest.getTime())/1e3:0},l=function(){var e,t,n,a=this;return e=o?a.abrController.getQualityFor("audio"):i,t=s?a.abrController.getQualityFor("video"):r,n=e===i&&t===r,n};return{system:void 0,videoModel:void 0,metricsExt:void 0,metricsModel:void 0,abrController:void 0,bufferMax:void 0,updateData:function(e,t){if(e){var n=e.Representation_asArray.length-1;"audio"===t?(i=n,o=e):"video"===t&&(r=n,s=e)}},getTopQualityIndex:function(e){var t=null;return"audio"===e?t=i:"video"===e&&(t=r),t},decideBufferLength:function(t,n){return e=n===1/0?t>0?t:d.dependencies.BufferExtensions.DEFAULT_MIN_BUFFER_TIME:t>=n?Math.min(n,d.dependencies.BufferExtensions.DEFAULT_MIN_BUFFER_TIME):Math.min(n,t),e},getLeastBufferLevel:function(){var e=this.metricsModel.getReadOnlyMetricsFor("video"),t=this.metricsExt.getCurrentBufferLevel(e),n=this.metricsModel.getReadOnlyMetricsFor("audio"),i=this.metricsExt.getCurrentBufferLevel(n),r=null;return r=null===t||null===i?null!==i?i.level:null!==t?t.level:null:Math.min(i.level,t.level),r},getRequiredBufferLength:function(i,r,o,s){var u,c=this,h=c.metricsModel.getReadOnlyMetricsFor("video"),f=c.metricsModel.getReadOnlyMetricsFor("audio"),p=s>=d.dependencies.BufferExtensions.LONG_FORM_CONTENT_DURATION_THRESHOLD,m=t.defer(),g=!1;return c.bufferMax===d.dependencies.BufferExtensions.BUFFER_SIZE_MIN?(u=e,m.resolve(u)):c.bufferMax===d.dependencies.BufferExtensions.BUFFER_SIZE_INFINITY?(u=s,m.resolve(u)):c.bufferMax===d.dependencies.BufferExtensions.BUFFER_SIZE_REQUIRED?(n=e,o||i||(g=l.call(c)),g&&(n=p?d.dependencies.BufferExtensions.BUFFER_TIME_AT_TOP_QUALITY_LONG_FORM:d.dependencies.BufferExtensions.BUFFER_TIME_AT_TOP_QUALITY),u=n+r+Math.max(a.call(c,h),a.call(c,f)),m.resolve(u)):m.reject("invalid bufferMax value: "+c.bufferMax),m.promise},getBufferTarget:function(){return void 0===n?e:n}}},d.dependencies.BufferExtensions.BUFFER_SIZE_REQUIRED="required",d.dependencies.BufferExtensions.BUFFER_SIZE_MIN="min",d.dependencies.BufferExtensions.BUFFER_SIZE_INFINITY="infinity",d.dependencies.BufferExtensions.BUFFER_TIME_AT_STARTUP=1,d.dependencies.BufferExtensions.DEFAULT_MIN_BUFFER_TIME=16,d.dependencies.BufferExtensions.DEFAULT_BUFFER_TO_KEEP=30,d.dependencies.BufferExtensions.DEFAULT_LIVE_DELAY=16,d.dependencies.BufferExtensions.BUFFER_TIME_AT_TOP_QUALITY=30,d.dependencies.BufferExtensions.BUFFER_TIME_AT_TOP_QUALITY_LONG_FORM=300,d.dependencies.BufferExtensions.LONG_FORM_CONTENT_DURATION_THRESHOLD=600,d.dependencies.BufferExtensions.prototype.constructor=d.dependencies.BufferExtensions,d.utils.Capabilities=function(){},d.utils.Capabilities.prototype={constructor:d.utils.Capabilities,system:void 0,supportsMediaSource:function(){"use strict";var e="WebKitMediaSource"in window,t="MediaSource"in window;return e||t},supportsMediaKeys:function(){"use strict";var e="WebKitMediaKeys"in window,t="MSMediaKeys"in window,n="MediaKeys"in window;return e||t||n},supportsEncryptedMedia:function(){return this.system.hasMapping("protectionModel")},supportsCodec:function(e,t){"use strict";if(!(e instanceof HTMLMediaElement))throw"element must be of type HTMLMediaElement.";var n=e.canPlayType(t);return"probably"===n||"maybe"===n}},d.utils.Config=function(){"use strict";var e=["video","audio"],t={"BufferController.minBufferTimeForPlaying":-1,"BufferController.minBufferTime":-1,"BufferController.bufferToKeep":-1,"BufferController.liveDelay":-1,"ABR.minBandwidth":-1,"ABR.maxBandwidth":-1,"ABR.minQuality":-1,"ABR.maxQuality":-1,"ABR.switchUpIncrementally":-1,"ABR.switchUpRatioSafetyFactor":-1,"ABR.latencyInBandwidth":-1,"ABR.switchDownBufferTime":-1,"ABR.switchDownBufferRatio":-1,"ABR.switchLowerBufferTime":-1,"ABR.switchLowerBufferRatio":-1,"ABR.switchUpBufferTime":-1,"ABR.switchUpBufferRatio":-1,"ABR.keepBandwidthCondition":-1,"ABR.droppedFramesMinRatio":-1,"ABR.droppedFramesMaxRatio":-1,"ManifestLoader.RetryAttempts":-1,"ManifestLoader.RetryInterval":-1,"FragmentLoader.RetryAttempts":-1,"FragmentLoader.RetryInterval":-1,"Protection.licensePersistence":-1,backoffSeekToEnd:2,video:{},audio:{}},n=function(n){var i,r,o;for(i in n)if(n.hasOwnProperty(i)&&-1===i.indexOf("//"))if(e.indexOf(i)>-1)for(o in r=n[i],r)r.hasOwnProperty(o)&&(t[i][o]=n[i][o]);else t[i]=n[i]},i=function(e,t,n,i){var r=e[t];if(void 0===r||-1===r)return i;if(void 0!==n&&typeof r!==n)switch(n){case"number":r=Number(r);break;case"boolean":r="true"===r||"1"===r||1===r;break;default:break}return r},r=function(e,n,r){return i(t,e,n,r)},o=function(e,n,r,o){var s=t[e];return void 0!==s&&void 0!==s[n]?i(s,n,r,o):i(t,n,r,o)};return{debug:void 0,setup:function(){},setParams:function(e){n(e);var t=this.getParam("Debug.level","number",-1);-1!==t&&this.debug.setLevel(t)},getParam:function(e,t,n){return r(e,t,n)},getParamFor:function(e,t,n,i){return o(e,t,n,i)}}},d.utils.Config.prototype={constructor:d.utils.Config},d.di.Context=function(){"use strict";var e=function(){var e=document.createElement("video"),t=this.system.getObject("debug");d.models.ProtectionModel_21Jan2015.detect(e)?this.system.mapSingleton("protectionModel",d.models.ProtectionModel_21Jan2015):d.models.ProtectionModel_3Feb2014.detect(e)?this.system.mapClass("protectionModel",d.models.ProtectionModel_3Feb2014):d.models.ProtectionModel_01b.detect(e)?this.system.mapClass("protectionModel",d.models.ProtectionModel_01b):(t.log("No supported version of EME detected on this user agent!"),t.log("Attempts to play encrypted content will fail!"))};return{system:void 0,setup:function(){this.system.autoMapOutlets=!0,this.system.mapSingleton("capabilities",d.utils.Capabilities),this.system.mapSingleton("config",d.utils.Config),this.system.mapSingleton("debug",d.utils.Debug),this.system.mapSingleton("debugController",d.utils.DebugController),this.system.mapClass("domParser",d.utils.DOMParser),this.system.mapSingleton("eventBus",d.utils.EventBus),this.system.mapSingleton("textTrackExtensions",d.utils.TextTrackExtensions),this.system.mapSingleton("tokenAuthentication",d.utils.TokenAuthentication),this.system.mapSingleton("vttParser",d.utils.VTTParser),this.system.mapSingleton("ttmlParser",d.utils.TTMLParser),this.system.mapSingleton("ttmlRenderer",d.utils.TTMLRenderer),this.system.mapSingleton("manifestModel",d.models.ManifestModel),this.system.mapClass("metrics",d.models.MetricsList),this.system.mapSingleton("metricsModel",d.models.MetricsModel),this.system.mapSingleton("uriQueryFragModel",d.models.URIQueryAndFragmentModel),this.system.mapSingleton("videoModel",d.models.VideoModel),this.system.mapSingleton("abrController",d.dependencies.AbrController),this.system.mapClass("bufferController",d.dependencies.BufferController),this.system.mapSingleton("bufferExt",d.dependencies.BufferExtensions),this.system.mapSingleton("errHandler",d.dependencies.ErrorHandler),this.system.mapClass("eventController",d.dependencies.EventController),this.system.mapClass("fragmentController",d.dependencies.FragmentController),this.system.mapClass("fragmentLoader",d.dependencies.FragmentLoader),this.system.mapClass("fragmentModel",d.dependencies.FragmentModel),this.system.mapClass("manifestLoader",d.dependencies.ManifestLoader),this.system.mapSingleton("manifestUpdater",d.dependencies.ManifestUpdater),this.system.mapSingleton("mediaSourceExt",d.dependencies.MediaSourceExtensions),this.system.mapSingleton("notifier",d.dependencies.Notifier),this.system.mapSingleton("parser",d.dependencies.Parser),this.system.mapSingleton("sourceBufferExt",d.dependencies.SourceBufferExtensions),this.system.mapClass("stream",d.dependencies.Stream),this.system.mapSingleton("streamController",d.dependencies.StreamController),this.system.mapClass("textController",d.dependencies.TextController),this.system.mapSingleton("textSourceBuffer",d.dependencies.TextSourceBuffer),this.system.mapSingleton("textTTMLXMLMP4SourceBuffer",d.dependencies.TextTTMLXMLMP4SourceBuffer),this.system.mapSingleton("videoExt",d.dependencies.VideoModelExtensions),d.dependencies.ProtectionController&&(this.system.mapClass("protectionController",d.dependencies.ProtectionController),this.system.mapSingleton("protectionExt",d.dependencies.ProtectionExtensions),this.system.mapSingleton("ksClearKey",d.dependencies.protection.KeySystem_ClearKey),this.system.mapSingleton("ksPlayReady",d.dependencies.protection.KeySystem_PlayReady),this.system.mapSingleton("ksWidevine",d.dependencies.protection.KeySystem_Widevine),this.system.mapSingleton("serverClearKey",d.dependencies.protection.servers.ClearKey),this.system.mapSingleton("serverDRMToday",d.dependencies.protection.servers.DRMToday),this.system.mapSingleton("serverPlayReady",d.dependencies.protection.servers.PlayReady),this.system.mapSingleton("serverWidevine",d.dependencies.protection.servers.Widevine),e.call(this)),this.system.mapClass("abrRulesCollection",d.rules.BaseRulesCollection),this.system.mapClass("abandonRequestRule",d.rules.AbandonRequestsRule),this.system.mapClass("downloadRatioRule",d.rules.DownloadRatioRule),this.system.mapClass("droppedFramesRule",d.rules.DroppedFramesRule),this.system.mapClass("insufficientBufferRule",d.rules.InsufficientBufferRule),this.system.mapClass("limitSwitchesRule",d.rules.LimitSwitchesRule),this.system.mapClass("baseURLExt",c.dependencies.BaseURLExtensions),this.system.mapClass("fragmentExt",c.dependencies.FragmentExtensions),this.system.mapClass("indexHandler",c.dependencies.DashHandler),this.system.mapSingleton("manifestExt",c.dependencies.DashManifestExtensions),this.system.mapSingleton("metricsExt",d.dependencies.MetricsExtensions),this.system.mapSingleton("timelineConverter",c.dependencies.TimelineConverter),this.system.mapClass("dashParser",c.dependencies.DashParser),l.dependencies.MssParser&&this.system.mapClass("mssParser",l.dependencies.MssParser),u.dependencies.HlsParser&&(this.system.mapClass("hlsParser",u.dependencies.HlsParser),this.system.mapSingleton("hlsDemux",u.dependencies.HlsDemux)),this.system.mapClass("hlsStream",u.dependencies.HlsStream),this.system.mapSingleton("contextManager",d.modules.ContextManager),this.system.mapHandler("setContext","contextManager","setContext")}}},d.modules.ContextManager=function(){"use strict";return{system:void 0,debug:void 0,setContext:function(e){this.system.autoMapOutlets=!0,"MSS"===e?(this.system.mapClass("mp4Processor",d.dependencies.Mp4Processor),this.system.mapClass("indexHandler",l.dependencies.MssHandler),this.system.mapClass("fragmentController",l.dependencies.MssFragmentController),this.system.mapClass("mssFragmentInfoController",l.dependencies.MssFragmentInfoController)):"HLS"===e?(this.system.mapClass("mp4Processor",d.dependencies.Mp4Processor),this.system.mapClass("fragmentController",u.dependencies.HlsFragmentController),this.system.mapClass("indexHandler",u.dependencies.HlsHandler)):(this.system.mapClass("fragmentController",d.dependencies.FragmentController),this.system.mapClass("indexHandler",c.dependencies.DashHandler))}}},d.modules.ContextManager.prototype={constructor:d.modules.ContextManager},d.utils.Debug=function(){"use strict";Date.prototype.HHMMSSmmm=function(){var e=this.getHours().toString(),t=this.getMinutes().toString(),n=this.getSeconds().toString(),i=this.getMilliseconds().toString(),r=e[1]?e:"0"+e[0],o=t[1]?t:"0"+t[0],s=n[1]?n:"0"+n[0],a=i[2]?i:"0"+(i[1]?i:"0"+i[0]);return r+":"+o+":"+s+"."+a},Date.prototype.MMSSmmm=function(){var e=this.getMinutes().toString(),t=this.getSeconds().toString(),n=this.getMilliseconds().toString(),i=e[1]?e:"0"+e[0],r=t[1]?t:"0"+t[0],o=n[2]?n:"0"+(n[1]?n:"0"+n[0]);return i+":"+r+"."+o};var e=function(){this.logArray=[],this.showLevel=!0};e.prototype.error=e.prototype.warn=e.prototype.info=e.prototype.debug=function(e){this.logArray.push(e)},e.prototype.getLogs=function(){return this.logArray};var t=0,n=1,i=2,r=3,o=4,s=4,a=0,l=!0,u=!1,c=new Date,d=console,h=function(e,t){if(e<=m()){var s=f(e,t);switch(e){case n:d.error(s);break;case i:d.warn(s);break;case r:d.info(s);break;case o:d.debug(s);break}}},f=function(e,t){var n="",i=null;return l&&(i=new Date,n+="["+i.HHMMSSmmm()+"]"),d&&d.showLevel&&(n+="["+p(e)+"]"),u&&(n+="["+new Date(i-c).MMSSmmm()+"]"),Array.apply(null,t).forEach(function(e){n+=e+" "}),n},p=function(e){switch(e){case n:return"ERROR";case i:return"WARN";case r:return"INFO";case o:return"DEBUG";default:return""}},m=function(){return a},g=function(){return d};return{NONE:t,ERROR:n,WARN:i,INFO:r,DEBUG:o,ALL:s,getLevel:m,getLogger:g,setLevel:function(e){a=e},setLogger:function(t){switch(t){case"log4javascript":var n=new log4javascript.PopUpAppender,i=new log4javascript.PatternLayout("%d{HH:mm:ss.SSS} %-5p - %m%n");n.setLayout(i),d.addAppender(n),d.setLevel(log4javascript.Level.ALL),d.initialized=!0;break;case"memory":d=new e;break;case"console":d=console;break;default:d=null}},error:function(){h.call(this,n,arguments)},warn:function(){h.call(this,i,arguments)},info:function(){h.call(this,r,arguments)},log:function(){h.call(this,o,arguments)}}},d.utils.DebugController=function(){"use strict";var e={isInDebug:!1,level:0,loggerType:"console"},t="",n=function(n){!0!==n.altKey||!0!==n.ctrlKey||!0!==n.shiftKey||68!==n.keyCode&&90!==n.keyCode||(e.isInDebug?(console.log("hasplayer.js debug OFF (v"+t+")"),e.isInDebug=!1,90===n.keyCode?(i(this.debug.getLogger().getLogs()),this.debug.setLevel(e.level),this.debug.setLogger(e.loggerType)):this.debug.setLevel(0)):(console.log("hasplayer.js debug ON (v"+t+")"),e.isInDebug=!0,e.level=this.debug.getLevel(),this.debug.setLevel(68===n.keyCode?4:3),this.debug.setLogger(68===n.keyCode?"console":"memory")))},i=function(e){if(e&&e.length>0){var t="hasplayer_logs.txt",n=JSON.stringify(e,null,"\r\n"),i=new Blob([n],{type:"text/json"});if(navigator.msSaveBlob)navigator.msSaveBlob(i,t);else{var r=document.createEvent("MouseEvents"),o=document.createElement("a");o.download=t,o.href=window.URL.createObjectURL(i),o.dataset.downloadurl=["text/json",o.download,o.href].join(":"),r.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(r)}}};return{debug:void 0,setup:function(){window.addEventListener("keydown",n.bind(this))},init:function(e){t=e}}},d.utils.DebugController.prototype={constructor:d.utils.DebugController},d.dependencies.ErrorHandler=function(){"use strict";return{eventBus:void 0,debug:void 0,sendWarning:function(e,t,n){this.debug.warn("[Warn] Code: "+e+", Message: "+t+", Data: "+JSON.stringify(n,null,"\t")),this.eventBus.dispatchEvent({type:"warning",data:{code:e,message:t,data:n}})},sendError:function(e,t,n){this.debug.error("[Error] Code: "+e+", Message: "+t+", Data: "+JSON.stringify(n,null,"\t")),this.eventBus.dispatchEvent({type:"error",data:{code:e,message:t,data:n}})}}},d.dependencies.ErrorHandler.prototype={constructor:d.dependencies.ErrorHandler},d.dependencies.ErrorHandler.prototype.INTERNAL_ERROR="INTERNAL_ERROR",d.dependencies.ErrorHandler.prototype.MEDIA_ERR_ABORTED="MEDIA_ERR_ABORTED",d.dependencies.ErrorHandler.prototype.MEDIA_ERR_NETWORK="MEDIA_ERR_NETWORK",d.dependencies.ErrorHandler.prototype.MEDIA_ERR_DECODE="MEDIA_ERR_DECODE",d.dependencies.ErrorHandler.prototype.MEDIA_ERR_SRC_NOT_SUPPORTED="MEDIA_ERR_SRC_NOT_SUPPORTED",d.dependencies.ErrorHandler.prototype.MEDIA_ERR_ENCRYPTED="MEDIA_ERR_ENCRYPTED",d.dependencies.ErrorHandler.prototype.CAPABILITY_ERR_MEDIASOURCE="CAPABILITY_ERR_MEDIASOURCE",d.dependencies.ErrorHandler.prototype.CAPABILITY_ERR_MEDIAKEYS="CAPABILITY_ERR_MEDIAKEYS",d.dependencies.ErrorHandler.prototype.MEDIA_ERR_CREATE_MEDIASOURCE="MEDIA_ERR_CREATE_MEDIASOURCE",d.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED="MEDIA_ERR_CODEC_UNSUPPORTED",d.dependencies.ErrorHandler.prototype.MEDIA_ERR_CREATE_SOURCEBUFFER="MEDIA_ERR_CREATE_SOURCEBUFFER",d.dependencies.ErrorHandler.prototype.MEDIA_ERR_APPEND_SOURCEBUFFER="MEDIA_ERR_APPEND_SOURCEBUFFER",d.dependencies.ErrorHandler.prototype.MEDIA_ERR_REMOVE_SOURCEBUFFER="MEDIA_ERR_REMOVE_SOURCEBUFFER",d.dependencies.ErrorHandler.prototype.MANIFEST_ERR_PARSE="MANIFEST_ERR_PARSE",d.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_STREAM="MANIFEST_ERR_NO_STREAM",d.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_VIDEO="MANIFEST_ERR_NO_VIDEO",d.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_AUDIO="MANIFEST_ERR_NO_AUDIO",d.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_TEXT="MANIFEST_ERR_NO_TEXT",d.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_MANIFEST="DOWNLOAD_ERR_MANIFEST",d.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_SIDX="DOWNLOAD_ERR_SIDX",d.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_INIT="DOWNLOAD_ERR_INIT",d.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_CONTENT="DOWNLOAD_ERR_CONTENT",d.dependencies.ErrorHandler.prototype.MSS_NO_TFRF="MSS_NO_TFRF",d.dependencies.ErrorHandler.prototype.HLS_INVALID_PACKET_ERROR="HLS_INVALID_PACKET_ERROR",d.dependencies.ErrorHandler.prototype.HLS_DEMUX_ERROR="HLS_DEMUX_ERROR",d.dependencies.ErrorHandler.prototype.HLS_INVALID_KEY_ERROR="HLS_INVALID_KEY_ERROR",d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR="MEDIA_KEYERR",d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_UNKNOWN="MEDIA_KEYERR_UNKNOWN",d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_CLIENT="MEDIA_KEYERR_CLIENT",d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_SERVICE="MEDIA_KEYERR_SERVICE",d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_OUTPUT="MEDIA_KEYERR_OUTPUT",d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_HARDWARECHANGE="MEDIA_KEYERR_HARDWARECHANGE",d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_DOMAIN="MEDIA_KEYERR_DOMAIN",d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_EXPIRED="MEDIA_KEYERR_EXPIRED",d.dependencies.ErrorHandler.prototype.MEDIA_KEYSYSERR_ACCESS_DENIED="MEDIA_KEYSYSERR_ACCESS_DENIED",d.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_URL_LICENSER_UNKNOWN="MEDIA_KEYMESSERR_URL_LICENSER_UNKNOWN",d.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_NO_CHALLENGE="MEDIA_KEYMESSERR_NO_CHALLENGE",d.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_LICENSER_ERROR="MEDIA_KEYMESSERR_LICENSER_ERROR",d.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_NO_SESSION="MEDIA_KEYMESSERR_NO_SESSION",d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_SERVER_CERTIFICATE="MEDIA_KEYERR_SERVER_CERTIFICATE",d.dependencies.ErrorHandler.prototype.DOM_ERR_INDEX_SIZE=1,d.dependencies.ErrorHandler.prototype.DOM_ERR_HIERARCHY_REQUEST=3,d.dependencies.ErrorHandler.prototype.DOM_ERR_WRONG_DOCUMENT=4,d.dependencies.ErrorHandler.prototype.DOM_ERR_INVALID_CHARACTER=5,d.dependencies.ErrorHandler.prototype.DOM_ERR_NO_MODIFICATION_ALLOWED=7,d.dependencies.ErrorHandler.prototype.DOM_ERR_NOT_FOUND=8,d.dependencies.ErrorHandler.prototype.DOM_ERR_NOT_SUPPORTED=9,d.dependencies.ErrorHandler.prototype.DOM_ERR_INVALID_STATE=11,d.dependencies.ErrorHandler.prototype.DOM_ERR_SYNTAX=12,d.dependencies.ErrorHandler.prototype.DOM_ERR_INVALID_MODIFICATION=13,d.dependencies.ErrorHandler.prototype.DOM_ERR_NAMESPACE=14,d.dependencies.ErrorHandler.prototype.DOM_ERR_INVALID_ACCESS=15,d.dependencies.ErrorHandler.prototype.DOM_ERR_SECURITY=18,d.dependencies.ErrorHandler.prototype.DOM_ERR_NETWORK=19,d.dependencies.ErrorHandler.prototype.DOM_ERR_ABORT=20,d.dependencies.ErrorHandler.prototype.DOM_ERR_URL_MISMATCH=21,d.dependencies.ErrorHandler.prototype.DOM_ERR_QUOTA_EXCEEDED=22,d.dependencies.ErrorHandler.prototype.DOM_ERR_TIMEOUT=23,d.dependencies.ErrorHandler.prototype.DOM_ERR_INVALID_NODE_TYPE=24,d.dependencies.ErrorHandler.prototype.DOM_ERR_DATA_CLONE=25,d.utils.EventBus=function(){"use strict";var e,t=function(t,n){var i=(n?"1":"0")+t;return i in e||(e[i]=[]),e[i]},n=function(){e={}};return n(),{addEventListener:function(e,n,i){var r=t(e,i),o=r.indexOf(n);-1===o&&r.push(n)},removeEventListener:function(e,n,i){var r=t(e,i),o=r.indexOf(n);-1!==o&&r.splice(o,1)},dispatchEvent:function(e){var n=t(e.type,!1).slice(),i=0;for(i=0;i<n.length;i+=1)n[i].call(this,e);return!e.defaultPrevented}}},d.dependencies.EventController=function(){"use strict";var e=[],t=[],n=[],i=null,r=100,o=r/1e3,s="urn:mpeg:dash:event:2012",a=1,l=function(){null!==i&&(clearInterval(i),i=null),e=null,t=null,n=null},u=function(){null!==i&&(clearInterval(i),i=null)},c=function(){var e=this;e.debug.log("[EventController] Start Event Controller"),isNaN(r)||(i=setInterval(f.bind(this),r))},d=function(t){var n=this;e=[],t&&t.length>0&&(e=t),n.debug.log("[EventController] Added "+t.length+" inline events")},h=function(e){var n,i=this,r=0;for(r=0;r<e.length;r++)n=e[r],t[n.id]=n,i.debug.log("[EventController] Add inband event with id "+n.id)},f=function(){p.call(this,t),p.call(this,e),m.call(this)},p=function(e){var t,i,r=this,l=this.videoModel.getCurrentTime(),u=0;if(e)for(u=0;u<e.length;u++)i=e[u],void 0!==i&&(t=i.presentationTime/i.eventStream.timescale,(0===t||t<=l&&t+o>l)&&(r.debug.log("[EventController] Start Event at "+l),i.duration>0&&n.push(i),i.eventStream.schemeIdUri===s&&i.eventStream.value===a&&g.call(this),e.splice(u,1)))},m=function(){var e,t,i=this,r=0;if(n)for(e=this.videoModel.getCurrentTime(),r=0;r<n.length;r++)t=n[r],null!==t&&(t.duration+t.presentationTime)/t.eventStream.timescale<e&&(i.debug.log("[EventController] Remove Event at time "+e),t=null,n.splice(r,1))},g=function(){var e=this,t=e.manifestModel.getValue(),n=t.mpdUrl;t.hasOwnProperty("Location")&&(n=t.Location),e.debug.log("[EventController] Refresh manifest @ "+n),e.manifestLoader.load(n).then(function(t){e.manifestModel.setValue(t)})};return{manifestModel:void 0,manifestLoader:void 0,debug:void 0,system:void 0,videoModel:void 0,addInlineEvents:d,addInbandEvents:h,reset:l,clear:u,start:c}},d.dependencies.EventController.prototype={constructor:d.dependencies.EventController},d.dependencies.FragmentController=function(){"use strict";var e=[],n=function(t){var n=e.length,i=0;for(i=0;i<n;i+=1)if(e[i].getContext()===t)return e[i];return null},i=function(){var t=!0,n=e.length,i=0;for(i=0;i<n;i+=1)if(!e[i].isReady()){t=!1;break}return t},r=function(){var t=0;for(t=0;t<e.length;t+=1)e[t].executeCurrentRequest()};return{system:void 0,debug:void 0,process:function(e){var n=null;return null!==e&&void 0!==e&&e.byteLength>0&&(n=new Uint8Array(e)),t.when(n)},attachBufferController:function(t){var i;return t?(i=n(t),i||(i=this.system.getObject("fragmentModel"),i.setContext(t),e.push(i)),i):null},detachBufferController:function(t){var n=e.indexOf(t);n>-1&&e.splice(n,1)},onBufferControllerStateChange:function(){i()&&r.call(this)},isFragmentLoadedOrPending:function(e,t){var i,r=n(e);return!!r&&(i=r.isFragmentLoadedOrPending(t),i)},getPendingRequests:function(e){var t=n(e);return t?t.getPendingRequests():null},getLoadingRequests:function(e){var t=n(e);return t?t.getLoadingRequests():null},isInitializationRequest:function(e){return e&&e.type&&"initialization segment"===e.type.toLowerCase()},getLoadingTime:function(e){var t=n(e);return t?t.getLoadingTime():null},getExecutedRequestForTime:function(e,t){return e?e.getExecutedRequestForTime(t):null},removeExecutedRequest:function(e,t){e&&e.removeExecutedRequest(t)},removeExecutedRequestsBeforeTime:function(e,t){e&&e.removeExecutedRequestsBeforeTime(t)},clearExecutedRequests:function(e){e&&e.clearExecutedRequests()},cancelPendingRequestsForModel:function(e){e&&e.cancelPendingRequests()},abortRequestsForModel:function(e){e&&e.abortRequests()},prepareFragmentForLoading:function(e,t,i,r,o,s){var a=n(e);return a&&t?(a.addRequest(t),a.setCallbacks(i,r,o,s),!0):null}}},d.dependencies.FragmentController.prototype={constructor:d.dependencies.FragmentController},d.dependencies.FragmentLoader=function(){"use strict";var e,n=2,i=500,r=n,o=i,s=0,a=[],l=function(e){var t=new XMLHttpRequest,n=!1;t.open("HEAD",e.url,!0),t.onload=function(){t.status<200||t.status>399||(n=!0,e.deferred.resolve(e))},t.onloadend=t.onerror=function(){n||e.deferred.reject(t)},t.send()},u=function(n){var i=t.defer(),r=new XMLHttpRequest,o=null,s=!0,l=!0,u=null,c=this;return a.push(r),n.requestStartDate=new Date,o=c.metricsModel.addHttpRequest(n.streamType,null,n.type,n.url,null,n.range,n.requestStartDate,null,null,null,null,n.duration,n.startTime,n.quality),c.metricsModel.appendHttpTrace(o,n.requestStartDate,n.requestStartDate.getTime()-n.requestStartDate.getTime(),[0]),u=n.requestStartDate,r.open("GET",c.tokenAuthentication.addTokenAsQueryArg(n.url),!0),r.responseType="arraybuffer",r=c.tokenAuthentication.setTokenInRequestHeader(r),n.range&&r.setRequestHeader("Range","bytes="+n.range),r.onprogress=function(e){var t=new Date;s&&(s=!1,(!e.lengthComputable||e.lengthComputable&&e.total!==e.loaded)&&(n.firstByteDate=t,o.tresponse=t)),e.lengthComputable&&(n.bytesLoaded=e.loaded,n.bytesTotal=e.total),c.metricsModel.appendHttpTrace(o,t,t.getTime()-u.getTime(),[n.bytesLoaded?n.bytesLoaded:0]),u=t,c.notify(d.dependencies.FragmentLoader.eventList.ENAME_LOADING_PROGRESS,{request:n,httpRequestMetrics:o,lastTraceTime:u})},r.onload=function(){if(!(r.status<200||r.status>399)){l=!1;var t,s,a=new Date,d=r.response,h=d?d.byteLength:0;n.firstByteDate||(n.firstByteDate=n.requestStartDate),n.requestEndDate=a,t=n.firstByteDate.getTime()-n.requestStartDate.getTime(),s=n.requestEndDate.getTime()-n.firstByteDate.getTime(),c.debug.log("[FragmentLoader]["+e+"] Loaded: "+n.url+" ("+r.status+", "+t+"ms, "+s+"ms)"),o.tresponse=n.firstByteDate,o.tfinish=n.requestEndDate,o.responsecode=r.status,o.bytesLength=h,c.metricsModel.appendHttpTrace(o,a,a.getTime()-u.getTime(),[h]),u=a,i.resolve({data:d,request:n})}},r.onabort=function(){var e,t,i=new Date;r.aborted=!0,0!==o.trace.length&&(e=o.trace[o.trace.length-1],t=e.b[0],n.requestEndDate=i,o.tresponse=n.firstByteDate,o.tfinish=n.requestEndDate,o.responsecode=r.status,o.bytesLength=t)},r.onloadend=r.onerror=function(){-1!==a.indexOf(r)&&(a.splice(a.indexOf(r),1),l&&(l=!1,o.responsecode=r.status,i.reject(r)))},c.debug.log("[FragmentLoader]["+e+"] Load: "+n.url),r.send(),i.promise},c=function(e,t){var n=this;u.call(n,e).then(function(e){s=0,t.resolve(e)},function(i){i.aborted?(e.status=0,e.aborted=!0,t.reject(e)):s>=r?(s=0,e.status=i.status,t.reject(e)):setTimeout(function(){s++,c.call(n,e,t)},o)})};return{metricsModel:void 0,debug:void 0,tokenAuthentication:void 0,config:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,setup:function(){r=this.config.getParam("FragmentLoader.RetryAttempts","number",n),o=this.config.getParam("FragmentLoader.RetryInterval","number",i)},setType:function(t){e=t},load:function(e){var n=t.defer();return"Initialization Segment"===e.type&&e.data?n.resolve(e,{data:e.data}):c.call(this,e,n),n.promise},abort:function(){var t=0;for(t=0;t<a.length;t+=1)this.debug.log("[FragmentLoader]["+e+"] Abort XHR "+(a[t].responseURL?a[t].responseURL:"")),a[t].abort()},checkForExistence:function(e){return e?(e.deferred=t.defer(),l.call(this,e),e.deferred.promise):t.when(null)}}},d.dependencies.FragmentLoader.prototype={constructor:d.dependencies.FragmentLoader},d.dependencies.FragmentLoader.eventList={ENAME_LOADING_PROGRESS:"loadingProgress"},d.dependencies.FragmentModel=function(){"use strict";var e,t,n,i,r,o=[],s=[],a=[],l=2,u=function(r){var s,l,u=this;t.call(e,r),s=function(t,i){a.splice(a.indexOf(t),1),o.push(t),n.call(e,t,i),t.deferred=null},l=function(t){a.splice(a.indexOf(t),1),i.call(e,t),t.deferred=null},u.fragmentLoader.load(r).then(s.bind(e,r),l.bind(e,r))},c=function(e,t){var n=function(e,n){return e[t]<n[t]?-1:e[t]>n[t]?1:0};e.sort(n)},d=function(e){var t=o.indexOf(e);-1!==t&&o.splice(t,1)};return{system:void 0,debug:void 0,fragmentLoader:void 0,setContext:function(t){e=t},getContext:function(){return e},setType:function(e){e,this.fragmentLoader&&this.fragmentLoader.setType(e)},addRequest:function(e){if(e){if(this.isFragmentLoadedOrPending(e))return;s.push(e),c.call(this,s,"index")}},setCallbacks:function(e,o,s,a){t=e,r=a,i=s,n=o},isFragmentLoadedOrPending:function(e){var t,n=!1,i=0;for(i=0;i<o.length;i++)if(t=o[i],e.startTime===t.startTime||"complete"===t.action&&e.action===t.action){if(e.url===t.url){n=!0;break}o.splice(i,1),i--}if(!n)for(i=0;i<s.length;i++)t=s[i],e.url===t.url&&e.startTime===t.startTime&&(n=!0);if(!n)for(i=0;i<a.length;i++)t=a[i],e.url===t.url&&e.startTime===t.startTime&&(n=!0);return n},isReady:function(){return e.isReady()},getPendingRequests:function(){return s},getLoadingRequests:function(){return a},getLoadingTime:function(){var e,t,n=0;for(t=o.length-1;t>=0;t-=1)if(e=o[t],e.requestEndDate instanceof Date&&e.firstByteDate instanceof Date){n=e.requestEndDate.getTime()-e.firstByteDate.getTime();break}return n},getExecutedRequestForTime:function(e){var t,n=o.length-1,i=NaN,r=NaN,s=null;for(t=n;t>=0;t-=1)if(s=o[t],i=s.startTime,r=i+s.duration,!isNaN(i)&&!isNaN(r)&&e>i&&e<r)return s;return null},getExecutedRequestForQualityAndIndex:function(e,t){var n,i=o.length-1,r=null;for(n=i;n>=0;n-=1)if(r=o[n],r.quality===e&&r.index===t)return r;return null},removeExecutedRequest:function(e){d.call(this,e)},removeExecutedRequestsBeforeTime:function(e){var t,n=o.length-1,i=NaN,r=null;for(t=n;t>=0;t-=1)r=o[t],i=r.startTime,!isNaN(i)&&i<e&&d.call(this,r)},clearExecutedRequests:function(){o=[]},cancelPendingRequests:function(){s=[]},abortRequests:function(){this.fragmentLoader.abort(),a=[]},executeCurrentRequest:function(){var t,n=this;if(0!==s.length&&!(a.length>=l))switch(t=s.shift(),t.action){case"complete":o.push(t),r.call(e,t);break;case"download":a.push(t),u.call(n,t);break;default:this.debug.log("Unknown request action."),t.deferred?(t.deferred.reject(),t.deferred=null):i.call(e,t)}}}},d.dependencies.FragmentModel.prototype={constructor:d.dependencies.FragmentModel},d.dependencies.ManifestLoader=function(){"use strict";var e=2,n=500,i=e,r=n,o=null,s=function(e){var t,n="",i=0;if(e.length<1)return e;if(15360!==e.charCodeAt(0))return e;for(i=0;i<e.length;i+=1)t=e.charCodeAt(i),n+=String.fromCharCode((255&t)<<8|(65280&t)>>8);return n},a=function(e){var t=null;return-1!==e.indexOf("/")&&(-1!==e.indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),t=e.substring(0,e.lastIndexOf("/")+1)),t},l=function(){null!==o&&o.abort(),this.parser.abort()},u=function(e){var n=a(e),l=t.defer(),u=this;return o=new d.dependencies.XHRLoader,o.initialize(null,i,r),o.load(e).then(function(t){t.responseURL&&(u.debug.log("[ManifestLoader] Redirect URL: "+t.responseURL),n=a(t.responseURL)),u.tokenAuthentication.checkRequestHeaderForToken(t),u.metricsModel.addHttpRequest("stream",null,"MPD",e,null,null,t.startDate,t.endDate,t.status,null,null),u.parser.parse(s(t.responseText),n).then(function(n){n?(n.mpdUrl=e,n.mpdLoadedTime=t.endDate,u.metricsModel.addManifestUpdate("stream",n.type,t.startDate,t.endDate,n.availabilityStartTime),l.resolve(n)):l.reject()},function(t){t&&t.name&&t.message?l.reject(t):(u.debug.error("[ManifestLoader] Manifest parsing error"),l.reject({name:d.dependencies.ErrorHandler.prototype.MANIFEST_ERR_PARSE,message:"Failed to parse manifest",data:{url:e}}))})},function(t){!t||t.aborted?l.reject():(u.metricsModel.addHttpRequest("stream",null,"MPD",e,null,null,t.startDate,t.endDate,t.status,null,null),l.reject({name:d.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_MANIFEST,message:"Failed to download manifest",data:{url:e,status:t.status}}))}),l.promise};return{debug:void 0,parser:void 0,config:void 0,metricsModel:void 0,tokenAuthentication:void 0,setup:function(){i=this.config.getParam("ManifestLoader.RetryAttempts","number",e),r=this.config.getParam("ManifestLoader.RetryInterval","number",n)},load:u,abort:l}},d.dependencies.ManifestLoader.prototype={constructor:d.dependencies.ManifestLoader},d.dependencies.ManifestUpdater=function(){"use strict";var e,n=NaN,i=null,r=!1,o=function(){null!==i&&(clearInterval(i),i=null)},s=function(){o.call(this),isNaN(n)||(this.debug.log("Refresh manifest in "+n+" seconds."),i=setTimeout(l.bind(this),Math.min(1e3*n,Math.pow(2,31)-1),this))},a=function(){var e,t,i=this,r=i.manifestModel.getValue();void 0!==r&&null!==r&&(t=i.manifestExt.getRefreshDelay(r),e=((new Date).getTime()-r.mpdLoadedTime.getTime())/1e3,n=Math.max(t-e,0),s.call(i))},l=function(){var n,i,o=this;t.when(!e||e.promise).then(function(){e=t.defer(),n=o.manifestModel.getValue(),i=n.mpdUrl,n.hasOwnProperty("Location")&&(i=n.Location),o.manifestLoader.load(i).then(function(e){o.manifestModel.setValue(e),o.debug.log("Manifest has been refreshed."),r||a.call(o)})})},u=function(){e&&e.resolve()};return{debug:void 0,system:void 0,manifestModel:void 0,manifestExt:void 0,manifestLoader:void 0,setup:function(){a.call(this),this.system.mapHandler("streamsComposed",void 0,u.bind(this))},start:function(){r=!1,a.call(this)},stop:function(){r=!0,o.call(this)}}},d.dependencies.ManifestUpdater.prototype={constructor:d.dependencies.ManifestUpdater},d.models.ManifestModel=function(){"use strict";var e=null;return{system:void 0,eventBus:void 0,getValue:function(){return e},setValue:function(t){e=t,e&&this.system.notify("manifestUpdated"),null!==e&&this.eventBus.dispatchEvent({type:"manifestLoaded",data:t})}}},d.models.ManifestModel.prototype={constructor:d.models.ManifestModel},d.dependencies.MediaSourceExtensions=function(){},d.dependencies.MediaSourceExtensions.prototype={constructor:d.dependencies.MediaSourceExtensions,createMediaSource:function(){"use strict";var e="WebKitMediaSource"in window,t="MediaSource"in window;return t?new MediaSource:e?new WebKitMediaSource:null},attachMediaSource:function(e,t){"use strict";return t.setSource(window.URL.createObjectURL(e)),!0},detachMediaSource:function(e){"use strict";return e.setSource(null),!0},setDuration:function(e,t){"use strict";var n,i=!1;if("open"!==e.readyState)return e.duration;for(n=0;n<e.sourceBuffers.length;n++)if(e.sourceBuffers[n].updating){i=!0;break}return i||(e.duration=t),e.duration},signalEndOfStream:function(e){"use strict";var t=e.sourceBuffers,n=t.length,i=0;if("open"===e.readyState){for(i;i<n;i++){if(t[i].updating)return;if(0===t[i].buffered.length)return}return e.endOfStream(),!0}}},d.dependencies.MetricsExtensions=function(){"use strict";var e={42:"Baseline","4D":"Main",58:"Extended",64:"High"},t=function(e,t){var n,i,r,o,s,a,l,u;for(a=0;a<e.length;a+=1)for(n=e[a],r=n.AdaptationSet_asArray,l=0;l<r.length;l+=1)for(i=r[l],s=i.Representation_asArray,u=0;u<s.length;u+=1)if(o=s[u],t===o.id)return o;return null},n=function(e,t){var n=!1;return"video"===t?(this.manifestExt.getIsVideo(e),"video"===e.type&&(n=!0)):"audio"===t?(this.manifestExt.getIsAudio(e),"audio"===e.type&&(n=!0)):"text"===t?(this.manifestExt.getIsText(e),"text"===e.type&&(n=!0)):n=!1,n},i=d.utils.copyMethods(c.dependencies.DashMetricsExtensions);return i.config=void 0,i.getDuration=function(){var e=this,t=e.manifestModel.getValue(),n=t?t.Period.duration:null;return n!==1/0?n:-1},i.getFormatForType=function(e){var t,n=this,i=n.manifestModel.getValue(),r=0;if(!i)return null;for(r=0;r<i.Period.AdaptationSet.length;r++)if(t=i.Period.AdaptationSet[r],t.type===e)return t.mimeType;return null},i.getCodecForType=function(e){var t,n=this,i=n.manifestModel.getValue(),r=0;if(!i)return null;for(r=0;r<i.Period.AdaptationSet.length;r++)if(t=i.Period.AdaptationSet[r],t.type===e||t.contentType===e)return t.Representation_asArray[0].codecs;return null},i.getVideoWidthForRepresentation=function(e){var n,i,r=this,o=r.manifestModel.getValue();return o?(i=o.Period_asArray,n=t.call(r,i,e),null===n?null:n.width):null},i.getVideoHeightForRepresentation=function(e){var n,i,r=this,o=r.manifestModel.getValue();return o?(i=o.Period_asArray,n=t.call(r,i,e),null===n?null:n.height):null},i.getCodecsForRepresentation=function(e){var n,i=this,r=i.manifestModel.getValue(),o=r.Period_asArray;return r?(n=t.call(i,o,e),null===n?null:n.codecs):null},i.getH264ProfileLevel=function(t){if(t.indexOf("avc1")<0)return"";var n=e[t.substr(5,2)],i=parseInt(t.substr(9,2),16)/10;return n+"@"+i.toString()},i.getBitratesForType=function(e,t){var i,r,o,s,a,l,u,c,d=this,h=d.manifestModel.getValue(),f=null,p=[];if(!h)return null;if(t)f=t;else for(i=h.Period_asArray,o=0;o<i.length;o+=1)for(r=i[o],s=r.AdaptationSet_asArray,u=0;u<s.length;u+=1)if(f=s[u],n.call(d,s[u],e)){f=s[u];break}if(null!==f)for(f=d.manifestExt.processAdaptation(f),l=f.Representation_asArray,c=0;c<l.length;c+=1)a=l[c],p.push(a.bandwidth);return p},i.getBitratesWithResolutionForType=function(e){var t,i,r,o,s,a,l,u,c,d=this,h=d.manifestModel.getValue(),f=[];if(!h)return null;for(t=h.Period_asArray,r=0;r<t.length;r+=1)for(i=t[r],s=i.AdaptationSet_asArray,u=0;u<s.length;u+=1)if(o=s[u],n.call(d,o,e)){for(o=d.manifestExt.processAdaptation(o),l=o.Representation_asArray,c=0;c<l.length;c+=1){a=l[c];var p={bitrate:a.bandwidth,width:a.width,height:a.height};f.push(p)}return f}return f},i},d.dependencies.MetricsExtensions.prototype={constructor:d.dependencies.MetricsExtensions},d.models.MetricsModel=function(){"use strict";return{system:void 0,eventBus:void 0,config:void 0,streamMetrics:{},metricsChanged:function(){this.eventBus.dispatchEvent({type:"metricsChanged",data:{}})},metricChanged:function(e){this.eventBus.dispatchEvent({type:"metricChanged",data:{stream:e}}),this.metricsChanged()},metricUpdated:function(e,t,n){this.eventBus.dispatchEvent({type:"metricUpdated",data:{stream:e,metric:t,value:n}}),this.metricChanged(e)},metricAdded:function(e,t,n){this.eventBus.dispatchEvent({type:"metricAdded",data:{stream:e,metric:t,value:n}}),this.metricChanged(e)},clearAllCurrentMetrics:function(){var e=this;for(var t in this.streamMetrics)if(this.streamMetrics.hasOwnProperty(t)&&"stream"===t)delete this.streamMetrics[t];else{var n=this.config.getParamFor(t,"ABR.keepBandwidthCondition","boolean",!0);for(var i in this.streamMetrics[t])!this.streamMetrics[t].hasOwnProperty(i)||"HttpList"===i&&!1!==n||(this.streamMetrics[t][i]=[])}this.metricsChanged.call(e)},getReadOnlyMetricsFor:function(e){return this.streamMetrics.hasOwnProperty(e)?this.streamMetrics[e]:null},getMetricsFor:function(e){var t;return this.streamMetrics.hasOwnProperty(e)?t=this.streamMetrics[e]:(t=this.system.getObject("metrics"),this.streamMetrics[e]=t),t},addTcpConnection:function(e,t,n,i,r,o){var s=new d.vo.metrics.TCPConnection;return s.tcpid=t,s.dest=n,s.topen=i,s.tclose=r,s.tconnect=o,this.getMetricsFor(e).TcpList.push(s),this.metricAdded(e,"TcpConnection",s),s},addHttpRequest:function(e,t,n,i,r,o,s,a,l,u,c,h,f,p){var m=new d.vo.metrics.HTTPRequest,g=this.getMetricsFor(e).HttpList;return m.stream=e,m.tcpid=t,m.type=n,m.url=i,m.actualurl=r,m.range=o,m.trequest=s,m.tresponse=a,m.tfinish=l,m.responsecode=u,m.interval=c,m.mediaduration=h,m.startTime=f,m.quality=p,g.push(m),this.metricAdded(e,"HttpRequest",m),g.length>10&&g.shift(),m},appendHttpTrace:function(e,t,n,i){var r=new d.vo.metrics.HTTPRequest.Trace;return r.s=t,r.d=n,r.b=i,e.trace.push(r),this.metricUpdated(e.stream,"HttpRequestTrace",e),r},addRepresentationSwitch:function(e,t,n,i,r){var o=new d.vo.metrics.RepresentationSwitch;return o.t=t,o.mt=n,o.to=i,o.lto=r,this.getMetricsFor(e).RepSwitchList.push(o),this.metricAdded(e,"RepresentationSwitch",o),o},addBufferedSwitch:function(e,t,n,i){var r=new d.vo.metrics.BufferedSwitch;return r.mt=t,r.to=n,r.lto=i,this.getMetricsFor(e).BufferedSwitchList.push(r),this.metricAdded(e,"BufferedSwitch",r),r},addState:function(e,t,n,i){var r=this.getMetricsFor(e).State;if(!(r.length>0&&r[r.length-1].current===t)){var o=new d.vo.metrics.State,s=this.getMetricsFor(e).State;return o.current=t,o.position=n,o.reason=i,s.push(o),this.metricAdded(e,"State",o),s.length>10&&s.shift(),o}},addSession:function(e,t,n,i,r){var o=new d.vo.metrics.Session;return o.uri=t,o.loopMode=n?1:0,o.endTime=i,o.playerType=r,this.metricAdded(e,"Session",o),o},addCondition:function(e,t,n,i,r,o){var s=new d.vo.metrics.Condition;return s.isFullScreen=t,s.windowSize=n+"x"+i,s.fps=o,s.droppedFrames=r,this.metricAdded(e,"Condition",s),s},addMetaData:function(){this.metricAdded(null,"ManifestReady",null)},addBufferLevel:function(e,t,n){var i=new d.vo.metrics.BufferLevel,r=this.getMetricsFor(e).BufferLevel;return i.t=t,i.level=Number(n.toFixed(3)),r.push(i),this.metricAdded(e,"BufferLevel",i),r.length>10&&r.shift(),i},addDVRInfo:function(e,t,n){var i=new d.vo.metrics.DVRInfo,r=this.getMetricsFor(e).DVRInfo;return i.t=t,i.range=n,r.push(i),this.metricAdded(e,"DVRInfo",i),r.length>10&&r.shift(),i},addDroppedFrames:function(e,t){var n=new d.vo.metrics.DroppedFrames,i=this.getMetricsFor(e).DroppedFrames;return n.time=t.creationTime,n.droppedFrames=t.droppedVideoFrames,n.decodedFrameCount=t.totalVideoFrames,i.length>0&&i[i.length-1]===n?i[i.length-1]:(i.push(n),this.metricAdded(e,"DroppedFrames",n),n)},addPlaybackQuality:function(e,t,n,i){var r=new d.vo.metrics.PlaybackQuality,o=this.getMetricsFor(e).PlaybackQuality;return r.t=t,r.mt=i,r.droppedFrames=n.droppedVideoFrames,r.totalVideoFrames=n.totalVideoFrames,o.length>0&&r.droppedFrames===o[o.length-1].droppedFrames&&r.totalVideoFrames===o[o.length-1].totalVideoFrames?o[o.length-1]:(o.push(r),this.metricAdded(e,"PlaybackQuality",r),o.length>10&&o.shift(),r)},addVideoResolution:function(e,t,n,i,r){var o=new d.vo.metrics.VideoResolution,s=this.getMetricsFor(e).VideoResolution;return o.t=t,o.mt=r,o.width=n,o.height=i,s.length>0&&o.width===s[s.length-1].width&&o.height===s[s.length-1].height?s[s.length-1]:(s.push(o),this.metricAdded(e,"VideoResolution",o),o)},addManifestUpdate:function(e,t,n,i,r,o,s,a,l,u){var c=new d.vo.metrics.ManifestUpdate,h=this.getMetricsFor("stream");return c.streamType=e,c.type=t,c.requestTime=n,c.fetchTime=i,c.availabilityStartTime=r,c.presentationStartTime=o,c.clientTimeOffset=s,c.currentTime=a,c.buffered=l,c.latency=u,h.ManifestUpdate.push(c),this.metricAdded(e,"ManifestUpdate",c),c},updateManifestUpdateInfo:function(e,t){if(e&&t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);this.metricUpdated(e.streamType,"ManifestUpdate",e)}},addManifestUpdatePeriodInfo:function(e,t,n,i,r){var o=new d.vo.metrics.ManifestUpdate.PeriodInfo;return o.id=t,o.index=n,o.start=i,o.duration=r,e.periodInfo.push(o),this.metricUpdated(e.streamType,"ManifestUpdatePeriodInfo",e),o},addManifestUpdateRepresentationInfo:function(e,t,n,i,r,o,s,a){var l=new d.vo.metrics.ManifestUpdate.RepresentationInfo;return l.id=t,l.index=n,l.periodIndex=i,l.streamType=r,l.startNumber=s,l.segmentInfoType=a,l.presentationTimeOffset=o,e.representationInfo.push(l),this.metricUpdated(e.streamType,"ManifestUpdateRepresentationInfo",e),l},addPlayList:function(e,t,n,i,r){var o=new d.vo.metrics.PlayList,s=this.getMetricsFor(e).PlayList;return o.stream=e,o.start=t,o.mstart=n,o.starttype=i,o.speed=r,s.push(o),this.metricAdded(e,"PlayList",o),s.length>10&&s.shift(),o},appendPlayListTrace:function(e,t,n,i,r,o,s,a){var l=new d.vo.metrics.PlayList.Trace;return l.representationid=t,l.subreplevel=n,l.start=i,l.mstart=r,l.duration=o,l.playbackspeed=s,l.stopreason=a,e&&Array.isArray(e.trace)&&(e.trace.push(l),this.metricUpdated(e.stream,"PlayListTrace",e),e.trace.length>10&&e.trace.shift()),l}}},d.models.MetricsModel.prototype={constructor:d.models.MetricsModel},d.dependencies.Mp4Processor=function(){"use strict";var e=function(e){var t=new b.boxes.MovieHeaderBox,n=e[e.length-1];return t.version=1,t.creation_time=0,t.modification_time=0,t.timescale=n.timescale,t.duration=Math.round(n.duration*n.timescale),t.rate=65536,t.volume=256,t.reserved=0,t.reserved_2=[0,0],t.matrix=[65536,0,0,0,65536,0,0,0,1073741824],t.pre_defined=[0,0,0,0,0,0],t.next_track_ID=n.trackId+1,t.flags=0,t},t=function(e){var t,n,r;return t=new b.boxes.TrackBox,n=new b.boxes.TrackHeaderBox,n.version=1,n.flags=7,n.creation_time=0,n.modification_time=0,n.track_id=e.trackId,n.reserved=0,n.duration=Math.round(e.duration*e.timescale),n.reserved_2=[0,0],n.layer=0,n.alternate_group=0,n.volume=256,n.reserved_3=0,n.matrix=[65536,0,0,0,65536,0,0,0,1073741824],n.width=e.width<<16,n.height=e.height<<16,t.boxes.push(n),r=new b.boxes.MediaBox,r.boxes.push(i(e)),r.boxes.push(o(e)),r.boxes.push(s(e)),t.boxes.push(r),t},n=function(e){var t,n,i,r=0;return t=e.charCodeAt(0)-96<<10,n=e.charCodeAt(1)-96<<5,i=e.charCodeAt(2)-96,r=t|n|i,r},i=function(e){var t=new b.boxes.MediaHeaderBox;return t.flags=0,t.version=1,t.creation_time=0,t.modification_time=0,t.timescale=e.timescale,t.duration=Math.round(e.duration*e.timescale),t.pad=0,t.language=n(e.language),t.pre_defined=0,t},r=function(e){var t,n=0;for(t=0;t<e.length;t+=1)n|=e.charCodeAt(t)<<8*(e.length-t-1);return n},o=function(e){var t=new b.boxes.HandlerBox;switch(t.version=0,t.pre_defined=0,e.type){case"video":t.handler_type=r(t.HANDLERTYPEVIDEO),t.name=t.HANDLERVIDEONAME;break;case"audio":t.handler_type=r(t.HANDLERTYPEAUDIO),t.name=t.HANDLERAUDIONAME;break;default:t.handler_type=r(t.HANDLERTYPETEXT),t.name=t.HANDLERTEXTNAME}return t.name+="\0",t.reserved=[0,0,0],t.flags=0,t},s=function(e){var t=new b.boxes.MediaInformationBox;switch(e.type){case"video":t.boxes.push(L(e));break;case"audio":t.boxes.push(R(e));break;default:}return t.boxes.push(a(e)),t.boxes.push(A(e)),t},a=function(){var e,t,n;return e=new b.boxes.DataInformationBox,t=new b.boxes.DataReferenceBox,t.version=0,t.entry_count=1,t.flags=0,n=new b.boxes.DataEntryUrlBox,n.location="",n.version=0,n.flags=1,t.boxes.push(n),e.boxes.push(t),e},l=function(){var e=new b.boxes.TimeToSampleBox;return e.version=0,e.entry_count=0,e.flags=0,e.entry=[],e},u=function(){var e=new b.boxes.SampleToChunkBox;return e.flags=0,e.version=0,e.entry_count=0,e.entry=[],e},c=function(){var e=new b.boxes.ChunkOffsetBox;return e.version=0,e.entry_count=0,e.flags=0,e.chunk_offset=[],e},h=function(){var e=new b.boxes.SampleSizeBox;return e.version=0,e.flags=0,e.sample_count=0,e.sample_size=0,e},f=function(e){var t,n=new Uint8Array(e.length/2);for(t=0;t<e.length/2;t+=1)n[t]=parseInt(""+e[2*t]+e[2*t+1],16);return n},p=function(e,t){var n=new Uint8Array(e.length+t.length);return n.set(e,0),n.set(t,e.length),n},m=function(e){var t,n,i,r,o,s,a,l,u,c=new RegExp("^[A-Z0-9]7","gi"),d=new RegExp("^[A-Z0-9]8","gi");for(t=new b.boxes.AVCConfigurationBox,t.configurationVersion=1,t.lengthSizeMinusOne=3,t.reserved=63,t.SPS_NAL=[],t.PPS_NAL=[],n=new Uint8Array(0),i=e.codecPrivateData,r=i.split("00000001"),r.splice(0,1),o=0,s=0,a=0;a<r.length;a+=1)l=f(r[a]),r[a].match(c)&&(t.SPS_NAL[o++]={NAL_length:l.length,NAL:l},t.AVCProfileIndication=parseInt(r[a].substr(2,2),16),t.profile_compatibility=parseInt(r[a].substr(4,2),16),t.AVCLevelIndication=parseInt(r[a].substr(6,2),16)),r[a].match(d)&&(t.PPS_NAL[s++]={NAL_length:l.length,NAL:l}),u=new Uint8Array(l.length+4),u[3]=l.length,u.set(l,4),n=p(n,u);return t.numOfSequenceParameterSets=o,t.numOfPictureParameterSets=s,t},g=function(e){var t=null;return t=void 0!==e.contentProtection?new b.boxes.EncryptedVideoBox:new b.boxes.AVC1VisualSampleEntryBox,t.data_reference_index=1,t.compressorname=[10,65,86,67,32,67,111,100,105,110,103,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t.depth=24,t.reserved=[0,0,0,0,0,0],t.reserved_2=0,t.reserved_3=0,t.pre_defined=0,t.pre_defined_2=[0,0,0],t.pre_defined_3=65535,t.frame_count=1,t.horizresolution=4718592,t.vertresolution=4718592,t.height=e.height,t.width=e.width,t.boxes.push(m(e)),void 0!==e.contentProtection&&t.boxes.push(x(e)),t},y=function(e){var t=new b.boxes.OriginalFormatBox;return t.data_format=r(e.codecs.substring(0,e.codecs.indexOf("."))),t},v=function(){var e=new b.boxes.SchemeTypeBox;return e.flags=0,e.version=0,e.scheme_type=1667591779,e.scheme_version=65536,e},E=function(e){var t=new b.boxes.SchemeInformationBox;return t.boxes.push(_(e)),t},_=function(e){var t=new b.boxes.TrackEncryptionBox;return t.flags=0,t.version=0,t.default_IsEncrypted=1,t.default_IV_size=8,t.default_KID=e.contentProtection&&e.contentProtection.length>0&&e.contentProtection[0]["cenc:default_KID"]?e.contentProtection[0]["cenc:default_KID"]:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t},x=function(e){var t=new b.boxes.ProtectionSchemeInformationBox;return t.boxes.push(y(e)),t.boxes.push(v()),t.boxes.push(E(e)),t},T=function(e){var t=e.codecs.substring(0,e.codecs.indexOf("."));switch(t){case"avc1":return g(e);default:throw{name:d.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED,message:"Video codec is not supported (MP4)",data:{codec:t}}}},S=function(e){var t=[];while(e.length>=2)t.push(parseInt(e.substring(0,2),16)),e=e.substring(2,e.length);return t},w=function(e){var t,n,i,r,o,s,a;return t=S(e.codecPrivateData),n=t.length,i=new Uint8Array(2+n),i[0]=5,i[1]=n,i.set(t,2),r=13+i.length,o=new Uint8Array(2+r),o[0]=4,o[1]=r,o[2]=64,o[3]=20,o[3]|=0,o[3]|=1,o[4]=255,o[5]=255,o[6]=255,o[7]=(4278190080&e.bandwidth)>>24,o[8]=(16711680&e.bandwidth)>>16,o[9]=(65280&e.bandwidth)>>8,o[10]=255&e.bandwidth,o[11]=(4278190080&e.bandwidth)>>24,o[12]|=(16711680&e.bandwidth)>>16,o[13]|=(65280&e.bandwidth)>>8,o[14]|=255&e.bandwidth,o.set(i,15),s=3+o.length,a=new Uint8Array(2+s),a[0]=3,a[1]=s,a[2]=(65280&e.trackId)>>8,a[3]=255&e.trackId,a[4]=0,a.set(o,5),a},I=function(e){var t,n,i=null;return i=void 0!==e.contentProtection?new b.boxes.EncryptedAudioBox:new b.boxes.MP4AudioSampleEntryBox,i.reserved=[0,0,0,0,0,0],i.data_reference_index=1,i.reserved_2=[0,0],i.channelcount=e.channels,i.samplesize=16,i.pre_defined=0,i.reserved_3=0,i.samplerate=e.samplingRate<<16,t=new b.boxes.ESDBox,n=w(e),t.ES_tag=n[0],t.ES_length=n[1],t.ES_data=n.subarray(2,n.length),t.version=0,t.flags=0,i.boxes.push(t),void 0!==e.contentProtection&&i.boxes.push(x(e)),i},D=function(e){var t=e.codecs.substring(0,e.codecs.indexOf("."));switch(t){case"mp4a":return I(e);default:throw{name:d.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED,message:"Audio codec is not supported (MP4)",data:{codec:t}}}return null},M=function(e){var t=new b.boxes.SampleDescriptionBox;switch(t.version=0,t.flags=0,e.type){case"video":t.boxes.push(T(e));break;case"audio":t.boxes.push(D(e));break;default:break}return t},A=function(e){var t=new b.boxes.SampleTableBox;return t.boxes.push(l(e)),t.boxes.push(u(e)),t.boxes.push(c(e)),t.boxes.push(h(e)),t.boxes.push(M(e)),t},L=function(){var e=new b.boxes.VideoMediaHeaderBox;return e.version=0,e.flags=1,e.graphicsmode=0,e.opcolor=[0,0,0],e},R=function(){var e=new b.boxes.SoundMediaHeaderBox;return e.version=0,e.balance=0,e.reserved=0,e.flags=1,e},P=function(){var e=new b.boxes.FileTypeBox;return e.major_brand=1769172790,e.minor_brand=1,e.compatible_brands=[],e.compatible_brands[0]=1769172845,e.compatible_brands[1]=1769172790,e.compatible_brands[2]=1836278888,e},C=function(e){var t,n,i,r=e[e.length-1];for(t=new b.boxes.MovieExtendsBox,i=0;i<e.length;i+=1)r=e[i],n=new b.boxes.TrackExtendsBox,n.version=0,n.flags=0,n.track_ID=r.trackId,n.default_sample_description_index=1,n.default_sample_duration=0,n.default_sample_flags=0,n.default_sample_size=0,t.boxes.push(n);return t},N=function(e){var t,n,i,r=[];for(i=0;i<e.length;i+=1)t=new Uint8Array(e[i].initData),n=new b.boxes.ProtectionSystemSpecificHeaderBox,n.read(t,8,t.length),r.push(n);return r},B=function(n){var i,r,o,s=[];for(i=new b.boxes.MovieBox,i.boxes.push(e(n)),o=0;o<n.length;o+=1)i.boxes.push(t(n[o]));for(i.boxes.push(C(n)),o=0;o<n.length;o++)void 0!==n[o].contentProtection&&(r=this.protectionExt.getSupportedKeySystemsFromContentProtection(n[o].contentProtection),i.boxes.push.apply(i.boxes,N(r)));return s.push(P()),s.push(i),s},F=1,k=function(){var e=new b.boxes.MovieFragmentHeaderBox;return e.version=0,e.flags=0,e.sequence_number=F++,e},O=function(e){var t=new b.boxes.TrackFragmentBox;return t.version=0,t.flags=0,t.boxes.push(U(e)),t.boxes.push(H(e)),t.boxes.push(j(e)),t.boxes.push(V(e)),t},U=function(e){var t=new b.boxes.TrackFragmentHeaderBox;return t.version=0,t.flags=131072,t.track_ID=e.trackId,t},H=function(e){var t=new b.boxes.TrackFragmentBaseMediaDecodeTimeBox;return t.version=1,t.flags=0,t.baseMediaDecodeTime=e.samples.length>0?e.samples[0].dts:0,t},j=function(e){var t,n,i,r=new b.boxes.TrackFragmentRunBox;for(e.samples[0].cts,n=e.samples[0].duration>0?256:0,r.version=0,r.flags=1537|n|("video"===e.type?2048:0),r.data_offset=0,r.samples_table=[],r.sample_count=e.samples.length,t=0;t<e.samples.length;t++)i={sample_duration:e.samples[t].duration,sample_size:e.samples[t].size,sample_composition_time_offset:e.samples[t].cts-e.samples[t].dts,sample_flags:e.samples[t].flags},i.sample_composition_time_offset<0&&(r.version=1),r.samples_table.push(i);return r},V=function(e){var t,n=new b.boxes.SampleDependencyTableBox;for(n.version=0,n.flags=0,n.sample_dependency_table=[],t=0;t<e.samples.length;t++)n.sample_dependency_table.push((267386880&e.samples[t].flags)>>20);return n},K=function(e){var t=new b.boxes.MediaDataBox;return t.data=e.data,t},q=function(e){var t,n,i,r,o=[],s=0,a={},l=[],u=0;if(t=new b.boxes.MovieFragmentBox,t.boxes.push(k()),e)for(n=0;n<e.length;n+=1)t.boxes.push(O(e[n]));if(o.push(t),t.computeLength(),i=t.size,r=t.getBoxesByType("traf"),i+=8,e&&e.length&&(l=[e.length]),e)for(n=0;n<e.length;n+=1)r[n].getBoxByType("trun").data_offset=i,i+=e[n].data.length,l[n]=e[n].data,s+=l[n].length;for(a.data=new Uint8Array(s),n=0;n<l.length;n++)a.data.set(l[n],u),u+=l[n].length;return o.push(K(a)),o};return{protectionExt:void 0,generateInitSegment:function(e){var t=new b.boxes.File;return t.boxes=B.call(this,e),b.serialize(t)},generateMediaSegment:function(e){var t=new b.boxes.File;return t.boxes=q.call(this,e),b.serialize(t)},generateInitMediaSegment:function(e){var t=new b.boxes.File;return t.boxes=B.call(this,e),t.boxes=t.boxes.concat(q.call(this,e)),b.serialize(t)}}},d.dependencies.Mp4Processor.prototype={constructor:d.dependencies.Mp4Processor},d.dependencies.Notifier=function(){"use strict";var e,t="observableId",n=0,i=function(){return this[t]||(n+=1,this[t]="_id_"+n),this[t]};return{system:void 0,setup:function(){e=this.system,e.mapValue("notify",this.notify),e.mapValue("subscribe",this.subscribe),e.mapValue("unsubscribe",this.unsubscribe)},notify:function(){var t=arguments[0]+i.call(this),n=new d.vo.Event;n.sender=this,n.type=arguments[0],n.data=arguments[1],n.error=arguments[2],n.timestamp=(new Date).getTime(),e.notify.call(e,t,n)},subscribe:function(t,n,r,o){if(!r&&n[t]&&(r=n[t]=n[t].bind(n)),!n)throw"observer object cannot be null or undefined";if(!r)throw"event handler cannot be null or undefined";t+=i.call(this),e.mapHandler(t,void 0,r,o)},unsubscribe:function(t,n,r){r=r||n[t],t+=i.call(this),e.unmapHandler(t,void 0,r)}}},d.dependencies.Notifier.prototype={constructor:d.dependencies.Notifier},d.dependencies.Parser=function(){"use strict";var e=null,n=function(n,i){if(null===e)if(n.indexOf("SmoothStreamingMedia")>-1&&"undefined"!==typeof this.mssParser)this.system.notify("setContext","MSS"),e=this.mssParser;else if(n.indexOf("#EXTM3U")>-1&&"undefined"!==typeof this.hlsParser)this.system.notify("setContext","HLS"),e=this.hlsParser;else{if(!(n.indexOf("MPD")>-1&&"undefined"!==typeof this.dashParser))return t.reject("manifest cannot be parsed, protocol is unsupported!");this.system.notify("setContext","MPD"),e=this.dashParser}return e.parse(n,i)},i=function(){null!==e&&void 0!==e.abort&&e.abort()},r=function(){e=null};return{debug:void 0,system:void 0,dashParser:void 0,mssParser:void 0,hlsParser:void 0,metricsModel:void 0,parse:n,abort:i,reset:r}},d.dependencies.Parser.prototype={constructor:d.dependencies.Parser},d.dependencies.SourceBufferExtensions=function(){"use strict";this.system=void 0,this.manifestExt=void 0},d.dependencies.SourceBufferExtensions.prototype={constructor:d.dependencies.SourceBufferExtensions,createSourceBuffer:function(e,t){"use strict";var n=null;if(!e)return null;try{n=e.addSourceBuffer(t)}catch(i){if(!this.manifestExt.getIsTextTrack(t))throw i;if("text/vtt"===t||"text/ttml"===t)n=this.system.getObject("textSourceBuffer");else{if("application/ttml+xml+mp4"!==t&&"application/mp4"!==t&&"application/ttml+xml"!==t)throw i;n=this.system.getObject("textTTMLXMLMP4SourceBuffer")}}return n},removeSourceBuffer:function(e,t){"use strict";try{e.removeSourceBuffer(t)}catch(n){}},getBufferRange:function(e,t,n){"use strict";var i,r,o=null,s=0,a=0,l=null,u=null,c=0,d=n||.03;try{o=e.buffered}catch(h){return null}if(o){for(r=0,i=o.length;r<i;r+=1)if(s=o.start(r),a=o.end(r),null===l){if(c=Math.abs(s-t),t>=s&&t<a){l=s,u=a;continue}if(c<=d){l=s,u=a;continue}}else{if(c=s-u,!(c<=d))break;u=a}if(null!==l)return{start:l,end:u}}return null},getAllRanges:function(e){var t=null;try{return t=e.buffered,t}catch(n){return null}},getBufferLength:function(e,t,n){"use strict";var i,r,o=this;return i=o.getBufferRange(e,t,n),r=null===i?0:i.end-t,r},waitForUpdateEnd:function(e){"use strict";var n,i=t.defer(),r=50,o=function(){e.updating||(clearInterval(n),i.resolve(!0))},s=function(){e.updating||(e.removeEventListener("updateend",s,!1),i.resolve(!0))};if(!e.updating)return i.resolve(!0),i.promise;if("function"===typeof e.addEventListener)try{e.addEventListener("updateend",s,!1)}catch(a){n=setInterval(o,r)}else n=setInterval(o,r);return i.promise},append:function(e,n,i){var r=t.defer(),o=this;return o.waitForUpdateEnd(e).then(function(){try{"append"in e?e.append(n,i):"appendBuffer"in e&&e.appendBuffer(n),o.waitForUpdateEnd(e,i).then(function(){r.resolve()})}catch(t){r.reject({err:t,data:n})}}),r.promise},remove:function(e,n,i,r,o){var s=t.defer(),a=this;return a.waitForUpdateEnd(e).then(function(){try{n>=0&&n<r&&i>n&&"ended"!==o.readyState&&e.remove(n,i),isNaN(i)&&"ended"!==o.readyState&&e.remove(n),a.waitForUpdateEnd(e).then(function(){s.resolve()})}catch(t){s.reject(t)}}),s.promise},abort:function(e,t){"use strict";try{"open"===e.readyState&&t.abort()}catch(n){}}},Math.sign||(Math.sign=function(e){"use strict";return e<0?-1:0===e?0:1}),d.dependencies.Stream=function(){"use strict";var e,n,i,r,o,s,a,l,u,c,h,f,p,m,g,y,v,b,E,_,x,T,S,w,I,D,M,A,L=null,R=null,P=-1,C=null,N=-1,B=null,F=!1,k=!1,O=null,U=null,H=null,j=-1,V=!0,K=!1,q=!1,z="und",Y="und",$=null,W=-1,G=-1,X="Stopped",Q=1,J=!1,Z=!1,ee=null,te=!0,ne=null,ie=!1,re=-1,oe=-1,se=function(e){this.errHandler.sendError(e.data.code,e.data.message,e.data.data)},ae=function(){K&&(this.debug.info("[Stream] Play."),this.videoModel.play())},le=function(){this.debug.info("[Stream] Pause."),this.videoModel.pause()},ue=function(t,n){K&&(this.debug.info("[Stream] Seek: "+t),this.manifestExt.getIsDynamic(e)&&!ie&&0!==this.videoModel.getCurrentTime()&&ye.call(this),!0===n?(b=t,this.system.unmapHandler("bufferUpdated"),this.system.mapHandler("bufferUpdated",void 0,qe.bind(this)),Fe.call(this,b)):this.videoModel.setCurrentTime(t))},ce=function(e){var n=t.defer(),i=this,r=function(){e.removeEventListener("sourceopen",r),e.removeEventListener("webkitsourceopen",r),n.resolve(e)};return e.addEventListener("sourceopen",r,!1),e.addEventListener("webkitsourceopen",r,!1),i.mediaSourceExt.attachMediaSource(e,i.videoModel),n.promise},de=function(){var i=this,r=[],o=t.defer(),s=function(){R&&r.push(R.reset(q)),O&&r.push(O.reset(q)),C&&r.push(C.reset(q)),U&&r.push(U.reset(q)),B&&r.push(B.reset(q)),H&&r.push(H.reset(q)),t.all(r).then(function(){ee&&(ee.reset(),ee=void 0),n&&i.mediaSourceExt.detachMediaSource(i.videoModel),K=!1,L=null,R=null,C=null,B=null,n=null,e=null,o.resolve()})};return t.when(te).then(function(){s()}),o.promise},he=function(e,t){var i=null,r=null;if(("video"===e.type||"audio"===e.type)&&!this.capabilities.supportsCodec(this.videoModel.getElement(),t))return this.errHandler.sendError(d.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED,"Codec is not supported (HTMLMediaElement)",{codec:t}),null;try{r=this.sourceBufferExt.createSourceBuffer(n,t)}catch(o){return this.errHandler.sendError(d.dependencies.ErrorHandler.prototype.MEDIA_ERR_CREATE_SOURCEBUFFER,"Failed to create "+e.type+" source buffer",new d.vo.Error(o.code,o.name,o.message)),null}return i=this.system.getObject("bufferController"),i.initialize(e.type,$,e,r,this.fragmentController,n,ee),"text"===e.type&&r.hasOwnProperty("initialize")&&r.initialize(t,i,e),i},fe=function(t,n){if("MSS"!==e.name||!this.manifestExt.getIsDynamic(e)&&!this.manifestExt.getIsStartOver(e))return null;var i=null;return t&&n&&n.type&&(i=this.system.getObject("mssFragmentInfoController"),i.initialize(n.type,this.fragmentController,t)),i},pe=function(){var n,i,r=null,o=null,s=null,a=this;return n=this.manifestExt.getVideoData(e,$.index),n&&(s=this.manifestExt.getCodec(n),L=this.manifestExt.getContentProtectionData(n)),n=this.manifestExt.getSpecificAudioData(e,$.index,z),n&&(o=this.manifestExt.getCodec(n)),L?this.capabilities.supportsEncryptedMedia()?A?(r=t.defer(),i={},i[d.dependencies.ProtectionController.eventList.ENAME_KEY_SYSTEM_SELECTED]=function(){a.debug.log("[Stream] ProtectionController initialized"),A.unsubscribe(d.dependencies.ProtectionController.eventList.ENAME_KEY_SYSTEM_SELECTED,i),r.resolve(!0)},A.subscribe(d.dependencies.ProtectionController.eventList.ENAME_KEY_SYSTEM_SELECTED,i),this.debug.log("[Stream] Initialize ProtectionController"),A.init(L,o,s),r.promise):t.when(!0):(this.errHandler.sendError(d.dependencies.ErrorHandler.prototype.CAPABILITY_ERR_MEDIAKEYS,"EME is not supported/enabled",null),t.when(!1)):t.when(!0)},me=function(){var t,n,i,r;if(e)if(te=!1,ee=this.system.getObject("eventController"),t=this.manifestExt.getVideoData(e,$.index),null===t?this.errHandler.sendError(d.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_VIDEO,"No Video data in manifest"):($e.call(this,t),P=this.manifestExt.getDataIndex(t,e,$.index),n=this.manifestExt.getCodec(t),L=this.manifestExt.getContentProtectionData(t),null===n?this.errHandler.sendError(d.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED,"Video codec information not available",{codec:""}):(R=he.call(this,t,n),O=fe.call(this,R,t))),null!==R){if(t=this.manifestExt.getSpecificAudioData(e,$.index,z),null===t)this.errHandler.sendWarning(d.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_AUDIO,"No audio data in manifest");else if($e.call(this,t),N=this.manifestExt.getDataIndex(t,e,$.index),i=this.manifestExt.getCodec(t),null===i)this.errHandler.sendWarning(d.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED,"Audio codec information not available",{codec:""});else{if(C=he.call(this,t,i),null===C)return void(te=!0);U=fe.call(this,C,t)}t=this.manifestExt.getSpecificTextData(e,$.index,Y),null!==t&&(j=this.manifestExt.getDataIndex(t,e,$.index),r=this.manifestExt.getMimeType(t),null===r?this.errHandler.sendWarning(d.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_TEXT,"Text codec information not available"):(B=he.call(this,t,r),H=fe.call(this,B,t))),ee&&ee.addInlineEvents(this.manifestExt.getEventsForPeriod(e,$)),te=!0}else te=!0},ge=function(){this.debug.log("[Stream] Setting duration: "+$.duration),this.mediaSourceExt.setDuration(n,$.duration),K=!0},ye=function(){"MSS"===e.name&&(this.manifestExt.getIsDynamic(e)||this.manifestExt.getIsStartOver(e))&&(O&&!1===k&&(k=!0,O.start(R.getSegmentDuration())),U&&U.start(C.getSegmentDuration()),H&&F&&H.start(B.getSegmentDuration()))},ve=function(){O&&(k=!1,O.stop()),U&&U.stop(),H&&H.stop()},be=function(){this.debug.info("[Stream] <video> loadedmetadata event")},Ee=function(){this.debug.info("[Stream] <video> canplay event")},_e=function(){this.debug.info("[Stream] <video> playing event"),this.metricsModel.addState("video","playing",this.getVideoModel().getCurrentTime()),re=(new Date).getTime()/1e3,oe=this.getVideoModel().getCurrentTime()},xe=function(){this.debug.info("[Stream] <video> loadstart event")},Te=function(){this.debug.info("[Stream] <video> play event"),this.videoModel.listen("pause",s),1!==Q?this.setTrickModeSpeed(1):G>=0?(je.call(this,G),G=-1):Fe.call(this),this.metricsModel.addPlayList("video",(new Date).getTime(),this.videoModel.getCurrentTime(),"play")},Se=function(){this.debug.info("[Stream] <video> ended event"),this.metricsModel.addState("video","stopped",this.videoModel.getCurrentTime(),1),this.manifestExt.getIsStartOver(e)&&ve.call(this)},we=function(){this.debug.info("[Stream] <video> pause event"),re=-1,oe=-1,1===Q&&(this.metricsModel.addState("video","paused",this.videoModel.getCurrentTime()),this.metricsModel.addPlayList("video",(new Date).getTime(),this.videoModel.getCurrentTime(),"pause")),Ue.call(this),"MSS"===e.name&&this.manifestExt.getIsDynamic(e)&&ye.call(this)},Ie=function(e){var t,n=e.target.error,i="[Stream] <video> error: ";if(-1!==n.code){switch(n.code){case 1:t=d.dependencies.ErrorHandler.prototype.MEDIA_ERR_ABORTED,i+="fetching process aborted";break;case 2:t=d.dependencies.ErrorHandler.prototype.MEDIA_ERR_NETWORK,i+="network error";break;case 3:t=d.dependencies.ErrorHandler.prototype.MEDIA_ERR_DECODE,i+="media decoding error";break;case 4:t=d.dependencies.ErrorHandler.prototype.MEDIA_ERR_SRC_NOT_SUPPORTED,i+="media format not supported";break;case 5:t=d.dependencies.ErrorHandler.prototype.MEDIA_ERR_ENCRYPTED,i+="media is encrypted";break}q=!0,this.errHandler.sendError(t,i)}},De=function(){var e=this.videoModel.getCurrentTime(),t=this.videoModel.getDuration();if(this.debug.info("[Stream] <video> seeking event: "+e),1===Q||e.toFixed(3)===M.toFixed(3)){e=e<this.getStartTime()?this.getStartTime():e;var n=this.config.getParam("backoffSeekToEnd","number",2);t!==1/0&&e>=t-n?je.call(this,t-n):(1===Q&&(this.metricsModel.addState("video","seeking",this.getVideoModel().getCurrentTime()),this.metricsModel.addPlayList("video",(new Date).getTime(),e,d.vo.metrics.PlayList.SEEK_START_REASON)),Fe.call(this,e))}else this.setTrickModeSpeed(1)},Me=function(){var e,t,n,i,r,o,s,a,u,c=this,d=.9,h=function(e,t){if(c.videoModel.getCurrentTime()===c.getStartTime()||J)return c.debug.log("[Stream] Trick mode (x"+Q+"): stop"),void(J&&(a=document.createEvent("Event"),a.initEvent("ended",!0,!0),c.videoModel.getElement().dispatchEvent(a)));t<c.getStartTime()?t=c.getStartTime():t>=c.videoModel.getDuration()&&(t=c.videoModel.getDuration()-S,J=!0),e>0&&c.debug.log("[Stream] Trick mode (x"+Q+"): wait "+e.toFixed(3)+" s"),D=setTimeout(function(){I=(new Date).getTime()/1e3,c.debug.log("[Stream] Trick mode (x"+Q+"): seek time = "+t.toFixed(3)),M=t,c.videoModel.setCurrentTime(t)},e>0?1e3*e:0)};if(this.debug.info("[Stream] <video> seeked event"),Oe.call(this),1!==Q){if(e=(new Date).getTime()/1e3,t=c.videoModel.getCurrentTime(),n=e-x,i=e-I,r=Math.abs(t-T),o=r/n,c.debug.log("[Stream] Trick mode (x"+Q+"): elapsed time = "+n.toFixed(3)+", elapsed video time = "+r.toFixed(3)+", speed = "+o.toFixed(3)),"Changed"===X)clearTimeout(D),X="Running",x=(new Date).getTime()/1e3,T=t,c.debug.info("[Stream] Trick mode (x"+Q+"): videoTime = "+T),w=Math.abs(_/Q)>1?w/Math.abs(_/Q):w,s=t+w*Math.sign(Q),u=0;else if(o<Math.abs(Q)*d){var f=Math.abs(Q/o);w*=Math.round(f)+Math.round(f%S),c.debug.info("[Stream] Trick mode (x"+Q+"): seek step = "+w),s=t+w*Math.sign(Q),u=0}else s=t+w*Math.sign(Q),u=Math.abs(s-T)/Math.abs(Q)-n-i;h.call(c,u,s)}this.videoModel.listen("seeking",l),ie=!1,re=-1,oe=-1},Ae=function(){this.debug.info("[Stream] <video> progress event"),Be.call(this)},Le=function(){this.debug.info("[Stream] <video> timeupdate event: "+this.videoModel.getCurrentTime()),Be.call(this)},Re=function(){this.debug.info("[Stream] <video> waiting event"),this.getVideoModel().isSeeking()||this.metricsModel.addState("video","buffering",this.getVideoModel().getCurrentTime())},Pe=function(){var e=this.videoModel.getDuration();this.debug.info("[Stream] <video> durationchange event: "+e)},Ce=function(){this.debug.info("[Stream] <video> ratechange event: "+this.videoModel.getPlaybackRate()),R&&R.updateStalledState(),C&&C.updateStalledState(),B&&B.updateStalledState()},Ne=function(){le.call(this),ie=!0,this.system.notify("manifestUpdate",!0)},Be=function(){R&&R.updateBufferLevel(!0),C&&C.updateBufferLevel(!0),B&&B.updateBufferLevel(!0)},Fe=function(e){this.debug.log("[Stream] startBuffering"+(void 0===e?"":" at time "+e)),R&&(void 0===e?R.start():R.seek(e)),C&&(void 0===e?C.start():C.seek(e)),B&&F&&1===Q&&(void 0===e?B.start():B.seek(e))},ke=function(){this.debug.log("[Stream] stopBuffering"),R&&R.stop(),C&&C.stop(),B&&B.stop()},Oe=function(){R&&R.seeked(),C&&C.seeked(),B&&B.seeked()},Ue=function(){this.scheduleWhilePaused&&!this.manifestExt.getIsDynamic(e)||ke.call(this),clearInterval(E)},He=function(t){var i=this;e=t,i.debug.log("[Stream] Create MediaSource");try{n=i.mediaSourceExt.createMediaSource()}catch(r){i.errHandler.sendError(d.dependencies.ErrorHandler.prototype.MEDIA_ERR_CREATE_MEDIASOURCE,"Failed to create MediaSource",{name:r.name,message:r.message})}null!==n&&pe.call(i).then(function(){i.debug.log("[Stream] Setup MediaSource"),ce.call(i,n).then(function(e){n=e,i.debug.log("[Stream] Initialize MediaSource"),me.call(i),i.debug.log("[Stream] Initialize playback"),ge.call(i),i.debug.log("[Stream] Playback initialized")})})},je=function(e){this.debug.log("[Stream] Set video model current time: "+e),this.videoModel.unlisten("seeking",l),this.videoModel.setCurrentTime(e)},Ve=function(){R&&!R.isBufferingCompleted()||C&&!C.isBufferingCompleted()||n&&(this.videoModel.unlisten("pause",s),this.debug.info("[Stream] Signal end of stream"),this.mediaSourceExt.signalEndOfStream(n))},Ke=function(t){this.debug.info("[Stream] Start time = "+t),-1!==W&&!this.manifestExt.getIsDynamic(e)&&W<$.duration&&(this.debug.info("[Stream] Initial start time = "+W),t=W),ue.call(this,t,0===$.index&&V)},qe=function(){var t,n,i;if(this.debug.info("[Stream] Check start time"),t=this.sourceBufferExt.getBufferRange(R.getBuffer(),b,R.getSegmentDuration()),null!==t&&(i=Math.max(b,t.start),!(t.end<i))){if(C){if(n=this.sourceBufferExt.getBufferRange(C.getBuffer(),b,C.getSegmentDuration()),null===n)return;if(this.debug.info("[Stream] Check start time: A["+n.start+"-"+n.end+"], V["+t.start+"-"+t.end+"]"),n.end<i)return;i=Math.max(i,n.start)}this.debug.info("[Stream] Check start time: OK => "+i),this.system.unmapHandler("bufferUpdated"),this.videoModel.isPaused()?G=i:je.call(this,i),this.manifestExt.getIsStartOver(e)&&ye.call(this),ae.call(this)}},ze=function(t){this.debug.info("[Stream] Source duration changed: "+t),this.mediaSourceExt.setDuration(n,t),e.mediaPresentationDuration=t,$.duration=t},Ye=function(t,n,i){var r=-1;return t?-1===i?i:(r=this.manifestExt.getDataIndex(n,e,$.index),r!==i&&("MSS"===e.name&&(this.manifestExt.getIsDynamic(e)||this.manifestExt.getIsStartOver(e))?this.system.notify("manifestUpdate"):t.updateData(n,$)),r):i},$e=function(e){var t,n;n=1;while(n<e.Representation_asArray.length)t=this.manifestExt.getCodecForRepresentation(e.Representation_asArray[n]),t&&(this.capabilities.supportsCodec(this.videoModel.getElement(),t)||(this.debug.warn("[Stream] codec not supported: "+t),e.Representation_asArray.splice(n,1),n--)),n++},We=function(t){var n,i;if(e=this.manifestModel.getValue(),$=t,this.debug.log("[Stream] Manifest updated ... set new data on buffers."),R&&(n=R.getData(),i=n&&n.hasOwnProperty("id")?this.manifestExt.getDataForId(n.id,e,$.index):this.manifestExt.getDataForIndex(P,e,$.index),$e.call(this,i),R.updateData(i,$)),C&&(i=this.manifestExt.getDataForIndex(N,e,$.index),$e.call(this,i),C.updateData(i,$)),B&&(i=this.manifestExt.getDataForIndex(j,e,$.index),B.updateData(i,$)),ee){var r=this.manifestExt.getEventsForPeriod(e,$);ee.addInlineEvents(r)}ie&&R&&(this.system.unmapHandler("bufferUpdated"),this.system.mapHandler("bufferUpdated",void 0,qe.bind(this)),R.load()),k&&ye.call(this)},Ge=function(){var e=this.videoModel.getCurrentTime();B.seek(e),B.seeked()},Xe=function(t){var n=this;if(this.debug.log("[Stream] Segment loading failed: start time = "+t.startTime+", duration = "+t.duration),(this.manifestExt.getIsDynamic(e)||this.manifestExt.getIsStartOver(e))&&null===ne){ie=!0;var i=t.duration;this.debug.info("[Stream] Reload session in "+i+" s."),ne=setTimeout(function(){ne=null,ie=!0,n.debug.info("[Stream] Reload session (update manifest)"),n.system.notify("manifestUpdate",!0),ve.call(n)},1e3*i)}else ue.call(this,t.startTime+t.duration)},Qe=function(){if(!0!==document.hidden&&-1!==re){var e=(new Date).getTime()/1e3,t=this.getVideoModel().getCurrentTime(),n=e-re,i=t-oe;this.debug.log("[Stream] VisibilityChange: elapsedClockTime = "+n+", elapsedStreamTime = "+i+" ("+(n-i)+")"),n-i>1&&Ne.call(this)}};return{system:void 0,videoModel:void 0,manifestLoader:void 0,manifestModel:void 0,mediaSourceExt:void 0,sourceBufferExt:void 0,manifestExt:void 0,fragmentController:void 0,fragmentExt:void 0,protectionExt:void 0,capabilities:void 0,debug:void 0,metricsExt:void 0,errHandler:void 0,timelineConverter:void 0,scheduleWhilePaused:void 0,textTrackExtensions:void 0,metricsModel:void 0,eventBus:void 0,notify:void 0,config:void 0,setup:function(){this.system.mapHandler("startTimeFound",void 0,Ke.bind(this)),this.system.mapHandler("segmentLoadingFailed",void 0,Xe.bind(this)),this.system.mapHandler("bufferingCompleted",void 0,Ve.bind(this)),this.system.mapHandler("sourceDurationChanged",void 0,ze.bind(this)),d.dependencies.ProtectionController&&(this[d.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR]=se.bind(this)),o=Te.bind(this),s=we.bind(this),a=Ie.bind(this),l=De.bind(this),u=Me.bind(this),c=Re.bind(this),p=Ae.bind(this),m=Ce.bind(this),h=Le.bind(this),f=Pe.bind(this),r=be.bind(this),g=Ee.bind(this),y=_e.bind(this),v=xe.bind(this),i=Se.bind(this),Qe.bind(this)},load:function(e,t){$=t,He.call(this,e)},setVideoModel:function(e){this.videoModel=e,this.videoModel.listen("play",o),this.videoModel.listen("pause",s),this.videoModel.listen("error",a),this.videoModel.listen("seeking",l),this.videoModel.listen("seeked",u),this.videoModel.listen("waiting",c),this.videoModel.listen("timeupdate",h),this.videoModel.listen("durationchange",f),this.videoModel.listen("progress",p),this.videoModel.listen("ratechange",m),this.videoModel.listen("loadedmetadata",r),this.videoModel.listen("ended",i),this.videoModel.listen("canplay",g),this.videoModel.listen("playing",y),this.videoModel.listen("loadstart",v)},setInitialStartTime:function(e){var t=parseFloat(e);isNaN(t)||(W=t)},getAudioTracks:function(){return this.manifestExt.getAudioDatas(e,$.index)},setAudioTrack:function(e){U&&U.stop(),N=Ye.call(this,C,e,N)},getSelectedAudioTrack:function(){if(C)return this.manifestExt.getDataForIndex(N,e,$.index)},getSubtitleTracks:function(){return this.manifestExt.getTextDatas(e,$.index)},setSubtitleTrack:function(e){H&&H.stop(),j=Ye.call(this,B,e,j)},getSelectedSubtitleTrack:function(){if(B&&F)return this.manifestExt.getDataForIndex(j,e,$.index)},initProtection:function(e){A=e,A&&A.subscribe(d.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,this)},getVideoModel:function(){return this.videoModel},getManifestExt:function(){var e=this;return e.manifestExt},setAutoPlay:function(e){V=e},setDefaultAudioLang:function(e){z=e},setDefaultSubtitleLang:function(e){Y=e},getAutoPlay:function(){return V},reset:function(){var e=t.defer(),n=this;return this.debug.info("[Stream] Reset"),ke.call(this),ve.call(this),le.call(this),clearTimeout(D),clearTimeout(ne),1!==Q&&this.videoModel.setMute(Z),this.videoModel.unlisten("play",o),this.videoModel.unlisten("pause",s),this.videoModel.unlisten("error",a),this.videoModel.unlisten("seeking",l),this.videoModel.unlisten("seeked",u),this.videoModel.unlisten("waiting",c),this.videoModel.unlisten("timeupdate",h),this.videoModel.unlisten("durationchange",f),this.videoModel.unlisten("progress",p),this.videoModel.unlisten("ratechange",m),this.videoModel.unlisten("loadedmetadata",r),this.videoModel.unlisten("ended",i),this.videoModel.unlisten("canplay",g),this.videoModel.unlisten("playing",y),this.videoModel.unlisten("loadstart",v),this.system.unmapHandler("streamsComposed",void 0,Ge),this.system.unmapHandler("bufferUpdated"),this.system.unmapHandler("startTimeFound"),this.system.unmapHandler("segmentLoadingFailed"),this.system.unmapHandler("bufferingCompleted"),this.system.unmapHandler("sourceDurationChanged"),de.call(this).then(function(){A&&A.unsubscribe(d.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,n),A=void 0,n.fragmentController=void 0,e.resolve()}),e.promise},getDuration:function(){return $.duration},getStartTime:function(){return $.start},getPeriodIndex:function(){return $.index},getId:function(){return $.id},getPeriodInfo:function(){return $},getMinbufferTime:function(){return R?R.getMinbufferTime():d.dependencies.BufferExtensions.DEFAULT_MIN_BUFFER_TIME},getLiveDelay:function(){return R?R.getLiveDelay():d.dependencies.BufferExtensions.DEFAULT_LIVE_DELAY},startEventController:function(){ee.start()},resetEventController:function(){ee.reset()},enableSubtitles:function(t){var n;t!==F&&(F=t,n=this.textTrackExtensions.getCurrentTextTrack(this.videoModel.getElement()),this.textTrackExtensions.cleanSubtitles(),B&&(t?("MSS"===e.name&&(this.manifestExt.getIsDynamic(e)||this.manifestExt.getIsStartOver(e))?(this.system.mapHandler("streamsComposed",void 0,Ge.bind(this),!0),this.system.notify("manifestUpdate")):Ge.call(this),n&&"metadata"!==n.kind&&"showing"!==n.mode?n.mode="showing":n&&(n.mode="hidden")):(H&&H.stop(),n&&(n.mode="disabled"),B.stop())))},setTrickModeSpeed:function(e){var n,i,r=[],o=this,a=1!==e,l=function(){o.videoModel.getCurrentTime()>n+1&&(o.videoModel.unlisten("timeupdate",l),o.debug.info("[Stream] Set mute: "+Z+", the mute state before using trick mode."),o.videoModel.setMute(Z))};e!==Q&&R&&(o.debug.info("[Stream] Trick mode: speed = "+e),a&&"Stopped"===X?(this.videoModel.unlisten("pause",s),o.debug.info("[Stream] Set mute: true"),Z=o.videoModel.getMute(),Z||o.videoModel.setMute(!0),o.videoModel.pause()):a||(o.metricsModel.addPlayList("video",(new Date).getTime(),T,"trickMode",Q),Q=1,clearTimeout(D),ke.call(o)),r.push(R.setTrickMode(a,e>1)),C&&r.push(C.setTrickMode(a,e>1)),t.all(r).then(function(){_=Q,Q=e,n=o.videoModel.getCurrentTime(),a?"Running"===X?(o.metricsModel.addPlayList("video",(new Date).getTime(),T,"trickMode",_),X="Changed"):"Stopped"===X&&(J=!1,X="Running",w=S=R.getSegmentDuration(),x=I=(new Date).getTime()/1e3,T=n,o.debug.info("[Stream] Trick mode (x"+Q+"): videoTime = "+T),i=n+w*Math.sign(Q),i=Math.round(1e3*(i-i%S))/1e3,o.debug.info("[Stream] Trick mode (x"+Q+"): seek step = "+w),M=i,ue.call(o,i)):(o.videoModel.listen("pause",s),o.debug.info("[Stream] Trick mode: Stopped, current time = "+n),X="Stopped",o.videoModel.listen("timeupdate",l),n=J?o.getStartTime():n,ue.call(o,n,!0))}))},getTrickModeSpeed:function(){return Q},updateData:We,play:ae,seek:ue,pause:le}},d.dependencies.Stream.prototype={constructor:d.dependencies.Stream},d.dependencies.StreamController=function(){"use strict";var e,n,i,r,o,s,a,l,u,c=!1,h=[],f=!1,p=6,m=.2,g=!0,y=!1,v="und",b="und",E=!1,x=!1,T=null,S="Safari"===_().name,w=function(e,t){var n=e.getElement(),i=t.getElement();return i.parentNode||n.parentNode.insertBefore(i,n),n.style.width="0px",i.style.width="100%",M(n,i),D.call(this,e),I.call(this,t),!0},I=function(e){e.listen("seeking",o),e.listen("progress",s),e.listen("timeupdate",r),e.listen("pause",a),e.listen("play",l)},D=function(e){e.unlisten("seeking",o),e.unlisten("progress",s),e.unlisten("timeupdate",r),e.unlisten("pause",a),e.unlisten("play",l)},M=function(e,t){["controls","loop","muted","playbackRate","volume"].forEach(function(n){t[n]=e[n]})},A=function(){var e=n.getVideoModel().getElement().buffered;if(e.length){var t=e.length-1,i=e.end(t),r=n.getStartTime()+n.getDuration()-i;r<p&&(n.getVideoModel().unlisten("progress",s),B())}},L=function(e,t,i){!y&&e&&t&&e!==t&&(y=!0,e.pause(),n=t,w.call(this,e.getVideoModel(),t.getVideoModel()),i?this.seek(e.getVideoModel().getCurrentTime()):this.seek(t.getStartTime()),this.play(),e.resetEventController(),n.startEventController(),y=!1)},R=function(){if(n){var e=this,t=new Date,i=n.getStartTime()+n.getDuration(),r=n.getVideoModel().getElement(),o=r.currentTime,s=e.videoExt.getPlaybackQuality(r);s&&e.metricsModel.addPlaybackQuality("video",t,s,o),e.metricsModel.addVideoResolution("video",t,r.videoWidth,r.videoHeight,o),F()&&(n.getVideoModel().getElement().seeking||i-o<m&&L.call(this,n,F()))}},P=function(){var e=n.getVideoModel().getCurrentTime(),t=k(e);t&&t!==n&&L.call(this,n,t,e)},C=function(){this.manifestUpdater.stop()},N=function(){this.manifestUpdater.start()},B=function(){var e=F();e&&e.seek(e.getStartTime())},F=function(){var e=n.getPeriodIndex()+1;return e<h.length?h[e]:null},k=function(e){var t=0,n=null,i=h.length,r=0;for(i>0&&(t+=h[0].getStartTime()),r=0;r<i;r+=1)if(n=h[r],t+=n.getDuration(),e<t)return n},O=function(){var e=this.system.getObject("videoModel"),t=document.createElement("video");return e.setElement(t),e},U=function(e){e.parentNode&&e.parentNode.removeChild(e)},H=function(){var t,r,o,s,a,l,c,d,p,m=this.manifestModel.getValue(),y=this.metricsModel.getMetricsFor("stream"),_=this.metricsExt.getCurrentManifestUpdate(y);if(!m)return!1;if(e.startOver&&(m.startOver=!0),this.debug.info("[StreamController] composeStreams"),this.capabilities.supportsEncryptedMedia()&&(i||(i=this.system.getObject("protectionController"),f=!0),i.setMediaElement(this.videoModel.getElement()),u&&i.setProtectionData(u)),d=this.manifestExt.getMpd(m),n&&(t=n.getPeriodInfo(),d.isClientServerTimeSyncCompleted=t.mpd.isClientServerTimeSyncCompleted,d.clientServerTimeShift=t.mpd.clientServerTimeShift),r=this.manifestExt.getRegularPeriods(m,d),0===r.length)return!1;for(a=0,o=r.length;a<o;a+=1){for(c=r[a],l=0,s=h.length;l<s;l+=1)h[l].getId()===c.id&&(p=h[l],this.debug.info("[StreamController] update stream data"),p.updateData(c));p||(this.debug.info("[StreamController] Create stream"),p=this.system.getObject("stream"),p.setVideoModel(0===a?this.videoModel:O.call(this)),p.initProtection(i),p.setAutoPlay(g),p.setDefaultAudioLang(v),p.setDefaultSubtitleLang(b),p.enableSubtitles(E),p.setInitialStartTime(e.startTime),p.load(m,c),h.push(p)),this.metricsModel.addManifestUpdatePeriodInfo(_,c.id,c.index,c.start,c.duration),p=null}return n||(n=h[0],I.call(this,n.getVideoModel())),this.metricsModel.updateManifestUpdateInfo(_,{currentTime:this.videoModel.getCurrentTime(),buffered:this.videoModel.getElement().buffered,presentationStartTime:r[0].start,clientTimeOffset:d.clientServerTimeShift}),T&&(T.resolve(),T=null),!0},j=function(e){!0===e&&(x=!0),this.refreshManifest()},V=function(){if(c){this.debug.info("[StreamController] Manifest updated");var e=H.call(this);e?this.system.notify("streamsComposed"):this.errHandler.sendError(d.dependencies.ErrorHandler.prototype.MANIFEST_ERR_NO_STREAM,"No stream/period is provided in the manifest"),T&&(T.resolve(),T=null)}else T&&(T.resolve(),T=null)},K=function(e){if(S&&"HLS"===e.protocol){var t=this.system.getObject("hlsStream");return t.setVideoModel(this.videoModel),t.setProtectionData(u),t.setAutoPlay(g),t.setDefaultAudioLang(v),t.setDefaultSubtitleLang(b),t.enableSubtitles(E),t.setInitialStartTime(e.startTime),h.push(t),n=t,I.call(this,n.getVideoModel()),t.load(e.url),!0}return!1};return{system:void 0,videoModel:void 0,parser:void 0,manifestLoader:void 0,manifestUpdater:void 0,manifestModel:void 0,manifestExt:void 0,fragmentExt:void 0,capabilities:void 0,debug:void 0,metricsModel:void 0,metricsExt:void 0,videoExt:void 0,errHandler:void 0,eventBus:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,setup:function(){this.system.mapHandler("manifestUpdate",void 0,j.bind(this)),this.system.mapHandler("manifestUpdated",void 0,V.bind(this)),r=R.bind(this),s=A.bind(this),o=P.bind(this),a=C.bind(this),l=N.bind(this)},getManifestExt:function(){return n.getManifestExt()},setAutoPlay:function(e){g=e},getAutoPlay:function(){return g},getVideoModel:function(){return this.videoModel},setVideoModel:function(e){this.videoModel=e},getAudioTracks:function(){return n?n.getAudioTracks():null},getSelectedAudioTrack:function(){if(n)return n.getSelectedAudioTrack()},setAudioTrack:function(e){n&&n.setAudioTrack(e)},getSubtitleTracks:function(){return n?n.getSubtitleTracks():null},setSubtitleTrack:function(e){n&&n.setSubtitleTrack(e)},getSelectedSubtitleTrack:function(){if(n)return n.getSelectedSubtitleTrack()},getMinbufferTime:function(){return n?n.getMinbufferTime():d.dependencies.BufferExtensions.DEFAULT_MIN_BUFFER_TIME},getLiveDelay:function(){return n?n.getLiveDelay():d.dependencies.BufferExtensions.DEFAULT_LIVE_DELAY},load:function(n){var i=this;c=!0,e=n,e.protData&&(u=e.protData),K.call(this,e)||(x=!1,T=t.defer(),i.debug.info("[StreamController] load url: "+e.url),i.manifestLoader.load(e.url).then(function(e){i.manifestModel.setValue(e),i.metricsModel.addMetaData(),i.debug.info("[StreamController] Manifest has loaded."),i.manifestUpdater.start()},function(e){T.resolve(),T=null,e&&i.errHandler.sendError(e.name,e.message,e.data)}))},refreshManifest:function(e){var t=this.manifestModel.getValue(),n=e||(t.hasOwnProperty("Location")?t.Location:t.mpdUrl);this.debug.log("[StreamController] Refresh manifest: "+n);var i=this;this.manifestLoader.abort(),this.manifestLoader.load(n,!0).then(function(e){i.manifestModel.setValue(e),i.debug.log("[StreamController] Manifest has been refreshed"),x=!1},function(t){void 0!==t&&(e?x&&i.errHandler.sendError(t.name,t.message,t.data):(i.errHandler.sendWarning(t.name,t.message,t.data),i.eventBus.dispatchEvent({type:"manifestUrlUpdate",data:{url:n}})))})},reset:function(e){var r,o,s={},a=[],l=this;this.debug.info("[StreamController] Reset"),n&&D.call(this,n.getVideoModel()),c=!1,l.manifestLoader.abort(),l.manifestUpdater.stop(),l.parser.reset(),s[d.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE]=function(){f=!1,i=null,u=null,l.manifestModel.setValue(null),l.metricsModel.addState("video","stopped",l.videoModel.getCurrentTime(),e),l.metricsModel.clearAllCurrentMetrics(),l.notify(d.dependencies.StreamController.eventList.ENAME_TEARDOWN_COMPLETE)},t.when(!T||T.promise).then(function(){for(l.pause(),y=!1,o=0;o<h.length;o+=1)r=h[o],a.push(r.reset()),r!==n&&U(r.getVideoModel().getElement());l.videoModel.reset(),t.all(a).then(function(){h=[],n=null,i?f?(i.protectionModel.subscribe(d.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE,s,void 0,!0),i.teardown()):(i.setMediaElement(null),s[d.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE]()):s[d.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE]()})})},setDefaultAudioLang:function(e){v=e},setDefaultSubtitleLang:function(e){b=e},enableSubtitles:function(e){E=e,n&&n.enableSubtitles(e)},setTrickModeSpeed:function(e){n&&n.setTrickModeSpeed(e)},getTrickModeSpeed:function(){return n?n.getTrickModeSpeed():0},play:function(){n.play()},pause:function(){n&&n.pause()},seek:function(e,t){n&&n.seek(e,t)}}},d.dependencies.StreamController.prototype={constructor:d.dependencies.StreamController},d.dependencies.StreamController.eventList={ENAME_STREAMS_COMPOSED:"streamsComposed",ENAME_TEARDOWN_COMPLETE:"streamTeardownComplete"},d.utils.TokenAuthentication=function(){"use strict";var e={type:d.utils.TokenAuthentication.TYPE_QUERY};return{debug:void 0,getTokenAuthentication:function(){return e},setTokenAuthentication:function(t){e=t},checkRequestHeaderForToken:function(t){void 0!==e.name&&null!==t.getResponseHeader(e.name)&&(e.token=t.getResponseHeader(e.name),this.debug.log(e.name+" received: "+e.token))},addTokenAsQueryArg:function(t){if(void 0!==e.name&&void 0!==e.token&&e.type===d.utils.TokenAuthentication.TYPE_QUERY){var n=-1===t.indexOf("?")?"?":"&";t+=n+e.name+"="+e.token,this.debug.log(e.name+" is being appended on the request url with a value of : "+e.token)}return t},setTokenInRequestHeader:function(t){return e.type===d.utils.TokenAuthentication.TYPE_HEADER&&(t.setRequestHeader(e.name,e.token),this.debug.log(e.name+" is being set in the request header with a value of : "+e.token)),t}}},d.utils.TokenAuthentication.TYPE_QUERY="query",d.utils.TokenAuthentication.TYPE_HEADER="header",d.models.URIQueryAndFragmentModel=function(){"use strict";var e=new d.vo.URIFragmentData,t=[],n=function(){e=new d.vo.URIFragmentData,t=[]},i=function(n){var i=[],r=new RegExp(/[?]/),o=new RegExp(/[#]/),s=r.test(n),a=o.test(n);function l(e,t,n,i){var r=i[0].split(/[=]/);return i.push({key:r[0],value:r[1]}),i.shift(),i}function u(e,n,r){return n>0&&(s&&0===t.length?t=r[n].split(/[&]/):a&&(i=r[n].split(/[&]/))),r}return n.split(/[?#]/).map(u),t.length>0&&(t=t.reduce(l,null)),i.length>0&&(i=i.reduce(l,null),i.forEach(function(t){e[t.key]=t.value})),n};return{parseURI:i,reset:n,getURIFragmentData:function(){return e},getURIQueryData:t}},d.models.URIQueryAndFragmentModel.prototype={constructor:d.models.URIQueryAndFragmentModel},d.models.VideoModel=function(){"use strict";var e,t=[],n=null,i=function(e){null!==e&&-1===t.indexOf(e)&&(this.debug.info("<video> # stall stream "+e),t.push(e),1===t.length&&this.setPlaybackRate(0))},r=function(n){var i=t.indexOf(n);null!==n&&(this.debug.info("<video> # unstall stream "+n),-1!==i&&t.splice(i,1),!1===this.isStalled()&&0===e.playbackRate&&this.setPlaybackRate(1))};return{system:void 0,debug:void 0,setup:function(){t=[]},reset:function(){t=[]},play:function(){this.debug.info("<video> # play()"),e.play()},pause:function(){this.debug.info("<video> # pause()"),e.pause()},isPaused:function(){return e.paused},isSeeking:function(){return e.seeking},getDuration:function(){return e.duration},getPlaybackRate:function(){return e.playbackRate},setPlaybackRate:function(t){this.debug.info("<video> # playbackRate = "+t),e.playbackRate=t},getMute:function(){return e.muted},setMute:function(t){e.muted=t},getVolume:function(){return e.volume},setVolume:function(t){e.volume=t},getCurrentTime:function(){return e.currentTime},setCurrentTime:function(t){this.debug.info("<video> # currentTime = "+t),e.currentTime=t},listen:function(t,n){e.addEventListener(t,n,!1)},unlisten:function(t,n){e.removeEventListener(t,n,!1)},listenOnParent:function(t,n){e.parentElement.addEventListener(t,n,!1)},unlistenOnParent:function(t,n){e.parentElement.removeEventListener(t,n,!1)},getElement:function(){return e},setElement:function(t){e=t},setSource:function(t){t?(this.debug.info("<video> # set source"),e.src=t):(this.debug.info("<video> # reset source"),e.removeAttribute("src"),e.load())},isStalled:function(){return t.length>0},stallStream:function(e,t){t?i.call(this,e):r.call(this,e)},getTTMLRenderingDiv:function(){return n},setTTMLRenderingDiv:function(e){n=e,n.style.position="absolute",n.style.display="flex",n.style.overflow="hidden",n.style.pointerEvents="none",n.style.top=0,n.style.left=0}}},d.models.VideoModel.prototype={constructor:d.models.VideoModel},d.dependencies.VideoModelExtensions=function(){"use strict";return{getPlaybackQuality:function(e){var t="webkitDroppedFrameCount"in e,n="getVideoPlaybackQuality"in e,i=null;return n?i=e.getVideoPlaybackQuality():t&&(i={droppedVideoFrames:e.webkitDroppedFrameCount,creationTime:new Date,totalVideoFrames:e.webkitDecodedFrameCount}),i}}},d.dependencies.VideoModelExtensions.prototype={constructor:d.dependencies.VideoModelExtensions},d.dependencies.XHRLoader=function(){"use strict";var e=null,n=null,i=null,r=null,o=null,s=0,a=0,l=0,u=null,c=null,d=function(){null!==e&&e.readyState>0&&e.readyState<4?e.abort():u&&(clearTimeout(u),u=null,c.reject())},h=function(){var t=!0,d=function(t){o&&o(e,t)},f=function(){e.aborted=!0},p=function(){e.status<200||e.status>299||200===e.status&&4===e.readyState&&(t=!1,e.endDate=new Date,c.resolve(e))},m=function(){t&&(t=!1,e.endDate=new Date,l++,!e.aborted&&s>0&&l<=s?u=setTimeout(function(){h()},a):c.reject(e))};try{e=new XMLHttpRequest,e.open("GET",n,!0),i&&(e.responseType=i),r&&e.setRequestHeader("Range","bytes="+r),e.onprogress=d,e.onabort=f,e.onload=p,e.onloadend=m,e.onerror=m,e.startDate=new Date,e.send()}catch(g){e.onerror()}};return{initialize:function(e,t,n,r){i=e,s=t,a=n,o=r},load:function(e,i){return n=e,r=i,l=0,c=t.defer(),h(),c.promise},abort:d}},d.dependencies.XHRLoader.prototype={constructor:d.dependencies.XHRLoader},d.dependencies.TextController=function(){var e,t,n,i,r="LOADING",o="READY",s=!1,a=null,l=o,u=function(e){this.debug.log("TextController setState to:"+e),l=e},c=function(){if(s&&l===o){var e=this;e.indexHandler.getInitRequest(i[0]).then(function(t){e.fragmentLoader.load(t).then(f.bind(e,t),p.bind(e,t)),u.call(e,r)})}},d=function(){c.call(this)},h=function(e,t){var n,i,r=this.manifestModel.getValue();return i=this.manifestExt.getDataIndex(e,r,t.index),n=this.manifestExt.getAdaptationsForPeriod(r,t),this.manifestExt.getRepresentationsForAdaptation(r,n[i])},f=function(e,t){var i=this;i.fragmentController.process(t.data,e).then(function(e){null!==e&&i.sourceBufferExt.append(n,e,i.videoModel)})},p=function(){};return{videoModel:void 0,fragmentLoader:void 0,fragmentController:void 0,indexHandler:void 0,sourceBufferExt:void 0,manifestModel:void 0,manifestExt:void 0,debug:void 0,initialize:function(e,t,n,i,r){var o=this;o.setVideoModel(i),o.setBuffer(n),o.setMediaSource(r),o.updateData(t,e),s=!0,c.call(o)},setPeriodInfo:function(e){a=e},getPeriodIndex:function(){return a.index},getVideoModel:function(){return this.videoModel},setVideoModel:function(e){this.videoModel=e},getData:function(){return t},setData:function(e){t=e},getBuffer:function(){return n},setBuffer:function(e){n=e},setMediaSource:function(t){e=t},updateData:function(e,n){t=e,a=n,i=h.call(this,t,a),u.call(this,o),c.call(this)},reset:function(t){t||(this.sourceBufferExt.abort(e,n),this.sourceBufferExt.removeSourceBuffer(e,n))},start:d}},d.dependencies.TextController.prototype={constructor:d.dependencies.TextController},d.dependencies.TextSourceBuffer=function(){var e,t,n,i=function(e){var t="",n=0,i=0,r=0,o=0,s=new Uint8Array(e);s.length>=3&&239===s[0]&&187===s[1]&&191===s[2]&&(n=3);while(n<s.length)if(i=s[n],i<128)t+=String.fromCharCode(i),n++;else if(i>191&&i<224){if(n+1>=s.length)throw"UTF-8 Decode failed. Two byte character was truncated.";r=s[n+1],t+=String.fromCharCode((31&i)<<6|63&r),n+=2}else{if(n+2>=s.length)throw"UTF-8 Decode failed. Multi byte character was truncated.";r=s[n+1],o=s[n+2],t+=String.fromCharCode((15&i)<<12|(63&r)<<6|63&o),n+=3}return t},r={length:0,ranges:[],start:function(e){return this.ranges[e].start},end:function(e){return this.ranges[e].end},addRange:function(e,t){var n=0,i=!1,r=.01;for(n=0;n<this.ranges.length;n++)this.ranges[n].end<=e+r&&this.ranges[n].end>=e-r&&(i=!0,this.ranges[n].end=t),this.ranges[n].start<=t+r&&this.ranges[n].start>=t-r&&(i=!0,this.ranges[n].start=e);i||(this.ranges.push({start:e,end:t}),this.length=this.length+1,this.ranges.sort(function(e,t){return e.start-t.start}))},removeRange:function(e,t){var n=0;for(n=this.ranges.length-1;n>=0;n-=1)(void 0===t||-1===t||this.ranges[n].end<=t)&&(void 0===e||-1===e||this.ranges[n].start>=e)&&this.ranges.splice(n,1);this.length=this.ranges.length},reset:function(){this.length=0,this.ranges=[]}};return{system:void 0,eventBus:void 0,errHandler:void 0,textTrackExtensions:void 0,buffered:r,initialize:function(i,o){n=i,e=o.getVideoModel().getElement(),t=o.getData(),r.reset()},remove:function(t,n){if(t<0||t>=n)throw"INVALID_ACCESS_ERR";this.textTrackExtensions.deleteCues(e,!1,t,n),this.buffered.removeRange(t,n)},append:function(n,r){var o=this,s=i(n),a=o.getParser().parse(s,r);0===e.textTracks.length&&o.textTrackExtensions.addTextTrack(e,[],t.Representation_asArray[0].id,t.lang,!0),0!==e.textTracks.length&&(o.textTrackExtensions.addCues(e.textTracks[0],a),r&&o.buffered.addRange(r.startTime,r.startTime+r.duration))},abort:function(){this.textTrackExtensions.deleteCues(e),this.buffered.reset()},getParser:function(){var e;return"text/vtt"===n&&(e=this.system.getObject("vttParser")),e},addEventListener:function(e,t,n){this.eventBus.addEventListener(e,t,n)},removeEventListener:function(e,t,n){this.eventBus.removeEventListener(e,t,n)}}},d.dependencies.TextSourceBuffer.prototype={constructor:d.dependencies.TextSourceBuffer},d.utils.TextTrackExtensions=function(){"use strict";var e,t="",n=null;return{system:void 0,eventBus:void 0,videoModel:void 0,debug:void 0,config:void 0,setup:function(){e=window.VTTCue||window.TextTrackCue},cueEnter:function(e,t,n){this.eventBus.dispatchEvent({type:"cueEnter",data:{text:t,style:e,type:n}})},cueExit:function(e,t,n){this.eventBus.dispatchEvent({type:"cueExit",data:{text:t,style:e,type:n}})},getCurrentTextTrack:function(e){for(var t=0;t<e.textTracks.length;t++)if("hascaption"===e.textTracks[t].label)return e.textTracks[t];return null},addTextTrack:function(i,r,o,s,a){var l,u=null,c=null,d="subtitles",h=this.videoModel.getTTMLRenderingDiv();for(u=this.getCurrentTextTrack(i),u?(this.cleanSubtitles(),u.default=a,"showing"!==u.mode&&"metadata"!==u.kind&&(u.mode="showing"),t=s):(h&&(n=this.system.getObject("ttmlRenderer"),n.initialize(h)),d=null!==h?"metadata":"subtitles","subtitles"===d&&(d=!0===this.config.getParam("TextTrackExtensions.displayModeExtern","boolean")?"metadata":"subtitles"),u=i.addTextTrack(d,"hascaption",s),t=s,u.default=a,u.mode="metadata"!==d?"showing":"hidden"),l=0;l<r.length;l+=1)c=r[l],u.addCue(new e(c.start,c.end,c.data));return u},onCueEnter:function(e){var t=this.videoModel.getTTMLRenderingDiv();"image"===e.currentTarget.type&&null===t&&this.debug.warn("[TextTrackExtensions] Rendering image subtitles without div is impossible"),t&&n.onCueEnter(e),this.cueEnter(e.currentTarget.style,e.currentTarget.text,e.currentTarget.type)},onCueExit:function(e){var t=this.videoModel.getTTMLRenderingDiv();t&&n.onCueExit(e),this.cueExit(e.currentTarget.style,e.currentTarget.text)},addCues:function(n,i){var r=0,o=null,s=null;for(r=0;r<i.length;r+=1)o=i[r],o.start<o.end&&(s=new e(o.start,o.end,o.data),s.id=t,s.type=o.type,s.onenter=this.onCueEnter.bind(this),s.onexit=this.onCueExit.bind(this),s.snapToLines=!1,s.line=o.line,o.style&&(s.style=o.style),n.addCue(s))},deleteCues:function(e,t,n,i){var r,o=null,s=null,a=null,l=0;if(e&&(o=e.textTracks[0],o)){if(r=o.mode,"disabled"===r&&(o.mode="hidden"),s=o.cues,s)for(a=s.length-1,l=a;l>=0;l-=1)(void 0===i||-1===i||s[l].endTime<=i)&&(void 0===n||-1===n||s[l].startTime>=n)&&o.removeCue(s[l]);o.mode=r}},cleanSubtitles:function(){var e=this.videoModel.getTTMLRenderingDiv();e&&n&&n.cleanSubtitles()}}},d.dependencies.TextTTMLXMLMP4SourceBuffer=function(){var e,n,i,r,o={length:0,ranges:[],start:function(e){return this.ranges[e].start},end:function(e){return this.ranges[e].end},addRange:function(e,t){var n=0,i=!1,r=.01;for(n=0;n<this.ranges.length;n++)this.ranges[n].end<=e+r&&this.ranges[n].end>=e-r&&(i=!0,this.ranges[n].end=t),this.ranges[n].start<=t+r&&this.ranges[n].start>=t-r&&(i=!0,this.ranges[n].start=e);i||(this.ranges.push({start:e,end:t}),this.length=this.length+1,this.ranges.sort(function(e,t){return e.start-t.start}))},removeRange:function(e,t){var n=0;for(n=this.ranges.length-1;n>=0;n-=1)(void 0===t||-1===t||this.ranges[n].end<=t)&&(void 0===e||-1===e||this.ranges[n].start>=e)&&this.ranges.splice(n,1);this.length=this.ranges.length},reset:function(){this.length=0,this.ranges=[]}};return{updating:!1,system:void 0,eventBus:void 0,buffered:o,textTrackExtensions:void 0,ttmlParser:void 0,debug:void 0,manifestModel:void 0,errHandler:void 0,initialize:function(t,s,a){n=t,e=s.getVideoModel().getElement(),o.reset(),i=a.lang,r=a.id},remove:function(t,n){if(t<0||t>=n)throw"INVALID_ACCESS_ERR";this.getTextTrackExtensions().deleteCues(e,!1,t,n),this.buffered.removeRange(t,n)},append:function(t){var o,s,a,l,u,c,h,f,p,m,g=this,y=b.deserialize(t),v=y.getBoxByType("moov"),E=0,_="utf-8";if("application/ttml+xml"===n)return this.track=this.textTrackExtensions.addTextTrack(e,[],r,i,!0),d.utils.isUTF16(t)&&(_="utf-16"),void this.convertUTFToString(t,_).then(function(t){g.ttmlParser.parse(t).then(function(t){t&&(g.textTrackExtensions.addCues(g.track,t),g.buffered.addRange(0,e.duration),g.eventBus.dispatchEvent({type:"updateend"}))},function(e){g.errHandler.sendWarning(d.dependencies.ErrorHandler.prototype.INTERNAL_ERROR,"Internal error while parsing TTML data",e)})});if(v)return o=v.getBoxByType("mvhd"),g.timescale=o.timescale,this.track=this.textTrackExtensions.addTextTrack(e,[],r,i,!0),void this.eventBus.dispatchEvent({type:"updateend"});if(s=y.getBoxByType("moof"),s){if(a=y.getBoxByType("mdat"),l=s.getBoxByType("traf"),u=l.getBoxByType("tfhd"),c=l.getBoxByType("tfdt"),h=l.getBoxByType("trun"),f=l.getBoxByType("subs"),p=c.baseMediaDecodeTime/g.timescale,E=0,E=256&h.flags?h.samples_table[0].sample_duration/g.timescale:u.default_sample_duration/g.timescale,g.buffered.addRange(p,p+E),f)for(var x=0;x<f.entry_count;x++)for(var T=0;T<f.entry[x].subsample_count;T++){m=a.data.subarray(0,f.entry[x].subSampleEntries[0].subsample_size);break}else m=a.data;d.utils.isUTF16(m)&&(_="utf-16"),g.convertUTFToString(m,_).then(function(e){g.ttmlParser.parse(e).then(function(e){var t,n=g.manifestModel.getValue();if(e){if("MSS"===n.name)for(t=0;t<e.length;t+=1)e[t].start=e[t].start+p,e[t].end=e[t].end+p;g.textTrackExtensions.addCues(g.track,e),g.eventBus.dispatchEvent({type:"updateend"})}},function(e){g.errHandler.sendWarning(d.dependencies.ErrorHandler.prototype.INTERNAL_ERROR,"Internal error while parsing TTML data",e)})})}},convertUTFToString:function(e,n){var i=t.defer(),r=new Blob([e],{type:"text/xml"}),o=new FileReader;return o.onload=function(e){i.resolve(e.target.result)},o.readAsText(r,n),i.promise},UpdateLang:function(e,t){r=e,i=t},abort:function(){this.getTextTrackExtensions().deleteCues(e,!0)},getTextTrackExtensions:function(){return this.textTrackExtensions},addEventListener:function(e,t,n){this.eventBus.addEventListener(e,t,n),this.updating||this.eventBus.dispatchEvent({type:"updateend"})},removeEventListener:function(e,t,n){this.eventBus.removeEventListener(e,t,n)}}},d.dependencies.TextTTMLXMLMP4SourceBuffer.prototype={constructor:d.dependencies.TextTTMLXMLMP4SourceBuffer},d.utils.TTMLParser=function(){"use strict";var e=3600,n=60,i="http://www.w3.org/2006/10/ttaf1",r="http://www.w3.org/2006/10/ttaf1#parameter",o="http://www.w3.org/2006/10/ttaf1#styling",s="http://www.w3.org/ns/ttml",a="http://www.w3.org/ns/ttml#parameter",l="http://www.w3.org/ns/ttml#styling",u="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",c=[s,i],d=[l,o],h=[a,r],f=[u],p=/^(0[0-9]|1[0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9])((\.[0-9][0-9][0-9])|(:[0-9][0-9]))$/,m=/^\d+(\.\d+|)(h|m|s|ms|f)$/,g=null,y=null,v=null,b=null,E=null,_=[],x=[],T=[],S=function(t){var i,r,o;if(p.test(t))return i=t.split(":"),r=parseFloat(i[0])*e+parseFloat(i[1])*n+parseFloat(i[2]),i[3]&&E&&!isNaN(E)&&(r+=parseFloat(i[3])/E),r;if(m.test(t)){switch("ms"==t.substr(t.length-2)?(r=parseFloat(t.substr(0,t.length-3)),o=t.substr(t.length-2)):(r=parseFloat(t.substr(0,t.length-2)),o=t.substr(t.length-1)),o){case"h":r=60*r*60;break;case"m":r*=60;break;case"s":break;case"ms":r*=.01;break;case"f":if(!E||isNaN(E))return NaN;r/=E;break}return r}return NaN},w=function(){var e=!1;return y=g?this.domParser.getChildNode(g,"tt"):null,v=y?this.domParser.getChildNode(y,"head"):null,v?this.domParser.getChildNode(v,"layout"):null,v?this.domParser.getChildNode(v,"styling"):null,b=y?this.domParser.getChildNode(y,"body"):null,y&&v&&b&&(e=!0),e},I=function(e,t,n){var i,r,o=null,s=0;for(s=0;s<e.length;s+=1){if(o=M.call(this,[e[s]],d,t),o)return o;if(i=M.call(this,[e[s]],c,"style"),i){if(o=D.call(this,_,i,t),o)return o;i=D.call(this,_,i,"style");while(i){if(o=D.call(this,_,i,t),o)return o;i=D.call(this,_,i,"style")}}if(r=M.call(this,[e[s]],c,"region"),r){if(o=D.call(this,x,r,t),o)return o;if(i=D.call(this,x,r,"style"),i){if(o=D.call(this,_,i,t),o)return o;i=D.call(this,_,i,"style");while(i){if(o=D.call(this,_,i,t),o)return o;i=D.call(this,_,i,"style")}}}}return void 0!==n?n:null},D=function(e,t,n){var i=0,r=null,o=0;for(i=0;i<e[t].length;i+=1){for(o=0;o<d.length;o+=1)if(r=e[t].getNamedItem(n),r||(r=e[t].getNamedItemNS(d[o],n)),r)return r.nodeValue;for(o=0;o<c.length;o+=1)if(r=e[t].getNamedItem(n),r||(r=e[t].getNamedItemNS(c[o],n)),r)return r.nodeValue}return null},M=function(e,t,n){var i=null,r=0,o=0;for(r=0;r<e.length;r+=1)for(o=0;o<t.length;o+=1)if(i=this.domParser.getAttributeValue(e[r],n,t[o]),i)return i;return i},A=function(e){e||(e="32 15");var t=e,n=0;for(t=t.split(" "),n=0;n<t.length;n+=1)t[n]=parseFloat(t[n]);return t},L=function(e,t){var n={backgroundColor:null,color:null,fontSize:null,fontFamily:null,fontStyle:null,textOutline:{color:null,with:null},textAlign:null,displayAlign:null,origin:null,extent:null,cellResolution:null,rootExtent:t,showBackground:null};return n.backgroundColor=I.call(this,e,"backgroundColor","transparent"),n.color=I.call(this,e,"color"),n.fontSize=I.call(this,e,"fontSize"),n.fontFamily=I.call(this,e,"fontFamily"),n.fontStyle=I.call(this,e,"fontStyle","normal"),n.textOutline=I.call(this,e,"textOutline"),n.extent=I.call(this,e,"extent"),n.origin=I.call(this,e,"origin"),n.textAlign=I.call(this,e,"textAlign","start"),n.displayAlign=I.call(this,e,"displayAlign","before"),n.showBackground=I.call(this,e,"showBackground"),n.cellResolution=M.call(this,e,h,"cellResolution"),n.cellResolution=A(n.cellResolution),n},R=function(e){var n,i,r,o,s,a,l,u,d,p,m,v,D,A,R,P=[],C=null,N=null,B=null,F="",k="";try{if(null!==this.videoModel.getTTMLRenderingDiv()&&(k="html"),g=this.domParser.createXmlTree(e),!w.call(this))return n="TTML document has incorrect structure",t.reject(n);for(u=0;u<h.length;u+=1)E=this.domParser.getAttributeValue(y,"frameRate",h[u])?parseInt(E,10):null;if(l=this.domParser.getChildNodes(b,"div"),!l||0===l.length)return n="TTML body document does not contain any div",t.reject(n);for(_=this.domParser.getAllSpecificNodes(y,"style"),x=this.domParser.getAllSpecificNodes(y,"region"),T=this.domParser.getAllSpecificNodes(y,"image"),v=I.call(this,[y],"extent"),m=0;m<l.length;m+=1)if(A=M.call(this,[l[m]],f,"backgroundImage"),A&&void 0!==T[A.substring(1)]&&(o=S(M.call(this,[l[m]],c,"begin")),s=S(M.call(this,[l[m]],c,"end")),B=L.call(this,[l[m],y],v),a={start:o,end:s,data:"data:image/"+T[A.substring(1)].imagetype.nodeValue+";base64, "+this.domParser.getChildNode(T[A.substring(1)],"#text").nodeValue,type:"image",line:80,style:B},P.push(a)),i=this.domParser.getChildNodes(l[m],"p"),i&&0!==i.length)for(u=0;u<i.length;u+=1)if(a=null,B=null,r=i[u],o=S(M.call(this,[r],c,"begin")),s=S(M.call(this,[r],c,"end")),isNaN(o)||isNaN(s)||s<o)n="TTML document has incorrect timing value";else if(A=M.call(this,[r],f,"backgroundImage"),A&&void 0!==T[A.substring(1)]&&(B=L.call(this,[r,l[m],y],v),a={start:o,end:s,data:"data:image/"+T[A.substring(1)].imagetype.nodeValue+";base64, "+this.domParser.getChildNode(T[A.substring(1)],"#text").nodeValue,type:"image",line:80,style:B}),d=this.domParser.getChildNodes(r,"span"),d.length>0){for(p=0;p<d.length;p++){p>0&&(F+="\n"),0===p&&(B=L.call(this,[d[p],r,b,y,l[m]],v)),D=this.domParser.getTextNodesIn(d[p]);for(var O=0;O<D.length;O+=1)O>0&&(F+="\n"),F+=D[O].textContent}a={start:o,end:s,data:F,type:"text",line:80,style:B},F="",P.push(a)}else{if(B=L.call(this,[r,b,y],v),u>0&&(C=S(M.call(this,[i[u-1]],c,"begin")),N=S(M.call(this,[i[u-1]],c,"end"))),o===C&&s===N||o>=C&&s<=N)""!==r.textContent&&("html"===k?a={start:o,end:s,data:r.textContent,type:"text",line:80,style:B}:(o>=C&&s<=N?(R=P[P.length-1],R.end=o):R=P.pop(),a={start:o,end:s,data:R.data+"\n"+r.textContent,type:"text",line:80,style:B}));else{for(D=this.domParser.getTextNodesIn(r),p=0;p<D.length;p+=1)p>0&&(F+="\n"),F+=D[p].textContent;""!==F&&(a={start:o,end:s,data:F,type:"text",line:80,style:B},F="")}null!==a&&P.push(a)}else n="TTML document does not contain any cues";return P.length>0?t.when(P):t.reject(n)}catch(U){return n=U.message,t.reject(n)}};return{domParser:void 0,videoModel:void 0,parse:R}},d.utils.TTMLRenderer=function(){"use strict";var e,t=[],n=function(){var n=0;for(n=0;n<t.length;n++)c(t[n],t[n].ttmlStyle,e)},i=function(){this.cleanSubtitles()},r=function(){var t=document.createElement("div");return t.style.position="absolute",t.style.display="flex",t.style.flexDirection="row",t.style.overflow="initial",t.style.pointerEvents="none",e.appendChild(t),t},o=function(t){e.hasChildNodes()&&e.removeChild(t)},s=function(e,t){var n,i;if(e&&"%"===e[e.length-1])n=parseFloat(e.substr(0,e.length-1))/100*t[1]+"px";else if(e&&"x"===e[e.length-1])n=e;else if(e&&"c"===e[e.length-1]){var r=e.replace(/\s/g,"").split("c");for(i=0;i<r.length;i+=1)r[i]=parseFloat(r[i]);n=isNaN(r[1])?r[0]*t[1]+"px":r[1]*t[1]+"px"}else n=t[1]+"px";return n},a=function(e,t,n){var i,r={color:n,width:null},o=0;if(e&&(e=e.split(" "),e[0]&&isNaN(e[0][0])?(r.color=e[0],o=1):r.color=n,r.color&&"#"===r.color[0]&&(r.color=l(r.color)),e[o]))switch(i=e[o][e[o].length-1],i){case"c":e[o]=e[o].split("c"),e[o][0]&&(r.width=e[o][0]*t[1]+"px");break;case"x":r.width=e[o];break}return r},l=function(e){e=e.replace("#","");var t=parseInt(e.substring(0,2),16),n=parseInt(e.substring(2,4),16),i=parseInt(e.substring(4,6),16),r=e.length>6?parseInt(e.substring(6,8),16):255,o="rgba("+t+","+n+","+i+","+r+")";return o},u=function(e){var t,n,i=e;return t=e.replace(/^(rgb|rgba)\(/,"").replace(/\)$/,"").replace(/\s/g,"").split(","),t[t.length-1]>1&&(n=parseInt(t[t.length-1],10)/255,i="rgba("+t[0]+","+t[1]+","+t[2]+","+n+")"),i},c=function(e,t,n){var i,r,o,c,d=[n.clientWidth/t.cellResolution[0],n.clientHeight/t.cellResolution[1]];if(e){if(t.backgroundColor&&"#"===t.backgroundColor[0]?t.backgroundColor=l(t.backgroundColor):t.backgroundColor&&"a"===t.backgroundColor[3]&&(t.backgroundColor=u(t.backgroundColor)),t.color&&"#"===t.color[0]?t.color=l(t.color):t.color&&"a"===t.color[3]&&(t.color=u(t.color)),t.origin&&"%"===t.origin[t.origin.length-1])i=t.origin.split("%"),e.style.left=parseInt(i[0],10)+"%",e.style.top=parseInt(i[1],10)+"%",t.extent&&"%"===t.extent[t.extent.length-1]&&(r=t.extent.split("%"),e.style.width=parseInt(r[0],10)+"%",e.style.height=parseInt(r[1],10)+"%");else if(t.origin&&"x"===t.origin[t.origin.length-1])if(i=t.origin.split("px"),t.rootExtent&&"x"===t.rootExtent[t.rootExtent.length-1]){c=t.rootExtent.split("px");var h=i[0]/c[0]*n.clientWidth;e.style.left=h/n.clientWidth*100+"%",h=i[1]/c[1]*n.clientHeight,e.style.top=h/n.clientHeight*100+"%",t.extent&&"x"===t.extent[t.extent.length-1]&&(r=t.extent.split("px"),h=r[0]/c[0]*n.clientWidth,e.style.width=h/n.clientWidth*100+"%",h=r[1]/c[1]*n.clientHeight,e.style.height=h/n.clientHeight*100+"%")}else e.style.left=i[0]+"px",e.style.top=i[1]+"px";else t.origin&&"c"===t.origin[t.origin.length-1]&&(i=t.origin.split("c"),e.style.left=i[0]*d[0]+"px",e.style.top=i[1]*d[1]+"px",t.extent&&"c"===t.extent[t.extent.length-1]&&(r=t.extent.split("c"),e.style.width=r[0]*d[0]+"px",e.style.height=r[1]*d[1]+"px"));switch(o=a(t.textOutline,d,t.color),e.style.webkitTextStrokeWidth=o.width,e.style.webkitTextStroke=o.color,t.textAlign){case"start":e.style.justifyContent="flex-start";break;case"end":e.style.justifyContent="flex-end";break;case"center":e.style.justifyContent="center";break;case"right":e.style.justifyContent="flex-end";break;case"left":e.style.justifyContent="flex-start";break;default:e.style.justifyContent="flex-start"}switch(t.displayAlign){case"before":e.style.alignItems="flex-start";break;case"center":e.style.alignItems=t.displayAlign;break;case"after":e.style.alignItems="flex-end";break;default:e.style.alignItems="flex-start"}e.style.fontStyle=t.fontStyle,t.showBackground&&"whenActive"===t.showBackground?e.style.backgroundColor="transparent":e.style.backgroundColor=t.backgroundColor,e.style.color=t.color,e.style.fontSize=s(t.fontSize,d),e.style.fontFamily=t.fontFamily}};return{videoModel:void 0,initialize:function(t){e=t,document.addEventListener("webkitfullscreenchange",n.bind(this)),document.addEventListener("mozfullscreenchange",n.bind(this)),document.addEventListener("fullscreenchange",n.bind(this)),this.videoModel.listen("seeking",i.bind(this))},cleanSubtitles:function(){var e=0;for(e=0;e<t.length;e++)o(t[e]);t=[]},onCueEnter:function(n){var i=r();if(n.currentTarget.style&&(c(i,n.currentTarget.style,e),i.ttmlStyle=n.currentTarget.style),"image"!==n.currentTarget.type){var o=document.createElement("p");i.appendChild(o),o.innerText=n.currentTarget.text,o.style.marginTop="auto",i.ttmlStyle&&i.ttmlStyle.showBackground&&"whenActive"===i.ttmlStyle.showBackground&&(o.style.backgroundColor=n.currentTarget.style.backgroundColor)}else{var s=new Image;s.style.height="auto",s.style.width="auto",s.src=n.currentTarget.text,i.appendChild(s)}i.data=n.currentTarget.text,t.push(i)},onCueExit:function(e){var n=0;for(n=0;n<t.length;n++)if(e.currentTarget.text===t[n].data&&t[n].ttmlStyle===e.currentTarget.style)break;o(t[n]),t.splice(n,1)}}},d.utils.VTTParser=function(){"use strict";var e=/X-TIMESTAMP-MAP=(.+)/,t=/\s*(.+?)\s*:((?:\".*?\")|.*?)(?:,|$)/g,n=/(\S*)[\s]*-->[\s]*(\S*)(.*)/g,i=/(?:\r\n|\r|\n)/gm,r=function(e){for(var t=e.split(":"),n=t.length,i=0,r=0;r<n;r++)i+=parseFloat(t[r],10)*Math.pow(60,n-r-1);return i},o=function(n){var i,o,s,a,l=null,u=null;if(i=e.exec(n),!i)return-1;o=i[1];while(null!==(i=t.exec(o)))switch(s=i[1],a=i[2],s){case"MPEGTS":u=parseInt(a,10);break;case"LOCAL":l=r(a)}return null===l||null===u?-1:{local:l,mpegts:u}},s=function(e,t){if(-1===e)return 0;var n=this.manifestModel.getValue().timestampMap;if(!n)return e.local-t.startTime;var i=(e.mpegts-n.mpegts)/9e4;return e.local-n.local-i};return{manifestModel:void 0,parse:function(e,t){var a,l,u,c=[],d=null,h=s.call(this,o(e),t),f=e.split(i);for(u=0;u<f.length;u++)a=f[u].trim(),0!==a.length&&(f[u].match(n)?(null!==d&&c.push(d),l=f[u].split(n),d={type:"text",line:80,start:r(l[1])-h,end:r(l[2])-h,data:""}):null!==d&&(d.data+=(0===d.data.length?"":"\n")+f[u]));return null!==d&&c.push(d),c}}},d.rules.AbandonRequestsRule=function(){"use strict";var e=.5,t=2;return{debug:void 0,metricsExt:void 0,name:"AbandonRequestRule",execute:function(n,i){var r,o,s,a=(new Date).getTime(),l=n.streamType,u=new d.rules.SwitchRequest(d.rules.SwitchRequest.prototype.NO_CHANGE,d.rules.SwitchRequest.prototype.WEAK);if(null===n.firstByteDate||n.aborted)return this.debug.log("[AbandonRequestsRule]["+l+"] Request has already been aborted."),void i(u);r=(a-n.firstByteDate.getTime())/1e3,n.bytesLoaded<n.bytesTotal&&r>=n.duration*e&&(o=n.bytesLoaded/r,s=n.bytesTotal/o,s>n.duration*t&&(u=new d.rules.SwitchRequest(0,d.rules.SwitchRequest.prototype.STRONG),this.debug.info("[AbandonRequestsRule]["+l+"] BW = "+(8*o/1e3).toFixed(3)+" kb/s => switch to lowest quality"))),i(u)}}},d.rules.AbandonRequestsRule.prototype={constructor:d.rules.AbandonRequestsRule},d.rules.BaseRulesCollection=function(){"use strict";var e=[],t=[];return{downloadRatioRule:void 0,insufficientBufferRule:void 0,droppedFramesRule:void 0,abandonRequestRule:void 0,getRules:function(n){switch(n){case d.rules.BaseRulesCollection.prototype.QUALITY_SWITCH_RULES:return e;case d.rules.BaseRulesCollection.prototype.ABANDON_FRAGMENT_RULES:return t;default:return null}},setup:function(){e.push(this.downloadRatioRule),e.push(this.insufficientBufferRule),e.push(this.droppedFramesRule),t.push(this.abandonRequestRule)}}},d.rules.BaseRulesCollection.prototype={constructor:d.rules.BaseRulesCollection,QUALITY_SWITCH_RULES:"qualitySwitchRules",ABANDON_FRAGMENT_RULES:"abandonFragmentRules"},d.rules.DownloadRatioRule=function(){"use strict";return{debug:void 0,manifestExt:void 0,metricsExt:void 0,manifestModel:void 0,config:void 0,name:"DownloadRatioRule",checkIndex:function(e,t,n){var i,r,o,s,a,l,u,c,h,f=this.metricsExt.getHttpRequests(t),p=null,m=[],g=d.rules.SwitchRequest.prototype.NO_CHANGE,y=0,v=d.rules.SwitchRequest.prototype.DEFAULT;if(n&&n.hasOwnProperty("type")){if(a=this.config.getParamFor(n.type,"ABR.latencyInBandwidth","boolean",!0),l=this.config.getParamFor(n.type,"ABR.switchUpRatioSafetyFactor","number",1.5),this.debug.log("[DownloadRatioRule]["+n.type+"] Checking download ratio rule... (current = "+e+")"),!t)return this.debug.log("[DownloadRatioRule]["+n.type+"] No metrics, bailing."),new d.rules.SwitchRequest;h=f.length-1;while(h>=0&&null===p)f[h].tfinish&&f[h].trequest&&f[h].tresponse&&f[h].bytesLength>0&&(p=f[h]),h--;if(null===p)return this.debug.log("[DownloadRatioRule]["+n.type+"] No valid requests made for this stream yet, bailing."),new d.rules.SwitchRequest;if(r=(p.tfinish.getTime()-p.trequest.getTime())/1e3,i=(p.tfinish.getTime()-p.tresponse.getTime())/1e3,r<=0)return this.debug.log("[DownloadRatioRule]["+n.type+"] Don't know how long the download of the last fragment took, bailing."),new d.rules.SwitchRequest;if(null===p.mediaduration||void 0===p.mediaduration||p.mediaduration<=0||isNaN(p.mediaduration))return this.debug.log("[DownloadRatioRule]["+n.type+"] Don't know the duration of the last media fragment, bailing."),new d.rules.SwitchRequest;y=p.bytesLength,this.debug.log("[DownloadRatioRule]["+n.type+"] DL: "+Number(i.toFixed(3))+"s, Total: "+Number(r.toFixed(3))+"s, Length: "+y),c=1;while(h>=0&&c<3){if(f[h].tfinish&&f[h].trequest&&f[h].tresponse&&f[h].bytesLength>0){var b=(f[h].tfinish.getTime()-f[h].trequest.getTime())/1e3,E=(f[h].tfinish.getTime()-f[h].tresponse.getTime())/1e3;this.debug.log("[DownloadRatioRule]["+n.type+"] DL: "+Number(E.toFixed(3))+"s, Total: "+Number(b.toFixed(3))+"s, Length: "+f[h].bytesLength),r+=b,i+=E,y+=f[h].bytesLength,c+=1}h--}if(y*=8,o=a?y/r:y/i,this.debug.log("[DownloadRatioRule]["+n.type+"] BW = "+Math.round(o/1e3)+" kb/s"),isNaN(o))return new d.rules.SwitchRequest;for(c=this.manifestExt.getRepresentationCount(n),u=this.manifestExt.getRepresentationFor(e,n),s=this.manifestExt.getBandwidth(u),h=0;h<c;h+=1)m.push(this.manifestExt.getRepresentationBandwidth(n,h));if(o<=s){for(h=e-1;h>0;h-=1)if(m[h]<=o)break;return g=h,v=d.rules.SwitchRequest.prototype.WEAK,this.debug.info("[DownloadRatioRule]["+n.type+"] SwitchRequest: q="+g+"/"+(c-1)+" ("+m[g]+"), p="+v),new d.rules.SwitchRequest(g,v)}for(h=c-1;h>e;h-=1)if(o>m[h]*l)break;return g=h,v=d.rules.SwitchRequest.prototype.STRONG,this.debug.info("[DownloadRatioRule]["+n.type+"] SwitchRequest: q="+g+"/"+(c-1)+" ("+m[g]+"), p="+v),new d.rules.SwitchRequest(g,v)}return new d.rules.SwitchRequest}}},d.rules.DownloadRatioRule.prototype={constructor:d.rules.DownloadRatioRule},d.rules.DroppedFramesRule=function(){"use strict";var e=1,t=null,n=-1,i=-1,r=function(r){var o;null!==t?(o=r.mt-t.mt,o<e||(n=r.droppedFrames-t.droppedFrames,i=r.totalVideoFrames-t.totalVideoFrames,t=r)):t=r};return{debug:void 0,metricsExt:void 0,manifestModel:void 0,config:void 0,name:"DroppedFramesRule",checkIndex:function(e,o,s,a){var l,u=this.config.getParamFor(s.type,"ABR.droppedFramesMaxRatio","number",.3),c=this.config.getParamFor(s.type,"ABR.droppedFramesMinRatio","number",.1),h=this.metricsExt.getCurrentPlaybackQuality(o),f=d.rules.SwitchRequest.prototype.NO_CHANGE,p=d.rules.SwitchRequest.prototype.DEFAULT;return null===s?new d.rules.SwitchRequest:"video"!==s.type?new d.rules.SwitchRequest:null===h?(t=null,n=i=-1,new d.rules.SwitchRequest):"buffering"===a?(t=null,n=i=-1,new d.rules.SwitchRequest):(r(h),-1===n?new d.rules.SwitchRequest:(l=n/i,this.debug.info("[DroppedFramesRule]["+s.type+"] DroppedFrames:"+n+", totalVideoFrames:"+i+" => ratio = "+l),l>u&&e>0?(f=e-1,p=d.rules.SwitchRequest.prototype.STRONG):l>c&&(f=e,p=d.rules.SwitchRequest.prototype.STRONG),this.debug.info("[DroppedFramesRule]["+s.type+"] SwitchRequest: q="+f+", p="+p),new d.rules.SwitchRequest(f,p)))}}},d.rules.DroppedFramesRule.prototype={constructor:d.rules.DroppedFramesRule},d.rules.InsufficientBufferRule=function(){"use strict";return{debug:void 0,manifestExt:void 0,metricsExt:void 0,manifestModel:void 0,config:void 0,isStartBuffering:{},name:"InsufficientBufferRule",checkIndex:function(e,t,n,i){var r,o,s,a,l,u,c,h=this.metricsExt.getCurrentBufferLevel(t),f=e,p=d.rules.SwitchRequest.prototype.DEFAULT;if(null===n)return new d.rules.SwitchRequest;if("buffering"===i&&(this.isStartBuffering[n.type]=!0),null===h)return new d.rules.SwitchRequest;if(this.debug.info("[InsufficientBufferRule]["+n.type+"] Checking buffer level ... (current = "+e+", buffer level = "+Math.round(100*h.level)/100+", buffering = "+this.isStartBuffering[n.type]+")"),c=this.manifestExt.getMpd(this.manifestModel.getValue()),c){if(r=this.config.getParamFor(n.type,"BufferController.minBufferTime","number",c.manifest.minBufferTime),o=this.config.getParamFor(n.type,"ABR.switchLowerBufferRatio","number",.25),s=this.config.getParamFor(n.type,"ABR.switchLowerBufferTime","number",o*r),a=this.config.getParamFor(n.type,"ABR.switchDownBufferRatio","number",.5),l=this.config.getParamFor(n.type,"ABR.switchDownBufferTime","number",a*r),u=this.config.getParamFor(n.type,"ABR.switchUpBufferRatio","number",.75),this.config.getParamFor(n.type,"ABR.switchUpBufferTime","number",u*r),h.level<l&&this.isStartBuffering[n.type])return new d.rules.SwitchRequest;h.level>=l&&(this.isStartBuffering[n.type]=!1);this.manifestExt.getRepresentationCount(n);return 1,h.level<=s?(f=0,p=d.rules.SwitchRequest.prototype.STRONG):h.level<=l&&(f=e>0?e-1:0,p=d.rules.SwitchRequest.prototype.DEFAULT),this.debug.info("[InsufficientBufferRule]["+n.type+"] SwitchRequest: q="+f+", p="+p),new d.rules.SwitchRequest(f,p)}return this.debug.log("[InsufficientBufferRule]["+n.type+"] Manifest not present yet"),new d.rules.SwitchRequest}}},d.rules.InsufficientBufferRule.prototype={constructor:d.rules.OInsufficientBufferRule},d.rules.LimitSwitchesRule=function(){"use strict";var e=10,t=2e4,n=5,i=0;return{debug:void 0,name:"LimitSwitchesRule",checkIndex:function(r,o){if(i>0)return i-=1,new d.rules.SwitchRequest(r,d.rules.SwitchRequest.prototype.STRONG);var s,a,l,u=this,c=!1,h=(new Date).getTime(),f=o.RepSwitchList.length;for(l=f-1;l>=0;l-=1){if(s=o.RepSwitchList[l],a=h-s.t.getTime(),a>=t){u.debug.log("Reached time limit, bailing.");break}if(l>=e){u.debug.log("Found too many switches within validation time, force the stream to not change."),c=!0;break}}return c?(u.debug.log("Wait some time before allowing another switch."),i=n,new d.rules.SwitchRequest(r,d.rules.SwitchRequest.prototype.STRONG)):new d.rules.SwitchRequest(d.rules.SwitchRequest.prototype.NO_CHANGE,d.rules.SwitchRequest.prototype.STRONG)}}},d.rules.LimitSwitchesRule.prototype={constructor:d.rules.LimitSwitchesRule},d.rules.SwitchRequest=function(e,t){"use strict";this.quality=e,this.priority=t,void 0===this.quality&&(this.quality=999),void 0===this.priority&&(this.priority=.5)},d.rules.SwitchRequest.prototype={constructor:d.rules.SwitchRequest,NO_CHANGE:999,DEFAULT:.5,STRONG:1,WEAK:0},d.models.ProtectionModel=function(){},d.models.ProtectionModel.eventList={ENAME_NEED_KEY:"needkey",ENAME_KEY_SYSTEM_ACCESS_COMPLETE:"keySystemAccessComplete",ENAME_KEY_SYSTEM_SELECTED:"keySystemSelected",ENAME_VIDEO_ELEMENT_SELECTED:"videoElementSelected",ENAME_SERVER_CERTIFICATE_UPDATED:"serverCertificateUpdated",ENAME_KEY_MESSAGE:"keyMessage",ENAME_KEY_ADDED:"keyAdded",ENAME_KEY_ERROR:"keyError",ENAME_KEY_SESSION_CREATED:"keySessionCreated",ENAME_KEY_SESSION_REMOVED:"keySessionRemoved",ENAME_KEY_SESSION_CLOSED:"keySessionClosed",ENAME_KEY_STATUSES_CHANGED:"keyStatusesChanged",ENAME_TEARDOWN_COMPLETE:"protectionTeardownComplete"},d.vo.Error=function(e,t,n){"use strict";this.code=e||null,this.message=t||null,this.data=n||null},d.vo.Error.prototype={constructor:d.vo.Error},d.vo.Event=function(){"use strict";this.type=null,this.sender=null,this.data=null,this.error=null,this.timestamp=NaN},d.vo.Event.prototype={constructor:d.vo.Event},d.models.MetricsList=function(){"use strict";return{TcpList:[],HttpList:[],RepSwitchList:[],BufferedSwitchList:[],BufferLevel:[],PlayList:[],State:[],DroppedFrames:[],PlaybackQuality:[],VideoResolution:[],DVRInfo:[],ManifestUpdate:[]}},d.models.MetricsList.prototype={constructor:d.models.MetricsList},d.vo.Mp4Track=function(){"use strict";this.type="und",this.trackId=0,this.timescale=0,this.duration=0,this.codecs="",this.codecPrivateData="",this.bandwidth="",this.width=0,this.height=0,this.language="und",this.channels=0,this.samplingRate=0,this.contentProtection=void 0,this.samples=[],this.data=null},d.vo.Mp4Track.prototype={constructor:d.vo.Mp4Track},d.vo.Mp4Track.Sample=function(){"use strict";this.dts=0,this.cts=0,this.duration=0,this.flags=0,this.data=null,this.size=0},d.vo.Mp4Track.Sample.prototype={constructor:d.vo.Mp4Track.Sample},d.vo.SegmentRequest=function(){"use strict";this.action="download",this.startTime=NaN,this.streamType=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.deferred=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null},d.vo.SegmentRequest.prototype={constructor:d.vo.SegmentRequest,ACTION_DOWNLOAD:"download",ACTION_COMPLETE:"complete"},d.vo.URIFragmentData=function(){"use strict";this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null},d.vo.URIFragmentData.prototype={constructor:d.vo.URIFragmentData},d.vo.metrics.BufferedSwitch=function(){"use strict";this.mt=null,this.to=null,this.lto=null},d.vo.metrics.BufferedSwitch.prototype={constructor:d.vo.metrics.BufferedSwitch},d.vo.metrics.BufferLevel=function(){"use strict";this.t=null,this.level=null},d.vo.metrics.BufferLevel.prototype={constructor:d.vo.metrics.BufferLevel},d.vo.metrics.Condition=function(){"use strict";this.isFullScreen=null,this.windowSize=null,this.droppedFrames=null,this.fps=null,this.bandwidth=null},d.vo.metrics.Condition.prototype={constructor:d.vo.metrics.Condition},d.vo.metrics.DroppedFrames=function(){"use strict";this.time=null,this.droppedFrames=null},d.vo.metrics.DroppedFrames.prototype={constructor:d.vo.metrics.DroppedFrames},d.vo.metrics.DVRInfo=function(){"use strict";this.time=null,this.range=null},d.vo.metrics.DVRInfo.prototype={constructor:d.vo.metrics.DVRInfo},d.vo.metrics.HTTPRequest=function(){"use strict";this.stream=null,this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.tfinish=null,this.responsecode=null,this.interval=null,this.mediaduration=null,this.trace=[],this.startTime=null,this.quality=null,this.bytesLength=null},d.vo.metrics.HTTPRequest.prototype={constructor:d.vo.metrics.HTTPRequest},d.vo.metrics.HTTPRequest.Trace=function(){"use strict";this.s=null,this.d=null,this.b=[]},d.vo.metrics.HTTPRequest.Trace.prototype={constructor:d.vo.metrics.HTTPRequest.Trace},d.vo.metrics.ManifestUpdate=function(){"use strict";this.streamType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.periodInfo=[],this.representationInfo=[]},d.vo.metrics.ManifestUpdate.PeriodInfo=function(){"use strict";this.id=null,this.index=null,this.start=null,this.duration=null},d.vo.metrics.ManifestUpdate.RepresentationInfo=function(){"use strict";this.id=null,this.index=null,this.streamType=null,this.periodIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.segmentInfoType=null},d.vo.metrics.ManifestUpdate.prototype={constructor:d.vo.metrics.ManifestUpdate},d.vo.metrics.ManifestUpdate.PeriodInfo.prototype={constructor:d.vo.metrics.ManifestUpdate.PeriodInfo},d.vo.metrics.ManifestUpdate.RepresentationInfo.prototype={constructor:d.vo.metrics.ManifestUpdate.RepresentationInfo},d.vo.metrics.PlaybackQuality=function(){"use strict";this.t=null,this.mt=null,this.droppedFrames=null,this.totalVideoFrames=null},d.vo.metrics.PlaybackQuality.prototype={constructor:d.vo.metrics.PlaybackQuality},d.vo.metrics.PlayList=function(){"use strict";this.stream=null,this.start=null,this.mstart=null,this.starttype=null,this.trace=[]},d.vo.metrics.PlayList.Trace=function(){"use strict";this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null},d.vo.metrics.PlayList.prototype={constructor:d.vo.metrics.PlayList},d.vo.metrics.PlayList.INITIAL_PLAY_START_REASON="initial_start",d.vo.metrics.PlayList.SEEK_START_REASON="seek",d.vo.metrics.PlayList.Trace.prototype={constructor:d.vo.metrics.PlayList.Trace()},d.vo.metrics.PlayList.Trace.USER_REQUEST_STOP_REASON="user_request",d.vo.metrics.PlayList.Trace.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",d.vo.metrics.PlayList.Trace.END_OF_CONTENT_STOP_REASON="end_of_content",d.vo.metrics.PlayList.Trace.REBUFFERING_REASON="rebuffering",d.vo.metrics.RepresentationSwitch=function(){"use strict";this.t=null,this.mt=null,this.to=null,this.lto=null},d.vo.metrics.RepresentationSwitch.prototype={constructor:d.vo.metrics.RepresentationSwitch},d.vo.metrics.Session=function(){"use strict";this.uri=null,this.loopMode=null,this.endTime=null,this.playerType=null},d.vo.metrics.Session.prototype={constructor:d.vo.metrics.Session},d.vo.metrics.State=function(){"use strict";this.t=null,this.current=null,this.position=null,this.reason=null},d.vo.metrics.State.prototype={constructor:d.vo.metrics.State},d.vo.metrics.TCPConnection=function(){"use strict";this.tcpid=null,this.dest=null,this.topen=null,this.tclose=null,this.tconnect=null},d.vo.metrics.TCPConnection.prototype={constructor:d.vo.metrics.TCPConnection},d.vo.metrics.VideoResolution=function(){"use strict";this.t=null,this.mt=null,this.width=null,this.height=null},d.vo.metrics.VideoResolution.prototype={constructor:d.vo.metrics.VideoResolution},c=function(){"use strict";return{modules:{},dependencies:{},vo:{},di:{}}}(),c.dependencies.BaseURLExtensions=function(){"use strict";var e=function(e,t){var n,i,r,o,s,a,l,u,c,d,h=new DataView(e),f={},p=0;while("sidx"!==u&&p<h.byteLength){for(c=h.getUint32(p),p+=4,u="",o=0;o<4;o+=1)d=h.getInt8(p),u+=String.fromCharCode(d),p+=1;"moof"!==u&&"traf"!==u&&"sidx"!==u?p+=c-8:"sidx"===u&&(p-=8)}if(r=h.getUint32(p,!1)+p,r>e.byteLength)throw"sidx terminates after array buffer";for(f.version=h.getUint8(p+8),p+=12,f.timescale=h.getUint32(p+4,!1),p+=8,0===f.version?(f.earliest_presentation_time=h.getUint32(p,!1),f.first_offset=h.getUint32(p+4,!1),p+=8):(f.earliest_presentation_time=g.Math.to64BitNumber(h.getUint32(p+4,!1),h.getUint32(p,!1)),f.first_offset=(h.getUint32(p+8,!1)<<32)+h.getUint32(p+12,!1),p+=16),f.first_offset+=r+(t||0),f.reference_count=h.getUint16(p+2,!1),p+=4,f.references=[],n=f.first_offset,i=f.earliest_presentation_time,o=0;o<f.reference_count;o+=1)a=h.getUint32(p,!1),s=a>>>31,a&=2147483647,l=h.getUint32(p+4,!1),p+=12,a>0&&f.references.push({size:a,type:s,offset:n,duration:l,time:i,timescale:f.timescale}),n+=a,i+=l;if(p!==r)throw"Error: final pos "+p+" differs from SIDX end "+r;return f},n=function(t,n,i){var r,o,s,a,l,u,d,h;for(r=e.call(this,t,i),o=r.references,s=[],l=0,u=o.length;l<u;l+=1)a=new c.vo.Segment,a.duration=o[l].duration,a.media=n,a.startTime=o[l].time,a.timescale=o[l].timescale,d=o[l].offset,h=o[l].offset+o[l].size-1,a.mediaRange=d+"-"+h,s.push(a);return this.debug.log("Parsed SIDX box: "+s.length+" segments."),s},i=function(e,n){var r,o,s,a,l,u,c,d,h=t.defer(),f=new DataView(e),p=0,m="",g=0,y=!1,v=this;v.debug.log("Searching for initialization.");while("moov"!==m&&p<f.byteLength){for(g=f.getUint32(p),p+=4,m="",l=0;l<4;l+=1)u=f.getInt8(p),m+=String.fromCharCode(u),p+=1;"ftyp"===m&&(r=p-8),"moov"===m&&(o=p-8),"moov"!==m&&(p+=g-8)}return f.byteLength-p,"moov"!==m?(v.debug.log("Loading more bytes to find initialization."),n.range.start=0,n.range.end=n.bytesLoaded+n.bytesToLoad,c=new XMLHttpRequest,c.onloadend=function(){y||h.reject("Error loading initialization.")},c.onload=function(){y=!0,n.bytesLoaded=n.range.end,i.call(v,c.response).then(function(e){h.resolve(e)})},c.onerror=function(){h.reject("Error loading initialization.")},c.open("GET",v.tokenAuthentication.addTokenAsQueryArg(n.url)),c.responseType="arraybuffer",c.setRequestHeader("Range","bytes="+n.range.start+"-"+n.range.end),c=v.tokenAuthentication.setTokenInRequestHeader(c),c.send(null)):(s=void 0===r?o:r,a=o+g-1,d=s+"-"+a,v.debug.log("Found the initialization.  Range: "+d),h.resolve(d)),h.promise},r=function(e){var n=t.defer(),r=new XMLHttpRequest,o=!0,s=this,a={url:e,range:{},searching:!1,bytesLoaded:0,bytesToLoad:1500,request:r};return s.debug.log("Start searching for initialization."),a.range.start=0,a.range.end=a.bytesToLoad,r.onload=function(){r.status<200||r.status>299||(o=!1,a.bytesLoaded=a.range.end,i.call(s,r.response,a).then(function(e){n.resolve(e)},function(){n.reject()}))},r.onloadend=r.onerror=function(){if(o){o=!1;var e={};e.url=a.url,e.request=r,s.errHandler.sendError(d.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_INIT,null,e),n.reject(r)}},r.open("GET",s.tokenAuthentication.addTokenAsQueryArg(a.url)),r.responseType="arraybuffer",r.setRequestHeader("Range","bytes="+a.range.start+"-"+a.range.end),r=s.tokenAuthentication.setTokenInRequestHeader(r),r.send(null),s.debug.log("Perform init search: "+a.url),n.promise},o=function(e,i){var r,s,a,l,u,c,h,f,p=t.defer(),m=new DataView(e),g=new XMLHttpRequest,y=0,v="",b=0,E=!0,_=!1,x=this;x.debug.log("Searching for SIDX box."),x.debug.log(i.bytesLoaded+" bytes loaded.");while("sidx"!==v&&y<m.byteLength){for(b=m.getUint32(y),y+=4,v="",u=0;u<4;u+=1)c=m.getInt8(y),v+=String.fromCharCode(c),y+=1;"sidx"!==v&&(y+=b-8)}if(r=m.byteLength-y,"sidx"!==v)p.reject();else if(r<b-8)x.debug.log("Found SIDX but we don't have all of it."),i.range.start=0,i.range.end=i.bytesLoaded+(b-r),g.onload=function(){g.status<200||g.status>299||(E=!1,i.bytesLoaded=i.range.end,o.call(x,g.response,i).then(function(e){p.resolve(e)}))},g.onloadend=g.onerror=function(){if(E){E=!1;var e={};e.url=i.url,e.request=g,x.errHandler.sendError(d.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_SIDX,null,e),p.reject(g)}},g.open("GET",x.tokenAuthentication.addTokenAsQueryArg(i.url)),g.responseType="arraybuffer",g.setRequestHeader("Range","bytes="+i.range.start+"-"+i.range.end),g=x.tokenAuthentication.setTokenInRequestHeader(g),g.send(null);else if(i.range.start=y-8,i.range.end=i.range.start+b,x.debug.log("Found the SIDX box.  Start: "+i.range.start+" | End: "+i.range.end),s=new ArrayBuffer(i.range.end-i.range.start),l=new Uint8Array(s),a=new Uint8Array(e,i.range.start,i.range.end-i.range.start),l.set(a),h=this.parseSIDX.call(this,s,i.range.start),f=h.references,null!==f&&void 0!==f&&f.length>0&&(_=1===f[0].type),_){x.debug.log("Initiate multiple SIDX load.");var T,S,w,I,D,M,A=[];for(T=0,S=f.length;T<S;T+=1)w=f[T].offset,I=f[T].offset+f[T].size-1,D=w+"-"+I,A.push(this.loadSegments.call(x,i.url,D));t.all(A).then(function(e){for(M=[],T=0,S=e.length;T<S;T+=1)M=M.concat(e[T]);p.resolve(M)},function(e){p.reject(e)})}else x.debug.log("Parsing segments from SIDX."),p.resolve(n.call(x,s,i.url,i.range.start));return p.promise},s=function(e,i){var r,s=t.defer(),a=new XMLHttpRequest,l=!0,u=this,c={url:e,range:{},searching:!1,bytesLoaded:0,bytesToLoad:1500,request:a};return null===i?(u.debug.log("No known range for SIDX request."),c.searching=!0,c.range.start=0,c.range.end=c.bytesToLoad):(r=i.split("-"),c.range.start=parseFloat(r[0]),c.range.end=parseFloat(r[1])),a.onload=function(){a.status<200||a.status>299||(l=!1,c.searching?(c.bytesLoaded=c.range.end,o.call(u,a.response,c).then(function(e){s.resolve(e)},function(){s.reject()})):s.resolve(n.call(u,a.response,c.url,c.range.start)))},a.onloadend=a.onerror=function(){if(l){l=!1;var e={};e.url=c.url,e.request=a,u.errHandler.sendError(d.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_SIDX,null,e),s.reject(a)}},a.open("GET",u.tokenAuthentication.addTokenAsQueryArg(c.url)),a.responseType="arraybuffer",a.setRequestHeader("Range","bytes="+c.range.start+"-"+c.range.end),a=u.tokenAuthentication.setTokenInRequestHeader(a),a.send(null),u.debug.log("Perform SIDX load: "+c.url),s.promise};return{debug:void 0,errHandler:void 0,tokenAuthentication:void 0,loadSegments:s,loadInitialization:r,parseSegments:n,parseSIDX:e,findSIDX:o}},c.dependencies.BaseURLExtensions.prototype={constructor:c.dependencies.BaseURLExtensions},c.di.DashContext=function(){"use strict";return{system:void 0,setup:function(){c.di.DashContext.prototype.setup.call(this),this.system.mapClass("parser",c.dependencies.DashParser),this.system.mapClass("indexHandler",c.dependencies.DashHandler),this.system.mapClass("baseURLExt",c.dependencies.BaseURLExtensions),this.system.mapClass("fragmentExt",c.dependencies.FragmentExtensions),this.system.mapSingleton("manifestExt",c.dependencies.DashManifestExtensions),this.system.mapSingleton("metricsExt",c.dependencies.DashMetricsExtensions),this.system.mapSingleton("timelineConverter",c.dependencies.TimelineConverter)}}},c.di.DashContext.prototype=new d.di.Context,c.di.DashContext.prototype.constructor=c.di.DashContext,c.dependencies.DashHandler=function(){"use strict";var e,n,i=-1,r=null,o=function(e,t){while(e.length<t)e="0"+e;return e},s=function(e,t,n){var i,r,s,a,l=0,u=0,c=t.length,d="%0",h=d.length;while(1){if(l=e.indexOf("$"+t),l<0)return e;if(u=e.indexOf("$",l+c),u<0)return e;if(i=e.indexOf(d,l+c),i>l&&i<u)switch(r=e.charAt(u-1),s=parseInt(e.substring(i+h,u-1),10),r){case"d":case"i":case"u":a=o(n.toString(),s);break;case"x":a=o(n.toString(16),s);break;case"X":a=o(n.toString(16),s).toUpperCase();break;case"o":a=o(n.toString(8),s);break;default:return this.debug.log("Unsupported/invalid IEEE 1003.1 format identifier string in URL"),e}else a=n;e=e.substring(0,l)+a+e.substring(u+1)}},a=function(e){return e.split("$$").join("$")},l=function(e,t){if(null===t||-1===e.indexOf("$RepresentationID$"))return e;var n=t.toString();return e.split("$RepresentationID$").join(n)},u=function(e,t){return e.representation.startNumber+t},h=function(e,t){var n,i=t.adaptation.period.mpd.manifest.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index].Representation_asArray[t.index].BaseURL;return n=e===i?e:-1!==e.indexOf("http://")||-1!==e.indexOf("https://")?e:i+e,n},f=function(t,n){var i,r,o=this,s=new d.vo.SegmentRequest;return i=t.adaptation.period,s.streamType=n,s.type="Initialization Segment",s.url=h(t.initialization,t),s.range=t.range,r=i.start,s.availabilityStartTime=o.timelineConverter.calcAvailabilityStartTimeFromPresentationTime(r,t.adaptation.period.mpd,e),s.availabilityEndTime=o.timelineConverter.calcAvailabilityEndTimeFromPresentationTime(r+i.duration,i.mpd,e),s.quality=t.index,s},p=function(e){var i=t.defer(),r=null,o=null,s=this;return e?(e.initialization?(r=f.call(s,e,n),i.resolve(r)):(o=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].BaseURL,s.baseURLExt.loadInitialization(o).then(function(t){e.range=t,e.initialization=o,r=f.call(s,e,n),i.resolve(r)},function(e){i.reject(e)})),i.promise):t.reject("no represenation")},m=function(t){var n,r,o,s=t.adaptation.period,a=!1;return e?a=!1:i<0?a=!1:i<t.availableSegmentsNumber+t.segmentStartIndex?(r=M(i,t),r&&(o=r.presentationStartTime-s.start,n=t.adaptation.period.duration,a=o>=n)):a=!0,a},g=function(t,n){var i,r,o,s,a=this;return r=t.segmentDuration,o=t.adaptation.period.start+n*r,s=o+r,i=new c.vo.Segment,i.representation=t,i.duration=r,i.presentationStartTime=o,i.mediaStartTime=a.timelineConverter.calcMediaTimeFromPresentationTime(i.presentationStartTime,t),i.availabilityStartTime=a.timelineConverter.calcAvailabilityStartTimeFromPresentationTime(i.presentationStartTime,t.adaptation.period.mpd,e),i.availabilityEndTime=a.timelineConverter.calcAvailabilityEndTimeFromPresentationTime(s,t.adaptation.period.mpd,e),i.wallStartTime=a.timelineConverter.calcWallTimeForSegment(i,e),i.replacementNumber=u(i,n),i.availabilityIdx=n,i},y=function(e){var n,i,o,s,a,l,u,c,d,h,f,p,m,g=this,y=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate,v=y.SegmentTimeline,b=e.availableSegmentsNumber>0,_=10,T=[],S=0,w=-1,I=!1,D=function(t){return x.call(g,e,S,t.d,m,y.media,t.mediaRange,w,t.tManifest)};for(m=e.timescale,n=v.S_asArray,d=E.call(g,e),d?(f=d.start,p=d.end):h=g.timelineConverter.calcMediaTimeFromPresentationTime(r||0,e),o=0,s=n.length;o<s;o+=1)if(i=n[o],l=0,i.hasOwnProperty("r")&&(l=i.r),i.hasOwnProperty("t")&&(S=i.t),l<0&&(c=n[o+1],u=c&&c.hasOwnProperty("t")?c.t/m:e.adaptation.period.duration,l=Math.ceil((u-S/m)/(i.d/m))-1),I){if(b)break;w+=l+1}else for(a=0;a<=l;a+=1){if(w+=1,d){if(w>p){if(I=!0,b)break;continue}w>=f&&T.push(D.call(g,i))}else{if(T.length>_){if(I=!0,b)break;continue}S/m>=h-i.d/m&&T.push(D.call(g,i))}S+=i.d}var M,A,L=n[0];return M=void 0===L.t?0:g.timelineConverter.calcPresentationTimeFromMediaTime(L.t/m,e),A=g.timelineConverter.calcPresentationTimeFromMediaTime((S-i.d)/m,e),e.segmentAvailabilityRange={start:M,end:A},e.availableSegmentsNumber=w+1,e.segmentStartIndex=0,t.when(T)},v=function(n){var i,r,o,a,l=[],u=this,c=t.defer(),d=n.adaptation.period.mpd.manifest.Period_asArray[n.adaptation.period.index].AdaptationSet_asArray[n.adaptation.index].Representation_asArray[n.index].SegmentTemplate,h=n.segmentDuration,f=null,p=Math.floor(n.adaptation.period.start/h),m=null,y=null;return a=n.startNumber,_.call(u,n).then(function(t){for(n.segmentAvailabilityRange=t,f=b.call(u,n),r=f.start,o=f.end,i=r;i<=o;i+=1)m=g.call(u,n,i-(e?p:0)),m.replacementTime=(a+i-1)*n.segmentDuration,y=d.media,y=s(y,"Number",m.replacementNumber),y=s(y,"Time",m.replacementTime),m.media=y,l.push(m),m=null;n.availableSegmentsNumber=p+Math.ceil((t.end-t.start)/h),n.segmentStartIndex=r,c.resolve(l)}),c.promise},b=function(t){var n,o,s,a=this,l=t.adaptation.period.start,u=t.segmentDuration,c=t.adaptation.period.mpd.manifest.minBufferTime,d=t.segmentAvailabilityRange,h=NaN,f=null,p=t.segments,m=2*u,g=Math.max(2*c,10*u);return d||(d=a.timelineConverter.calcSegmentAvailabilityRange(t,e)),e&&!t.adaptation.period.mpd.isClientServerTimeSyncCompleted?(n=Math.floor(d.start/u),o=Math.floor(d.end/u),s={start:n,end:o},s):(p?(f=M(i,t),h=f?f.presentationStartTime-l:i>0?i*u:r-l||p[0].presentationStartTime-l):h=i>0?i*u:e?d.end:d.start,n=Math.floor(Math.max(h-m,d.start)/u),o=Math.floor(Math.min(n+g/u,d.end/u)),s={start:n,end:o},s)},E=function(t){var n,o,s,a=NaN,l=t.segments,u=2,c=10,d=0,h=Number.POSITIVE_INFINITY;if(e&&!t.adaptation.period.mpd.isClientServerTimeSyncCompleted)return s={start:d,end:h},s;if(!e&&null!==r)return null;if(l){if(i<0)return null;a=i}else a=i>0?i:e?h:d;return n=Math.max(a-u,d),o=Math.min(a+c,h),s={start:n,end:o},s},_=function(n){var i,r,o=this,s=t.defer(),a=function(){i=o.timelineConverter.calcSegmentAvailabilityRange(n,e),i.end>0?s.resolve(i):(r=1e3*Math.abs(i.end),setTimeout(a,r))};return a(),s.promise},x=function(t,n,i,r,o,a,l,d){var h,f,p,m=this,g=n/r,y=Math.min(i/r,t.adaptation.period.mpd.maxSegmentDuration);return h=m.timelineConverter.calcPresentationTimeFromMediaTime(g,t),h=g,f=h+y,p=new c.vo.Segment,p.representation=t,p.duration=y,p.mediaStartTime=g,p.presentationStartTime=h,p.availabilityStartTime=t.adaptation.period.mpd.manifest.mpdLoadedTime,p.availabilityEndTime=m.timelineConverter.calcAvailabilityEndTimeFromPresentationTime(f,t.adaptation.period.mpd,e),p.wallStartTime=m.timelineConverter.calcWallTimeForSegment(p,e),p.replacementTime=d||n,p.replacementNumber=u(p,l),o=s(o,"Number",p.replacementNumber),o=s(o,"Time",p.replacementTime),p.media=o,p.mediaRange=a,p.availabilityIdx=l,p},T=function(n){var i,r,o,s,a,l=this,u=[],c=t.defer(),d=n.adaptation.period.mpd.manifest.Period_asArray[n.adaptation.period.index].AdaptationSet_asArray[n.adaptation.index].Representation_asArray[n.index].SegmentList,h=d.SegmentURL_asArray.length,f=0,p=d.SegmentURL_asArray.length;return a=n.startNumber,_.call(l,n).then(function(t){for(e||(s=b.call(l,n),f=s.start,p=s.end),i=f;i<p;i+=1)o=d.SegmentURL_asArray[i],r=g.call(l,n,i),r.replacementTime=(a+i-1)*n.segmentDuration,r.media=o.media,r.mediaRange=o.mediaRange,r.index=o.index,r.indexRange=o.indexRange,o.duration&&(r.duration=o.duration,r.presentationStartTime=r.mediaStartTime=o.time),void 0!==o.sequenceNumber&&(r.sequenceNumber=o.sequenceNumber),void 0!==o.decryptionInfo&&(r.decryptionInfo=o.decryptionInfo),u.push(r),r=null;n.segmentAvailabilityRange=t,n.availableSegmentsNumber=h,n.segmentStartIndex=f,c.resolve(u)}),c.promise},S=function(e){var n,i,r,o,s=this,a=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].BaseURL,l=t.defer(),u=[],c=0,d=null;return e.indexRange&&(d=e.indexRange),this.baseURLExt.loadSegments(a,d).then(function(t){for(i=0,r=t.length;i<r;i+=1)n=t[i],o=x.call(s,e,n.startTime,n.duration,n.timescale,n.media,n.mediaRange,c),u.push(o),o=null,c+=1;e.segmentAvailabilityRange={start:u[0].presentationStartTime,end:u[r-1].presentationStartTime},e.availableSegmentsNumber=r,e.segmentStartIndex=0,l.resolve(u)},function(){l.reject()}),l.promise},w=function(n){var i,r,o=t.defer(),s=this;return L.call(s,n)?(i="SegmentTimeline"===n.segmentInfoType?y.call(s,n):"SegmentTemplate"===n.segmentInfoType?v.call(s,n):"SegmentList"===n.segmentInfoType?T.call(s,n):S.call(s,n),t.when(i).then(function(t){if(n.segments=t,r=t.length-1,e&&isNaN(n.adaptation.period.liveEdge)){var i=s.metricsModel.getMetricsFor("stream"),a=t[r].presentationStartTime;n.adaptation.period.liveEdge=a,s.metricsModel.updateManifestUpdateInfo(s.metricsExt.getCurrentManifestUpdate(i),{presentationStartTime:a})}o.resolve(t)},function(){o.reject()}),o.promise):t.when(n.segments)},I=function(e){var i=this,r=t.defer();return e.segments=null,i.debug.log("[DashHandler]["+n+"] updateSegmentList for representation ",e.id),w.call(i,e).then(function(t){e.segments=t,r.resolve(t)}),r.promise},D=function(e,i){var r,o,s,a,l=null===i?null:i.segments,u=null===l?0:l.length-1,d=-1,h=this;if(h.debug.log("[DashHandler]["+n+"] getIndexForSegments for time ",e),l&&l.length>0)for(a=u;a>=0;a--){if(r=l[a],o=r.presentationStartTime,s=r.duration,e+c.dependencies.DashHandler.EPSILON>=o&&e-c.dependencies.DashHandler.EPSILON<=o+s){d=r.availabilityIdx,h.debug.log("[DashHandler]["+n+"] getIndexForSegments, idx =  ",d);break}if(-1===d&&e-c.dependencies.DashHandler.EPSILON>o+s){h.debug.log("[DashHandler]["+n+"] getIndexForSegments, (past the end) idx =  ",d),d=isNaN(i.segmentDuration)?r.availabilityIdx+1:Math.floor((e-i.adaptation.period.start)/i.segmentDuration);break}}return-1===d&&(isNaN(i.segmentDuration)?l&&l.length>0&&e<l[0].presentationStartTime?(h.debug.log("[DashHandler]["+n+"] getIndexForSegments, (before start) idx =  ",d),d=0):h.debug.log("[DashHandler]["+n+"] Couldn't figure out segment for time: "+e):(h.debug.log("[DashHandler]["+n+"] getIndexForSegments, (segment duration) idx =  ",d),d=Math.floor((e-i.adaptation.period.start)/i.segmentDuration))),t.when(d)},M=function(e,t){if(!t||!t.segments)return null;var n,i,r=t.segments.length;for(i=0;i<r;i+=1)if(n=t.segments[i],n.availabilityIdx===e)return n;return null},A=function(e,t){if(!t||!t.segments)return null;var n,i,r=t.segments.length;for(i=0;i<r;i+=1)if(n=t.segments[i],void 0!==n.sequenceNumber&&n.sequenceNumber===e)return i<r-1?t.segments[i+1]:null;return null},L=function(e){var t,n,o,s,a=!1,l=e.segments;return l&&0!==l.length?null!==r?(s=l[0].presentationStartTime,o=l[l.length-1].presentationStartTime,a=r<s||r>o):(n=l[0].availabilityIdx,t=l[l.length-1].availabilityIdx,a=i<n||i>t):a=!0,a},R=function(e){if(null===e||void 0===e)return null;var t,i=new d.vo.SegmentRequest,r=e.representation,o=r.adaptation.period.mpd.manifest.Period_asArray[r.adaptation.period.index].AdaptationSet_asArray[r.adaptation.index].Representation_asArray[r.index].bandwidth;return t=h(e.media,r),t=s(t,"Number",e.replacementNumber),t=s(t,"Time",e.replacementTime),t=s(t,"Bandwidth",o),t=l(t,r.id),t=a(t),i.streamType=n,i.type="Media Segment",i.url=t,i.range=e.mediaRange,i.startTime=e.presentationStartTime,i.duration=e.duration,i.timescale=r.timescale,i.availabilityStartTime=e.availabilityStartTime,i.availabilityEndTime=e.availabilityEndTime,i.wallStartTime=e.wallStartTime,i.quality=r.index,i.index=e.availabilityIdx,void 0!==e.sequenceNumber&&(i.sequenceNumber=e.sequenceNumber),void 0!==e.decryptionInfo&&(i.decryptionInfo=e.decryptionInfo),i},P=function(e,o){var s,a,l,u=this;return e?(r=o,i=-1,u.debug.log("[DashHandler]["+n+"] Getting the request for time: "+o),s=t.defer(),w.call(u,e).then(function(){var t;return t=D.call(u,o,e),t},function(){s.reject()}).then(function(r){return u.debug.log("[DashHandler]["+n+"] Index for time "+o+" is "+r),i=r,t.when(m.call(u,e))}).then(function(r){var o=null;return r?(a=new d.vo.SegmentRequest,a.action=a.ACTION_COMPLETE,a.index=i,u.debug.log("[DashHandler]["+n+"] Signal complete."),u.debug.log(a),s.resolve(a)):(l=M(i,e),o=R.call(u,l)),t.when(o)}).then(function(e){s.resolve(e)}),s.promise):t.reject("no representation")},C=function(e){var o,s,a,l,u=this;if(!e)return t.reject("no represenation");if(-1===i)throw"You must call getSegmentRequestForTime first.";return r=null,i+=1,o=t.defer(),u.debug.log("[DashHandler]["+n+"] Getting the next request => index = "+i),l=m.call(u,e),l?(s=new d.vo.SegmentRequest,s.action=s.ACTION_COMPLETE,s.index=i,u.debug.log("[DashHandler]["+n+"] Signal complete."),o.resolve(s)):w.call(u,e).then(function(){var n;return a=M(i,e),n=R.call(u,a),t.when(n)}).then(function(e){o.resolve(e)}),o.promise},N=function(e,o){var s,a,l,u,c=this;if(!e)return t.reject("no represenation");if(-1===i)throw"You must call getSegmentRequestForTime first.";return r=null,i+=1,s=t.defer(),c.debug.log("[DashHandler]["+n+"] Getting the next request => sn = "+o),w.call(c,e).then(function(){if(u=m.call(c,e),u)a=new d.vo.SegmentRequest,a.action=a.ACTION_COMPLETE,a.index=i,c.debug.log("[DashHandler]["+n+"] Signal complete."),s.resolve(a);else if(l=A(o,e),null===l)s.resolve(null);else{i=l.availabilityIdx;var t=R.call(c,l);s.resolve(t)}}),s.promise},B=function(e,i,r){var o,s=this,a=Math.max(i-r,0),l=t.defer(),u=0;return e?(s.debug.log("[DashHandler]["+n+"] getSegmentCountForDuration"),w.call(s,e).then(function(e){o=e[0].duration,u=Math.ceil(a/o),l.resolve(u)},function(){l.resolve(0)}),l.promise):t.reject("no represenation")},F=function(e){var r,o,s=this,a=t.defer();return e?(o=i,w.call(s,e).then(function(t){o<0?r=s.timelineConverter.calcPresentationStartTime(e.adaptation.period):(o=o<t[0].availabilityIdx?t[0].availabilityIdx:Math.min(t[t.length-1].availabilityIdx,o),r=M(o,e).presentationStartTime,s.debug.log("[DashHandler]["+n+"] getSegmentByIndex, index = "+o+" => time = "+r)),s.debug.log("[DashHandler]["+n+"] getCurrentTime => ",r),a.resolve(r)},function(){a.reject()}),a.promise):t.reject("no represenation")},k=function(){},O=function(){};return{debug:void 0,baseURLExt:void 0,metricsModel:void 0,metricsExt:void 0,manifestModel:void 0,manifestExt:void 0,timelineConverter:void 0,capabilities:void 0,videoModel:void 0,getType:function(){return n},setType:function(e){n=e},getIsDynamic:function(){return e},setIsDynamic:function(t){e=t},getInitRequest:p,getSegmentRequestForTime:P,getNextSegmentRequest:C,getNextSegmentRequestFromSN:N,getCurrentTime:F,getSegmentCountForDuration:B,updateSegmentList:I,getIFrameRequest:k,getFragmentInfoRequest:O}},c.dependencies.DashHandler.EPSILON=.003,c.dependencies.DashHandler.prototype={constructor:c.dependencies.DashHandler},c.dependencies.DashManifestExtensions=function(){"use strict";this.timelineConverter=void 0},c.dependencies.DashManifestExtensions.prototype={constructor:c.dependencies.DashManifestExtensions,isInteger:Number.isInteger||function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e},getIsType:function(e,t,n){"use strict";var i,r,o,s,a=!1;if(!e)return!1;if(void 0===e.type&&(e.type=null),o=e.ContentComponent_asArray,o)for(i=0;i<e.ContentComponent_asArray.length&&!a;i++)e.ContentComponent_asArray[i].contentType===t&&(e.type=t,a=!0);if(!a&&e.mimeType)for(i=0;i<n.length&&!a;i++)-1!==e.mimeType.indexOf(n[i])&&(e.type=t,a=!0);if(!a)for(i=0;i<e.Representation_asArray.length&&!a;i++)for(s=e.Representation_asArray[i],r=0;r<n.length&&!a;r++)-1!==s.mimeType.indexOf(n[r])&&(e.type=t,a=!0);return a},getIsVideo:function(e){return this.getIsType(e,"video",["video"])},getIsAudio:function(e){return this.getIsType(e,"audio",["audio"])},getIsText:function(e){return this.getIsType(e,"text",["vtt","ttml","application/mp4"])},getIsTextTrack:function(e){return"text/vtt"===e||"application/ttml+xml"===e||"application/ttml+xml+mp4"===e||"application/mp4"===e},getIsMain:function(){"use strict";return!1},processAdaptation:function(e){"use strict";return void 0!==e.Representation_asArray&&null!==e.Representation_asArray&&e.Representation_asArray.sort(function(e,t){return e.bandwidth-t.bandwidth}),e},getDataForId:function(e,t,n){"use strict";var i,r,o=t.Period_asArray[n].AdaptationSet_asArray;for(i=0,r=o.length;i<r;i+=1)if(o[i].hasOwnProperty("id")&&o[i].id===e)return o[i];return null},getDataForIndex:function(e,t,n){"use strict";var i;return t&&n>=0&&(i=t.Period_asArray[n].AdaptationSet_asArray,i&&i.length>0&&!isNaN(e))?i[e]:[]},getIndex:function(e,t){var n,i,r,o=t.Period_asArray;for(i=0;i<o.length;i+=1)for(n=o[i].AdaptationSet_asArray,r=0;r<n.length;r+=1)if(n[r]===e)return r;return-1},getDataIndex:function(e,t,n){"use strict";var i,r,o;if(t&&n>=0)if(i=t.Period_asArray[n].AdaptationSet_asArray,e.id){for(r=0,o=i.length;r<o;r+=1)if(i[r].id&&i[r].id===e.id)return r}else{var s,a=JSON.stringify(e);for(r=0,o=i.length;r<o;r+=1)if(s=JSON.stringify(i[r]),s===a)return r}return-1},getVideoData:function(e,t){"use strict";var n,i;if(!e||t<0)return null;if(n=e.Period_asArray[t].AdaptationSet_asArray,0===n.length)return null;for(i=0;i<n.length;i+=1)if(this.getIsVideo(n[i]))return n[i];return null},getTextDatas:function(e,t){"use strict";var n,i,r=[];if(!e||t<0)return r;if(n=e.Period_asArray[t].AdaptationSet_asArray,0===n.length)return r;for(i=0;i<n.length;i+=1)this.getIsText(n[i])&&r.push(n[i]);return r},getAudioDatas:function(e,t){"use strict";var n,i,r=[];if(!e||t<0)return r;if(n=e.Period_asArray[t].AdaptationSet_asArray,0===n.length)return r;for(i=0;i<n.length;i+=1)this.getIsAudio(n[i])&&r.push(n[i]);return r},getSpecificAudioData:function(e,t,n){"use strict";var i,r;if(!e||t<0)return null;if(r=this.getAudioDatas(e,t),0===r.length)return null;for(i=0;i<r.length;i+=1)if(r[i].lang===n)return this.processAdaptation(r[i]);return this.processAdaptation(r[0])},getSpecificTextData:function(e,t,n){"use strict";var i,r;if(!e||t<0)return null;if(r=this.getTextDatas(e,t),0===r.length)return null;for(i=0;i<r.length;i+=1)if(r[i].lang===n)return this.processAdaptation(r[i]);return this.processAdaptation(r[0])},getCodec:function(e){"use strict";var t,n=0,i=null;while(null===i&&n<e.Representation_asArray.length)t=e.Representation_asArray[n],i=this.getCodecForRepresentation(t),n++;return i},getCodecForRepresentation:function(e){"use strict";return null===e.codecs||""===e.codecs?null:e.mimeType+';codecs="'+e.codecs+'"'},getMimeType:function(e){"use strict";return e.Representation_asArray[0].mimeType},getKID:function(e){"use strict";return e&&e.hasOwnProperty("cenc:default_KID")?e["cenc:default_KID"]:null},getContentProtectionData:function(e){"use strict";return e&&e.hasOwnProperty("ContentProtection_asArray")&&0!==e.ContentProtection_asArray.length?e.ContentProtection_asArray:null},getIsDynamic:function(e){"use strict";var t=!1,n="dynamic";return e&&e.hasOwnProperty("type")&&(t=e.type===n),t},getIsDVR:function(e){"use strict";var t,n,i=this.getIsDynamic(e);return t=!isNaN(e.timeShiftBufferDepth),n=i&&t,n},getIsOnDemand:function(e){"use strict";var t=!1;return e.profiles&&e.profiles.length>0&&(t=-1!==e.profiles.indexOf("urn:mpeg:dash:profile:isoff-on-demand:2011")),t},getIsStartOver:function(e){"use strict";var t=!1;return e&&e.hasOwnProperty("startOver")&&(t=!0===e.startOver),t},getDuration:function(e){var t;return t=e&&e.hasOwnProperty("mediaPresentationDuration")?e.mediaPresentationDuration:Number.POSITIVE_INFINITY,t},getBandwidth:function(e){"use strict";return e&&e.bandwidth?e.bandwidth:NaN},getRefreshDelay:function(e){"use strict";var t=NaN,n=2;return e.hasOwnProperty("minimumUpdatePeriod")&&(t=Math.max(parseFloat(e.minimumUpdatePeriod),n)),t},getRepresentationCount:function(e){"use strict";return e?e.Representation_asArray.length:null},getRepresentationFor:function(e,t){"use strict";return t&&t.Representation_asArray&&t.Representation_asArray.length>0&&this.isInteger(e)&&e<t.Representation_asArray.length?t.Representation_asArray[e]:null},getRepresentationsForAdaptation:function(e,t){var n,i,r,o,s,a=[];if(e&&t){n=this.processAdaptation(e.Period_asArray[t.period.index].AdaptationSet_asArray[t.index]);for(var l=0;l<n.Representation_asArray.length;l+=1)s=n.Representation_asArray[l],i=new c.vo.Representation,i.index=l,i.adaptation=t,s.hasOwnProperty("id")&&(i.id=s.id),s.hasOwnProperty("SegmentBase")?(o=s.SegmentBase,i.segmentInfoType="SegmentBase"):s.hasOwnProperty("SegmentList")?(o=s.SegmentList,i.segmentInfoType="SegmentList",i.useCalculatedLiveEdgeTime=!0):s.hasOwnProperty("SegmentTemplate")?(o=s.SegmentTemplate,o.hasOwnProperty("SegmentTimeline")?i.segmentInfoType="SegmentTimeline":i.segmentInfoType="SegmentTemplate",o.hasOwnProperty("initialization")&&(i.initialization=o.initialization.split("$Bandwidth$").join(s.bandwidth).split("$RepresentationID$").join(s.id))):(o=s.BaseURL,i.segmentInfoType="BaseURL"),o.hasOwnProperty("Initialization")?(r=o.Initialization,r.hasOwnProperty("sourceURL")?i.initialization=r.sourceURL:r.hasOwnProperty("range")&&(i.initialization=s.BaseURL,i.range=r.range)):s.hasOwnProperty("mimeType")&&this.getIsTextTrack(s.mimeType)&&!i.initialization&&(i.initialization=s.BaseURL,i.range=0),o.hasOwnProperty("timescale")&&(i.timescale=o.timescale),o.hasOwnProperty("duration")&&(i.segmentDuration=o.duration/i.timescale),o.hasOwnProperty("startNumber")&&(i.startNumber=o.startNumber),o.hasOwnProperty("indexRange")&&(i.indexRange=o.indexRange),o.hasOwnProperty("presentationTimeOffset")&&(i.presentationTimeOffset=o.presentationTimeOffset/i.timescale),i.MSETimeOffset=this.timelineConverter.calcMSETimeOffset(i),a.push(i)}return a},getAdaptationsForPeriod:function(e,t){var n,i=null===e?null:e.Period_asArray[t.index],r=[];if(i)for(var o=0;o<i.AdaptationSet_asArray.length;o+=1)n=new c.vo.AdaptationSet,n.index=o,n.period=t,r.push(n);return r},getRegularPeriods:function(e,t){var n,i,r=[],o=this.getIsDynamic(e),s=null,a=null,l=null,u=null;for(n=0,i=e.Period_asArray.length;n<i;n+=1)a=e.Period_asArray[n],a.hasOwnProperty("start")?(u=new c.vo.Period,u.start=a.start):null!==s&&a.hasOwnProperty("duration")?(u=new c.vo.Period,u.start=l.start+l.duration,u.duration=a.duration):0!==n||o||(u=new c.vo.Period,u.start=0),null!==l&&isNaN(l.duration)&&(l.duration=u.start-l.start),null!==u&&a.hasOwnProperty("id")&&(u.id=a.id),null!==u&&a.hasOwnProperty("duration")&&(u.duration=a.duration),null!==u&&(u.index=n,u.mpd=t,r.push(u)),s=a,a=null,l=u,u=null;return 0===r.length?r:(t.checkTime=this.getCheckTime(e,r[0]),null!==l&&isNaN(l.duration)&&(l.duration=this.getEndTimeForLastPeriod(t)-l.start),r)},getMpd:function(e){var t=new c.vo.Mpd;return e?(t.manifest=e,e.hasOwnProperty("availabilityStartTime")?t.availabilityStartTime=new Date(e.availabilityStartTime.getTime()):t.availabilityStartTime=new Date(e.mpdLoadedTime.getTime()),e.hasOwnProperty("availabilityEndTime")&&(t.availabilityEndTime=new Date(e.availabilityEndTime.getTime())),e.hasOwnProperty("suggestedPresentationDelay")&&(t.suggestedPresentationDelay=e.suggestedPresentationDelay),e.hasOwnProperty("timeShiftBufferDepth")&&(t.timeShiftBufferDepth=e.timeShiftBufferDepth),e.hasOwnProperty("maxSegmentDuration")&&(t.maxSegmentDuration=e.maxSegmentDuration),t):null},getFetchTime:function(e,t){var n=this.timelineConverter.calcPresentationTimeFromWallTime(e.mpdLoadedTime,t);return n},getCheckTime:function(e,t){var n=NaN;return e.hasOwnProperty("minimumUpdatePeriod")&&(n=this.getFetchTime(e,t)+e.minimumUpdatePeriod),n},getEndTimeForLastPeriod:function(e){var t;if(e.manifest.mediaPresentationDuration)t=e.manifest.mediaPresentationDuration;else{if(isNaN(e.checkTime))return new Error("Must have @mediaPresentationDuration or @minimumUpdatePeriod on MPD or an explicit @duration on the last period.");t=e.checkTime}return t},getEventsForPeriod:function(e,t){var n=null===e?null:e.Period_asArray,i=null===n?null:n[t.index].EventStream_asArray,r=[];if(i)for(var o=0;o<i.length;o+=1){var s=new c.vo.EventStream;if(s.period=t,s.timescale=1,!i[o].hasOwnProperty("schemeIdUri"))throw"Invalid EventStream. SchemeIdUri has to be set";s.schemeIdUri=i[o].schemeIdUri,i[o].hasOwnProperty("timescale")&&(s.timescale=i[o].timescale),i[o].hasOwnProperty("value")&&(s.value=i[o].value);for(var a=0;a<i[o].Event_asArray.length;a+=1){var l=new c.vo.Event;l.presentationTime=0,l.eventStream=s,i[o].Event_asArray[a].hasOwnProperty("presentationTime")&&(l.presentationTime=i[o].Event_asArray[a].presentationTime),i[o].Event_asArray[a].hasOwnProperty("duration")&&(l.duration=i[o].Event_asArray[a].duration),i[o].Event_asArray[a].hasOwnProperty("id")&&(l.id=i[o].Event_asArray[a].id),r.push(l)}}return r},getEventStreamForAdaptationSet:function(e){var t,n=[];if(e&&(t=e.InbandEventStream_asArray,t))for(var i=0;i<t.length;i+=1){var r=new c.vo.EventStream;if(r.timescale=1,!t[i].hasOwnProperty("schemeIdUri"))throw"Invalid EventStream. SchemeIdUri has to be set";r.schemeIdUri=t[i].schemeIdUri,t[i].hasOwnProperty("timescale")&&(r.timescale=t[i].timescale),t[i].hasOwnProperty("value")&&(r.value=t[i].value),n.push(r)}return n},getEventStreamForRepresentation:function(e,t){var n,i=[];if(e&&t&&(n=e.Representation_asArray[t.index].InbandEventStream_asArray,n))for(var r=0;r<n.length;r++){var o=new c.vo.EventStream;if(o.timescale=1,o.representation=t,!n[r].hasOwnProperty("schemeIdUri"))throw"Invalid EventStream. SchemeIdUri has to be set";o.schemeIdUri=n[r].schemeIdUri,n[r].hasOwnProperty("timescale")&&(o.timescale=n[r].timescale),n[r].hasOwnProperty("value")&&(o.value=n[r].value),i.push(o)}return i},getRepresentationBandwidth:function(e,t){return this.getBandwidth(this.getRepresentationFor(t,e))}},c.dependencies.DashMetricsExtensions=function(){"use strict";var e=function(e,t){var n,i,r,o,s,a,l,u;for(a=0;a<e.length;a+=1)for(n=e[a],r=n.AdaptationSet_asArray,l=0;l<r.length;l+=1)for(i=r[l],s=i.Representation_asArray,u=0;u<s.length;u+=1)if(o=s[u],t===o.id)return u;return-1},t=function(e,t){var n,i,r,o,s,a,l,u;for(a=0;a<e.length;a+=1)for(n=e[a],r=n.AdaptationSet_asArray,l=0;l<r.length;l+=1)for(i=r[l],s=i.Representation_asArray,u=0;u<s.length;u+=1)if(o=s[u],t===o.id)return o;return null},n=function(e,t){var n=!1;return"video"===t?(this.manifestExt.getIsVideo(e),"video"===e.type&&(n=!0)):"audio"===t?(this.manifestExt.getIsAudio(e),"audio"===e.type&&(n=!0)):n=!1,n},i=function(e,t){var i,r,o,s,a,l;for(a=0;a<e.length;a+=1)for(i=e[a],o=i.AdaptationSet_asArray,l=0;l<o.length;l+=1)if(r=o[l],s=r.Representation_asArray,n.call(this,r,t))return s.length;return-1},r=function(e){var n,i=this,r=i.manifestModel.getValue(),o=null===r?null:r.Period_asArray;return o?(n=t.call(i,o,e),null===n?null:n.bandwidth):null},o=function(t){var n,i=this,r=i.manifestModel.getValue(),o=null===r?null:r.Period_asArray;return o?(n=e.call(i,o,t),n):null},s=function(e){var t,n=this,r=n.manifestModel.getValue(),o=null===r?null:r.Period_asArray;return o?(t=i.call(this,o,e),t):null},a=function(e){if(null===e)return null;var t,n,i,r=e.RepSwitchList;return null===r||r.length<=0?null:(t=r.length,n=t-1,i=r[n],i)},l=function(e){if(null===e)return null;var t,n,i,r=e.BufferLevel;return null===r||r.length<=0?null:(t=r.length,n=t-1,i=r[n],i)},u=function(e){if(null===e)return null;var t,n,i=e.HttpList,r=null;if(null===i||i.length<=0)return null;t=i.length,n=t-1;while(n>=0){if(null!==i[n].responsecode){r=i[n];break}n-=1}return r},c=function(e){return null===e?[]:e.HttpList?e.HttpList:[]},d=function(e){if(null===e)return null;var t,n,i,r=e.DroppedFrames;return null===r||r.length<=0?null:(t=r.length,n=t-1,i=r[n],i)},h=function(e){if(null===e)return null;var t=e.PlaybackQuality;return null===t||t.length<=0?null:t[t.length-1]},f=function(e){if(null===e)return null;var t,n=e.DVRInfo,i=null;return null===n||n.length<=0?null:(t=n.length-1,i=n[t],i)},p=function(e){if(null===e)return null;var t,n,i,r=e.ManifestUpdate;return null===r||r.length<=0?null:(t=r.length,n=t-1,i=r[n],i)};return{manifestModel:void 0,manifestExt:void 0,getBandwidthForRepresentation:r,getIndexForRepresentation:o,getMaxIndexForBufferType:s,getCurrentRepresentationSwitch:a,getCurrentBufferLevel:l,getCurrentHttpRequest:u,getHttpRequests:c,getCurrentDroppedFrames:d,getCurrentPlaybackQuality:h,getCurrentDVRInfo:f,getCurrentManifestUpdate:p}},c.dependencies.DashMetricsExtensions.prototype={constructor:c.dependencies.DashMetricsExtensions},c.dependencies.DashParser=function(){"use strict";var e=31536e3,n=2592e3,i=86400,r=3600,o=60,s=60,a=1e3,l=/^P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,u=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})([0-9]{2}))?/,c=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,d=[{type:"duration",test:function(e){return l.test(e)},converter:function(t){var s=l.exec(t);return parseFloat(s[2]||0)*e+parseFloat(s[4]||0)*n+parseFloat(s[6]||0)*i+parseFloat(s[8]||0)*r+parseFloat(s[10]||0)*o+parseFloat(s[12]||0)}},{type:"datetime",test:function(e){return u.test(e)},converter:function(e){var t,n=u.exec(e);if(t=Date.UTC(parseInt(n[1],10),parseInt(n[2],10)-1,parseInt(n[3],10),parseInt(n[4],10),parseInt(n[5],10),n[6]&&parseInt(n[6],10)||0,n[7]&&parseFloat(n[7])*a||0),n[9]&&n[10]){var i=parseInt(n[9],10)*s+parseInt(n[10],10);t+=("+"===n[8]?-1:1)*i*o*a}return new Date(t)}},{type:"numeric",test:function(e){return c.test(e)},converter:function(e){return parseFloat(e)}}],h=function(){var e,t,n,i;return i=[{name:"profiles",merge:!1},{name:"width",merge:!1},{name:"height",merge:!1},{name:"sar",merge:!1},{name:"frameRate",merge:!1},{name:"audioSamplingRate",merge:!1},{name:"mimeType",merge:!1},{name:"segmentProfiles",merge:!1},{name:"codecs",merge:!1},{name:"maximumSAPPeriod",merge:!1},{name:"startsWithSap",merge:!1},{name:"maxPlayoutRate",merge:!1},{name:"codingDependency",merge:!1},{name:"scanType",merge:!1},{name:"FramePacking",merge:!0},{name:"AudioChannelConfiguration",merge:!0},{name:"ContentProtection",merge:!0}],e={},e.name="AdaptationSet",e.isRoot=!1,e.isArray=!0,e.parent=null,e.children=[],e.properties=i,t={},t.name="Representation",t.isRoot=!1,t.isArray=!0,t.parent=e,t.children=[],t.properties=i,e.children.push(t),n={},n.name="SubRepresentation",n.isRoot=!1,n.isArray=!0,n.parent=t,n.children=[],n.properties=i,t.children.push(n),e},f=function(){var e,t,n,i;return i=[{name:"SegmentBase",merge:!0},{name:"SegmentTemplate",merge:!0},{name:"SegmentList",merge:!0}],e={},e.name="Period",e.isRoot=!1,e.isArray=!0,e.parent=null,e.children=[],e.properties=i,t={},t.name="AdaptationSet",t.isRoot=!1,t.isArray=!0,t.parent=e,t.children=[],t.properties=i,e.children.push(t),n={},n.name="Representation",n.isRoot=!1,n.isArray=!0,n.parent=t,n.children=[],n.properties=i,t.children.push(n),e},p=function(){var e,t,n,i,r;return r=[{name:"BaseURL",merge:!0,mergeFunction:function(e,t){var n;return n=0===t.indexOf("http://")?t:e+t,n}}],e={},e.name="mpd",e.isRoot=!0,e.isArray=!0,e.parent=null,e.children=[],e.properties=r,t={},t.name="Period",t.isRoot=!1,t.isArray=!0,t.parent=null,t.children=[],t.properties=r,e.children.push(t),n={},n.name="AdaptationSet",n.isRoot=!1,n.isArray=!0,n.parent=t,n.children=[],n.properties=r,t.children.push(n),i={},i.name="Representation",i.isRoot=!1,i.isArray=!0,i.parent=n,i.children=[],i.properties=r,n.children.push(i),e},m=function(){var e=[];return e.push(h()),e.push(f()),e.push(p()),e},g=function(e,n){var i,r=new v(d,"",!0),o=new y(m()),s=new Date,a=null,l=null;try{i=r.xml_str2json(e),a=new Date,i.hasOwnProperty("BaseURL")?(i.BaseURL=i.BaseURL_asArray[0],0!==i.BaseURL.toString().indexOf("http")&&(i.BaseURL=n+i.BaseURL)):i.BaseURL=n,o.run(i),l=new Date,this.debug.log("Parsing complete: ( xml2json: "+(a.getTime()-s.getTime())+"ms, objectiron: "+(l.getTime()-a.getTime())+"ms, total: "+(l.getTime()-s.getTime())/1e3+"s)")}catch(u){return t.reject(null)}return t.when(i)};return{debug:void 0,parse:g}},c.dependencies.DashParser.prototype={constructor:c.dependencies.DashParser},c.dependencies.FragmentExtensions=function(){"use strict";var e=function(e){var t,n,i,r,o,s,a=new DataView(e),l=0;while("tfdt"!==r&&l<a.byteLength){for(i=a.getUint32(l),l+=4,r="",o=0;o<4;o+=1)s=a.getInt8(l),r+=String.fromCharCode(s),l+=1;"moof"!==r&&"traf"!==r&&"tfdt"!==r&&(l+=i-8)}if(l===a.byteLength)throw"Error finding live offset.";return n=a.getUint8(l),this.debug.log("position: "+l),0===n?(l+=4,t=a.getUint32(l,!1)):(l+=i-16,t=g.Math.to64BitNumber(a.getUint32(l+4,!1),a.getUint32(l,!1))),{version:n,base_media_decode_time:t}},n=function(e){var n,i,r,o,s,a,l,u=new DataView(e),c=0;while("sidx"!==s&&c<u.byteLength){for(a=u.getUint32(c),c+=4,s="",o=0;o<4;o+=1)l=u.getInt8(c),s+=String.fromCharCode(l),c+=1;"moof"!==s&&"traf"!==s&&"sidx"!==s?c+=a-8:"sidx"===s&&(c-=8)}return n=u.getUint8(c+8),c+=12,i=u.getUint32(c+4,!1),c+=8,r=0===n?u.getUint32(c,!1):g.Math.to64BitNumber(u.getUint32(c+4,!1),u.getUint32(c,!1)),t.when({earliestPresentationTime:r,timescale:i})},i=function(n){var i,r,o,s=t.defer(),a=new XMLHttpRequest,l=!1;return i=n,a.onloadend=function(){l||(r="Error loading fragment: "+i,s.reject(r))},a.onload=function(){l=!0,o=e(a.response),s.resolve(o)},a.onerror=function(){r="Error loading fragment: "+i,s.reject(r)},a.open("GET",i),a.responseType="arraybuffer",a.send(null),s.promise};return{debug:void 0,loadFragment:i,parseTFDT:e,parseSIDX:n}},c.dependencies.FragmentExtensions.prototype={constructor:c.dependencies.FragmentExtensions},c.dependencies.TimelineConverter=function(){"use strict";var e=0,t=function(e,t,n,i){var r=NaN;return r=i?n&&t.timeShiftBufferDepth!==Number.POSITIVE_INFINITY?new Date(t.availabilityStartTime.getTime()+1e3*(e+t.timeShiftBufferDepth)):t.availabilityEndTime:n?new Date(t.availabilityStartTime.getTime()+1e3*e):t.availabilityStartTime,r},n=function(e,n,i){return t.call(this,e,n,i)},i=function(e,n,i){return t.call(this,e,n,i,!0)},r=function(e){var t,n="dynamic"===e.mpd.manifest.type,i=parseInt(this.uriQueryFragModel.getURIFragmentData().s,10);return n?(!isNaN(i)&&i>1262304e3&&(t=i-e.mpd.availabilityStartTime.getTime()/1e3,(t>e.liveEdge||t<e.liveEdge-e.mpd.timeShiftBufferDepth)&&(t=null)),t=t||e.liveEdge):t=!isNaN(i)&&i<e.duration&&i>=0?i:e.start,t},o=function(e,t){return(e.getTime()-t.mpd.availabilityStartTime.getTime())/1e3},s=function(e,t){var n=t.presentationTimeOffset;return e-n},a=function(e,t){var n=t.presentationTimeOffset;return n+e},l=function(e,t){var n,i,r;return t&&(n=e.representation.adaptation.period.mpd.suggestedPresentationDelay,i=e.presentationStartTime+n,r=new Date(e.availabilityStartTime.getTime()+1e3*i)),r},u=function(e,t,n){var i,r=this,o=r.calcSegmentAvailabilityRange(e,n);return t>=o.start&&t<=o.end?t:(i=Math.max(o.end-2*e.adaptation.period.mpd.manifest.minBufferTime,o.start),i)},c=function(t,n){var i,r,s=t.segmentDuration,a=0,l=t.adaptation.period.duration,u={start:a,end:l};return n?t.adaptation.period.mpd.isClientServerTimeSyncCompleted&&!isNaN(s)||!t.segmentAvailabilityRange?(i=t.adaptation.period.mpd.checkTime,r=o(new Date((new Date).getTime()+e),t.adaptation.period),a=Math.max(r-t.adaptation.period.mpd.timeShiftBufferDepth,0),i+=e/1e3,l=isNaN(i)?r:Math.min(i,r),u={start:a,end:l},u):t.segmentAvailabilityRange:u},d=function(e){var t=e.presentationTimeOffset;return-t};return{system:void 0,debug:void 0,uriQueryFragModel:void 0,setup:function(){},calcAvailabilityStartTimeFromPresentationTime:n,calcAvailabilityEndTimeFromPresentationTime:i,calcPresentationTimeFromWallTime:o,calcPresentationTimeFromMediaTime:s,calcPresentationStartTime:r,calcActualPresentationTime:u,calcMediaTimeFromPresentationTime:a,calcSegmentAvailabilityRange:c,calcWallTimeForSegment:l,calcMSETimeOffset:d}},c.dependencies.TimelineConverter.prototype={constructor:c.dependencies.TimelineConverter},c.vo.AdaptationSet=function(){"use strict";this.period=null,this.index=-1},c.vo.AdaptationSet.prototype={constructor:c.vo.AdaptationSet},c.vo.Event=function(){"use strict";this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN},c.vo.Event.prototype={constructor:c.vo.Event},c.vo.EventStream=function(){"use strict";this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri=""},c.vo.EventStream.prototype={constructor:c.vo.EventStream},c.vo.Mpd=function(){"use strict";this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.checkTime=NaN,this.clientServerTimeShift=0,this.isClientServerTimeSyncCompleted=!1},c.vo.Mpd.prototype={constructor:c.vo.Mpd},c.vo.Period=function(){"use strict";this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null,this.liveEdge=NaN},c.vo.Period.prototype={constructor:c.vo.Period},c.vo.Representation=function(){"use strict";this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.segmentAvailabilityRange=null,this.availableSegmentsNumber=0},c.vo.Representation.prototype={constructor:c.vo.Representation},c.vo.Segment=function(){"use strict";this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.availabilityIdx=NaN,this.wallStartTime=NaN,this.representation=null},c.vo.Segment.prototype={constructor:c.vo.Segment},u=function(){"use strict";return{dependencies:{}}}(),u.dependencies.HlsStream=function(){"use strict";var e,n,i,r,o,s,a,l,u,c,h,p,m,g,y,v,b,E,_,x,T,S={stream:{responseType:"arraybuffer",contentType:"application/octet-stream"},text:{responseType:"text",contentType:"application/x-www-form-urlencoded"}},w=null,I=!1,D=!0,M=!1,A=null,L="und",R="und",P=-1,C=function(){M&&(this.debug.info("[Stream] Play."),this.videoModel.play())},N=function(){this.debug.info("[Stream] Pause."),this.videoModel.pause()},B=function(e){M&&(this.debug.info("[Stream] Seek: "+e),this.videoModel.setCurrentTime(e))},F=function(){this.debug.info("[Stream] <video> loadedmetadata event"),this.metricsModel.addMetaData(),this.metricsModel.addState("video","buffering",this.getVideoModel().getCurrentTime())},k=function(){this.debug.info("[Stream] <video> loadeddata event"),this.setAudioLang(L),this.enableSubtitles(I)},O=function(){this.debug.info("[Stream] <video> canplay event"),D&&this.videoModel.play()},U=function(){this.debug.info("[Stream] <video> playing event"),this.metricsModel.addState("video","playing",this.getVideoModel().getCurrentTime())},H=function(){this.debug.info("[Stream] <video> loadstart event")},j=function(){this.debug.info("[Stream] <video> play event"),this.metricsModel.addPlayList("video",(new Date).getTime(),this.videoModel.getCurrentTime(),"play")},V=function(){this.debug.info("[Stream] <video> ended event"),this.metricsModel.addState("video","stopped",this.videoModel.getCurrentTime(),1)},K=function(){this.debug.info("[Stream] <video> pause event"),this.metricsModel.addState("video","paused",this.videoModel.getCurrentTime()),this.metricsModel.addPlayList("video",(new Date).getTime(),this.videoModel.getCurrentTime(),"pause")},q=function(e){var t,n=e.target.error,i="[Stream] <video> error: ",r=null;if(-1!==n.code){switch(n.code){case 1:t=d.dependencies.ErrorHandler.prototype.MEDIA_ERR_ABORTED,i+="[HLS] The fetching process for the media resource was aborted by the user";break;case 2:t=d.dependencies.ErrorHandler.prototype.MEDIA_ERR_NETWORK,i+="[HLS] A network error has caused the user agent to stop fetching the media resource";break;case 3:t=d.dependencies.ErrorHandler.prototype.MEDIA_ERR_DECODE,i+="[HLS] An error has occurred in the decoding of the media resource";break;case 4:t=d.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_MANIFEST,i="[HLS] Failed to download manifest",r={url:w,status:0};break;case 5:t=d.dependencies.ErrorHandler.prototype.MEDIA_ERR_ENCRYPTED,i+="[HLS] The encrypted media stream could not be played";break}!0,this.errHandler.sendError(t,i,r)}},z=function(){this.debug.info("[Stream] <video> seeking event: "+this.videoModel.getCurrentTime()),this.metricsModel.addState("video","seeking",this.videoModel.getCurrentTime()),this.metricsModel.addPlayList("video",(new Date).getTime(),this.getVideoModel().getCurrentTime(),d.vo.metrics.PlayList.SEEK_START_REASON)},Y=function(){},$=function(){},W=function(){this.debug.info("[Stream] <video> timeupdate event: "+this.videoModel.getCurrentTime())},G=function(){this.debug.info("[Stream] <video> waiting event"),this.getVideoModel().isSeeking()||this.metricsModel.addState("video","buffering",this.getVideoModel().getCurrentTime())},X=function(){this.debug.info("[Stream] <video> durationchange event: "+this.videoModel.getDuration())},Q=function(){this.debug.info("[Stream] <video> ratechange event: "+this.videoModel.getPlaybackRate())},J=function(t){return e?e[t]:null},Z=function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return n},ee=function(e){var t=String.fromCharCode.apply(null,new Uint16Array(e.buffer)),n=t.split("//");if(2!=n.length)throw"Invalid content key format";return n[1]},te=function(){var e=J("com.apple.fps.1_0");return e&&e.serverCertificate?f.decodeArray(e.serverCertificate):new Uint8Array(0)},ne=function(e,t,n){"string"==typeof t&&(t=Z(t));var i=0,r=new ArrayBuffer(e.byteLength+4+t.byteLength+4+n.byteLength),o=new DataView(r),s=new Uint8Array(r,i,e.byteLength);s.set(e),i+=s.byteLength,o.setUint32(i,t.byteLength,!0),i+=4;var a=new Uint16Array(r,i,t.length);a.set(t),i+=a.byteLength,o.setUint32(i,n.byteLength,!0),i+=4;var l=new Uint8Array(r,i,n.byteLength);return l.set(n),new Uint8Array(r,0,r.byteLength)},ie=function(e,t,n){return"text"===t&&(n=String.fromCharCode.apply(null,n),n="spc="+f.encodeASCII(n)+"&assetId="+encodeURIComponent(e.contentId)),n},re=function(e,t,n,i){var r=this,o=!0,s=new XMLHttpRequest;s.responseType=S[t].responseType,s.session=e,s.onload=function(){this.status<200||this.status>299||200===this.status&&4===this.readyState&&(r.debug.log("[DRM] Received license response"),o=!1,oe(this,t))},s.onerror=s.onloadend=function(){o?(o=!1,this.aborted||r.errHandler.sendError(d.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_LICENSER_ERROR,"License request failed",{url:n,status:this.status,error:this.response}),s=null):s=null},s.open("POST",n,!0),s.setRequestHeader("Content-Type",S[t].contentType),s.send(i)},oe=function(e,t){var n;"text"===t?(n=e.responseText.trim(),"<ckc>"===n.substr(0,5)&&"</ckc>"===n.substr(-6)&&(n=n.slice(5,-6)),n=f.decodeArray(n)):n=new Uint8Array(e.response),e.session.update(n)},se=function(e){var t=e.target.error,n=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR,i="MediakeyError";if(t)switch(t.code){case 1:n=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_UNKNOWN,i="An unspecified error occurred. This value is used for errors that don't match any of the other codes.";break;case 2:n=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_CLIENT,i="The Key System could not be installed or updated.";break;case 3:n=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_SERVICE,i="The message passed into update indicated an error from the license service.";break;case 4:n=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_OUTPUT,i="There is no available output device with the required characteristics for the content protection system.";break;case 5:n=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_HARDWARECHANGE,i+="A hardware configuration change caused a content protection error.";break;case 6:n=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_DOMAIN,i="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.";break;default:n=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_UNKNOWN,i="An unspecified error occurred. This value is used for errors that don't match any of the other codes.";break}else n=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_UNKNOWN,i="An unspecified error occurred. This value is used for errors that don't match any of the other codes.";return t.systemCode&&(i+="  (System Code = "+e.systemCode+")"),new d.vo.protection.KeyError(n,i)},ae=function(e){this.debug.info("[Stream] <video> needkey event",e);var t=this.videoModel.getElement(),n=ee(e.initData),i=te(),r=ne(e.initData,n,i),o=new WebKitMediaKeys("com.apple.fps.1_0");t.webkitSetMediaKeys(o);var s=t.webkitKeys.createSession("video/mp4",r);if(!s)throw"Could not create key session";s.error&&this.errHandler.sendError(d.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_NO_SESSION,"Failed to create key session",{code:s.error.code,systemCode:s.error.systemCode}),s.contentId=n,s.addEventListener("webkitkeymessage",_,!1),s.addEventListener("webkitkeyadded",x,!1),s.addEventListener("webkitkeyerror",T,!1)},le=function(e){this.debug.info("[Stream] keymessage event",e);var t,n=e.target,i=e.message,r=null,o=J("com.apple.fps.1_0");o&&(o.serverURL&&"string"===typeof o.serverURL&&""!==o.serverURL?r=o.serverURL:o.laURL&&""!==o.laURL&&(r=o.laURL)),null!==r?(t=o&&o.requestType&&"text"===o.requestType?"text":"stream",i=ie(n,t,i),re.call(this,n,t,r,i)):this.errHandler.sendError(d.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_URL_LICENSER_UNKNOWN,"No license server URL specified")},ue=function(e){this.debug.info("[Stream] keyadded event",e)},ce=function(e){this.debug.info("[Stream] keyerror event",e);var t=se(e);this.errHandler.sendError(t.code,t.msg)};return{system:void 0,videoModel:void 0,capabilities:void 0,debug:void 0,metricsExt:void 0,errHandler:void 0,metricsModel:void 0,eventBus:void 0,notify:void 0,setup:function(){o=j.bind(this),s=K.bind(this),a=q.bind(this),l=z.bind(this),u=Y.bind(this),m=$.bind(this),g=Q.bind(this),c=W.bind(this),h=G.bind(this),p=X.bind(this),i=F.bind(this),r=k.bind(this),y=O.bind(this),v=U.bind(this),b=H.bind(this),E=ae.bind(this),_=le.bind(this),x=ue.bind(this),T=ce.bind(this),n=V.bind(this)},load:function(e){w=e,P>=0&&(e+="#t="+P),this.videoModel.setSource(e)},setVideoModel:function(e){this.videoModel=e,this.videoModel.listen("play",o),this.videoModel.listen("pause",s),this.videoModel.listen("error",a),this.videoModel.listen("seeking",l),this.videoModel.listen("seeked",u),this.videoModel.listen("timeupdate",c),this.videoModel.listen("waiting",h),this.videoModel.listen("durationchange",p),this.videoModel.listen("progress",m),this.videoModel.listen("ratechange",g),this.videoModel.listen("loadedmetadata",i),this.videoModel.listen("loadeddata",r),this.videoModel.listen("ended",n),this.videoModel.listen("canplay",y),this.videoModel.listen("playing",v),this.videoModel.listen("loadstart",b),this.videoModel.listen("webkitneedkey",E)},reset:function(){return this.debug.info("[Stream] Reset"),N.call(this),A&&(A.aborted=!0,A.abort()),this.videoModel.unlisten("play",o),this.videoModel.unlisten("pause",s),this.videoModel.unlisten("error",a),this.videoModel.unlisten("seeking",l),this.videoModel.unlisten("seeked",u),this.videoModel.unlisten("timeupdate",c),this.videoModel.unlisten("waiting",h),this.videoModel.unlisten("durationchange",p),this.videoModel.unlisten("progress",m),this.videoModel.unlisten("ratechange",g),this.videoModel.unlisten("loadedmetadata",i),this.videoModel.unlisten("loadeddata",r),this.videoModel.unlisten("ended",n),this.videoModel.unlisten("canplay",y),this.videoModel.unlisten("playing",v),this.videoModel.unlisten("loadstart",b),this.videoModel.unlisten("webkitneedkey",E),this.debug.info("[Stream] Reset source"),this.videoModel.setSource(null),this.videoModel=null,t.when(!0)},setProtectionData:function(t){e=t},setInitialStartTime:function(e){var t=parseFloat(e);isNaN(t)||(P=t)},getAudioTracks:function(){var e=[],t=this.getVideoModel().getElement().audioTracks;if(0===t.length)return[];for(var n=0;n<t.length;n++)e.push({type:"audio",id:t[n].id,lang:t[n].language});return e},setAudioLang:function(e){this.debug.log("[Stream] Set audio lang: "+e);var t=this.getVideoModel().getElement().audioTracks;if(0!==t.length)for(var n=0;n<t.length;n++)e===t[n].language&&(t[n].enabled=!0)},setAudioTrack:function(e){this.debug.log("[Stream] Set audio track: "+e.lang);var t=this.getVideoModel().getElement().audioTracks;if(0!==t.length)for(var n=0;n<t.length;n++)e.id===t[n].id&&e.lang===t[n].language&&(t[n].enabled=!0)},getSelectedAudioTrack:function(){for(var e=this.getVideoModel().getElement().audioTracks,t=0;t<e.length;t++)if(e[t].enabled)return{type:"audio",id:e[t].id,lang:e[t].language};return null},getSubtitleTracks:function(){var e=[],t=this.getVideoModel().getElement().textTracks;if(0===t.length)return[];for(var n=0;n<t.length;n++)e.push({type:"text",id:t[n].label,lang:t[n].language});return e},enableSubtitles:function(e){I=e;var t=this.getVideoModel().getElement().textTracks;if(0!==t.length){e&&this.debug.log("[Stream] Set subtitle lang: "+R);for(var n=!1,i=0;i<t.length;i++)e&&R===t[i].language?(t[i].mode="showing",n=!0):t[i].mode="hidden";e&&!n&&(t[0].mode="showing")}},setSubtitleTrack:function(e){this.debug.log("[Stream] Set subtitle track: "+e.lang);var t=this.getVideoModel().getElement().textTracks;if(0!==t.length)for(var n=0;n<t.length;n++)e.id===t[n].label&&e.lang===t[n].language&&(t[n].mode="showing")},getSelectedSubtitleTrack:function(){for(var e=this.getVideoModel().getElement().textTracks,t=0;t<e.length;t++)if("showing"===e[t].mode)return{type:"text",id:e[t].label,lang:e[t].language};return null},initProtection:function(){},getVideoModel:function(){return this.videoModel},setAutoPlay:function(e){D=e},setDefaultAudioLang:function(e){L=e},setDefaultSubtitleLang:function(e){R=e},getAutoPlay:function(){return D},getDuration:function(){return this.videoModel.getDuration()},getStartTime:function(){return 0},getPeriodIndex:function(){return 0},getId:function(){return""},getPeriodInfo:function(){return null},getMinbufferTime:function(){return 0},getLiveDelay:function(){return-1},startEventController:function(){},resetEventController:function(){},setTrickModeSpeed:function(){},getTrickModeSpeed:function(){return-1},updateData:function(){},play:C,seek:B,pause:N}},u.dependencies.HlsStream.prototype={constructor:u.dependencies.HlsStream},l=function(){"use strict";return{dependencies:{}}}(),d.utils.copyMethods=function(e){var t=new e;for(var n in t.parent={},t)t.parent[n]=t[n];return t.setup=function(){for(var e in this.parent)void 0===this.parent[e]&&(this.parent[e]=this[e])},t},d.utils.DOMParser=function(){"use strict";var e=null,t=null;return{getAllSpecificNodes:function(e,t){var n,i,r=0,o=[];if(e&&(i=e.querySelectorAll(t),i))for(r=0;r<i.length;r++)n=this.getAttributeValue(i[r],"xml:id"),n&&(o[n]=i[r].attributes,i[r].childNodes.length>0&&(o[n].childNodes=i[r].childNodes));return o},getAttributeName:function(e,t){var n=[],i=null,r=0,o=null;if(e&&e.attributes&&(o=e.attributes,o))for(r=0;r<o.length;r++)i=o[r],i.value===t&&n.push(i.name);return n},getTextNodesIn:function(e){var t=[],n=0,i=null,r=null,o=null;if(e)for(i=e.childNodes,n=0;n<i.length;n++)r=i[n],o=r.nodeType,3==o?t.push(r):1!=o&&9!=o&&11!=o||(t=t.concat(this.getTextNodesIn(r)));return t},getAttributeValue:function(e,t,n){var i=null;return e&&"function"==typeof e.getAttribute&&(i=e.getAttribute(t),null===i&&n&&(i=e.getAttributeNS(n,t))),i},getChildNode:function(e,t){var n,i=0;if(e&&e.childNodes)for(i=0;i<e.childNodes.length;i++){if(n=e.childNodes[i],n.nodeName===t)return n;n=void 0}return n},getChildNodes:function(e,t){var n=0,i=[];if(e&&e.childNodes)for(n=0;n<e.childNodes.length;n++)e.childNodes[n].nodeName===t&&i.push(e.childNodes[n]);return i},createXmlTree:function(n){if(window.DOMParser)try{if(e||(e=new window.DOMParser),t=e.parseFromString(n,"text/xml"),t.getElementsByTagName("parsererror").length>0)throw new Error("Error parsing XML")}catch(i){t=null}return t}}},d.utils.isUTF16=function(e){var t,n,i,r,o=0,s=e&&e.length,a=null;if(s<2){if(e[0]>255)return!1}else{if(t=e[0],n=e[1],255===t&&254===n)return!0;if(254===t&&255===n)return!0;for(;o<s;o++){if(0===e[o]){a=o;break}if(e[o]>255)return!1}if(null===a)return!1;if(i=e[a+1],void 0!==i&&i>0&&i<128)return!0;if(r=e[a-1],void 0!==r&&r>0&&r<128)return!0}return!1},d.utils.ObjectIron=function(e){var t;t=[];for(var n=0,i=e.length;n<i;n+=1)e[n].isRoot?t.push("root"):t.push(e[n].name);var r=function(e,t){var n;if(null!==e&&null!==t)for(n in e)e.hasOwnProperty(n)&&(t.hasOwnProperty(n)||(t[n]=e[n]))},o=function(e,t,n){var i,o,s,a,l;if(null!==e&&0!==e.length)for(i=0,o=e.length;i<o;i+=1)s=e[i],t.hasOwnProperty(s.name)&&(n.hasOwnProperty(s.name)?s.merge&&(a=t[s.name],l=n[s.name],"object"===typeof a&&"object"===typeof l?r(a,l):null!==s.mergeFunction?n[s.name]=s.mergeFunction(a,l):n[s.name]=a+l):n[s.name]=t[s.name])},s=function(e,t){var n,i,r,a,l,u,c,d=e;if(e.transformFunc&&(t=e.transformFunc(t)),null===d.children||0===d.children.length)return t;for(n=0,i=d.children.length;n<i;n+=1){u=d.children[n];var h=null;if(t.hasOwnProperty(u.name))if(u.isArray)for(l=t[u.name+"_asArray"],r=0,a=l.length;r<a;r+=1)c=l[r],o(d.properties,t,c),h=s(u,c),t[u.name+"_asArray"][r]=h,t[u.name][r]=h;else c=t[u.name],o(d.properties,t,c),h=s(u,c),t[u.name]=h,t[u.name+"_asArray"]=[h]}return t},a=function(n){var i,r,o,l,u,c,d;if(null===n)return n;if("object"!==typeof n)return n;for(i=0,r=t.length;i<r;i+=1)"root"===t[i]&&(u=e[i],c=n,n=s(u,c));for(l in n)if(n.hasOwnProperty(l)){if(o=t.indexOf(l),-1!==o)if(u=e[o],u.isArray)for(d=n[l+"_asArray"],i=0,r=d.length;i<r;i+=1)c=d[i],n[l][i]=s(u,c),n[l+"_asArray"][i]=s(u,c);else c=n[l],n[l]=s(u,c),n[l+"_asArray"]=[s(u,c)];n[l]=a(n[l])}return n};return{run:a}},d.dependencies.protection.CommonEncryption={findCencContentProtection:function(e){var t,n=null,i=0;for(i=0;i<e.length;++i)t=e[i],"urn:mpeg:dash:mp4protection:2011"===t.schemeIdUri.toLowerCase()&&"cenc"===t.value.toLowerCase()&&(n=t);return n},getPSSHData:function(e){var t=8,n=new DataView(e),i=n.getUint8(t);return t+=20,i>0&&(t+=4+16*n.getUint32(t)),t+=4,e.slice(t)},getPSSHForKeySystem:function(e,t){var n=d.dependencies.protection.CommonEncryption.parsePSSHList(t);return n.hasOwnProperty(e.uuid.toLowerCase())?n[e.uuid.toLowerCase()]:null},parseInitDataFromContentProtection:function(e){return e&&"pssh"in e?f.decodeArray(e.pssh.__text).buffer:null},readBytes:function(e,t,n){var i=0,r=0;for(r=0;r<n;r++)i<<=8,i+=e[t],t++;return i},parsePSSHList:function(e){if(null===e)return[];var t=new DataView(e),n=!1,i={},r=0;while(!n){var o,s,a,l,u=r;if(r>=t.buffer.byteLength)break;if(o=t.getUint32(r),s=r+o,r+=4,1886614376===t.getUint32(r))if(r+=4,a=t.getUint8(r),0===a||1===a){var c,d;for(r++,r+=3,l="",c=0;c<4;c++)d=t.getUint8(r+c).toString(16),l+=1===d.length?"0"+d:d;for(r+=4,l+="-",c=0;c<2;c++)d=t.getUint8(r+c).toString(16),l+=1===d.length?"0"+d:d;for(r+=2,l+="-",c=0;c<2;c++)d=t.getUint8(r+c).toString(16),l+=1===d.length?"0"+d:d;for(r+=2,l+="-",c=0;c<2;c++)d=t.getUint8(r+c).toString(16),l+=1===d.length?"0"+d:d;for(r+=2,l+="-",c=0;c<6;c++)d=t.getUint8(r+c).toString(16),l+=1===d.length?"0"+d:d;r+=6,l=l.toLowerCase(),t.getUint32(r),r+=4,i[l]=t.buffer.slice(u,s),r=s}else r=s;else r=s}return i},getKeySystemConfigurations:function(e,t,n){var i=[],r=[];return e&&r.push(new d.vo.protection.MediaCapability(e)),t&&i.push(new d.vo.protection.MediaCapability(t)),[new d.vo.protection.KeySystemConfiguration(i,r,"optional","temporary"===n?"optional":"required",[n])]}},ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return e&&e.buffer instanceof ArrayBuffer}),ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(e,t){var n,i,r,o=this.byteLength;return e=0|e||0,t=void 0===t?o:0|t,e<0&&(e=Math.max(e+o,0)),t<0&&(t=Math.max(t+o,0)),0===o||e>=o||e>=t?new ArrayBuffer(0):(n=Math.min(o-e,t-e),i=new ArrayBuffer(n),r=new Uint8Array(i),r.set(new Uint8Array(this,e,n)),i)}),d.dependencies.ProtectionController=function(){"use strict";var e,t,n,i=[],r=null,o=!1,s=function(e){var t=null,i=e.systemString;return n&&(t=i in n?n[i]:null),t},a=function(n,r){var o,s,a,l,u,c=this,h=[],f=[],p=0;if(this.keySystem){for(s=0;s<n.length;s++)if(this.keySystem===n[s].ks){o=n[s].ks.sessionType,h.push({ks:n[s].ks,configs:n[s].ks.getKeySystemConfigurations(t,e,o)}),f.push({schemeIdURI:n[s].ks.schemeIdURI,systemString:n[s].ks.systemString}),a={},a[d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE]=function(e){c.protectionModel.unsubscribe(d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,a),e.error?(c.debug.log("[DRM] KeySystem Access Denied! -- "+e.error),c.eventBus.dispatchEvent({type:d.dependencies.ProtectionController.events.KEY_SYSTEM_SELECTED,error:"[DRM] KeySystem Access Denied! -- "+e.error})):(c.debug.log("[DRM] KeySystem Access Granted"),c.eventBus.dispatchEvent({type:d.dependencies.ProtectionController.events.KEY_SYSTEM_SELECTED,data:e.data}),c.createKeySession(n[s].initData,n[s].cdmData))},this.protectionModel.subscribe(d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,a,void 0,!0),this.protectionModel.requestKeySystemAccess(h);break}}else if(void 0===this.keySystem){for(this.keySystem=null,i.push(n),p=0;p<n.length;p++)o=n[p].ks.sessionType,h.push({ks:n[p].ks,configs:n[p].ks.getKeySystemConfigurations(t,e,o)}),f.push({schemeIdURI:n[p].ks.schemeIdURI,systemString:n[p].ks.systemString});l={},l[d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE]=function(e){c.protectionModel&&(c.protectionModel.unsubscribe(d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,l),e.error?(c.debug.log("[DRM] KeySystem Access Denied! -- "+e.error),c.keySystem=void 0,c.protectionModel.unsubscribe(d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,l),r||c.eventBus.dispatchEvent({type:d.dependencies.ProtectionController.events.KEY_SYSTEM_SELECTED,error:"[DRM] KeySystem Access Denied! -- "+e.error}),c.notify(d.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new d.vo.Error(d.dependencies.ErrorHandler.prototype.MEDIA_KEYSYSERR_ACCESS_DENIED,"No KeySystem/CDM available",{keySystems:f}))):(u=e.data,c.debug.log("[DRM] KeySystem Access ("+u.keySystem.systemString+") Granted!  Selecting key system..."),c.protectionModel.selectKeySystem(u)))},l[d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED]=function(e){if(c.protectionModel)if(c.protectionModel.unsubscribe(d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,l),e.error)c.keySystem=void 0,r||c.eventBus.dispatchEvent({type:d.dependencies.ProtectionController.events.KEY_SYSTEM_SELECTED,error:"[DRM] Error selecting key system! -- "+e.error}),c.notify(d.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new d.vo.Error(d.dependencies.ErrorHandler.prototype.MEDIA_KEYSYSERR_ACCESS_DENIED,"No KeySystem/CDM available",{keySystems:f}));else for(c.debug.log("[DRM] KeySystem selected => create key session"),c.keySystem=c.protectionModel.keySystem,c.notify(d.dependencies.ProtectionController.eventList.ENAME_KEY_SYSTEM_SELECTED,u),c.eventBus.dispatchEvent({type:d.dependencies.ProtectionController.events.KEY_SYSTEM_SELECTED,data:u}),p=0;p<i.length;p++)for(s=0;s<i[p].length;s++)if(c.keySystem===i[p][s].ks){c.createKeySession(i[p][s].initData,i[p][s].cdmData);break}},this.protectionModel.subscribe(d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,l,void 0,!0),this.protectionModel.subscribe(d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,l,void 0,!0),this.protectionModel.requestKeySystemAccess(h)}else i.push(n)},l=function(e){var t,n,i=this,o=null;t=e.data,n=t.messageType?t.messageType:"license-request",this.debug.log("[DRM] Key message: type = "+n),this.eventBus.dispatchEvent({type:d.dependencies.ProtectionController.events.KEY_MESSAGE,data:t});var a=t.message,l=t.sessionToken,u=s(this.keySystem),c=this.keySystem.systemString,h=this.protectionExt.getLicenseServer(this.keySystem,u,n),f=!0;if(a&&0!==a.byteLength)if(h){if(this.protectionExt.isClearKey(this.keySystem)){var p=this.protectionExt.processClearKeyLicenseRequest(u,a);if(p)return this.debug.log("[DRM] ClearKey license request handled by application!"),void this.protectionModel.updateKeySession(l,p)}r=new XMLHttpRequest;var m=null;if(u)if(u.serverURL){var g=u.serverURL;"string"===typeof g&&""!==g?m=g:"object"===typeof g&&g.hasOwnProperty(n)&&(m=g[n])}else u.laURL&&""!==u.laURL&&(m=u.laURL);if(null===m&&(m=this.keySystem.getLicenseServerURLFromInitData(d.dependencies.protection.CommonEncryption.getPSSHData(l.initData)),m||(m=e.data.defaultURL)),m=h.getServerURLFromMessage(m,a,n),this.debug.log("[DRM] Licenser server url: "+m),m){r.open(h.getHTTPMethod(n),m,!0),r.responseType=h.getResponseType(c,n),r.onload=function(){this.status<200||this.status>299||200===this.status&&4===this.readyState&&(i.debug.log("[DRM] Received license response"),f=!1,o=h.getLicenseMessage(this.response,c,n),null!==o?(f=!1,i.protectionModel.updateKeySession(l,o)):f=!0)},r.onerror=r.onloadend=function(){f?(f=!1,this.aborted||i.notify(d.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new d.vo.Error(d.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_LICENSER_ERROR,"License request failed",{url:m,status:this.status,error:this.response&&null!==this.response?h.getErrorResponse(this.response):""})),r=null):r=null};var y=function(e){var t;if(e)for(t in e)"authorization"===t.toLowerCase()&&(r.withCredentials=!0),r.setRequestHeader(t,e[t])};u&&y(u.httpRequestHeaders),y(this.keySystem.getRequestHeadersFromMessage(a)),u&&u.withCredentials&&(r.withCredentials=!0),this.debug.log("[DRM] Send license request");var v=this.keySystem.getLicenseRequestFromMessage(a);null===v&&this.notify(d.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new d.vo.Error(d.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_NO_CHALLENGE,"No license challenge from CDM key message")),r.send(v)}else this.notify(d.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new d.vo.Error(d.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_URL_LICENSER_UNKNOWN,"No license server URL specified"))}else this.debug.log("[DRM] License server request not required for this message (type = "+e.data.messageType+").  Session ID = "+l.getSessionID());else this.notify(d.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new d.vo.Error(d.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_NO_CHALLENGE,"Empty key message from CDM"))},u=function(e){var t,n,i=this;if(i.debug.log("[DRM] onNeedKey, initDataType = "+e.data.initDataType),"cenc"===e.data.initDataType){if(t=e.data.initData,ArrayBuffer.isView(t)&&(t=t.buffer),this.keySystem)for(var r=d.dependencies.protection.CommonEncryption.getPSSHForKeySystem(this.keySystem,t),o=this.protectionModel.getAllInitData(),s=0;s<o.length;s++)if(this.protectionExt.initDataEquals(r,o[s]))return void this.debug.log("[DRM] Ignoring initData because we have already seen it!");n=this.protectionExt.getSupportedKeySystems(t),0!==n.length?a.call(this,n,!1):i.debug.log("[DRM] Received needkey event with initData, but we don't support any of the key systems!")}else i.debug.log("[DRM] Only 'cenc' initData is supported!  Ignoring initData of type: "+e.data.initDataType)},c=function(e){e.error?(this.debug.error("[DRM] Failed to set license server certificate"),this.notify(d.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new d.vo.Error(d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_SERVER_CERTIFICATE,"Failed to set server certificate",e.error))):this.debug.log("[DRM] License server certificate successfully updated")},h=function(e){e.error?(this.debug.error("[DRM] Failed to create key session"),this.notify(d.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new d.vo.Error(d.dependencies.ErrorHandler.prototype.MEDIA_KEYMESSERR_NO_SESSION,"Failed to create key session",e.error))):this.debug.log("[DRM] Session created.  SessionID = "+e.data.getSessionID())},f=function(){this.debug.log("[DRM] Key added")},p=function(e){this.notify(d.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new d.vo.Error(e.data.code,e.data.message,e.data.data))},m=function(e){e.error?this.debug.warn("[DRM] Failed to close session"):this.debug.log("[DRM] Session closed. SessionID = "+e.data)},g=function(e){e.error?this.debug.warn("[DRM] Failed to remove session"):this.debug.log("[DRM] Session removed. SessionID = "+e.data)},y=function(e){e.error?this.notify(d.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new d.vo.Error(e.error.code,e.error.message,e.error.data)):this.debug.log("[DRM] Key statuses changed. statuses = "+e.data)};return{system:void 0,debug:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,protectionExt:void 0,keySystem:void 0,setup:function(){this[d.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE]=l.bind(this),this[d.models.ProtectionModel.eventList.ENAME_NEED_KEY]=u.bind(this),this[d.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED]=c.bind(this),this[d.models.ProtectionModel.eventList.ENAME_KEY_ADDED]=f.bind(this),this[d.models.ProtectionModel.eventList.ENAME_KEY_ERROR]=p.bind(this),this[d.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED]=h.bind(this),this[d.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED]=m.bind(this),this[d.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED]=g.bind(this),this[d.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED]=y.bind(this),this.protectionExt.getKeySystems(),this.protectionModel=this.system.getObject("protectionModel"),this.protectionModel.init(),this.eventBus=this.system.getObject("eventBus"),this.protectionModel.subscribe(d.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED,this),this.protectionModel.subscribe(d.models.ProtectionModel.eventList.ENAME_KEY_ADDED,this),this.protectionModel.subscribe(d.models.ProtectionModel.eventList.ENAME_KEY_ERROR,this),this.protectionModel.subscribe(d.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,this),this.protectionModel.subscribe(d.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,this),this.protectionModel.subscribe(d.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED,this),this.protectionModel.subscribe(d.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,this),this.protectionModel.subscribe(d.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED,this)},init:function(n,i,r){var s;o||(this.debug.log("[DRM] Initialize ProtectionController ("+r+", "+i+")"),e=i,t=r,s=this.protectionExt.getSupportedKeySystemsFromContentProtection(n),s&&s.length>0&&a.call(this,s,!0),o=!0)},addEventListener:function(e,t){this.eventBus.addEventListener(e,t)},removeEventListener:function(e,t){this.eventBus.removeEventListener(e,t)},teardown:function(){var e=this;r&&(r.aborted=!0,r.abort()),this.protectionModel.unsubscribe(d.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,this),this.protectionModel.unsubscribe(d.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED,this),this.protectionModel.unsubscribe(d.models.ProtectionModel.eventList.ENAME_KEY_ADDED,this),this.protectionModel.unsubscribe(d.models.ProtectionModel.eventList.ENAME_KEY_ERROR,this),this.protectionModel.unsubscribe(d.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,this),this.protectionModel.unsubscribe(d.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,this),this.protectionModel.unsubscribe(d.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED,this),this.protectionModel.unsubscribe(d.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,this),this.protectionModel.unsubscribe(d.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED,this),this.keySystem=void 0,this.setMediaElement(null).then(function(){e.protectionModel.teardown(),e.protectionModel=void 0})},createKeySession:function(e,t){var n,i=d.dependencies.protection.CommonEncryption.getPSSHForKeySystem(this.keySystem,e),r=0;if(i){for(this.debug.log("[DRM] create key session for initData:",String.fromCharCode.apply(null,new Uint8Array(i))),n=this.protectionModel.getAllInitData(),r=0;r<n.length;r++)if(this.protectionExt.initDataEquals(i,n[r]))return void this.debug.log("[DRM] Ignoring initData because we have already seen it!");try{this.protectionModel.createKeySession(i,this.keySystem.sessionType,t)}catch(o){this.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,null,{reason:"Create key session raised en exception",error:new d.vo.Error(o.code,o.name,o.message)})}}else this.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,null,{reason:"needkey/encrypted event contains no initData corresponding to that key system "+this.keySystem.systemString,error:null})},loadKeySession:function(e){this.protectionModel.loadKeySession(e)},removeKeySession:function(e){this.protectionModel.removeKeySession(e)},closeKeySession:function(e){this.protectionModel.closeKeySession(e)},setServerCertificate:function(e){this.protectionModel.setServerCertificate(e)},setMediaElement:function(e){return e?this.protectionModel.subscribe(d.models.ProtectionModel.eventList.ENAME_NEED_KEY,this):null===e&&this.protectionModel.unsubscribe(d.models.ProtectionModel.eventList.ENAME_NEED_KEY,this),this.protectionModel.setMediaElement(e)},setSessionType:function(e){this.keysystem&&(this.keySystem.sessionType=e)},setProtectionData:function(e){n=e,this.protectionExt.init(e)}}},d.dependencies.ProtectionController.events={KEY_SYSTEM_SELECTED:"keySystemSelected",SERVER_CERTIFICATE_UPDATED:"serverCertificateUpdated",KEY_ADDED:"keyAdded",KEY_SESSION_CREATED:"keySessionCreated",KEY_SESSION_REMOVED:"keySessionRemoved",KEY_SESSION_CLOSED:"keySessionClosed",KEY_STATUSES_CHANGED:"keyStatusesChanged",KEY_MESSAGE:"keyMessage",LICENSE_REQUEST_COMPLETE:"licenseRequestComplete"},d.dependencies.ProtectionController.eventList={ENAME_PROTECTION_ERROR:"protectionError",ENAME_KEY_SYSTEM_SELECTED:"keySystemSelected"},d.dependencies.ProtectionController.prototype={constructor:d.dependencies.ProtectionController},d.dependencies.ProtectionExtensions=function(){"use strict";this.system=void 0,this.debug=void 0,this.keySystems=[],this.clearkeyKeySystem=void 0},d.dependencies.ProtectionExtensions.prototype={constructor:d.dependencies.ProtectionExtensions,setup:function(){var e;e=this.system.getObject("ksPlayReady"),this.keySystems.push(e),e=this.system.getObject("ksWidevine"),this.keySystems.push(e),e=this.system.getObject("ksClearKey"),this.keySystems.push(e),this.clearkeyKeySystem=e},init:function(e){for(var t=function(t){var n=null;return e&&(n=t in e?e[t]:null),n},n=0;n<this.keySystems.length;n++){var i=this.keySystems[n];i.init(t(i.systemString))}},getKeySystems:function(){return this.keySystems},getKeySystemBySystemString:function(e){for(var t=0;t<this.keySystems.length;t++)if(this.keySystems[t].systemString===e)return this.keySystems[t];return null},isClearKey:function(e){return e===this.clearkeyKeySystem},initDataEquals:function(e,t){if(e.byteLength===t.byteLength){for(var n=new Uint8Array(e),i=new Uint8Array(t),r=0;r<n.length;r++)if(n[r]!==i[r])return!1;return!0}return!1},getSupportedKeySystemsFromContentProtection:function(e){var t,n,i,r,o=[];if(e)for(i=0;i<this.keySystems.length;++i)for(n=this.keySystems[i],r=0;r<e.length;++r)if(t=e[r],t.schemeIdUri.toLowerCase()===n.schemeIdURI){var s=n.getInitData(t);s&&o.push({ks:this.keySystems[i],initData:s,cdmData:n.getCDMData()})}return o},getSupportedKeySystems:function(e){var t,n=[],i=d.dependencies.protection.CommonEncryption.parsePSSHList(e);for(this.debug.log("[DRM] Get supported key systems from init data"),t=0;t<this.keySystems.length;++t)this.keySystems[t].uuid in i&&n.push({ks:this.keySystems[t],initData:i[this.keySystems[t].uuid],cdmData:this.keySystems[t].getCDMData()});return n},getLicenseServer:function(e,t,n){if("license-release"===n||"individualization-request"==n)return null;var i=null;return t&&t.hasOwnProperty("drmtoday")?i=this.system.getObject("serverDRMToday"):"com.widevine.alpha"===e.systemString?i=this.system.getObject("serverWidevine"):"com.microsoft.playready"===e.systemString?i=this.system.getObject("serverPlayReady"):"org.w3.clearkey"===e.systemString&&(i=this.system.getObject("serverClearKey")),i},processClearKeyLicenseRequest:function(e,t){try{return d.dependencies.protection.KeySystem_ClearKey.getClearKeysFromProtectionData(e,t)}catch(n){return this.log("Failed to retrieve clearkeys from ProtectionData"),null}},autoSelectKeySystem:function(e,t,n,i){if(this.debug.log("[DRM] Auto select key system: "),this.debug.log("[DRM] ---- video codec = "+n),this.debug.log("[DRM] ---- audio codec = "+i),0===e.length)throw new Error("DRM system for this content not supported by the player!");var r=[],o=[];n&&o.push(new d.vo.protection.MediaCapability(n)),i&&r.push(new d.vo.protection.MediaCapability(i));for(var s=new d.vo.protection.KeySystemConfiguration(r,o),a=[],l=0;l<e.length;l++)a.push({ks:e[l].ks,configs:[s]});var u=this;(function(e){var t={};t[d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE]=function(t){if(e.protectionModel.unsubscribe(d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,this),t.error)u.debug.log(t.error),e.notify(d.dependencies.ProtectionController.eventList.ENAME_PROTECTION_ERROR,new d.vo.Error(d.dependencies.ErrorHandler.prototype.MEDIA_KEYSYSERR_ACCESS_DENIED,"[DRM] KeySystem Access Denied! -- "+t.error,null));else{var n=t.data;u.debug.log("[DRM] KeySystem Access Granted ("+n.keySystem.systemString+")!"),e.selectKeySystem(n)}},e.protectionModel.subscribe(d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,t),e.requestKeySystemAccess(a)})(t)}},d.models.ProtectionModel_01b=function(){var e,n=null,i=null,r=[],o=[],s=function(){var t=this;return{handleEvent:function(n){var s=null;switch(n.type){case i.needkey:var a=ArrayBuffer.isView(n.initData)?n.initData.buffer:n.initData;t.notify(d.models.ProtectionModel.eventList.ENAME_NEED_KEY,new d.vo.protection.NeedKey(a,"cenc"));break;case i.keyerror:if(s=l(o,n.sessionId),s||(s=l(r,n.sessionId)),s){var u=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR,c="MediakeyError";switch(n.errorCode.code){case 1:u=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_UNKNOWN,c+="An unspecified error occurred. This value is used for errors that don't match any of the other codes.";break;case 2:u=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_CLIENT,c+="The Key System could not be installed or updated.";break;case 3:u=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_SERVICE,c+="The message passed into update indicated an error from the license service.";break;case 4:u=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_OUTPUT,c+="There is no available output device with the required characteristics for the content protection system.";break;case 5:u=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_HARDWARECHANGE,c+="A hardware configuration change caused a content protection error.";break;case 6:u=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_DOMAIN,c+="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.";break}n.systemCode&&(c+="  (System Code = "+n.systemCode+")"),t.notify(d.models.ProtectionModel.eventList.ENAME_KEY_ERROR,new d.vo.protection.KeyError(u,c))}else t.log("No session token found for key error");break;case i.keyadded:s=l(o,n.sessionId),s||(s=l(r,n.sessionId)),s?t.notify(d.models.ProtectionModel.eventList.ENAME_KEY_ADDED,s):t.log("No session token found for key added");break;case i.keymessage:if(e=null!==n.sessionId&&void 0!==n.sessionId,e?(s=l(o,n.sessionId),!s&&r.length>0&&(s=r.shift(),o.push(s),s.sessionID=n.sessionId)):r.length>0&&(s=r.shift(),o.push(s),0!==r.length&&t.errHandler.mediaKeyMessageError("Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!")),s){var h=ArrayBuffer.isView(n.message)?n.message.buffer:n.message;s.keyMessage=h,t.notify(d.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,new d.vo.protection.KeyMessage(s,h,n.defaultURL))}else t.log("No session token found for key message");break}}}},a=null,l=function(e,t){if(t&&e){for(var n=e.length,i=0;i<n;i++)if(e[i].sessionID===t)return e[i];return null}return null},u=function(){n.removeEventListener(i.keyerror,a),n.removeEventListener(i.needkey,a),n.removeEventListener(i.keymessage,a),n.removeEventListener(i.keyadded,a)};return{system:void 0,log:void 0,errHandler:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,protectionExt:void 0,keySystem:null,setup:function(){a=s.call(this)},init:function(){var e=document.createElement("video");i=d.models.ProtectionModel_01b.detect(e)},teardown:function(){n&&u();for(var e=0;e<o.length;e++)this.closeKeySession(o[e]);this.notify(d.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE)},getAllInitData:function(){var e,t=[];for(e=0;e<r.length;e++)t.push(r[e].initData);for(e=0;e<o.length;e++)t.push(o[e].initData);return t},requestKeySystemAccess:function(e){var t=n;t||(t=document.createElement("video"));for(var i=!1,r=0;r<e.length;r++)for(var o=e[r].ks.systemString,s=e[r].configs,a=null,l=null,u=0;u<s.length;u++){var c=s[u].videoCapabilities;if(c&&0!==c.length){l=[];for(var h=0;h<c.length;h++)""!==t.canPlayType(c[h].contentType,o)&&l.push(c[h])}if(!(!a&&!l||a&&0===a.length||l&&0===l.length)){i=!0;var f=new d.vo.protection.KeySystemConfiguration(a,l),p=this.protectionExt.getKeySystemBySystemString(o),m=new d.vo.protection.KeySystemAccess(p,f);this.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,m);break}}i||this.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,null,"Key system access denied! -- No valid audio/video content configurations detected!")},selectKeySystem:function(e){this.keySystem=e.keySystem,this.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED)},setMediaElement:function(e){if(n!==e)return n&&u(),n=e,n&&(n.addEventListener(i.keyerror,a),n.addEventListener(i.needkey,a),n.addEventListener(i.keymessage,a),n.addEventListener(i.keyadded,a),this.notify(d.models.ProtectionModel.eventList.ENAME_VIDEO_ELEMENT_SELECTED)),t.when()},createKeySession:function(t){if(!this.keySystem)throw new Error("Can not create sessions until you have selected a key system");if(e||0===o.length){var s={sessionID:null,initData:t,getSessionID:function(){return this.sessionID},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return r.push(s),n[i.generateKeyRequest](this.keySystem.systemString,new Uint8Array(t)),s}throw new Error("Multiple sessions not allowed!")},updateKeySession:function(e,t){var r=e.sessionID;if(this.protectionExt.isClearKey(this.keySystem))for(var o=0;o<t.keyPairs.length;o++)n[i.addKey](this.keySystem.systemString,t.keyPairs[o].key,t.keyPairs[o].keyID,r);else n[i.addKey](this.keySystem.systemString,new Uint8Array(t),new Uint8Array(e.initData),r)},closeKeySession:function(e){n[i.cancelKeyRequest](this.keySystem.systemString,e.sessionID)},setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},checkIfEncrypted:function(){}}},d.models.ProtectionModel_01b.prototype={constructor:d.models.ProtectionModel_01b},d.models.ProtectionModel_01b.APIs=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],d.models.ProtectionModel_01b.detect=function(e){for(var t=d.models.ProtectionModel_01b.APIs,n=0;n<t.length;n++){var i=t[n];if("function"===typeof e[i.generateKeyRequest]&&("function"===typeof e[i.addKey]&&"function"===typeof e[i.cancelKeyRequest]))return i}return null},d.models.ProtectionModel_3Feb2014=function(){var e=null,n=null,i=null,r=null,o=null,s=[],a=function(){var e=this;return{handleEvent:function(t){switch(t.type){case o.needkey:if(t.initData){var n=ArrayBuffer.isView(t.initData)?t.initData.buffer:t.initData;e.notify(d.models.ProtectionModel.eventList.ENAME_NEED_KEY,new d.vo.protection.NeedKey(n,"cenc"))}break}}}},l=null,u=function(){var t=function(){e.removeEventListener("loadedmetadata",r),e[o.setMediaKeys](n),this.notify(d.models.ProtectionModel.eventList.ENAME_VIDEO_ELEMENT_SELECTED)};e.readyState>=1?t.call(this):(r=t.bind(this),e.addEventListener("loadedmetadata",r))},c=function(e){var t=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR,n="MediakeyError";if(e.errorCode)switch(e.errorCode.code){case 1:t=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_UNKNOWN,n="An unspecified error occurred. This value is used for errors that don't match any of the other codes.";break;case 2:t=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_CLIENT,n="The Key System could not be installed or updated.";break;case 3:t=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_SERVICE,n="The message passed into update indicated an error from the license service.";break;case 4:t=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_OUTPUT,n="There is no available output device with the required characteristics for the content protection system.";break;case 5:t=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_HARDWARECHANGE,n+="A hardware configuration change caused a content protection error.";break;case 6:t=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_DOMAIN,n="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.";break;default:t=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_UNKNOWN,n="An unspecified error occurred. This value is used for errors that don't match any of the other codes.";break}else t=d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_UNKNOWN,n="An unspecified error occurred. This value is used for errors that don't match any of the other codes.";return e.systemCode&&(n+="  (System Code = "+e.systemCode+")"),new d.vo.protection.KeyError(t,n)},h=function(e,t){var n=this;return{session:e,initData:t,handleEvent:function(e){switch(e.type){case o.error:n.notify(d.models.ProtectionModel.eventList.ENAME_KEY_ERROR,c(e));break;case o.message:var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;n.notify(d.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,new d.vo.protection.KeyMessage(this,t,e.destinationURL));break;case o.ready:n.notify(d.models.ProtectionModel.eventList.ENAME_KEY_ADDED,this);break;case o.close:n.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,this.getSessionID());break}},getSessionID:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}}};return{system:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,protectionExt:void 0,debug:void 0,keySystem:null,setup:function(){l=a.call(this)},init:function(){var e=document.createElement("video");o=d.models.ProtectionModel_3Feb2014.detect(e)},teardown:function(){try{for(var t=0;t<s.length;t++)this.closeKeySession(s[t]);e&&e.removeEventListener(o.needkey,l),this.notify(d.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE)}catch(n){this.notify(d.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE,null,"Error tearing down key sessions and MediaKeys! -- "+n.message)}},getAllInitData:function(){for(var e=[],t=0;t<s.length;t++)e.push(s[t].initData);return e},requestKeySystemAccess:function(e){for(var t=!1,n=0;n<e.length;n++){var i=e[n].ks.systemString,r=e[n].configs,s=null,a=null;this.debug.log("[DRM][3Feb2014] Request access for key system "+i);for(var l=0;l<r.length;l++){var u=r[l].audioCapabilities,c=r[l].videoCapabilities;if(u&&0!==u.length){s=[];for(var h=0;h<u.length;h++)window[o.MediaKeys].isTypeSupported(i,u[h].contentType)&&s.push(u[h])}if(c&&0!==c.length){a=[];for(var f=0;f<c.length;f++)window[o.MediaKeys].isTypeSupported(i,c[f].contentType)&&a.push(c[f])}if(!(!s&&!a||s&&0===s.length||a&&0===a.length)){t=!0;var p=new d.vo.protection.KeySystemConfiguration(s,a),m=this.protectionExt.getKeySystemBySystemString(i),g=new d.vo.protection.KeySystemAccess(m,p);this.debug.log("[DRM][3Feb2014] configuration supported = audio:"+JSON.stringify(s)+", video:"+JSON.stringify(a)),this.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,g);break}}}t||this.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,null,"[DRM][3Feb2014] Key system access denied! -- No valid audio/video content configurations detected!")},selectKeySystem:function(t){this.debug.log("[DRM][3Feb2014] Select key system "+t.keySystem.systemString);try{n=t.mediaKeys=new window[o.MediaKeys](t.keySystem.systemString),this.keySystem=t.keySystem,i=t,e&&u.call(this),this.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED)}catch(r){this.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,null,"Error selecting keys system ("+this.keySystem.systemString+")! Could not create MediaKeys -- TODO")}},setMediaElement:function(i){if(e!==i)return e&&(e.removeEventListener(o.needkey,l),e.removeEventListener("loadedmetadata",r)),e=i,e&&n&&u.call(this),t.when()},createKeySession:function(e,t,r){if(!this.keySystem||!n||!i)throw new Error("Can not create sessions until you have selected a key system");this.debug.log("[DRM][3Feb2014] Create key session");var a=i.ksConfiguration.videoCapabilities[0].contentType,l=n.createSession(a,new Uint8Array(e),r?new Uint8Array(r):null),u=h.call(this,l,e);l.addEventListener(o.error,u),l.addEventListener(o.message,u),l.addEventListener(o.ready,u),l.addEventListener(o.close,u),s.push(u),this.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,u)},updateKeySession:function(e,t){var n=e.session;this.debug.log("[DRM][3Feb2014] Update key session"),this.protectionExt.isClearKey(this.keySystem)?n.update(new Uint8Array(t.toJWK())):n.update(new Uint8Array(t))},closeKeySession:function(e){this.debug.log("[DRM][3Feb2014] Close key session, token = "+e.session.sessionId);var t=e.session;t.removeEventListener(o.error,e),t.removeEventListener(o.message,e),t.removeEventListener(o.ready,e),t.removeEventListener(o.close,e);for(var n=0;n<s.length;n++)if(s[n]===e){s.splice(n,1);break}t[o.release]()},setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},checkIfEncrypted:function(){}}},d.models.ProtectionModel_3Feb2014.APIs=[{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"},{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"}],d.models.ProtectionModel_3Feb2014.detect=function(e){for(var t=d.models.ProtectionModel_3Feb2014.APIs,n=0;n<t.length;n++){var i=t[n];if("function"===typeof e[i.setMediaKeys]&&"function"===typeof window[i.MediaKeys])return i}return null},d.models.ProtectionModel_3Feb2014.prototype={constructor:d.models.ProtectionModel_3Feb2014},d.models.ProtectionModel_21Jan2015=function(){var e=null,n=null,i=null,r=[],o=function(e){var t,n="[";for(t=0;t<e.length;t++)n+="0x"+e[t].toString(16),t<e.length-1&&(n+=",");return n+="]",n},s=function(e,t){var n=this;void 0!==navigator.requestMediaKeySystemAccess&&"function"===typeof navigator.requestMediaKeySystemAccess?function(t){var i=e[t].ks,r=e[t].configs;n.debug.log("[DRM][PM_21Jan2015] requestMediaKeySystemAccess: "+i.systemString),navigator.requestMediaKeySystemAccess(i.systemString,r).then(function(e){var t="function"===typeof e.getConfiguration?e.getConfiguration():null,r=new d.vo.protection.KeySystemAccess(i,t);r.mksa=e,n.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,r)}).catch(function(){++t<e.length?s.call(n,e,t):n.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,null,"Key system access denied!")})}(t):this.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,null,"Insecure origins are not allowed")},a=function(e){var t=e.session;return t.removeEventListener("keystatuseschange",e),t.removeEventListener("message",e),t.close()},l=function(){var e=this;return{session:null,handleEvent:function(t){switch(t.type){case"encrypted":if(e.debug.log("[DRM][PM_21Jan2015] 'encrypted' event"),t.initData){var n=ArrayBuffer.isView(t.initData)?t.initData.buffer:t.initData;e.notify(d.models.ProtectionModel.eventList.ENAME_NEED_KEY,new d.vo.protection.NeedKey(n,"cenc"))}break;case"waitingforkey":e.debug.log("[DRM][PM_21Jan2015] 'waitingforkey' event"),null!==this.session&&this.session.usable&&(this.session.usable=!1,e.notify(d.models.ProtectionModel.eventList.ENAME_KEY_ERROR,new d.vo.protection.KeyError(d.dependencies.ErrorHandler.prototype.MEDIA_ERR_ENCRYPTED,"Media is encrypted and no valid key is available")));break}}}},u=function(e){for(var t=0;t<r.length;t++)if(r[t]===e){r.splice(t,1);break}},c=function(t,n,s){var a=this,l=function(e,t){for(var n=0;n<r.length;n++)if(r[n].session===e){r[n].usable=t;break}},c={session:t,initData:n,usable:!1,handleEvent:function(t){switch(t.type){case"keystatuseschange":a.notify(d.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED,this),t.target.keyStatuses.forEach(function(){var n,r;switch(arguments&&arguments.length>0&&(arguments[0]&&("string"===typeof arguments[0]?n=arguments[0]:r=arguments[0]),arguments[1]&&("string"===typeof arguments[1]?n=arguments[1]:r=arguments[1])),a.debug.log("[DRM][PM_21Jan2015] status = "+n+" for KID "+o(new Uint8Array(r))),n){case"expired":l(t.target,!1),a.notify(d.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED,null,new d.vo.Error(d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_EXPIRED,"License has expired",null));break;case"output-restricted":l(t.target,!1),a.notify(d.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED,null,new d.vo.Error(d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR_OUTPUT,"There is no available output device with the required characteristics for the content protection system",null));break;case"usable":l(t.target,!0),e.addEventListener("waitingforkey",i);break;default:a.notify(d.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED,{status:n,keyId:r})}});break;case"message":a.debug.log("[DRM][PM_21Jan2015] 'message' event: ",t);var n=ArrayBuffer.isView(t.message)?t.message.buffer:t.message;a.notify(d.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,new d.vo.protection.KeyMessage(this,n,void 0,t.messageType));break}},getSessionID:function(){return this.session.sessionId},getExpirationTime:function(){return this.session.expiration},getKeyStatuses:function(){return this.session.keyStatuses},getSessionType:function(){return s}};return t.addEventListener("keystatuseschange",c),t.addEventListener("message",c),t.closed.then(function(){u(c),a.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,c.getSessionID())}),r.push(c),c};return{system:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,protectionExt:void 0,keySystem:null,config:null,debug:null,setup:function(){i=l.call(this)},init:function(){i.session=null},teardown:function(){var e,t,i,o=r.length,s=this;if(this.debug.log("[DRM][PM_21Jan2015] Teardown"),this.config.getParam("Protection.licensePersistence","boolean",!1)){for(t=0;t<r.length;t++)e=r[t],e.usable||(r.splice(t,1),t--);this.notify(d.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE)}else{var l=function(e){s.debug.log("[DRM][PM_21Jan2015] Session closed"),u(e),t>=o-1&&(n=null,clearTimeout(i),s.notify(d.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE))},c=function(){for(t=0;t<o;t++)l(r[t])};if(0===o)return n=null,void this.notify(d.models.ProtectionModel.eventList.ENAME_TEARDOWN_COMPLETE);for(t=0;t<o;t++)e=r[t],function(t){s.debug.log("[DRM][PM_21Jan2015] Close session "+e.getSessionID()),e.session.closed.then(function(){l(t)}),a(e).catch(function(){l(t)})}(e);i=setTimeout(c,1e3)}},getAllInitData:function(){for(var e=[],t=0;t<r.length;t++)e.push(r[t].initData);return e},requestKeySystemAccess:function(e){s.call(this,e,0)},selectKeySystem:function(t){var r=this;if(r.debug.log("[DRM][PM_21Jan2015] Select key system, create new MediaKeys"),null!==n)return r.debug.log("[DRM][PM_21Jan2015] MediaKeys already created"),void r.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED);t.mksa.createMediaKeys().then(function(o){r.keySystem=t.keySystem,n=o,e&&e.setMediaKeys(n).then(function(){var t=r.keySystem.getServerCertificate();t?r.setServerCertificate(t).then(function(){r.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED),e.addEventListener("encrypted",i)}):(r.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED),e.addEventListener("encrypted",i))})}).catch(function(){r.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,null,"Error selecting keys system ("+t.keySystem.systemString+")! Could not create MediaKeys -- TODO")})},setMediaElement:function(r){var o=this,s=t.defer();return e===r?(s.resolve(),s.promise):(e&&(e.removeEventListener("encrypted",i),e.removeEventListener("waitingforkey",i),e.setMediaKeys?e.setMediaKeys(null).then(function(){o.debug.log("[DRM][PM_21Jan2015] Successfully detached MediaKeys from video element"),s.resolve()},function(e){o.debug.error("[DRM][PM_21Jan2015] Failed to detach MediaKeys from video element: "+e),s.resolve()}):s.resolve()),e=r,e&&n&&e.setMediaKeys&&(e.addEventListener("encrypted",i),e.setMediaKeys(n)),s.promise)},setServerCertificate:function(e){if(!this.keySystem||!n)throw new Error("Can not set server certificate until you have selected a key system");this.debug.log("[DRM][PM_21Jan2015] Set server certificate");var i=this,r=t.defer();return n.setServerCertificate(e).then(function(){i.notify(d.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED),r.resolve()}).catch(function(e){i.notify(d.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED,null,"Error updating server certificate -- "+e.name),r.reject()}),r.promise},createKeySession:function(e,t){if(!this.keySystem||!n)throw new Error("Can not create sessions until you have selected a key system");this.debug.log("[DRM][PM_21Jan2015] Create key session, type = "+t),this.debug.log("[DRM][PM_21Jan2015] initData = "+String.fromCharCode.apply(null,new Uint8Array(e)));var i=n.createSession(t),r=c.call(this,i,e,t),o=this;i.generateRequest("cenc",e).then(function(){o.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,r)}).catch(function(e){u(r),o.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,null,{reason:"Failed to generate key request",error:new d.vo.Error(e.code,e.name,e.message)})})},updateKeySession:function(e,t){var n=e.session,r=this;r.debug.log("[DRM][PM_21Jan2015] Update key session. SessionID = "+n.sessionId),this.protectionExt.isClearKey(this.keySystem)&&(t=t.toJWK()),n.update(t).then(function(){i.session=e}).catch(function(e){r.notify(d.models.ProtectionModel.eventList.ENAME_KEY_ERROR,new d.vo.protection.KeyError(d.dependencies.ErrorHandler.prototype.MEDIA_KEYERR,"Error while providing license to the CDM",e))})},loadKeySession:function(e){if(!this.keySystem||!n)throw new Error("Can not load sessions until you have selected a key system");this.debug.log("[DRM][PM_21Jan2015] Load key session. SessionID = "+e);var t=n.createSession(),i=this;t.load(e).then(function(n){if(n){var r=c.call(this,t);i.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,r)}else i.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,null,{reason:"Failed to load session "+e,error:null})}).catch(function(t){i.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,{reason:"Failed to load session "+e,error:new d.vo.Error(t.code,t.name,t.message)})})},removeKeySession:function(e){var t=e.session;this.debug.log("[DRM][PM_21Jan2015] Remove key session. SessionID = "+e.getSessionID());var n=this;t.remove().then(function(){n.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED,e.getSessionID())},function(t){n.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED,null,"Error removing session ("+e.getSessionID()+"). "+t.name)})},closeKeySession:function(e){this.debug.log("[DRM][PM_21Jan2015] Close key session. SessionID = "+e.getSessionID());var t=this;a(e).catch(function(n){u(e),t.notify(d.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,null,"Error closing session ("+e.getSessionID()+") "+n.name)})},checkIfEncrypted:function(){}}},d.models.ProtectionModel_21Jan2015.detect=function(e){return void 0!==e.onencrypted&&void 0!==e.mediaKeys&&!window.MSMediaKeys},d.models.ProtectionModel_21Jan2015.prototype={constructor:d.models.ProtectionModel_21Jan2015},d.dependencies.protection.KeySystem=function(){},d.dependencies.protection.KeySystem_Access=function(){},d.dependencies.protection.KeySystem_Access.prototype={constructor:d.dependencies.protection.KeySystem_Access},d.dependencies.protection.KeySystem_ClearKey=function(){"use strict";var e="org.w3.clearkey",t="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b";return{system:void 0,schemeIdURI:"urn:uuid:"+t,systemString:e,uuid:t,sessionType:"temporary",init:function(e){e},getInitData:d.dependencies.protection.CommonEncryption.parseInitDataFromContentProtection,getKeySystemConfigurations:d.dependencies.protection.CommonEncryption.getKeySystemConfigurations,getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getServerCertificate:function(){return null}}},d.dependencies.protection.KeySystem_ClearKey.prototype={constructor:d.dependencies.protection.KeySystem_ClearKey},d.dependencies.protection.KeySystem_ClearKey.getClearKeysFromProtectionData=function(e,t){var n=null;if(e){for(var i=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),r=[],o=0;o<i.kids.length;o++){var s=i.kids[o],a=e.clearkeys.hasOwnProperty(s)?e.clearkeys[s]:null;if(!a)throw new Error("[DRM] ClearKey keyID ("+s+") is not known!");r.push(new d.vo.protection.KeyPair(s,a))}n=new d.vo.protection.ClearKeyKeySet(r)}return n},d.dependencies.protection.KeySystem_PlayReady=function(){"use strict";var e,t="com.microsoft.playready",n="9a04f079-9840-4286-ab92-e65be0885f95",i='<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>',r=function(e){var t,n,i,r,o={},s=e instanceof ArrayBuffer?e:e.buffer,a=d.utils.isUTF16(new Uint8Array(s))?new Uint16Array(s):new Uint8Array(s),l=0;for(t=String.fromCharCode.apply(null,a),n=this.domParser.createXmlTree(t),i=n.getElementsByTagName("name"),r=n.getElementsByTagName("value"),l=0;l<i.length;l+=1)o[i[l].childNodes[0].nodeValue]=r[l].childNodes[0].nodeValue;return o.hasOwnProperty("Content")&&(o["Content-Type"]=o.Content,delete o.Content),o.hasOwnProperty("Content-Type")||(o["Content-Type"]="text/xml; charset=utf-8"),o},o=function(e){var t,n,i,r=null,o=e instanceof ArrayBuffer?e:e.buffer,s=d.utils.isUTF16(new Uint8Array(o))?new Uint16Array(o):new Uint8Array(o);return t=String.fromCharCode.apply(null,s),n=this.domParser.createXmlTree(t),n.getElementsByTagName("Challenge")[0]&&(i=n.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue,i&&(r=f.decode(i))),r||(r=t),r},s=function(e){if(e){var t,n,i,r,o,s,a,l=new DataView(e),u=l.getUint16(4,!0),c=6,d=0;for(d=0;d<u;d++)if(t=l.getUint16(c,!0),c+=2,n=l.getUint16(c,!0),c+=2,1===t){if(i=e.slice(c,c+n),r=String.fromCharCode.apply(null,new Uint16Array(i)),o=this.domParser.createXmlTree(r),o.getElementsByTagName("LA_URL")[0]&&(s=o.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue,s))return s;if(o.getElementsByTagName("LUI_URL")[0]&&(a=o.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue,a))return a}else c+=n}return null},a=function(e){var t,n,i,r,o,s=0,a=new Uint8Array([112,115,115,104,0,0,0,0]),l=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),u=null;if("pssh"in e)return d.dependencies.protection.CommonEncryption.parseInitDataFromContentProtection(e);if("pro"in e)u=f.decodeArray(e.pro.__text);else{if(!("prheader"in e))return null;u=f.decodeArray(e.prheader.__text)}return t=u.length,n=4+a.length+l.length+4+t,i=new ArrayBuffer(n),r=new Uint8Array(i),o=new DataView(i),o.setUint32(s,n),s+=4,r.set(a,s),s+=a.length,r.set(l,s),s+=l.length,o.setUint32(s,t),s+=4,r.set(u,s),s+=t,r.buffer},l=function(){var t,n,r,o;if(e&&e.cdmData){for(t=[],o=0;o<e.cdmData.length;++o)t.push(e.cdmData.charCodeAt(o)),t.push(0);for(t=String.fromCharCode.apply(null,t),t=f.encode(t),n=i.replace("%CUSTOMDATA%",t),r=[],o=0;o<n.length;++o)r.push(n.charCodeAt(o)),r.push(0);return new Uint8Array(r).buffer}return null};return{schemeIdURI:"urn:uuid:"+n,systemString:t,uuid:n,notify:void 0,subscribe:void 0,unsubscribe:void 0,domParser:void 0,sessionType:"temporary",init:function(t){t&&(e=t,e.sessionType&&(this.sessionType=e.sessionType))},getInitData:a,getKeySystemConfigurations:d.dependencies.protection.CommonEncryption.getKeySystemConfigurations,getRequestHeadersFromMessage:r,getLicenseRequestFromMessage:o,getLicenseServerURLFromInitData:s,getCDMData:l,getServerCertificate:function(){return null}}},d.dependencies.protection.KeySystem_PlayReady.prototype={constructor:d.dependencies.protection.KeySystem_PlayReady},d.dependencies.protection.KeySystem_Widevine=function(){"use strict";var e,t="com.widevine.alpha",n="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",i=function(e){return d.dependencies.protection.CommonEncryption.parseInitDataFromContentProtection(e)},r=function(t,n,i){var r=d.dependencies.protection.CommonEncryption.getKeySystemConfigurations(t,n,i);return e&&(e.audioRobustness&&r[0].audioCapabilities.length>0&&(r[0].audioCapabilities[0].robustness=e.audioRobustness),e.videoRobustness&&r[0].videoCapabilities.length>0&&(r[0].videoCapabilities[0].robustness=e.videoRobustness)),r},o=function(){return e&&e.serverCertificate&&e.serverCertificate.length>0?f.decodeArray(e.serverCertificate).buffer:null};return{schemeIdURI:"urn:uuid:"+n,systemString:t,uuid:n,sessionType:"temporary",init:function(t){e=t,e&&e.sessionType&&(this.sessionType=e.sessionType)},getInitData:i,getKeySystemConfigurations:r,getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getServerCertificate:o}},d.dependencies.protection.KeySystem_Widevine.prototype={constructor:d.dependencies.protection.KeySystem_Widevine},d.dependencies.protection.servers.ClearKey=function(){"use strict";return{getServerURLFromMessage:function(e,t){var n=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),i=0;for(e+="/?",i=0;i<n.kids.length;i++)e+=n.kids[i]+"&";return e=e.substring(0,e.length-1),e},getHTTPMethod:function(){return"GET"},getResponseType:function(){return"json"},getLicenseMessage:function(e){var t,n,i,r,o=[];if(!e.hasOwnProperty("keys"))return null;for(t=0;t<e.keys.length;t++)n=e.keys[t],i=n.kid.replace(/=/g,""),r=n.k.replace(/=/g,""),o.push(new d.vo.protection.KeyPair(i,r));return new d.vo.protection.ClearKeyKeySet(o)},getErrorResponse:function(e){return{code:0,name:"UnknownError",message:String.fromCharCode.apply(null,new Uint8Array(e))}}}},d.dependencies.protection.servers.ClearKey.prototype={constructor:d.dependencies.protection.servers.ClearKey},d.dependencies.protection.servers.DRMToday=function(){"use strict";var e={"com.widevine.alpha":{responseType:"json",getLicenseMessage:function(e){return f.decodeArray(e.license)},getErrorResponse:function(e){return e}},"com.microsoft.playready":{responseType:"arraybuffer",getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}};return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(t){return e[t].responseType},getLicenseMessage:function(t,n){return e[n].getLicenseMessage(t)},getErrorResponse:function(t,n){return{code:0,name:"UnknownError",message:e[n].getErrorResponse(t)}}}},d.dependencies.protection.servers.DRMToday.prototype={constructor:d.dependencies.protection.servers.DRMToday},d.dependencies.protection.servers.LicenseServer=function(){},d.dependencies.protection.servers.PlayReady=function(){"use strict";var e=function(e){var t="",n=0,i=0,r=0,o=0,s=new Uint8Array(e);s.length>=3&&239===s[0]&&187===s[1]&&191===s[2]&&(n=3);while(n<s.length)if(i=s[n],i<128)t+=String.fromCharCode(i),n++;else if(i>191&&i<224){if(n+1>=s.length)throw"UTF-8 Decode failed. Two byte character was truncated.";r=s[n+1],t+=String.fromCharCode((31&i)<<6|63&r),n+=2}else{if(n+2>=s.length)throw"UTF-8 Decode failed. Multi byte character was truncated.";r=s[n+1],o=s[n+2],t+=String.fromCharCode((15&i)<<12|(63&r)<<6|63&o),n+=3}return t},t=function(t){var n=e(t),i=this.domParser.createXmlTree(n),r=i?this.domParser.getChildNode(i,"soap:Envelope"):null,o=r?this.domParser.getChildNode(r,"soap:Body"):null,s=o?this.domParser.getChildNode(o,"soap:Fault"):null;return s?null:t},n=function(t){var n=e(t),i=this.domParser.createXmlTree(n),r=i?this.domParser.getChildNode(i,"soap:Envelope"):null,o=r?this.domParser.getChildNode(r,"soap:Body"):null,s=o?this.domParser.getChildNode(o,"soap:Fault"):null,a=s?this.domParser.getChildNode(s,"detail"):null,l=a?this.domParser.getChildNode(a,"Exception"):null,u=null,c="",d="",h="",f=-1,p=-1;return null===s?{code:0,name:"UnknownError",message:String.fromCharCode.apply(null,new Uint8Array(t))}:(u=this.domParser.getChildNode(s,"faultstring").firstChild,c=u?u.nodeValue:null,null!==l&&(u=this.domParser.getChildNode(l,"StatusCode"),d=u?u.firstChild.nodeValue:null,u=this.domParser.getChildNode(l,"Message"),h=u?u.firstChild.nodeValue:null,f=h?h.lastIndexOf("[")+1:-1,p=h?h.indexOf("]"):-1),{code:d,name:c,message:h?h.substring(f,p):""})};return{domParser:void 0,getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return t.call(this,e)},getErrorResponse:function(e){return n.call(this,e)}}},d.dependencies.protection.servers.PlayReady.prototype={constructor:d.dependencies.protection.servers.PlayReady},d.dependencies.protection.servers.Widevine=function(){"use strict";return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return e},getErrorResponse:function(e){return{code:0,name:"UnknownError",message:String.fromCharCode.apply(null,new Uint8Array(e))}}}},d.dependencies.protection.servers.Widevine.prototype={constructor:d.dependencies.protection.servers.Widevine},d.vo.protection.ClearKeyKeySet=function(e,t){if(t&&"persistent"!==t&&"temporary"!==t)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=e,this.type=t,this.toJWK=function(){var e,t=this.keyPairs.length,n={keys:[]};for(e=0;e<t;e++){var i={kty:"oct",alg:"A128KW",kid:this.keyPairs[e].keyID,k:this.keyPairs[e].key};n.keys.push(i)}this.type&&(n.type=this.type);var r=JSON.stringify(n),o=r.length,s=new ArrayBuffer(o),a=new Uint8Array(s);for(e=0;e<o;e++)a[e]=r.charCodeAt(e);return s}},d.vo.protection.ClearKeyKeySet.prototype={constructor:d.vo.protection.ClearKeyKeySet},d.vo.protection.KeyError=function(e,t,n){"use strict";this.code=e,this.message=t,this.data=n},d.vo.protection.KeyError.prototype={constructor:d.vo.protection.KeyError},d.vo.protection.KeyMessage=function(e,t,n,i){"use strict";this.sessionToken=e,this.message=t,this.defaultURL=n,this.messageType=i},d.vo.protection.KeyMessage.prototype={constructor:d.vo.protection.KeyMessage},d.vo.protection.KeyPair=function(e,t){"use strict";this.keyID=e,this.key=t},d.vo.protection.KeyPair.prototype={constructor:d.vo.protection.KeyPair},d.vo.protection.KeySystemAccess=function(e,t){this.keySystem=e,this.ksConfiguration=t},d.vo.protection.KeySystemAccess.prototype={constructor:d.vo.protection.KeySystemAccess},d.vo.protection.KeySystemConfiguration=function(e,t,n,i,r){this.initDataTypes=["cenc"],this.audioCapabilities=e,this.videoCapabilities=t,this.distinctiveIdentifier=n,this.persistentState=i,this.sessionTypes=r},d.vo.protection.KeySystemConfiguration.prototype={constructor:d.vo.protection.KeySystemConfiguration},d.vo.protection.LicenseRequestComplete=function(e,t){"use strict";this.message=e,this.requestData=t},d.vo.protection.LicenseRequestComplete.prototype={constructor:d.vo.protection.LicenseRequestComplete},d.vo.protection.MediaCapability=function(e,t){this.contentType=e,this.robustness=t},d.vo.protection.MediaCapability.prototype={constructor:d.vo.protection.MediaCapability},d.vo.protection.NeedKey=function(e,t){this.initData=e,this.initDataType=t},d.vo.protection.NeedKey.prototype={constructor:d.vo.protection.NeedKey},d.vo.protection.ProtectionData=function(e,t,n,i){this.laURL=e,this.httpRequestHeaders=t,this.bearerToken=n,this.clearkeys=i},d.vo.protection.ProtectionData.prototype={constructor:d.vo.protection.ProtectionData},d.models.SessionToken=function(){},d.models.SessionToken.prototype={initData:null,getSessionID:function(){return""},getExpirationTime:function(){return NaN},getKeyStatuses:function(){return null}},u.dependencies.AES=function(){this.init=function(e){this._tables=[[[],[],[],[],[]],[[],[],[],[],[]]],this._precompute.call(this);var t,n,i,r,o,s=this._tables[0][4],a=this._tables[1],l=e.length,u=1;if(4!==l&&6!==l&&8!==l)throw new Error("Invalid aes key size="+l);for(r=e.slice(0),o=[],this._key=[r,o],t=l;t<4*l+28;t++)i=r[t-1],(t%l===0||8===l&&t%l===4)&&(i=s[i>>>24]<<24^s[i>>16&255]<<16^s[i>>8&255]<<8^s[255&i],t%l===0&&(i=i<<8^i>>>24^u<<24,u=u<<1^283*(u>>7))),r[t]=r[t-l]^i;for(n=0;t;n++,t--)i=r[3&n?t:t-4],o[n]=t<=4||n<4?i:a[0][s[i>>>24]]^a[1][s[i>>16&255]]^a[2][s[i>>8&255]]^a[3][s[255&i]]},this._precompute=function(){var e,t,n,i,r,o,s,a,l,u=this._tables[0],c=this._tables[1],d=u[4],h=c[4],f=[],p=[];for(e=0;e<256;e++)p[(f[e]=e<<1^283*(e>>7))^e]=e;for(t=n=0;!d[t];t^=i||1,n=p[n]||1)for(s=n^n<<1^n<<2^n<<3^n<<4,s=s>>8^255&s^99,d[t]=s,h[s]=t,o=f[r=f[i=f[t]]],l=16843009*o^65537*r^257*i^16843008*t,a=257*f[s]^16843008*s,e=0;e<4;e++)u[e][t]=a=a<<24^a>>>8,c[e][s]=l=l<<24^l>>>8;for(e=0;e<5;e++)u[e]=u[e].slice(0),c[e]=c[e].slice(0)},this.decrypt=function(e,t,n,i,r,o){var s,a,l,u,c=this._key[1],d=e^c[0],h=i^c[1],f=n^c[2],p=t^c[3],m=c.length/4-2,g=4,y=this._tables[1],v=y[0],b=y[1],E=y[2],_=y[3],x=y[4];for(u=0;u<m;u++)s=v[d>>>24]^b[h>>16&255]^E[f>>8&255]^_[255&p]^c[g],a=v[h>>>24]^b[f>>16&255]^E[p>>8&255]^_[255&d]^c[g+1],l=v[f>>>24]^b[p>>16&255]^E[d>>8&255]^_[255&h]^c[g+2],p=v[p>>>24]^b[d>>16&255]^E[h>>8&255]^_[255&f]^c[g+3],g+=4,d=s,h=a,f=l;for(u=0;u<4;u++)r[(3&-u)+o]=x[d>>>24]<<24^x[h>>16&255]<<16^x[f>>8&255]<<8^x[255&p]^c[g++],s=d,d=h,h=f,f=p,p=s}},u.dependencies.AES.prototype={constructor:u.dependencies.AES},u.dependencies.AES128Decrypter=function(e,t){"use strict";this.key=e,this.iv=t,this.ntoh=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},this.doDecrypt=function(e,t,n){var i,r,o,s,a,l,c,d,h,f=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),p=new u.dependencies.AES,m=new Uint8Array(e.byteLength),g=new Int32Array(m.buffer);for(p.init(Array.prototype.slice.call(t)),i=~~n[0],r=~~n[1],o=~~n[2],s=~~n[3],h=0;h<f.length;h+=4)a=~~this.ntoh(f[h]),l=~~this.ntoh(f[h+1]),c=~~this.ntoh(f[h+2]),d=~~this.ntoh(f[h+3]),p.decrypt(a,l,c,d,g,h),g[h]=this.ntoh(g[h]^i),g[h+1]=this.ntoh(g[h+1]^r),g[h+2]=this.ntoh(g[h+2]^o),g[h+3]=this.ntoh(g[h+3]^s),i=a,r=l,o=c,s=d;return m},this.localDecrypt=function(e,t,n,i){var r=this.doDecrypt(e,t,n);i.set(r,e.byteOffset)},this.decrypt=function(e){var t=32e3,n=new Int32Array(e),i=new Uint8Array(e.byteLength),r=0,o=this.key,s=this.iv;for(this.localDecrypt(n.subarray(r,r+t),o,s,i),r=t;r<n.length;r+=t)s=new Uint32Array([this.ntoh(n[r-4]),this.ntoh(n[r-3]),this.ntoh(n[r-2]),this.ntoh(n[r-1])]),this.localDecrypt(n.subarray(r,r+t),o,s,i);return i}},u.dependencies.AES128Decrypter.prototype={constructor:u.dependencies.AES128Decrypter},u.dependencies.HlsDemux=function(){"use strict";var e=function(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(e,0),n.set(t,e.byteLength),n},t=[1,5,6],n=1,i=[],r=[],o=-1,s=-1,a=function(e,t,n,i){var r,o=t;while(o<e.length){if(r=new E.ts.TsPacket,r.parse(e.subarray(o,o+E.ts.TsPacket.prototype.TS_PACKET_SIZE)),r.getPid()===n&&(void 0===i||r.getPusi()===i))return{offset:o,packet:r};o+=E.ts.TsPacket.prototype.TS_PACKET_SIZE}return null},l=function(e){var t=new E.ts.TsPacket;return t.checkSyncWord(e.subarray(0,E.ts.TsPacket.prototype.TS_PACKET_SIZE))},u=function(e){var t=a.call(this,e,0,E.ts.TsPacket.prototype.PAT_PID);if(null===t)return null;var n=new E.si.PAT;return n.parse(t.packet.getPayload()),n},c=function(e,t){var n=a.call(this,e,0,t);if(null===n)return null;var i=new E.si.PMT;return i.parse(n.packet.getPayload()),i},h=function(e){var t,n,r,a,l=null,u=null;if(t=new E.ts.TsPacket,t.parse(e),!t.hasAdaptationFieldOnly()&&(n=t.getPid(),r=i[n],r))if(t.getPusi())if(a=new E.pes.PesPacket,a.parse(t.getPayload()),l=new d.vo.Mp4Track.Sample,l.cts=a.getPts().getValue(),l.dts=null!==a.getDts()?a.getDts().getValue():l.cts,l.size=0,l.duration=0,l.subSamples=[],-1===o&&(o=l.dts),l.mpegTimestamp=l.cts,l.dts-=o,l.cts-=o,l.dts+=s,l.cts+=s,u=a.getPayload(),"audio"===r.type&&(l.flags=16777216),"video"===r.type&&-1!==r.streamType.search("H.264")&&(l.flags=E.h264.isIDR(u)?33554432:16842752),l.subSamples.push(u),l.dts>=0)r.samples.push(l);else{var c=Math.abs(l.dts)/9e4;if(c>10)throw{name:d.dependencies.ErrorHandler.prototype.HLS_DEMUX_ERROR,message:"A/V desynchronization ("+Math.round(c)+" s.)"}}else r.samples.length>0&&(l=r.samples[r.samples.length-1],l.subSamples.push(t.getPayload()))},f=function(e){var t,n,i,r,o=0,s=0;if(0!==e.samples.length){for(i=0;i<e.samples.length;i++){for(n=0,t=e.samples[i],r=0;r<t.subSamples.length;r++)n+=t.subSamples[r].length;i>0&&(e.samples[i-1].duration=e.samples[i].dts-e.samples[i-1].dts),t.size=n,o+=n}for(e.samples[e.samples.length-1].duration=e.samples[e.samples.length-2].duration,e.data=new Uint8Array(o),e.dataCTS=[],i=0;i<e.samples.length;i++)for(t=e.samples[i],-1!==e.streamType.search("ADTS")&&(e.dataCTS[s]=t.cts),r=0;r<t.subSamples.length;r++)e.data.set(t.subSamples[r],s),s+=t.subSamples[r].length;if(-1!==e.streamType.search("H.264")&&p.call(this,e),-1!==e.streamType.search("ADTS")&&m.call(this,e),e.previousCts&&e.previousDuration){t=e.samples[0];var a=t.cts-(e.previousCts+e.previousDuration);a>0&&a<e.timescale&&(t.cts-=a,t.dts-=a,t.duration+=a,this.debug.log("[HlsDemux]["+e.type+"] Patch sample duration, cts = "+(t.cts/9e4).toFixed(3)+", duration = "+(t.duration/9e4).toFixed(3)))}}},p=function(e){var n,i,r,o,s,a,l;for(r=0,s=0,a=0;a<e.samples.length;a++){for(n=e.samples[a],n.nalus=E.h264.parseNALUs(e.data.subarray(s,s+n.size)),l=0;l<n.nalus.length;l++)i=n.nalus[l],-1!==t.indexOf(i.type)?(i.offset+=s,r+=4+n.nalus[l].size):(n.nalus.splice(l,1),l--);s+=n.size}for(o=new Uint8Array(r),s=0,a=0;a<e.samples.length;a++)for(n=e.samples[a],n.size=0,l=0;l<n.nalus.length;l++)i=n.nalus[l],o[s++]=(4278190080&i.size)>>24,o[s++]=(16711680&i.size)>>16,o[s++]=(65280&i.size)>>8,o[s++]=255&i.size,o.set(e.data.subarray(i.offset,i.offset+i.size),s),s+=i.size,n.size+=4+i.size;e.data=o},m=function(e){var t,n,i,r,o,s,a,l,u=[];for(t=E.aac.parseADTS(e.data,e.dataCTS),n=0,l=0;l<t.length;l++)n+=t[l].length;for(r=new Uint8Array(n),s=e.samples[0].cts,a=1024*e.timescale/e.samplingRate,i=0,l=0;l<t.length;l++)o=new d.vo.Mp4Track.Sample,o.cts=o.dts=t[l].cts?t[l].cts:s,o.size=t[l].length,o.duration=a,o.flags=16777216,0===u.length&&(o.mpegTimestamp=e.samples[0].mpegTimestamp),u.push(o),s=o.cts+a,l>0&&(u[l-1].duration=u[l].cts-u[l-1].cts,u[l-1].duration>a&&this.debug.log("[HlsDemux]["+e.type+"] Patch sample duration, cts = "+(u[l-1].cts/9e4).toFixed(3)+", duration = "+(u[l-1].duration/9e4).toFixed(3))),r.set(e.data.subarray(t[l].offset,t[l].offset+t[l].length),i),i+=t[l].length;e.data=r,e.samples=u},g=function(e){var t="",n=0,i=0;for(n=0;n<e.length;n++)i=e[n].toString(16),i.length<2&&(i="0"+i),t+=i;return t},y=function(){this.debug.log("[HlsDemux] Reset"),n=1,i=[],r=[],o=-1,s=-1},v=function(t,n){var i,r,o,s,l,u,c,h;if(i=a.call(this,t,0,n.pid,!0),null===i)throw{name:d.dependencies.ErrorHandler.prototype.HLS_DEMUX_ERROR,message:"No packets for track "+n.type};if(r=new E.pes.PesPacket,r.parse(i.packet.getPayload()),o=r.getPayload(),-1!==n.streamType.search("H.264")){s=E.h264.getSequenceHeader(o);while(null===s)i=a.call(this,t,i.offset+E.ts.TsPacket.prototype.TS_PACKET_SIZE,n.pid,!1),o=e(o,i.packet.getPayload()),s=E.h264.getSequenceHeader(o);n.codecPrivateData=g(s.bytes),n.codecs="avc1.",l=/00000001[0-9]7/.exec(n.codecPrivateData),l&&l[0]&&(n.codecs+=n.codecPrivateData.substr(n.codecPrivateData.indexOf(l[0])+10,6)),n.width=s.width,n.height=s.height,this.debug.log("[HlsDemux] width  = "+n.width),this.debug.log("[HlsDemux] height = "+n.height)}-1!==n.streamType.search("AAC")&&(u=E.aac.getAudioSpecificConfig(o),c=(248&u[0])>>3,n.codecPrivateData=g(u),n.codecs="mp4a.40."+c,h=(7&u[0])<<1|(128&u[1])>>7,n.samplingRate=E.aac.SAMPLING_FREQUENCY[h],n.channels=(120&u[1])>>3,n.bandwidth=0),this.debug.log("[HlsDemux] codecs = "+n.codecs),this.debug.log("[HlsDemux] codecPrivateData = "+n.codecPrivateData)},b=function(e){var t,o,s,a,h,f,p=0;if(!l.call(this,e))throw{name:d.dependencies.ErrorHandler.prototype.HLS_INVALID_PACKET_ERROR,message:"Failed to demux, packet is invalid, missing SYNC byte"};if(t=u.call(this,e),null===t)throw{name:d.dependencies.ErrorHandler.prototype.HLS_DEMUX_ERROR,message:"Failed to demux, missing signalization (PAT)"};if(o=c.call(this,e,t.getPmtPid()),null===o)throw{name:d.dependencies.ErrorHandler.prototype.HLS_DEMUX_ERROR,message:"Failed to demux, missing signalization (PMT)"};for(p=0;p<o.m_listOfComponents.length;p++){if(s=o.m_listOfComponents[p],a=s.m_elementary_PID,h=i[a],!h){if(h=new d.vo.Mp4Track,h.timescale=E.Pts.prototype.SYSTEM_CLOCK_FREQUENCY,h.pid=a,f=o.gStreamTypes[s.m_stream_type],null===f){this.debug.log("[HlsDemux] Stream Type "+s.m_stream_type+" unknown!");continue}switch(h.streamType=f.name,f.value){case 224:h.type="video";break;case 192:h.type="audio";break;case 252:h.type="data";break;default:h.type="und"}}if(v.call(this,e,h),""===h.codecs)throw{name:d.dependencies.ErrorHandler.prototype.HLS_DEMUX_ERROR,message:"Failed to get codec information for track "+h.type};i[a]||(h.trackId=n,n++,this.debug.log("[HlsDemux] Add track: type = "+h.type+", PID = "+h.pid+", trackId = "+h.trackId),r.push(h),i[a]=h)}return r},_=function(e,t){var n,i,o=0,a=-1;for(-1===s&&(s=9e4*t.startTime,this.debug.log("[HlsDemux] Media start time = "+s+" ("+t.startTime+")")),this.debug.log("[HlsDemux] Demux chunk, size = "+e.length+", nb packets = "+Math.round(e.length/E.ts.TsPacket.prototype.TS_PACKET_SIZE)),b.call(this,e),o=0;o<r.length;o++)n=r[o],n.samples.length>0&&(n.previousCts=n.samples[n.samples.length-1].cts,n.previousDuration=n.samples[n.samples.length-1].duration),r[o].samples=[],r[o].data=null;o=0;while(o<e.length){if(o+E.ts.TsPacket.prototype.TS_PACKET_SIZE>e.length){this.debug.log("[HlsDemux] Demux chunk, residual bytes = "+(e.length-o));break}h.call(this,e.subarray(o,o+E.ts.TsPacket.prototype.TS_PACKET_SIZE)),o+=E.ts.TsPacket.prototype.TS_PACKET_SIZE}for(o=0;o<r.length;o++)if(n=r[o],0!==n.samples.length&&(f.call(this,n),this.debug.log("[HlsDemux]["+n.type+"] Demux: 1st PTS = "+n.samples[0].dts+" ("+n.samples[0].dts/9e4+")"),a=Math.max(a,n.samples[0].dts),i=Math.abs(n.samples[0].dts-a)/9e4,i>10))throw{name:d.dependencies.ErrorHandler.prototype.HLS_DEMUX_ERROR,message:"A/V desynchronization ("+Math.round(i)+" s.)"};var l=[];for(o=0;o<r.length;o++)r[o].samples.length>0&&l.push(r[o]);return l};return{debug:void 0,reset:y,getTracks:b,demux:_}},u.dependencies.HlsDemux.prototype={constructor:u.dependencies.HlsDemux},u.dependencies.HlsFragmentController=function(){"use strict";var e={},n=function(e,t){var n=0,i=a.hlsDemux.demux(new Uint8Array(e),t);for(n=0;n<i.length;n+=1)!a.manifestModel.getValue().timestampMap&&i[n].samples[0].mpegTimestamp&&(a.manifestModel.getValue().timestampMap={local:i[n].samples[0].cts/9e4,mpegts:i[n].samples[0].mpegTimestamp});return a.mp4Processor.generateInitMediaSegment(i)},i=function(e){var t=new Uint8Array(16),n=0;for(n=12;n<16;n++)t[n]=e>>8*(15-n)&255;return t},r=function(e,t){var n=new Date,r=new DataView(t.key.buffer),o=new Uint32Array([r.getUint32(0),r.getUint32(4),r.getUint32(8),r.getUint32(12)]);r=new DataView(i(t.iv).buffer);var s=new Uint32Array([r.getUint32(0),r.getUint32(4),r.getUint32(8),r.getUint32(12)]),l=new u.dependencies.AES128Decrypter(o,s);return a.debug.log("[HlsFragmentController] decrypted chunk ("+(((new Date).getTime()-n.getTime())/1e3).toFixed(3)+"s.)"),l.decrypt(e)},o=function(e){var n=t.defer();this.debug.log("[HlsFragmentController]","Load decryption key: "+e.uri);var i=new d.dependencies.XHRLoader;return i.initialize("arraybuffer",0,0),i.load(e.uri).then(function(t){e.key=new Uint8Array(t.response),n.resolve()},function(t){!t||t.aborted?n.reject():n.reject({name:d.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_MANIFEST,message:"Failed to download HLS decryption key",data:{url:e.uri,status:t.status}})}),n.promise},s=function(n,i){var s,a=t.defer(),l=this;return i.decryptionInfo&&"NONE"!==i.decryptionInfo.method?(s=e[i.decryptionInfo.uri],s?a.resolve(r.call(this,n,s)):(s=i.decryptionInfo,o.call(this,s).then(function(){if(s.key&&16!==s.key.byteLength)return a.reject({name:d.dependencies.ErrorHandler.prototype.HLS_INVALID_KEY_ERROR,message:"Invalid HLS key - Key length ("+s.key.byteLength+") does not respect specification"});e[s.uri]=s,a.resolve(r.call(l,n,s))},function(e){a.reject(e)})),a.promise):(a.resolve(n),a.promise)},a=d.utils.copyMethods(d.dependencies.FragmentController);return a.manifestModel=void 0,a.hlsDemux=void 0,a.mp4Processor=void 0,a.process=function(e,i){var r=t.defer(),o=null;return null===e||void 0===e||0===e.byteLength?(r.resolve(null),r.promise):i&&"Media Segment"===i.type?"text"===i.streamType?(r.resolve(e),r.promise):(s.call(a,e,i).then(function(e){try{a.manifestModel.getValue()?(o=n(e,i),a.sequenceNumber++,r.resolve(o)):r.resolve(null)}catch(t){r.reject(t)}},function(e){r.reject(e)}),r.promise):(r.resolve(null),r.promise)},a},u.dependencies.HlsFragmentController.prototype={constructor:u.dependencies.HlsFragmentController},u.dependencies.HlsHandler=function(){"use strict";var e=function(e){var i,r,o,s=null,a=this,l=null,u=t.defer();return s=e.adaptation.period,l=s.start,i=n.manifestModel.getValue(),r=n.manifestExt.getIsDynamic(i),o=new d.vo.SegmentRequest,o.streamType=n.getType(),o.type="Initialization Segment",o.url=null,o.data=1,o.range=e.range,o.availabilityStartTime=a.timelineConverter.calcAvailabilityStartTimeFromPresentationTime(l,e.adaptation.period.mpd,r),o.availabilityEndTime=a.timelineConverter.calcAvailabilityEndTimeFromPresentationTime(l+s.duration,s.mpd,r),o.quality=e.index,u.resolve(o),u.promise},n=d.utils.copyMethods(c.dependencies.DashHandler);return n.getInitRequest=e,n},u.dependencies.HlsHandler.prototype={constructor:u.dependencies.HlsHandler},u.dependencies.HlsParser=function(){var e,n=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,i=/#EXT-X-MEDIA:(.*)/g,r="(?:#(EXT-X-MEDIA-SEQUENCE):*(\\d+))",o="(?:#(EXT-X-TARGETDURATION):*(\\d+))",s="(?:#(EXT-X-PROGRAM-DATE-TIME):*(.+))",a="(?:#(EXT-X-KEY):(.+))",l="(?:#(EXTINF):*(\\d+(?:\\.\\d+)?)(?:,(.*))?[\r\n]*(.*))",u="(?:#(EXT-X-ENDLIST))",c=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,h=new RegExp("(?:"+r+"|"+o+"|"+s+"|"+a+"|"+l+"|"+u+")","g"),f=2,p=500,m=f,g=p,y=function(e){var t,n,i,r={};while(null!==(t=c.exec(e)))n=t[1],i=t[2].replace(/"/g,""),r[n]=i;return r},v=function(e,t){return 0===e.indexOf("http://")||0===e.indexOf("https://")?e:t+e},b=function(e){var t,i,r,o,s,a,l,u,c,d,h=[];while(null!==(i=n.exec(e))){for(r=y(i[1]),o=r["CODECS"]||"",o=o.split(","),s=a="",d=0;d<o.length;d++)-1!==o[d].indexOf("avc1")?a=o[d]:s=o[d];l=r["RESOLUTION"]||"0x0",l=l.split("x"),u=parseInt(l[0],10),c=parseInt(l[1],10),t={programId:r["PROGRAM-ID"]||"",bandwidth:parseInt(r["BANDWIDTH"]||"0",10),audioCodec:s,videoCodec:a,width:u,height:c,audioId:r["AUDIO"]||"",subtitlesId:r["SUBTITLES"]||"",uri:i[2]},h.push(t)}return h},E=function(e){var t,n,r,o,s=[];while(null!==(t=i.exec(e))){if(n=y(t[1]),r=(n["TYPE"]||"").toLowerCase(),0===r.length)break;o={type:r,groupId:n["GROUP-ID"]||"",name:r+(n["NAME"]?"_"+n["NAME"]:""),language:n["LANGUAGE"]||"",autoSelect:"YES"===n["AUTO-SELECT"],default:"YES"===n["SUTITLES"],uri:n["URI"]||""},s.push(o)}return s},_=function(e,t){for(var n=0;n<e.length;n++){if(!(e[n].sequenceNumber<t))break;e.shift(),n--}},x=function(e,t,n){var i,r,o,s,a,l,u,c,d=null,f=0,p=0,m=null;if(!e||e&&e.length<0)return!1;if(0!==e.indexOf("#EXTM3U"))return!1;i=t["SegmentList"],i||(i={name:"SegmentList",isRoot:!1,isArray:!1,duration:0,startNumber:0,timescale:1,BaseURL:t.BaseURL,SegmentURL_asArray:[]},t["SegmentList"]=i),r=i.SegmentURL_asArray,t.duration=1/0;while(null!==(l=h.exec(e)))switch(l=l.filter(function(e){return void 0!==e}),u=l[1],u){case"EXT-X-MEDIA-SEQUENCE":p=parseInt(l[2]),i.startNumber=p;break;case"EXT-X-TARGETDURATION":i.duration=parseInt(l[2]);break;case"EXT-X-KEY":c=y(l[2]),d={method:c["METHOD"]||"NONE",uri:v(c["URI"],i.BaseURL),iv:c["IV"]};break;case"EXTINF":o={name:"SegmentURL",isRoot:!1,isArray:!0,media:v(l[4],i.BaseURL),sequenceNumber:p,time:0===r.length?0:r[r.length-1].time+r[r.length-1].duration,duration:parseFloat(l[2]),decryptionInfo:d},o.decryptionInfo&&!o.decryptionInfo.iv&&(o.decryptionInfo.iv=o.sequenceNumber),(0===r.length||o.sequenceNumber>r[r.length-1].sequenceNumber)&&r.push(o),p++,f+=o.duration,m&&(o.programDateTime=m,m+=1e3*o.duration);break;case"EXT-X-ENDLIST":t.duration=f;break;case"EXT-X-PROGRAM-DATE-TIME":m=Date.parse(l[2]);break;default:break}if(_(r,i.startNumber),n.segments&&n.segments.length>0&&(_(r,n.segments[0].sequenceNumber),r.length>0&&(_(n.segments,r[0].sequenceNumber),n.segments.length>0&&r[0].time!==n.segments[0].time)))for(r[0].time=n.segments[0].time,a=1;a<r.length;a++)r[a].time=r[a-1].time+r[a-1].duration;if(0===r.length)return!0;n.segments=r;var g={start:r[0].time,end:r[r.length-1].time+r[r.length-1].duration};return m&&(g.programStart=r[0].programDateTime,g.programEnd=r[r.length-1].programDateTime+r[r.length-1].duration),"video"===n.contentType&&this.metricsModel.addDVRInfo("video",new Date,g),s={name:"Initialization",sourceURL:t.SegmentList.SegmentURL_asArray[0].media},t.SegmentList.Initialization=s,!0},T=function(e,n){var i,r,o,s,a,l,u=t.defer(),c=e.Period_asArray[0],h=c.AdaptationSet_asArray[0],f=h.Representation_asArray[n],p=new d.vo.SegmentRequest;for(c.start=0,h.duration=f.duration,c.duration=f.duration,f.duration!==1/0&&(e.mediaPresentationDuration=f.duration),e.type=f.duration===1/0?"dynamic":"static",i=f.SegmentList.duration*f.SegmentList.SegmentURL_asArray.length,"dynamic"===e.type&&(r=new Date,e.availabilityStartTime=new Date(r.getTime()-1e3*i),e.timeShiftBufferDepth=i),e.minBufferTime=3*f.SegmentList.duration,o=Math.max.apply(null,c.AdaptationSet_asArray.map(function(e){var t=n>e.Representation_asArray.length?0:n;return e.Representation_asArray[t].SegmentList.startNumber})),s=0;s<c.AdaptationSet_asArray.length;s++){var m=c.AdaptationSet_asArray[s];for(a=0;a<m.Representation_asArray.length;a++)if(m.Representation_asArray[a].SegmentList){var g=m.Representation_asArray[a].SegmentList.SegmentURL_asArray;if(g.length>0&&g[0].sequenceNumber<o&&(_(g,o),g.length>0))for(g[0].time=0,l=1;l<g.length;l++)g[l].time=g[l-1].time+g[l-1].duration}}f=h.Representation_asArray[n],p.type="Initialization Segment",p.url=f.SegmentList.Initialization.sourceURL;var y=function(e,t){var n=this.hlsDemux.getTracks(new Uint8Array(t.data)),i=0;for(e.codecs="",i=0;i<n.length;i++)e.codecs+=n[i].codecs,i<n.length-1&&(e.codecs+=",");u.resolve()},v=function(){u.resolve()};return""===f.codecs?(this.debug.log("[HlsParser]","Load initialization segment: "+p.url),this.fragmentLoader.load(p).then(y.bind(this,f),v.bind(this))):u.resolve(),u.promise},S=function(e){var t=null;return-1!==e.indexOf("/")&&(-1!==e.indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),t=e.substring(0,e.lastIndexOf("/")+1)),t},w=function(n,i){var r=this,o=t.defer();return this.debug.log("[HlsParser]","Load playlist manifest: "+n.url),e=new d.dependencies.XHRLoader,e.initialize("text",m,g),e.load(n.url).then(function(e){x.call(r,e.response,n,i)?o.resolve():o.reject({name:d.dependencies.ErrorHandler.prototype.MANIFEST_ERR_PARSE,message:"Failed to parse variant stream playlist",data:{url:n.url}})},function(e){!e||e.aborted?o.reject():o.reject({name:d.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_MANIFEST,message:"Failed to download variant stream playlist",data:{url:n.url,status:e.status}})}),o.promise},I=function(e,n){var i,r,o,s,a,l,u,c,d=this,h=t.defer(),f=[],p=0,m=[],g=[],y=[],_=0;if(0!==e.indexOf("#EXTM3U"))return this.debug.error("[HlsParser] no stream in HLS manifest"),h.reject(),h.promise;if(i={},i.name="M3U",i.isRoot=!0,i.isArray=!0,i.parent=null,i.BaseURL=n,i.profiles="urn:mpeg:dash:profile:isoff-live:2011",i.type="static",r={},r.name="Period",r.isRoot=!1,r.isArray=!1,r.parent=i,r.duration=0,r.BaseURL=i.BaseURL,i.Period=r,i.Period_asArray=[r],f=[],r.AdaptationSet=f,r.AdaptationSet_asArray=f,m=b(e),0===m.length)return this.debug.error("[HlsParser] No stream in HLS manifest"),h.reject(),h.promise;for(m.sort(function(e,t){return e.bandwidth-t.bandwidth}),o={name:"AdaptationSet",isRoot:!1,isArray:!0,id:"video",lang:"",contentType:"video",mimeType:"video/mp4",maxWidth:0,maxHeight:0,BaseURL:r.BaseURL},s=[],_=0;_<m.length;_++){if(l=m[_],l.bandwidth<=64e3)break;a={name:"Representation",isRoot:!1,isArray:!0,id:p.toString(),mimeType:"video/mp4",codecs:l.videoCodec.length>0?l.audioId.length>0?l.videoCodec:l.videoCodec+","+l.audioCodec:"",bandwidth:l.bandwidth,width:l.width,height:l.height,url:v(l.uri,o.BaseURL)},a.BaseURL=S(a.url),s.push(a),p++}for(o.Representation=s.length>1?s:s[0],o.Representation_asArray=s,f.push(o),c=this.abrController.getPlaybackQuality("video",f[0]).quality,a=f[0].Representation_asArray[c],y.push(w.call(this,a,o)),g=E(e),_=0;_<g.length;_++)u=g[_],o={name:"AdaptationSet",isRoot:!1,isArray:!0,id:u.name,lang:u.language,contentType:u.type,mimeType:"audio"===u.type?"audio/mp4":"text/vtt",maxWidth:0,maxHeight:0,BaseURL:r.BaseURL},a={name:"Representation",isRoot:!1,isArray:!0,id:"",mimeType:"audio"===u.type?"audio/mp4":"text/vtt",codecs:"audio"===u.type?m[0].audioCodec:"WebVTT",bandwidth:0,width:0,height:0,url:v(u.uri,o.BaseURL)},a.BaseURL=S(a.url),o.Representation=a,o.Representation_asArray=[a],f.push(o),y.push(w.call(this,a,o));return t.all(y).then(function(){T.call(d,i,c).then(function(){h.resolve(i)})},function(e){e?h.reject(e):h.resolve(null)}),h.promise},D=function(e,t){return this.hlsDemux.reset(),this.debug.log("[HlsParser]","Doing parse."),this.debug.log("[HlsParser]",e),I.call(this,e,t)},M=function(){null!==e&&e.abort()};return{debug:void 0,config:void 0,manifestModel:void 0,fragmentLoader:void 0,abrController:void 0,hlsDemux:void 0,metricsModel:void 0,setup:function(){m=this.config.getParam("ManifestLoader.RetryAttempts","number",f),g=this.config.getParam("ManifestLoader.RetryInterval","number",p)},parse:D,updatePlaylist:w,abort:M}},u.dependencies.HlsParser.prototype={constructor:u.dependencies.HlsParser},Number.MAX_SAFE_INTEGER||(Number.MAX_SAFE_INTEGER=9007199254740991),l.dependencies.MssParser=function(){"use strict";var e=1e7,n=["AAC","AACL","AVC1","H264","TTML","DFXP"],i={96000:0,88200:1,64000:2,48000:3,44100:4,32000:5,24000:6,22050:7,16000:8,12000:9,11025:10,8000:11,7350:12},o={video:"video/mp4",audio:"audio/mp4",text:"application/ttml+xml+mp4"},s=null,a=null,l=function(e){var t,n,i={},r=[],o=this.domParser.getChildNode(s,"SmoothStreamingMedia");for(i.BaseURL=a,n=0;n<o.childNodes.length;n++)"StreamIndex"===o.childNodes[n].nodeName&&(t=u.call(this,o.childNodes[n],e),null!==t&&r.push(t));return r.length>0&&(i.AdaptationSet=r.length>1?r:r[0]),i.AdaptationSet_asArray=r,i},u=function(e,t){var n,i,r={},s=[],l={},u=null,d=null;for(r.id=this.domParser.getAttributeValue(e,"Name"),r.lang=this.domParser.getAttributeValue(e,"Language"),r.contentType=this.domParser.getAttributeValue(e,"Type"),r.mimeType=o[r.contentType],r.maxWidth=this.domParser.getAttributeValue(e,"MaxWidth"),r.maxHeight=this.domParser.getAttributeValue(e,"MaxHeight"),r.BaseURL=a,d=this.domParser.getAttributeValue(e,"Subtype"),d&&(r.subType=d),l=m.call(this,e,t),u=this.domParser.getChildNodes(e,"QualityLevel"),i=0;i<u.length;i++)u[i].BaseURL=r.BaseURL,u[i].mimeType=r.mimeType,u[i].Id=r.id+"_"+this.domParser.getAttributeValue(u[i],"Index"),n=c.call(this,u[i],e),null!==n&&(n.SegmentTemplate=l,s.push(n));return 0===s.length?null:(r.Representation=s.length>1?s:s[0],r.Representation_asArray=s,r.SegmentTemplate=l,r)},c=function(e,t){var i={},r=null,o=this.domParser.getAttributeValue(t,"Type");if(i.id=e.Id,i.bandwidth=parseInt(this.domParser.getAttributeValue(e,"Bitrate"),10),i.mimeType=e.mimeType,i.width=parseInt(this.domParser.getAttributeValue(e,"MaxWidth"),10),i.height=parseInt(this.domParser.getAttributeValue(e,"MaxHeight"),10),r=this.domParser.getAttributeValue(e,"FourCC"),null!==r&&""!==r||(r=this.domParser.getAttributeValue(t,"FourCC")),null===r||""===r){if("audio"!==o)return this.errHandler.sendWarning(d.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED,o+" codec/FourCC not provided",{codec:""}),null;r="AAC"}return-1===n.indexOf(r.toUpperCase())?(this.debug.warn("[MssParser] Codec not supported: "+r),null):("H264"===r||"AVC1"===r?i.codecs=h.call(this,e):r.indexOf("AAC")>=0&&(i.codecs=p.call(this,e,r),i.audioSamplingRate=parseInt(this.domParser.getAttributeValue(e,"SamplingRate"),10),i.audioChannels=parseInt(this.domParser.getAttributeValue(e,"Channels"),10)),i.codecPrivateData=""+this.domParser.getAttributeValue(e,"CodecPrivateData"),i.BaseURL=e.BaseURL,i)},h=function(e){var t,n,i=this.domParser.getAttributeValue(e,"CodecPrivateData").toString();return t=/00000001[0-9]7/.exec(i),n=t&&t[0]?i.substr(i.indexOf(t[0])+10,6):void 0,"avc1."+n},p=function(e,t){var n,r,o,s,a=0,l=this.domParser.getAttributeValue(e,"CodecPrivateData").toString(),u=parseInt(this.domParser.getAttributeValue(e,"SamplingRate"),10);return"AACH"===t&&(a=5),void 0===l||""===l?(a=2,o=i[u],"AACH"===t?(a=5,l=new Uint8Array(4),s=i[2*u],l[0]=a<<3|o>>1,l[1]=o<<7|e.Channels<<3|s>>1,l[2]=s<<7|8,l[3]=0,r=new Uint16Array(2),r[0]=(l[0]<<8)+l[1],r[1]=(l[2]<<8)+l[3],n=r[0].toString(16),n=r[0].toString(16)+r[1].toString(16)):(l=new Uint8Array(2),l[0]=a<<3|o>>1,l[1]=o<<7|parseInt(this.domParser.getAttributeValue(e,"Channels"),10)<<3,r=new Uint16Array(1),r[0]=(l[0]<<8)+l[1],n=r[0].toString(16)),l=""+n,l=l.toUpperCase(),e.setAttribute("CodecPrivateData",l)):0===a&&(a=(248&parseInt(l.substr(0,2),16))>>3),"mp4a.40."+a},m=function(e,t){var n,i,r={};return n=this.domParser.getAttributeValue(e,"Url").replace("{bitrate}","$Bandwidth$"),n=n.replace("{start time}","$Time$"),i=this.domParser.getAttributeValue(e,"TimeScale"),i=i?parseFloat(i):t,r.media=n,r.timescale=i,r.SegmentTimeline=g.call(this,e,r.timescale),r},g=function(e,t){var n,i,o,s,a,l,u={},c=this.domParser.getChildNodes(e,"c"),d=[],h=0;for(o=0;o<c.length;o++)if(n={},l=this.domParser.getAttributeValue(c[o],"t"),l&&r.math.Long.fromString(l).greaterThan(r.math.Long.fromNumber(Number.MAX_SAFE_INTEGER))&&(n.tManifest=l),n.t=parseFloat(l),n.d=parseFloat(this.domParser.getAttributeValue(c[o],"d")),0!==o||n.t||(n.t=0),o>0&&(i=d[d.length-1],i.d||(i.tManifest?i.d=r.math.Long.fromString(l).subtract(r.math.Long.fromString(i.tManifest)).toNumber():i.d=n.t-i.t,h+=i.d),n.t||(i.tManifest?(n.tManifest=r.math.Long.fromString(i.tManifest).add(r.math.Long.fromNumber(i.d)).toString(),n.t=parseFloat(n.tManifest)):n.t=i.t+i.d)),n.d&&(h+=n.d),d.push(n),a=parseFloat(this.domParser.getAttributeValue(c[o],"r")),a)for(s=0;s<a-1;s++)i=d[d.length-1],n={},n.t=i.t+i.d,n.d=i.d,i.tManifest&&(n.tManifest=r.math.Long.fromString(i.tManifest).add(r.math.Long.fromNumber(i.d)).toString()),h+=n.d,d.push(n);return u.S=d,u.S_asArray=d,u.duration=h/t,u},y=function(e){var t,n,i,r;return t=f.decodeArray(e.firstChild.data),n=v(t),n=new Uint16Array(n.buffer),n=String.fromCharCode.apply(null,n),i=(new DOMParser).parseFromString(n,"application/xml"),r=i.querySelector("KID").textContent,r=f.decodeArray(r),b(r),r},v=function(e){var t,n,i,r=0;e[r+3],e[r+2],e[r+1],e[r],r+=4,e[r+1],e[r],r+=2;while(r<e.length)if(t=(e[r+1]<<8)+e[r],r+=2,1===t)return n=(e[r+1]<<8)+e[r],r+=2,i=new Uint8Array(n),i.set(e.subarray(r,r+n)),i;return null},b=function(e){E(e,0,3),E(e,1,2),E(e,4,5),E(e,6,7)},E=function(e,t,n){var i=e[t];e[t]=e[n],e[n]=i},_=function(e){var t,n={},i=this.system.getObject("ksPlayReady");return t={__text:e.firstChild.data,__prefix:"mspr"},n.schemeIdUri=i.schemeIdURI,n.value=i.systemString,n.pro=t,n.pro_asArray=t,n},x=function(e){var t={},n=this.system.getObject("ksWidevine");t.schemeIdUri=n.schemeIdURI,t.value=n.systemString;var i=new Uint8Array(2+e.length);i[0]=18,i[1]=16,i.set(e,2);var r=32+i.length,o=new Uint8Array(r),s=0;return o[s++]=(4278190080&r)>>24,o[s++]=(16711680&r)>>16,o[s++]=(65280&r)>>8,o[s++]=255&r,o.set([112,115,115,104,0,0,0,0],s),s+=8,o.set([237,239,139,169,121,214,74,206,163,200,39,220,213,29,33,237],s),s+=16,o[s++]=(4278190080&i.length)>>24,o[s++]=(16711680&i.length)>>16,o[s++]=(65280&i.length)>>8,o[s++]=255&i.length,o.set(i,s),o=String.fromCharCode.apply(null,o),o=f.encodeASCII(o),t.pssh={__text:o},t},T=function(e){var t=e.SegmentTemplate,n=t.SegmentTimeline.S_asArray;if(0!==n.length){var i={start:n[0].t/t.timescale,end:(n[n.length-1].t+n[n.length-1].d)/t.timescale};this.metricsModel.addDVRInfo(e.contentType,new Date,i)}},S=function(t){var n,i,r,o,u,c,h,f,p,m={},g=[],v=this.domParser.getChildNode(s,"SmoothStreamingMedia"),b=this.domParser.getChildNode(v,"Protection"),E=null;m.name="MSS",m.profiles="urn:mpeg:dash:profile:isoff-live:2011";var S=this.domParser.getAttributeValue(v,"TimeScale");m.timescale=S?parseFloat(S):e;var w=this.domParser.getAttributeValue(v,"IsLive");m.type=null!==w&&"true"===w.toLowerCase()?"dynamic":"static";var I=this.domParser.getAttributeValue(v,"CanSeek"),D=parseFloat(this.domParser.getAttributeValue(v,"DVRWindowLength"));0===D&&null!==I&&"true"===I.toLowerCase()&&(D=1/0),m.timeShiftBufferDepth=D/m.timescale;var M=parseFloat(this.domParser.getAttributeValue(v,"Duration"));if("dynamic"===m.type&&M>0&&(m.type="static",m.startOver=!0,m.timeShiftBufferDepth=M/m.timescale),m.mediaPresentationDuration=0===M?1/0:M/m.timescale,m.BaseURL=a,m.minBufferTime=d.dependencies.BufferExtensions.DEFAULT_MIN_BUFFER_TIME,"dynamic"===m.type&&m.timeShiftBufferDepth<1/0&&(m.availabilityStartTime=new Date(t.getTime()-1e3*m.timeShiftBufferDepth)),m.Period=l.call(this,m.timescale),m.Period_asArray=[m.Period],n=m.Period,n.start=0,void 0!==b){if(!d.dependencies.ProtectionController)return m.error={name:d.dependencies.ErrorHandler.prototype.MEDIA_ERR_ENCRYPTED,message:"protected content detected but protection module is not included."},m;E=this.domParser.getChildNode(b,"ProtectionHeader"),E.firstChild.data=E.firstChild.data.replace(/\n|\r/g,""),o=y(E),r=_.call(this,E),r["cenc:default_KID"]=o,g.push(r),r=x.call(this,o),r["cenc:default_KID"]=o,g.push(r),m.ContentProtection=g.length>1?g:g[0],m.ContentProtection_asArray=g}for(i=n.AdaptationSet_asArray,f=0;f<i.length;f+=1)void 0!==m.ContentProtection&&(i[f].ContentProtection=m.ContentProtection,i[f].ContentProtection_asArray=m.ContentProtection_asArray),"dynamic"===m.type&&(m.timeShiftBufferDepth===1/0&&(m.availabilityStartTime=new Date(t.getTime()-1e3*i[1].SegmentTemplate.SegmentTimeline.duration)),m.timeShiftBufferDepth>0&&m.timeShiftBufferDepth!==1/0&&"video"===i[f].contentType&&m.timeShiftBufferDepth>i[f].SegmentTemplate.SegmentTimeline.duration&&(m.timeShiftBufferDepth=i[f].SegmentTemplate.SegmentTimeline.duration),T.call(this,i[f]));if(m.timeShiftBufferDepth<m.minBufferTime&&(m.minBufferTime=m.timeShiftBufferDepth),delete m.ContentProtection,delete m.ContentProtection_asArray,"static"===m.type){var A=this.manifestModel.getValue();if(A&&A.timestampOffset)u=A.timestampOffset;else for(f=0;f<i.length;f++)"audio"!==i[f].contentType&&"video"!==i[f].contentType||(h=i[f].SegmentTemplate.SegmentTimeline.S_asArray,c=h[0].t/i[f].SegmentTemplate.timescale,void 0===u&&(u=c),u=Math.min(u,c),m.mediaPresentationDuration=Math.min(m.mediaPresentationDuration,i[f].SegmentTemplate.SegmentTimeline.duration));if(u>0){for(m.timestampOffset=u,f=0;f<i.length;f++){for(h=i[f].SegmentTemplate.SegmentTimeline.S_asArray,p=0;p<h.length;p++)h[p].tManifest||(h[p].tManifest=h[p].t),h[p].t-=u*i[f].SegmentTemplate.timescale;"audio"!==i[f].contentType&&"video"!==i[f].contentType||(n.start=Math.max(h[0].t,n.start))}n.start/=m.timescale}}return m.mediaPresentationDuration=Math.floor(1e3*m.mediaPresentationDuration)/1e3,n.duration=m.mediaPresentationDuration,m},w=function(e,n){this.debug.info("[MssParser]","Doing parse.");var i=new Date,r=null,o=null,l=null;return s=this.domParser.createXmlTree(e),r=new Date,null===s?t.reject(null):(a=n,o=S.call(this,i),o.error?t.reject(o.error):(l=new Date,this.debug.info("[MssParser]","Parsing complete (xmlParser: "+(r.getTime()-i.getTime())+"ms, mss2dash: "+(l.getTime()-r.getTime())+"ms, total: "+((new Date).getTime()-i.getTime())/1e3+"s)"),t.when(o)))};return{debug:void 0,system:void 0,errHandler:void 0,domParser:void 0,metricsModel:void 0,manifestModel:void 0,parse:w}},l.dependencies.MssParser.prototype={constructor:l.dependencies.MssParser},l.dependencies.MssHandler=function(){"use strict";var e=function(e,t){var n=1;return e.audioChannels?n=e.audioChannels:t.audioChannels&&(n=t.audioChannels),n},n=function(e,t){var n=1;return n=e.audioSamplingRate?e.audioSamplingRate:t.audioSamplingRate,n},i=function(t){var i,o,s,a,l,u=r.manifestModel.getValue();if(t.initData)return t.initData;if(i=t.adaptation,o=u.Period_asArray[i.period.index].AdaptationSet_asArray[i.index],s=o.Representation_asArray[t.index],a=new d.vo.Mp4Track,a.type=r.getType()||"und",a.trackId=i.index+1,a.timescale=t.timescale,a.duration=t.adaptation.period.duration,a.codecs=s.codecs,a.codecPrivateData=s.codecPrivateData,a.bandwidth=s.bandwidth,"text"!==a.type&&(l=s.mimeType+';codecs="'+s.codecs+'"',!this.capabilities.supportsCodec(this.videoModel.getElement(),l)))throw{name:d.dependencies.ErrorHandler.prototype.MEDIA_ERR_CODEC_UNSUPPORTED,message:"Codec is not supported (HTMLMediaElement)",data:{codec:l,bandwidth:s.bandwidth,codecPrivateData:s.codecPrivateData}};return o.ContentProtection_asArray&&o.ContentProtection_asArray.length>0&&(a.contentProtection=o.ContentProtection_asArray),a.width=s.width||o.maxWidth,a.height=s.height||o.maxHeight,a.language=o.lang?o.lang:"und",a.channels=e(o,s),a.samplingRate=n(o,s),t.initData=r.mp4Processor.generateInitSegment([a]),t.initData},r=d.utils.copyMethods(c.dependencies.DashHandler);return r.mp4Processor=void 0,r.getInitRequest=function(e){var n=null,o=this,s=null,a=null,l=t.defer();if(!e)throw new Error("MssHandler.getInitRequest(): representation is undefined");n=e.adaptation.period,s=n.start,a=new d.vo.SegmentRequest,a.streamType=r.getType(),a.type="Initialization Segment",a.url=null;try{a.data=i.call(this,e)}catch(u){return l.reject(u),l.promise}return a.range=e.range,a.availabilityStartTime=o.timelineConverter.calcAvailabilityStartTimeFromPresentationTime(s,e.adaptation.period.mpd,r.getIsDynamic()),a.availabilityEndTime=o.timelineConverter.calcAvailabilityEndTimeFromPresentationTime(s+n.duration,n.mpd,r.getIsDynamic()),a.quality=e.index,l.resolve(a),l.promise},r.getIFrameRequest=function(e){return e&&e.url&&("video"===e.streamType||"audio"===e.streamType)&&(e.url=e.url.replace("Fragments","KeyFrames")),e},r.getFragmentInfoRequest=function(e){return e&&e.url&&(e.url=e.url.replace("Fragments","FragmentInfo"),e.type="FragmentInfo Segment"),e},r},l.dependencies.MssHandler.prototype={constructor:l.dependencies.MssHandler},l.dependencies.MssFragmentController=function(){"use strict";var e=function(e,t,n,i){var o,s,a,l=this.manifestModel.getValue(),u=i.SegmentTemplate.SegmentTimeline.S_asArray,c=i.SegmentTemplate.timescale,d=t.entry,h=null,f=0,p=null,m=i.type;if((this.manifestExt.getIsDynamic(l)||this.manifestExt.getIsStartOver(l))&&0!==d.length&&(o=d[0],o.fragment_absolute_time.greaterThan(r.math.Long.fromNumber(Number.MAX_SAFE_INTEGER))&&(o.fragment_absolute_timeManifest=o.fragment_absolute_time.toString()),o.fragment_absolute_time=o.fragment_absolute_time.toNumber(),o.fragment_duration=o.fragment_duration.toNumber(),!(this.manifestExt.getIsStartOver(l)&&(s=u[0].tManifest?parseFloat(u[0].tManifest):u[0].t,o.fragment_absolute_time>s+l.timeShiftBufferDepth*c))&&(s=u[u.length-1].tManifest?parseFloat(u[u.length-1].tManifest):u[u.length-1].t,!(o.fragment_absolute_time<=s))))if(this.debug.log("[MssFragmentController]["+m+"] Add new segment - t = "+o.fragment_absolute_time/c),h={},h.t=o.fragment_absolute_time,h.d=o.fragment_duration,u[0].tManifest&&(h.t-=parseFloat(u[0].tManifest)-u[0].t),o.fragment_absolute_timeManifest?h.tManifest=o.fragment_absolute_timeManifest:u[0].tManifest&&(h.tManifest=o.fragment_absolute_time),u.push(h),this.manifestExt.getIsStartOver(l)){if("video"===m){h=u[u.length-1];var g=(h.t+h.d)/c;g>this.videoModel.getDuration()&&this.system.notify("sourceDurationChanged",g)}}else if(l.timeShiftBufferDepth&&l.timeShiftBufferDepth>0){h=u[u.length-1],f=h.t,p=f-l.timeShiftBufferDepth*c,h=u[0];while(h.t<p)this.debug.log("[MssFragmentController]["+m+"] Remove segment  - t = "+h.t/c),u.splice(0,1),h=u[0];a={start:u[0].t/i.SegmentTemplate.timescale,end:n.baseMediaDecodeTime/i.SegmentTemplate.timescale+e.duration};var y=this.metricsModel.getMetricsFor(i.type).DVRInfo;y&&y.length>0&&a.end>y[y.length-1].range.end&&this.metricsModel.addDVRInfo(i.type,new Date,a)}},n=function(t,n,i){var r,o=null,s=null,a=null,l=null,u=null;if(o=b.deserialize(t),s=o.getBoxByType("moof"),a=s.getBoxByType("traf"),l=a.getBoxByType("tfdt"),null===l&&(l=new b.boxes.TrackFragmentBaseMediaDecodeTimeBox,l.version=1,l.flags=0,l.baseMediaDecodeTime=Math.floor(n.startTime*n.timescale),r=a.getBoxIndexByType("tfhd"),a.boxes.splice(r+1,0,l)),u=a.getBoxesByType("tfrf"),null===u||0===u.length)throw{name:d.dependencies.ErrorHandler.prototype.MSS_NO_TFRF,message:"Missing tfrf in live FragmentInfo segment",data:{url:n.url}};e.call(this,n,u[0],l,i)},i=function(e,t){var n,i,r,o,s,a=null,l=null,u=null,c=null,d=null,h=null;for(a=e.getBoxByType("moof"),l=e.getBoxByType("mdat"),u=a.getBoxByType("traf"),c=u.getBoxByType("trun"),n=u.getBoxByType("tfhd"),c.samples_table[0].sample_duration||(c.samples_table[0].sample_duration=n.default_sample_duration),c.flags|=256,n.flags&=16777207,r=Math.floor(t/c.samples_table[0].sample_duration),i=0;i<r-1;i++)c.samples_table.push(c.samples_table[0]);if(c.sample_count=c.samples_table.length,o=r*c.samples_table[0].sample_duration,o<t&&(c.samples_table[c.samples_table.length-1].sample_duration+=t-o),d=u.getBoxByType("sepiff"),null!==d){for(d.sample_count>1&&(d.entry=d.entry.slice(0,1)),i=0;i<r-1;i+=1)d.entry.push(d.entry[0]);d.sample_count=d.entry.length}if(h=u.getBoxByType("saiz"),null!==h){if(0===h.default_sample_info_size)for(h.sample_count>1&&(h.sample_info_size=h.sample_info_size.slice(0,1)),i=0;i<r-1;i+=1)h.sample_info_size.push(h.sample_info_size[0]);h.sample_count=d.entry.length}for(s=l.data,l.data=new Uint8Array(s.length*c.sample_count),i=0;i<c.sample_count;i++)l.data.set(s,s.length*i)},o=function(t,n,r){var o,s,a=0,l=this.manifestModel.getValue(),u=l?this.manifestExt.getIndex(r,l)+1:-1,c=b.deserialize(t),h=null,f=null,p=null,m=null,g=null,y=null,v=null,E=null,_=null,x=null,T=-1,S=0,w=0,I=0,D=0,M=null;if(!c)return null;if(h=c.getBoxByType("moof"),f=c.getBoxByType("mdat"),p=h.getBoxByType("traf"),m=p.getBoxByType("trun"),g=p.getBoxByType("tfhd"),s=void 0!==m.samples_table[0].sample_duration?m.samples_table[0].sample_duration:g.default_sample_duration,o=n.duration*n.timescale,1===m.samples_table.length&&s<o&&i(c,o),g.track_ID=u,p.removeBoxByType("tfxd"),_=p.getBoxByType("tfdt"),null===_&&(_=new b.boxes.TrackFragmentBaseMediaDecodeTimeBox,_.version=1,_.flags=0,_.baseMediaDecodeTime=Math.floor(n.startTime*n.timescale),T=p.getBoxIndexByType("tfhd"),p.boxes.splice(T+1,0,_)),"dynamic"===l.type){if(x=p.getBoxesByType("tfrf"),null===x||0===x.length)throw{name:d.dependencies.ErrorHandler.prototype.MSS_NO_TFRF,message:"Missing tfrf in live media segment",data:{url:n.url}};e.call(this,n,x[0],_,r),p.removeBoxByType("tfrf")}if(v=p.getBoxByType("sepiff"),null!==v&&(v.boxtype="senc",v.extended_type=void 0,y=p.getBoxByType("saio"),null===y)){if(y=new b.boxes.SampleAuxiliaryInformationOffsetsBox,y.version=0,y.flags=0,y.entry_count=1,y.offset=[],E=new b.boxes.SampleAuxiliaryInformationSizesBox,E.version=0,E.flags=0,E.sample_count=v.sample_count,E.default_sample_info_size=0,E.sample_info_size=[],2&v.flags)for(a=0;a<v.sample_count;a+=1)E.sample_info_size[a]=10+6*v.entry[a].NumberOfEntries;else E.default_sample_info_size=8;p.boxes.push(E),p.boxes.push(y)}return g.flags&=16777214,g.flags|=131072,m.flags|=1,m.data_offset=0,S=c.getLength(),m.data_offset=S-f.size+8,y=p.getBoxByType("saio"),null!==y&&(w=c.getBoxOffsetByType("moof"),I=h.getBoxOffsetByType("traf"),D=p.getBoxOffsetByType("senc"),y.offset[0]=w+I+D+16),M=b.serialize(c),M},s=d.utils.copyMethods(d.dependencies.FragmentController);return s.manifestModel=void 0,s.manifestExt=void 0,s.metricsModel=void 0,s.videoModel=void 0,s.mediaSourceExt=void 0,s.process=function(e,i,r){var s=t.defer(),a=null,l=this.manifestModel.getValue(),u=null;if(!(null!==e&&void 0!==e&&e.byteLength>0))return s.resolve(null),s.promise;if(a=new Uint8Array(e),l&&r)try{u=l.Period_asArray[r.adaptation.period.index].AdaptationSet_asArray[r.adaptation.index],i&&("Media Segment"===i.type?(a=o.call(this,a,i,u),s.resolve(a||null)):"FragmentInfo Segment"===i.type?(n.call(this,a,i,u),s.resolve(a)):s.resolve(a))}catch(c){s.reject(c)}else s.resolve(a);return s.promise},s},l.dependencies.MssFragmentController.prototype={constructor:l.dependencies.MssFragmentController},l.dependencies.MssFragmentInfoController=function(){"use strict";var e,n,i,r=!1,o=!1,s=null,a=null,l=null,u=null,c=function(t,i,o){this.debug.log("[MssFragmentInfoController]["+t+"] Initialize"),n=o,e=t,s=i,a=s.attachBufferController(this),a.setType(t),r=!0},h=function(){return p.call(this),a&&(s.abortRequestsForModel(a),s.detachBufferController(a),a=null),t.when(null)},f=function(t){r&&!o&&(this.debug.info("[MssFragmentInfoController]["+e+"] START"),o=!0,l=(new Date).getTime()+1e3*t,_.call(this,t))},p=function(){o&&(this.debug.info("[MssFragmentInfoController]["+e+"] STOP"),s.abortRequestsForModel(a),clearTimeout(i),o=!1)},m=function(){if(o){var t,i=n.getData(),r=i.SegmentTemplate.SegmentTimeline.S_asArray,s=r[r.length-1],a=i.Representation_asArray[0];this.debug.log("[MssFragmentInfoController]["+e+"] Load next fragment for time: "+s.t/i.SegmentTemplate.timescale),t=g(i,a,s),y.call(this,t)}},g=function(t,n,i){var r=t.SegmentTemplate.timescale,o=new d.vo.SegmentRequest;return o.action="download",o.startTime=i.t/r,o.streamType=e,o.type="FragmentInfo Segment",o.duration=i.d/r,o.timescale=r,o.quality=n.quality,o.url=t.BaseURL+t.SegmentTemplate.media,o.url=o.url.replace("$Bandwidth$",n.bandwidth),o.url=o.url.replace("$Time$",i.tManifest?i.tManifest:i.t),o.url=o.url.replace("/Fragments(","/FragmentInfo("),o},y=function(t){s.isFragmentLoadedOrPending(this,t)?this.debug.log("[MssFragmentInfoController]["+e+"] No more fragments"):(this.debug.log("[MssFragmentInfoController]["+e+"] Request fragment info "+t.url),s.prepareFragmentForLoading(this,t,v,b,E,null),s.onBufferControllerStateChange())},v=function(t){this.debug.info("[MssFragmentInfoController]["+e+"] Load request ",null!==t.url?t.url:t.quality)},b=function(t,i){var r,o,a=this,c=n.getAvailableRepresentations()[0];this.debug.log("[MssFragmentInfoController]["+e+"] FragmentInfo loaded ",t.url),u||(u=t.startTime);try{s.process(i.data,t,c).then(function(){r=((new Date).getTime()-l)/1e3,o=t.startTime+t.duration-u,_.call(a,Math.max(0,o-r))})}catch(h){this.errHandler.sendError(d.dependencies.ErrorHandler.prototype.INTERNAL_ERROR,"Internal error while processing fragment info segment",h.message)}},E=function(e){o||this.errHandler.sendWarning(d.dependencies.ErrorHandler.prototype.DOWNLOAD_ERR_CONTENT,"Failed to download fragmentInfo segment",{url:e.url,status:e.status})},_=function(t){var n=this;this.debug.log("[MssFragmentInfoController]["+e+"] Load next fragment in "+t+" s."),clearTimeout(i),i=setTimeout(function(){i=null,m.call(n)},1e3*t)};return{debug:void 0,system:void 0,errHandler:void 0,initialize:c,reset:h,start:f,stop:p,isReady:function(){return r}}},l.dependencies.MssFragmentInfoController.prototype={constructor:l.dependencies.MssFragmentInfoController};var h={encode:function(e){for(var t=[],n=0;n<e.length;++n){var i=e.charCodeAt(n);i<128?t.push(i):i<2048?(t.push(192|i>>6),t.push(128|63&i)):i<65536?(t.push(224|i>>12),t.push(128|63&i>>6),t.push(128|63&i)):(t.push(240|i>>18),t.push(128|63&i>>12),t.push(128|63&i>>6),t.push(128|63&i))}return t},decode:function(e){var t=[],n=0;while(n<e.length){var i=e[n++];i<128||(i<224?(i=(31&i)<<6,i|=63&e[n++]):i<240?(i=(15&i)<<12,i|=(63&e[n++])<<6,i|=63&e[n++]):(i=(7&i)<<18,i|=(63&e[n++])<<12,i|=(63&e[n++])<<6,i|=63&e[n++])),t.push(String.fromCharCode(i))}return t.join("")}},f={};if(function(e){var t=function(t){var n=0,i=[],r=0|t.length/3;while(0<r--){var o=(t[n]<<16)+(t[n+1]<<8)+t[n+2];n+=3,i.push(e.charAt(63&o>>18)),i.push(e.charAt(63&o>>12)),i.push(e.charAt(63&o>>6)),i.push(e.charAt(63&o))}if(2==t.length-n){o=(t[n]<<16)+(t[n+1]<<8);i.push(e.charAt(63&o>>18)),i.push(e.charAt(63&o>>12)),i.push(e.charAt(63&o>>6)),i.push("=")}else if(1==t.length-n){o=t[n]<<16;i.push(e.charAt(63&o>>18)),i.push(e.charAt(63&o>>12)),i.push("==")}return i.join("")},n=function(){for(var t=[],n=0;n<e.length;++n)t[e.charCodeAt(n)]=n;return t["=".charCodeAt(0)]=0,t}(),i=function(e){var t=0,i=[],r=0|e.length/4;while(0<r--){var o=(n[e.charCodeAt(t)]<<18)+(n[e.charCodeAt(t+1)]<<12)+(n[e.charCodeAt(t+2)]<<6)+n[e.charCodeAt(t+3)];i.push(255&o>>16),i.push(255&o>>8),i.push(255&o),t+=4}return i&&("="==e.charAt(t-2)?(i.pop(),i.pop()):"="==e.charAt(t-1)&&i.pop()),i},r={encode:function(e){for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t},decode:function(e){for(var t=0;t<s.length;++t)a[t]=String.fromCharCode(a[t]);return a.join("")}};f.decodeArray=function(e){var t=i(e);return new Uint8Array(t)},f.encodeASCII=function(e){var n=r.encode(e);return t(n)},f.decodeASCII=function(e){var t=i(e);return r.decode(t)},f.encode=function(e){var n=h.encode(e);return t(n)},f.decode=function(e){var t=i(e);return h.decode(t)}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),void 0===p)var p=f.encode;if(void 0===m)var m=f.decode;if(function(e){"use strict";var t={VERSION:"0.5.3",System:function(){this._mappings={},this._outlets={},this._handlers={},this.strictInjections=!0,this.autoMapOutlets=!1,this.postInjectionHook="setup"}};t.System.prototype={_createAndSetupInstance:function(e,t){var n=new t;return this.injectInto(n,e),n},_retrieveFromCacheOrCreate:function(e,t){var n;if("undefined"===typeof t&&(t=!1),!this._mappings.hasOwnProperty(e))throw new Error(1e3);var i=this._mappings[e];return!t&&i.isSingleton?(null==i.object&&(i.object=this._createAndSetupInstance(e,i.clazz)),n=i.object):n=i.clazz?this._createAndSetupInstance(e,i.clazz):i.object,n},mapOutlet:function(e,t,n){if("undefined"===typeof e)throw new Error(1010);return t=t||"global",n=n||e,this._outlets.hasOwnProperty(t)||(this._outlets[t]={}),this._outlets[t][n]=e,this},getObject:function(e){if("undefined"===typeof e)throw new Error(1020);return this._retrieveFromCacheOrCreate(e)},mapValue:function(e,t){if("undefined"===typeof e)throw new Error(1030);return this._mappings[e]={clazz:null,object:t,isSingleton:!0},this.autoMapOutlets&&this.mapOutlet(e),this.hasMapping(e)&&this.injectInto(t,e),this},hasMapping:function(e){if("undefined"===typeof e)throw new Error(1040);return this._mappings.hasOwnProperty(e)},mapClass:function(e,t){if("undefined"===typeof e)throw new Error(1050);if("undefined"===typeof t)throw new Error(1051);return this._mappings[e]={clazz:t,object:null,isSingleton:!1},this.autoMapOutlets&&this.mapOutlet(e),this},mapSingleton:function(e,t){if("undefined"===typeof e)throw new Error(1060);if("undefined"===typeof t)throw new Error(1061);return this._mappings[e]={clazz:t,object:null,isSingleton:!0},this.autoMapOutlets&&this.mapOutlet(e),this},instantiate:function(e){if("undefined"===typeof e)throw new Error(1070);return this._retrieveFromCacheOrCreate(e,!0)},injectInto:function(e,t){if("undefined"===typeof e)throw new Error(1080);if("object"===typeof e){var n=[];for(var i in this._outlets.hasOwnProperty("global")&&n.push(this._outlets["global"]),"undefined"!==typeof t&&this._outlets.hasOwnProperty(t)&&n.push(this._outlets[t]),n){var r=n[i];for(var o in r){var s=r[o];(!this.strictInjections||o in e)&&(e[o]=this.getObject(s))}}"setup"in e&&e.setup.call(e)}return this},unmap:function(e){if("undefined"===typeof e)throw new Error(1090);return delete this._mappings[e],this},unmapOutlet:function(e,t){if("undefined"===typeof e)throw new Error(1100);if("undefined"===typeof t)throw new Error(1101);return delete this._outlets[e][t],this},mapHandler:function(e,t,n,i,r){if("undefined"===typeof e)throw new Error(1110);return t=t||"global",n=n||e,"undefined"===typeof i&&(i=!1),"undefined"===typeof r&&(r=!1),this._handlers.hasOwnProperty(e)||(this._handlers[e]={}),this._handlers[e].hasOwnProperty(t)||(this._handlers[e][t]=[]),this._handlers[e][t].push({handler:n,oneShot:i,passEvent:r}),this},unmapHandler:function(e,t,n){if("undefined"===typeof e)throw new Error(1120);if(t=t||"global",this._handlers.hasOwnProperty(e)&&this._handlers[e].hasOwnProperty(t)){var i=this._handlers[e][t];for(var r in i){var o=i[r];if(!n||o.handler===n){i.splice(r,1);break}}}return this},notify:function(e){if("undefined"===typeof e)throw new Error(1130);var t=Array.prototype.slice.call(arguments),n=t.slice(1);if(this._handlers.hasOwnProperty(e)){var i=this._handlers[e];for(var r in i){var o,s=i[r];"global"!==r&&(o=this.getObject(r));var a,l,u=[];for(a=0,l=s.length;a<l;a++){var c,d=s[a];c=o&&"string"===typeof d.handler?o[d.handler]:d.handler,d.oneShot&&u.unshift(a),d.passEvent?c.apply(o,t):c.apply(o,n)}for(a=0,l=u.length;a<l;a++)s.splice(u[a],1)}}return this}},e.dijon=t}(this),r={},r.math={},r.math.Long=function(e,t){this.low_=0|e,this.high_=0|t},r.math.Long.IntCache_={},r.math.Long.fromInt=function(e){if(-128<=e&&e<128){var t=r.math.Long.IntCache_[e];if(t)return t}var n=new r.math.Long(0|e,e<0?-1:0);return-128<=e&&e<128&&(r.math.Long.IntCache_[e]=n),n},r.math.Long.fromNumber=function(e){return isNaN(e)||!isFinite(e)?r.math.Long.ZERO:e<=-r.math.Long.TWO_PWR_63_DBL_?r.math.Long.MIN_VALUE:e+1>=r.math.Long.TWO_PWR_63_DBL_?r.math.Long.MAX_VALUE:e<0?r.math.Long.fromNumber(-e).negate():new r.math.Long(e%r.math.Long.TWO_PWR_32_DBL_|0,e/r.math.Long.TWO_PWR_32_DBL_|0)},r.math.Long.fromBits=function(e,t){return new r.math.Long(e,t)},r.math.Long.fromString=function(e,t){if(0==e.length)throw Error("number format error: empty string");var n=t||10;if(n<2||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return r.math.Long.fromString(e.substring(1),n).negate();if(e.indexOf("-")>=0)throw Error('number format error: interior "-" character: '+e);for(var i=r.math.Long.fromNumber(Math.pow(n,8)),o=r.math.Long.ZERO,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),l=parseInt(e.substring(s,s+a),n);if(a<8){var u=r.math.Long.fromNumber(Math.pow(n,a));o=o.multiply(u).add(r.math.Long.fromNumber(l))}else o=o.multiply(i),o=o.add(r.math.Long.fromNumber(l))}return o},r.math.Long.TWO_PWR_16_DBL_=65536,r.math.Long.TWO_PWR_24_DBL_=1<<24,r.math.Long.TWO_PWR_32_DBL_=r.math.Long.TWO_PWR_16_DBL_*r.math.Long.TWO_PWR_16_DBL_,r.math.Long.TWO_PWR_31_DBL_=r.math.Long.TWO_PWR_32_DBL_/2,r.math.Long.TWO_PWR_48_DBL_=r.math.Long.TWO_PWR_32_DBL_*r.math.Long.TWO_PWR_16_DBL_,r.math.Long.TWO_PWR_64_DBL_=r.math.Long.TWO_PWR_32_DBL_*r.math.Long.TWO_PWR_32_DBL_,r.math.Long.TWO_PWR_63_DBL_=r.math.Long.TWO_PWR_64_DBL_/2,r.math.Long.ZERO=r.math.Long.fromInt(0),r.math.Long.ONE=r.math.Long.fromInt(1),r.math.Long.NEG_ONE=r.math.Long.fromInt(-1),r.math.Long.MAX_VALUE=r.math.Long.fromBits(-1,2147483647),r.math.Long.MIN_VALUE=r.math.Long.fromBits(0,-2147483648),r.math.Long.TWO_PWR_24_=r.math.Long.fromInt(1<<24),r.math.Long.prototype.toInt=function(){return this.low_},r.math.Long.prototype.toNumber=function(){return this.high_*r.math.Long.TWO_PWR_32_DBL_+this.getLowBitsUnsigned()},r.math.Long.prototype.toString=function(e){var t=e||10;if(t<2||36<t)throw Error("radix out of range: "+t);if(this.isZero())return"0";if(this.isNegative()){if(this.equals(r.math.Long.MIN_VALUE)){var n=r.math.Long.fromNumber(t),i=this.div(n),o=i.multiply(n).subtract(this);return i.toString(t)+o.toInt().toString(t)}return"-"+this.negate().toString(t)}var s=r.math.Long.fromNumber(Math.pow(t,6)),a=(o=this,"");while(1){var l=o.div(s),u=o.subtract(l.multiply(s)).toInt(),c=u.toString(t);if(o=l,o.isZero())return c+a;while(c.length<6)c="0"+c;a=""+c+a}},r.math.Long.prototype.getHighBits=function(){return this.high_},r.math.Long.prototype.getLowBits=function(){return this.low_},r.math.Long.prototype.getLowBitsUnsigned=function(){return this.low_>=0?this.low_:r.math.Long.TWO_PWR_32_DBL_+this.low_},r.math.Long.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(r.math.Long.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var e=0!=this.high_?this.high_:this.low_,t=31;t>0;t--)if(0!=(e&1<<t))break;return 0!=this.high_?t+33:t+1},r.math.Long.prototype.isZero=function(){return 0==this.high_&&0==this.low_},r.math.Long.prototype.isNegative=function(){return this.high_<0},r.math.Long.prototype.isOdd=function(){return 1==(1&this.low_)},r.math.Long.prototype.equals=function(e){return this.high_==e.high_&&this.low_==e.low_},r.math.Long.prototype.notEquals=function(e){return this.high_!=e.high_||this.low_!=e.low_},r.math.Long.prototype.lessThan=function(e){return this.compare(e)<0},r.math.Long.prototype.lessThanOrEqual=function(e){return this.compare(e)<=0},r.math.Long.prototype.greaterThan=function(e){return this.compare(e)>0},r.math.Long.prototype.greaterThanOrEqual=function(e){return this.compare(e)>=0},r.math.Long.prototype.compare=function(e){if(this.equals(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.subtract(e).isNegative()?-1:1},r.math.Long.prototype.negate=function(){return this.equals(r.math.Long.MIN_VALUE)?r.math.Long.MIN_VALUE:this.not().add(r.math.Long.ONE)},r.math.Long.prototype.add=function(e){var t=this.high_>>>16,n=65535&this.high_,i=this.low_>>>16,o=65535&this.low_,s=e.high_>>>16,a=65535&e.high_,l=e.low_>>>16,u=65535&e.low_,c=0,d=0,h=0,f=0;return f+=o+u,h+=f>>>16,f&=65535,h+=i+l,d+=h>>>16,h&=65535,d+=n+a,c+=d>>>16,d&=65535,c+=t+s,c&=65535,r.math.Long.fromBits(h<<16|f,c<<16|d)},r.math.Long.prototype.subtract=function(e){return this.add(e.negate())},r.math.Long.prototype.multiply=function(e){if(this.isZero())return r.math.Long.ZERO;if(e.isZero())return r.math.Long.ZERO;if(this.equals(r.math.Long.MIN_VALUE))return e.isOdd()?r.math.Long.MIN_VALUE:r.math.Long.ZERO;if(e.equals(r.math.Long.MIN_VALUE))return this.isOdd()?r.math.Long.MIN_VALUE:r.math.Long.ZERO;if(this.isNegative())return e.isNegative()?this.negate().multiply(e.negate()):this.negate().multiply(e).negate();if(e.isNegative())return this.multiply(e.negate()).negate();if(this.lessThan(r.math.Long.TWO_PWR_24_)&&e.lessThan(r.math.Long.TWO_PWR_24_))return r.math.Long.fromNumber(this.toNumber()*e.toNumber());var t=this.high_>>>16,n=65535&this.high_,i=this.low_>>>16,o=65535&this.low_,s=e.high_>>>16,a=65535&e.high_,l=e.low_>>>16,u=65535&e.low_,c=0,d=0,h=0,f=0;return f+=o*u,h+=f>>>16,f&=65535,h+=i*u,d+=h>>>16,h&=65535,h+=o*l,d+=h>>>16,h&=65535,d+=n*u,c+=d>>>16,d&=65535,d+=i*l,c+=d>>>16,d&=65535,d+=o*a,c+=d>>>16,d&=65535,c+=t*u+n*l+i*a+o*s,c&=65535,r.math.Long.fromBits(h<<16|f,c<<16|d)},r.math.Long.prototype.div=function(e){if(e.isZero())throw Error("division by zero");if(this.isZero())return r.math.Long.ZERO;if(this.equals(r.math.Long.MIN_VALUE)){if(e.equals(r.math.Long.ONE)||e.equals(r.math.Long.NEG_ONE))return r.math.Long.MIN_VALUE;if(e.equals(r.math.Long.MIN_VALUE))return r.math.Long.ONE;var t=this.shiftRight(1),n=t.div(e).shiftLeft(1);if(n.equals(r.math.Long.ZERO))return e.isNegative()?r.math.Long.ONE:r.math.Long.NEG_ONE;var i=this.subtract(e.multiply(n)),o=n.add(i.div(e));return o}if(e.equals(r.math.Long.MIN_VALUE))return r.math.Long.ZERO;if(this.isNegative())return e.isNegative()?this.negate().div(e.negate()):this.negate().div(e).negate();if(e.isNegative())return this.div(e.negate()).negate();var s=r.math.Long.ZERO;i=this;while(i.greaterThanOrEqual(e)){n=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));var a=Math.ceil(Math.log(n)/Math.LN2),l=a<=48?1:Math.pow(2,a-48),u=r.math.Long.fromNumber(n),c=u.multiply(e);while(c.isNegative()||c.greaterThan(i))n-=l,u=r.math.Long.fromNumber(n),c=u.multiply(e);u.isZero()&&(u=r.math.Long.ONE),s=s.add(u),i=i.subtract(c)}return s},r.math.Long.prototype.modulo=function(e){return this.subtract(this.div(e).multiply(e))},r.math.Long.prototype.not=function(){return r.math.Long.fromBits(~this.low_,~this.high_)},r.math.Long.prototype.and=function(e){return r.math.Long.fromBits(this.low_&e.low_,this.high_&e.high_)},r.math.Long.prototype.or=function(e){return r.math.Long.fromBits(this.low_|e.low_,this.high_|e.high_)},r.math.Long.prototype.xor=function(e){return r.math.Long.fromBits(this.low_^e.low_,this.high_^e.high_)},r.math.Long.prototype.shiftLeft=function(e){if(e&=63,0==e)return this;var t=this.low_;if(e<32){var n=this.high_;return r.math.Long.fromBits(t<<e,n<<e|t>>>32-e)}return r.math.Long.fromBits(0,t<<e-32)},r.math.Long.prototype.shiftRight=function(e){if(e&=63,0==e)return this;var t=this.high_;if(e<32){var n=this.low_;return r.math.Long.fromBits(n>>>e|t<<32-e,t>>e)}return r.math.Long.fromBits(t>>e-32,t>=0?0:-1)},r.math.Long.prototype.shiftRightUnsigned=function(e){if(e&=63,0==e)return this;var t=this.high_;if(e<32){var n=this.low_;return r.math.Long.fromBits(n>>>e|t<<32-e,t>>>e)}return 32==e?r.math.Long.fromBits(t,0):r.math.Long.fromBits(t>>>e-32,0)},"undefined"==typeof g)var g={};function y(e){var t;for(t=[],i=0,len=e.length;i<len;i+=1)e[i].isRoot?t.push("root"):t.push(e[i].name);var n=function(e,t){var n;if(null!==e&&null!==t)for(n in e)e.hasOwnProperty(n)&&(t.hasOwnProperty(n)||(t[n]=e[n]))},r=function(e,t,i){var r,o,s,a,l;if(null!==e&&0!==e.length)for(r=0,o=e.length;r<o;r+=1)s=e[r],t.hasOwnProperty(s.name)&&(i.hasOwnProperty(s.name)?s.merge&&(a=t[s.name],l=i[s.name],"object"===typeof a&&"object"===typeof l?n(a,l):null!=s.mergeFunction?i[s.name]=s.mergeFunction(a,l):i[s.name]=a+l):i[s.name]=t[s.name])},o=function(e,t){var n,i,s,a,l,u,c,d=e;if(null!==d.children&&0!==d.children.length)for(n=0,i=d.children.length;n<i;n+=1)if(u=d.children[n],t.hasOwnProperty(u.name))if(u.isArray)for(l=t[u.name+"_asArray"],s=0,a=l.length;s<a;s+=1)c=l[s],r(d.properties,t,c),o(u,c);else c=t[u.name],r(d.properties,t,c),o(u,c)},s=function(n){var i,r,a,l,u,c,d;if(null===n)return n;if("object"!==typeof n)return n;for(i=0,r=t.length;i<r;i+=1)"root"===t[i]&&(u=e[i],c=n,o(u,c));for(l in n)if(n.hasOwnProperty(l)){if(a=t.indexOf(l),-1!==a)if(u=e[a],u.isArray)for(d=n[l+"_asArray"],i=0,r=d.length;i<r;i+=1)c=d[i],o(u,c);else c=n[l],o(u,c);s(n[l])}return n};return{run:s}}
/*!
 *
 * Copyright 2009-2012 Kris Kowal under the terms of the MIT
 * license found at http://github.com/kriskowal/q/raw/master/LICENSE
 *
 * With parts by Tyler Close
 * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found
 * at http://www.opensource.org/licenses/mit-license.html
 * Forked at ref_send.js version: 2009-05-11
 *
 * With parts by Mark Miller
 * Copyright (C) 2011 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */function v(e,t,n){null!==t&&void 0!==t||(t="_"),null!==n&&void 0!==n||(n=!1);var i="1.0.11",r=!1,o={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};function s(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function a(e){return e.prefix}function l(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):e}function u(e){return e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/")}function c(i){if(i.nodeType==o.DOCUMENT_NODE){var l,d,h=i.firstChild;for(l=0,d=i.childNodes.length;l<d;l+=1)if(i.childNodes[l].nodeType!==o.COMMENT_NODE){h=i.childNodes[l];break}if(n)p=c(h);else{p={};var f=s(h);p[f]=c(h)}return p}if(i.nodeType==o.ELEMENT_NODE){var p=new Object;p.__cnt=0;for(var m=i.childNodes,g=0;g<m.length;g++){h=m.item(g),f=s(h);if(p.__cnt++,null==p[f])p[f]=c(h),p[f+"_asArray"]=new Array(1),p[f+"_asArray"][0]=p[f];else{if(null!=p[f]&&!(p[f]instanceof Array)){var y=p[f];p[f]=new Array,p[f][0]=y,p[f+"_asArray"]=p[f]}var v=0;while(null!=p[f][v])v++;p[f][v]=c(h)}}for(var b=0;b<i.attributes.length;b++){var E=i.attributes.item(b);p.__cnt++;for(var _=E.value,x=0,T=e.length;x<T;x++){var S=e[x];S.test.call(this,E.value)&&(_=S.converter.call(this,E.value))}p[t+E.name]=_}var w=a(i);return null!=w&&""!=w&&(p.__cnt++,p.__prefix=w),1==p.__cnt&&null!=p["#text"]&&(p=p["#text"]),null!=p["#text"]&&(p.__text=p["#text"],r&&(p.__text=u(p.__text)),delete p["#text"],delete p["#text_asArray"]),null!=p["#cdata-section"]&&(p.__cdata=p["#cdata-section"],delete p["#cdata-section"],delete p["#cdata-section_asArray"]),null==p.__text&&null==p.__cdata||(p.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),p}return i.nodeType==o.TEXT_NODE||i.nodeType==o.CDATA_SECTION_NODE?i.nodeValue:i.nodeType==o.COMMENT_NODE?null:void 0}function d(e,t,n,i){var r="<"+(null!=e&&null!=e.__prefix?e.__prefix+":":"")+t;if(null!=n)for(var o=0;o<n.length;o++){var s=n[o],a=e[s];r+=" "+s.substr(1)+"='"+a+"'"}return r+=i?"/>":">",r}function h(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function f(e,t){return-1!==e.indexOf(t,e.length-t.length)}function p(e,t){return!!(f(t.toString(),"_asArray")||0==t.toString().indexOf("_")||e[t]instanceof Function)}function m(e){var t=0;if(e instanceof Object)for(var n in e)p(e,n)||t++;return t}function g(e){var t=[];if(e instanceof Object)for(var n in e)-1==n.toString().indexOf("__")&&0==n.toString().indexOf("_")&&t.push(n);return t}function y(e){var t="";return null!=e.__cdata&&(t+="<![CDATA["+e.__cdata+"]]>"),null!=e.__text&&(t+=r?l(e.__text):e.__text),t}function v(e){var t="";return e instanceof Object?t+=y(e):null!=e&&(t+=r?l(e):e),t}function b(e,t,n){var i="";if(0==e.length)i+=d(e,t,n,!0);else for(var r=0;r<e.length;r++)i+=d(e[r],t,g(e[r]),!1),i+=E(e[r]),i+=h(e[r],t);return i}function E(e){var t="",n=m(e);if(n>0)for(var i in e)if(!p(e,i)){var r=e[i],o=g(r);if(null==r||void 0==r)t+=d(r,i,o,!0);else if(r instanceof Object)if(r instanceof Array)t+=b(r,i,o);else{var s=m(r);s>0||null!=r.__text||null!=r.__cdata?(t+=d(r,i,o,!1),t+=E(r),t+=h(r,i)):t+=d(r,i,o,!0)}else t+=d(r,i,o,!1),t+=v(r),t+=h(r,i)}return t+=v(e),t}this.parseXmlString=function(e){var t;if(window.DOMParser)try{var n=new window.DOMParser;if(t=n.parseFromString(e,"text/xml"),t.getElementsByTagName("parsererror").length>0)throw new Error("Error parsing XML")}catch(i){return null}return t},this.xml2json=function(e){return c(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null===t?t:this.xml2json(t)},this.json2xml_str=function(e){return E(e)},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return i},this.escapeMode=function(e){r=e}}"undefined"==typeof g.Math&&(g.Math={}),g.Math.to64BitNumber=function(e,t){var n,i,o;return n=new r.math.Long(0,t),i=new r.math.Long(e,0),o=n.add(i),o.toNumber()},
/*!
 *
 * Copyright 2009-2012 Kris Kowal under the terms of the MIT
 * license found at http://github.com/kriskowal/q/raw/master/LICENSE
 *
 * With parts by Tyler Close
 * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found
 * at http://www.opensource.org/licenses/mit-license.html
 * Forked at ref_send.js version: 2009-05-11
 *
 * With parts by Mark Miller
 * Copyright (C) 2011 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
function(e){t=e()}(function(){"use strict";var e,t,i=_(),r=function(){};function o(e){var t=Function.call;return function(){return t.apply(e,arguments)}}"undefined"!==typeof n?t=n.nextTick:"function"===typeof setImmediate?t="undefined"!==typeof window?setImmediate.bind(window):setImmediate:function(){var e,n={task:void 0,next:null},i=n,r=2,o=0,s=0,a=0;function l(){if(--o,++a>=r){a=0,r*=4;var t=s&&Math.min(s-1,r);while(o<t)++o,e()}while(s){--s,n=n.next;var i=n.task;n.task=void 0,i()}a=0}if(t=function(t){i=i.next={task:t,next:null},o<++s&&o<r&&(++o,e())},"undefined"!==typeof MessageChannel){var u=new MessageChannel;u.port1.onmessage=l,e=function(){u.port2.postMessage(0)}}else e=function(){setTimeout(l,0)}}();var s,a=o(Array.prototype.slice),l=o(Array.prototype.reduce||function(e,t){var n=0,i=this.length;if(1===arguments.length)do{if(n in this){t=this[n++];break}if(++n>=i)throw new TypeError}while(1);for(;n<i;n++)n in this&&(t=e(t,this[n],n));return t}),u=o(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),c=o(Array.prototype.map||function(e,t){var n=this,i=[];return l(n,function(r,o,s){i.push(e.call(t,o,s,n))},void 0),i}),d=Object.create||function(e){function t(){}return t.prototype=e,new t},h=o(Object.prototype.hasOwnProperty),f=Object.keys||function(e){var t=[];for(var n in e)h(e,n)&&t.push(n);return t},p=o(Object.prototype.toString);function m(e){return"[object StopIteration]"===p(e)||e instanceof s}s="undefined"!==typeof ReturnValue?ReturnValue:function(e){this.value=e},x.longStackJumpLimit=1;var g="From previous event:";function y(e,t){t.stack&&"object"===typeof e&&null!==e&&e.stack&&-1===e.stack.indexOf(g)&&(e.stack=v(e.stack)+"\n"+g+"\n"+v(t.stack))}function v(e){for(var t=e.split("\n"),n=[],i=0;i<t.length;++i){var r=t[i];E(r)||b(r)||n.push(r)}return n.join("\n")}function b(e){return-1!==e.indexOf("(module.js:")||-1!==e.indexOf("(node.js:")}function E(t){var n=/at .+ \((.*):(\d+):\d+\)/.exec(t);if(!n)return!1;var r=n[1],o=n[2];return r===e&&o>=i&&o<=he}function _(){if(Error.captureStackTrace){var t,n,i=Error.prepareStackTrace;return Error.prepareStackTrace=function(e,i){t=i[1].getFileName(),n=i[1].getLineNumber()},(new Error).stack,Error.prepareStackTrace=i,e=t,n}}function x(e){return F(e)}function T(){var e,n=[],i=[],r=d(T.prototype),o=d(w.prototype);function s(r){n&&(e=F(r),l(n,function(n,i){t(function(){e.promiseDispatch.apply(e,i)})},void 0),n=void 0,i=void 0)}return o.promiseDispatch=function(r,o,s){var l=a(arguments);n?(n.push(l),"when"===o&&s[1]&&i.push(s[1])):t(function(){e.promiseDispatch.apply(e,l)})},o.valueOf=function(){return n?o:(e=I(e),e)},Error.captureStackTrace&&x.longStackJumpLimit>0&&(Error.captureStackTrace(o,T),o.stack=o.stack.substring(o.stack.indexOf("\n")+1)),r.promise=o,r.resolve=s,r.fulfill=function(e){s(B(e))},r.reject=function(e){s(N(e))},r.notify=function(e){n&&l(i,function(n,i){t(function(){i(e)})},void 0)},r}function S(e){var t=T();return G(e,t.resolve,t.reject,t.notify).fail(t.reject),t.promise}function w(e,t,n,i,r){void 0===t&&(t=function(e){return N(new Error("Promise does not support operation: "+e))});var o=d(w.prototype);return o.promiseDispatch=function(n,r,s){var a;try{a=e[r]?e[r].apply(o,s):t.call(o,r,s)}catch(i){a=N(i)}n&&n(a)},n&&(o.valueOf=n),r&&(o.exception=i),o}function I(e){return D(e)?e.valueOf():e}function D(e){return e&&"function"===typeof e.promiseDispatch}function M(e){return e&&"function"===typeof e.then}function A(e){return!L(e)&&!R(e)}function L(e){return!M(I(e))}function R(e){return e=I(e),D(e)&&"exception"in e}x.nextTick=t,x.defer=T,T.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):arguments.length>2?e.resolve(a(arguments,1)):e.resolve(n)}},x.promise=S,x.makePromise=w,w.prototype.then=function(e,t,n){return U(this,e,t,n)},w.prototype.thenResolve=function(e){return U(this,function(){return e})},l(["isFulfilled","isRejected","isPending","dispatch","when","spread","get","put","set","del","delete","post","send","invoke","keys","fapply","fcall","fbind","all","allResolved","timeout","delay","catch","finally","fail","fin","progress","done","nfcall","nfapply","nfbind","denodeify","nbind","ncall","napply","nbind","npost","nsend","ninvoke","nodeify"],function(e,t){w.prototype[t]=function(){return x[t].apply(x,[this].concat(a(arguments)))}},void 0),w.prototype.toSource=function(){return this.toString()},w.prototype.toString=function(){return"[object Promise]"},x.nearer=I,x.isPromise=D,x.isPromiseAlike=M,x.isPending=A,x.isFulfilled=L,x.isRejected=R;var P=[],C=[];function N(e){var t=w({when:function(t){if(t){var n=u(P,this);-1!==n&&(C.splice(n,1),P.splice(n,1))}return t?t(e):this}},function(){return N(e)},function(){return this},e,!0);return P.push(t),C.push(e),t}function B(e){return w({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},delete:function(t){delete e[t]},post:function(t,n){return null==t?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return f(e)}},void 0,function(){return e})}function F(e){return D(e)?e:(e=I(e),M(e)?k(e):B(e))}function k(e){var n=T();return t(function(){try{e.then(n.resolve,n.reject,n.notify)}catch(t){n.reject(t)}}),n.promise}function O(e){return w({isDef:function(){}},function(t,n){return q(e,t,n)},function(){return I(e)})}function U(e,n,i,r){var o=T(),s=!1;function a(e){try{return"function"===typeof n?n(e):e}catch(t){return N(t)}}function l(e){if("function"===typeof i){y(e,c);try{return i(e)}catch(t){return N(t)}}return N(e)}function u(e){return"function"===typeof r?r(e):e}var c=F(e);return t(function(){c.promiseDispatch(function(e){s||(s=!0,o.resolve(a(e)))},"when",[function(e){s||(s=!0,o.resolve(l(e)))}])}),c.promiseDispatch(void 0,"when",[void 0,function(e){var t,n=!1;try{t=u(e)}catch(i){if(n=!0,!x.onerror)throw i;x.onerror(i)}n||o.notify(t)}]),o.promise}function H(e,t,n){return U(e,function(e){return Q(e).then(function(e){return t.apply(void 0,e)},n)},n)}function j(e){return function(){function t(e,t){var o;try{o=n[e](t)}catch(s){return m(s)?s.value:N(s)}return U(o,i,r)}var n=e.apply(this,arguments),i=t.bind(t,"send"),r=t.bind(t,"throw");return i()}}function V(e){throw new s(e)}function K(e){return function(){return H([this,Q(arguments)],function(t,n){return e.apply(t,n)})}}function q(e,n,i){var r=T();return t(function(){F(e).promiseDispatch(r.resolve,n,i)}),r.promise}function z(e){return function(t){var n=a(arguments,1);return q(t,e,n)}}"undefined"!==typeof n&&n.on&&n.on("exit",function(){for(var e=0;e<C.length;e++){var t=C[e];t&&"undefined"!==typeof t.stack?console.warn("Unhandled rejected promise:",t.stack):console.warn("Unhandled rejected promise (no stack):",t)}}),x.reject=N,x.fulfill=B,x.resolve=F,x.master=O,x.when=U,x.spread=H,x.async=j,x["return"]=V,x.promised=K,x.dispatch=q,x.dispatcher=z,x.get=z("get"),x.set=z("set"),x["delete"]=x.del=z("delete");var Y=x.post=z("post");function $(e,t){var n=a(arguments,2);return Y(e,t,n)}function W(e,t){return q(e,"apply",[void 0,t])}function G(e){var t=a(arguments,1);return W(e,t)}function X(e){var t=a(arguments,1);return function(){var n=t.concat(a(arguments));return q(e,"apply",[this,n])}}function Q(e){return U(e,function(e){var t=e.length;if(0===t)return F(e);var n=T();return l(e,function(i,r,o){L(r)?(e[o]=I(r),0===--t&&n.resolve(e)):U(r,function(i){e[o]=i,0===--t&&n.resolve(e)}).fail(n.reject)},void 0),n.promise})}function J(e){return U(e,function(e){return e=c(e,F),U(Q(c(e,function(e){return U(e,r,r)})),function(){return e})})}function Z(e,t){return U(e,void 0,t)}function ee(e,t){return U(e,void 0,void 0,t)}function te(e,t){return U(e,function(e){return U(t(),function(){return e})},function(e){return U(t(),function(){return N(e)})})}function ne(e,i,r,o){var s=function(n){t(function(){if(y(n,e),!x.onerror)throw n;x.onerror(n)})},a=i||r||o?U(e,i,r,o):e;"object"===typeof n&&n&&n.domain&&(s=n.domain.bind(s)),Z(a,s)}function ie(e,t){var n=T(),i=setTimeout(function(){n.reject(new Error("Timed out after "+t+" ms"))},t);return U(e,function(e){clearTimeout(i),n.resolve(e)},function(e){clearTimeout(i),n.reject(e)}),n.promise}function re(e,t){void 0===t&&(t=e,e=void 0);var n=T();return setTimeout(function(){n.resolve(e)},t),n.promise}function oe(e,t){var n=a(t),i=T();return n.push(i.makeNodeResolver()),W(e,n).fail(i.reject),i.promise}function se(e){var t=a(arguments,1),n=T();return t.push(n.makeNodeResolver()),W(e,t).fail(n.reject),n.promise}function ae(e){var t=a(arguments,1);return function(){var n=t.concat(a(arguments)),i=T();return n.push(i.makeNodeResolver()),W(e,n).fail(i.reject),i.promise}}function le(e){var t=a(arguments,1);return function(){var n=t.concat(a(arguments)),i=T();n.push(i.makeNodeResolver());var r=this;function o(){return e.apply(r,arguments)}return W(o,n).fail(i.reject),i.promise}}function ue(e,t,n){var i=a(n||[]),r=T();return i.push(r.makeNodeResolver()),Y(e,t,i).fail(r.reject),r.promise}function ce(e,t){var n=a(arguments,2),i=T();return n.push(i.makeNodeResolver()),Y(e,t,n).fail(i.reject),i.promise}function de(e,n){if(!n)return e;e.then(function(e){t(function(){n(null,e)})},function(e){t(function(){n(e)})})}x.send=$,x.invoke=$,x.fapply=W,x["try"]=G,x.fcall=G,x.fbind=X,x.keys=z("keys"),x.all=Q,x.allResolved=J,x["catch"]=x.fail=Z,x.progress=ee,x["finally"]=x.fin=te,x.done=ne,x.timeout=ie,x.delay=re,x.nfapply=oe,x.nfcall=se,x.nfbind=ae,x.denodeify=x.nfbind,x.nbind=le,x.npost=ue,x.nsend=ce,x.ninvoke=x.nsend,x.nodeify=de;var he=_();return x});var b=function(){var e={boxes:{},fields:{},debug:!1,warningHandler:function(e){}},t={};return e.registerTypeBoxes=function(){t["moov"]=e.boxes.MovieBox,t["moof"]=e.boxes.MovieFragmentBox,t["ftyp"]=e.boxes.FileTypeBox,t["mfhd"]=e.boxes.MovieFragmentHeaderBox,t["mfra"]=e.boxes.MovieFragmentRandomAccessBox,t["udta"]=e.boxes.UserDataBox,t["trak"]=e.boxes.TrackBox,t["edts"]=e.boxes.EditBox,t["mdia"]=e.boxes.MediaBox,t["minf"]=e.boxes.MediaInformationBox,t["dinf"]=e.boxes.DataInformationBox,t["stbl"]=e.boxes.SampleTableBox,t["mvex"]=e.boxes.MovieExtendsBox,t["traf"]=e.boxes.TrackFragmentBox,t["meta"]=e.boxes.MetaBox,t["mvhd"]=e.boxes.MovieHeaderBox,t["mdat"]=e.boxes.MediaDataBox,t["free"]=e.boxes.FreeSpaceBox,t["sidx"]=e.boxes.SegmentIndexBox,t["tkhd"]=e.boxes.TrackHeaderBox,t["mdhd"]=e.boxes.MediaHeaderBox,t["mehd"]=e.boxes.MovieExtendsHeaderBox,t["hdlr"]=e.boxes.HandlerBox,t["stts"]=e.boxes.TimeToSampleBox,t["stsc"]=e.boxes.SampleToChunkBox,t["stco"]=e.boxes.ChunkOffsetBox,t["trex"]=e.boxes.TrackExtendsBox,t["vmhd"]=e.boxes.VideoMediaHeaderBox,t["smhd"]=e.boxes.SoundMediaHeaderBox,t["dref"]=e.boxes.DataReferenceBox,t["url "]=e.boxes.DataEntryUrlBox,t["urn "]=e.boxes.DataEntryUrnBox,t["tfhd"]=e.boxes.TrackFragmentHeaderBox,t["tfdt"]=e.boxes.TrackFragmentBaseMediaDecodeTimeBox,t["trun"]=e.boxes.TrackFragmentRunBox,t["stsd"]=e.boxes.SampleDescriptionBox,t["sdtp"]=e.boxes.SampleDependencyTableBox,t["avc1"]=e.boxes.AVC1VisualSampleEntryBox,t["encv"]=e.boxes.EncryptedVideoBox,t["avcC"]=e.boxes.AVCConfigurationBox,t["pasp"]=e.boxes.PixelAspectRatioBox,t["mp4a"]=e.boxes.MP4AudioSampleEntryBox,t["enca"]=e.boxes.EncryptedAudioBox,t["esds"]=e.boxes.ESDBox,t["stsz"]=e.boxes.SampleSizeBox,t["pssh"]=e.boxes.ProtectionSystemSpecificHeaderBox,t["senc"]=e.boxes.SampleEncryptionBox,t["saiz"]=e.boxes.SampleAuxiliaryInformationSizesBox,t["saio"]=e.boxes.SampleAuxiliaryInformationOffsetsBox,t["sinf"]=e.boxes.ProtectionSchemeInformationBox,t["schi"]=e.boxes.SchemeInformationBox,t["tenc"]=e.boxes.TrackEncryptionBox,t["schm"]=e.boxes.SchemeTypeBox,t["elst"]=e.boxes.EditListBox,t["hmhd"]=e.boxes.HintMediaHeaderBox,t["nmhd"]=e.boxes.NullMediaHeaderBox,t["ctts"]=e.boxes.CompositionOffsetBox,t["cslg"]=e.boxes.CompositionToDecodeBox,t["stss"]=e.boxes.SyncSampleBox,t["tref"]=e.boxes.TrackReferenceBox,t["frma"]=e.boxes.OriginalFormatBox,t["subs"]=e.boxes.SubSampleInformationBox,t[JSON.stringify([109,29,155,5,66,213,68,230,128,226,20,29,175,247,87,178])]=e.boxes.TfxdBox,t[JSON.stringify([212,128,126,242,202,57,70,149,142,84,38,203,158,70,167,159])]=e.boxes.TfrfBox,t[JSON.stringify([208,138,79,24,16,243,74,130,182,200,50,216,171,161,131,211])]=e.boxes.PiffProtectionSystemSpecificHeaderBox,t[JSON.stringify([137,116,219,206,123,231,76,81,132,249,113,72,249,136,37,84])]=e.boxes.PiffTrackEncryptionBox,t[JSON.stringify([162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244])]=e.boxes.PiffSampleEncryptionBox},e.constructorTypeBox=function(e){var t,n;return t=Object.create(e.prototype),n=Array.prototype.slice.call(arguments,1),e.apply(t,n),t},e.searchBox=function(n,i){var r;return r=i?t[i]:t[n],r||(r=e.boxes.UnknownBox),r},e.createBox=function(t,n,i){return e.constructorTypeBox.apply(null,[e.searchBox(t,i),n])},e.deserialize=function(t){var n=new e.boxes.File;try{n.read(t)}catch(i){return e.warningHandler(i.message),null}return n},e.serialize=function(e){var t=e.getLength(),n=new Uint8Array(t);return e.write(n),n},e.ParseException=function(e){this.message=e,this.name="ParseException"},e.DataIntegrityException=function(e){this.message=e,this.name="DataIntegrityException"},e}();"undefined"!==typeof e.exports?e.exports=b:window.mp4lib=b,b.fields.readBytes=function(e,t,n){var i=0,r=0;for(r=0;r<n;r++)i<<=8,i+=e[t],t++;return i},b.fields.writeBytes=function(e,t,n,i){var r=0;for(r=0;r<n;r++)e[t+n-r-1]=255&i,i>>=8},b.fields.readString=function(e,t,n){var i,r="";for(i=t;i<t+n;i++)r+=String.fromCharCode(e[i]);return r},b.fields.NumberField=function(e,t){this.bits=e,this.signed=t},b.fields.NumberField.prototype.read=function(e,t){return b.fields.readBytes(e,t,this.bits/8)},b.fields.NumberField.prototype.write=function(e,t,n){b.fields.writeBytes(e,t,this.bits/8,n)},b.fields.NumberField.prototype.getLength=function(){return this.bits/8},b.fields.LongNumberField=function(){},b.fields.LongNumberField.prototype.read=function(e,t){var n=b.fields.readBytes(e,t,4),i=b.fields.readBytes(e,t+4,4);return r.math.Long.fromBits(i,n)},b.fields.LongNumberField.prototype.write=function(e,t,n){var i="function"===typeof n.getLowBits?n:r.math.Long.fromNumber(n),o=i.getLowBits(),s=i.getHighBits();b.fields.writeBytes(e,t,4,s),b.fields.writeBytes(e,t+4,4,o)},b.fields.LongNumberField.prototype.getLength=function(){return 8},b.fields.FixedLenStringField=function(e){this.size=e},b.fields.FixedLenStringField.prototype.read=function(e,t){var n="",i=0;for(i=0;i<this.size;i++)n+=String.fromCharCode(e[t+i]);return n},b.fields.FixedLenStringField.prototype.write=function(e,t,n){var i=0;for(i=0;i<this.size;i++)e[t+i]=n.charCodeAt(i)},b.fields.FixedLenStringField.prototype.getLength=function(){return this.size},b.fields.BoxTypeField=function(){},b.fields.BoxTypeField.prototype.read=function(e,t){var n="",i=0;for(i=0;i<4;i++)n+=String.fromCharCode(e[t+i]);return n},b.fields.BoxTypeField.prototype.write=function(e,t,n){var i=0;for(i=0;i<4;i++)e[t+i]=n.charCodeAt(i)},b.fields.BoxTypeField.prototype.getLength=function(){return 4},b.fields.StringField=function(){},b.fields.StringField.prototype.read=function(e,t,n){var i="",r=0;for(r=t;r<n;r++)if(i+=String.fromCharCode(e[r]),0===e[r])return i;if(n-t<255&&e[0]==String.fromCharCode(n-t))return i=i.substr(1,n-t),b.warningHandler('null-terminated string expected, but found a string "'+i+'", which seems to be length-prefixed instead. Conversion done.'),i;throw new b.ParseException('expected null-terminated string, but end of field reached without termination. Read so far:"'+i+'"')},b.fields.StringField.prototype.write=function(e,t,n){var i=0;for(i=0;i<n.length;i++)e[t+i]=n.charCodeAt(i);e[t+n.length]=0},b.fields.StringField.prototype.getLength=function(e){return e.length},b.fields.ArrayField=function(e,t){this.innerField=e,this.size=t},b.fields.ArrayField.prototype.read=function(e,t){var n=-1,i=[],r=0;for(r=0;r<this.size;r++)i.push(this.innerField.read(e,t)),-1==n&&(n=this.innerField.getLength(i[r])),t+=n;return i},b.fields.FIELD_INT8=new b.fields.NumberField(8,!0),b.fields.FIELD_INT16=new b.fields.NumberField(16,!0),b.fields.FIELD_INT32=new b.fields.NumberField(32,!0),b.fields.FIELD_INT64=new b.fields.LongNumberField,b.fields.FIELD_UINT8=new b.fields.NumberField(8,!1),b.fields.FIELD_UINT16=new b.fields.NumberField(16,!1),b.fields.FIELD_UINT32=new b.fields.NumberField(32,!1),b.fields.FIELD_UINT64=new b.fields.LongNumberField,b.fields.FIELD_BIT8=new b.fields.NumberField(8,!1),b.fields.FIELD_BIT16=new b.fields.NumberField(16,!1),b.fields.FIELD_BIT24=new b.fields.NumberField(24,!1),b.fields.FIELD_BIT32=new b.fields.NumberField(32,!1),b.fields.FIELD_ID=new b.fields.BoxTypeField(4),b.fields.FIELD_STRING=new b.fields.StringField,b.boxes.File=function(){this.boxes=[]},b.boxes.File.prototype.getBoxByType=function(e){var t=0;for(t=0;t<this.boxes.length;t++)if(this.boxes[t].boxtype===e)return this.boxes[t];return null},b.boxes.File.prototype.getLength=function(){var e=0,t=0;for(t=0;t<this.boxes.length;t++)this.boxes[t].computeLength(),e+=this.boxes[t].size;return e},b.boxes.File.prototype.write=function(e){var t=0,n=0;for(n=0;n<this.boxes.length;n++)t=this.boxes[n].write(e,t)},b.boxes.File.prototype.read=function(e){var t,n=0,i=null,r=0,o=null,s=0,a=e.length;while(s<a)if(n=b.fields.FIELD_UINT32.read(e,s),i=b.fields.readString(e,s+4,4),"uuid"==i&&(r=1==n?16:8,o=new b.fields.ArrayField(b.fields.FIELD_INT8,16).read(e,s+r,s+r+16),o=JSON.stringify(o)),t=b.createBox(i,n,o),"uuid"===i?(s=t.read(e,s+16*b.fields.FIELD_INT8.getLength()+8,s+n),o=null):s=t.read(e,s+8,s+n),b.debug&&(t.__sourceBuffer=e.subarray(s-t.size,s)),t.boxtype&&this.boxes.push(t),t.size<=0||null===t.size)throw new b.ParseException("Problem on size of box "+t.boxtype+", parsing stopped to avoid infinite loop")},b.boxes.File.prototype.getBoxOffsetByType=function(e){var t=0,n=0;for(n=0;n<this.boxes.length;n++){if(this.boxes[n].boxtype===e)return t;t+=this.boxes[n].size}return-1},b.boxes.File.prototype.getBoxIndexByType=function(e){var t=0,n=0;for(n=0;n<this.boxes.length;n++){if(this.boxes[n].boxtype===e)return t;t++}return-1},b.boxes.Box=function(e,t,n,i){this.size=t||null,this.boxtype=e,1===this.size&&i&&(this.largesize=i),n&&(this.extended_type=n),this.localPos=0,this.localEnd=0},b.boxes.Box.prototype.write=function(e,t){this.localPos=t;var n=0;if(this._writeData(e,b.fields.FIELD_UINT32,this.size),this.extended_type?this._writeData(e,b.fields.FIELD_ID,"uuid"):this._writeData(e,b.fields.FIELD_ID,this.boxtype),1===this.size&&this._writeData(e,b.fields.FIELD_INT64,this.largesize),this.extended_type)for(n=0;n<16;n++)this._writeData(e,b.fields.FIELD_INT8,this.extended_type[n])},b.boxes.Box.prototype.getBoxByType=function(e){var t=0;if(this.hasOwnProperty("boxes"))for(t=0;t<this.boxes.length;t++)if(this.boxes[t].boxtype===e)return this.boxes[t];return null},b.boxes.Box.prototype.getBoxesByType=function(e){var t=[],n=0;if(this.hasOwnProperty("boxes"))for(n=0;n<this.boxes.length;n++)this.boxes[n].boxtype===e&&t.push(this.boxes[n]);return t},b.boxes.Box.prototype.removeBoxByType=function(e){var t=0;if(this.hasOwnProperty("boxes"))for(t=0;t<this.boxes.length;t++)this.boxes[t].boxtype===e&&this.boxes.splice(t,1);else b.warningHandler(this.boxtype+"does not have "+e+" box, impossible to remove it")},b.boxes.Box.prototype.getBoxOffsetByType=function(e){var t=8,n=0;if(this.hasOwnProperty("boxes"))for(n=0;n<this.boxes.length;n++){if(this.boxes[n].boxtype===e)return t;t+=this.boxes[n].size}return null},b.boxes.Box.prototype.getBoxIndexByType=function(e){var t=0,n=0;if(this.hasOwnProperty("boxes"))for(n=0;n<this.boxes.length;n++){if(this.boxes[n].boxtype===e)return t;t++}return null},b.boxes.Box.prototype.computeLength=function(){this.size=b.fields.FIELD_UINT32.getLength()+b.fields.FIELD_ID.getLength(),this.extended_type&&(this.size+=16*b.fields.FIELD_INT8.getLength())},b.boxes.Box.prototype._readData=function(e,t){var n=t.read(e,this.localPos,this.localEnd);return this.localPos+=t.getLength(n),n},b.boxes.Box.prototype._writeData=function(e,t,n){if(void 0===n||null===n)throw new b.ParseException("a field to write is null or undefined for box : "+this.boxtype);t.write(e,this.localPos,n),this.localPos+=t.getLength(n)},b.boxes.Box.prototype._writeBuffer=function(e,t,n){e.set(t,this.localPos),this.localPos+=n},b.boxes.Box.prototype._writeArrayData=function(e,t,n){var i=0;if(void 0===n||null===n||0===n.length)throw new b.ParseException("an array to write is null, undefined or length = 0 for box : "+this.boxtype);for(i=0;i<n.length;i++)this._writeData(e,t,n[i])},b.boxes.Box.prototype._readArrayData=function(e,t){var n=[],i=t.getLength(),r=(this.localEnd-this.localPos)/i,o=0;for(o=0;o<r;o++)n.push(t.read(e,this.localPos)),this.localPos+=i;return n},b.boxes.Box.prototype._readArrayFieldData=function(e,t,n){var i=-1,r=[],o=0;for(o=0;o<n;o++)r.push(t.read(e,this.localPos)),-1===i&&(i=t.getLength(r[o])),this.localPos+=i;return r},b.boxes.ContainerBox=function(e,t){b.boxes.Box.call(this,e,t),this.boxes=[]},b.boxes.ContainerBox.prototype=Object.create(b.boxes.Box.prototype),b.boxes.ContainerBox.prototype.constructor=b.boxes.ContainerBox,b.boxes.ContainerBox.prototype.computeLength=function(){b.boxes.Box.prototype.computeLength.call(this);var e=0;for(e=0;e<this.boxes.length;e++)this.boxes[e].computeLength(),this.size+=this.boxes[e].size},b.boxes.ContainerBox.prototype.write=function(e,t){b.boxes.Box.prototype.write.call(this,e,t);var n=0;for(n=0;n<this.boxes.length;n++)this.localPos=this.boxes[n].write(e,this.localPos);return this.localPos},b.boxes.ContainerBox.prototype.read=function(e,t,n){var i,r,o=0,s=0,a=null;while(t<n)if(o=b.fields.FIELD_UINT32.read(e,t),i=b.fields.readString(e,t+4,4),"uuid"===i&&(s=1==o?16:8,a=new b.fields.ArrayField(b.fields.FIELD_INT8,16).read(e,t+s,t+s+16),a=JSON.stringify(a)),r=b.createBox(i,o,a),"uuid"===i?(t=r.read(e,t+16*b.fields.FIELD_INT8.getLength()+8,t+o),a=null):t=r.read(e,t+8,t+o),b.debug&&(r.__sourceBuffer=e.subarray(t-r.size,t)),r.boxtype&&this.boxes.push(r),r.size<=0||null===r.size)throw new b.ParseException("Problem on size of box "+r.boxtype+", parsing stopped to avoid infinite loop");return t},b.boxes.FullBox=function(e,t,n){b.boxes.Box.call(this,e,t,n),this.version=null,this.flags=null},b.boxes.FullBox.prototype=Object.create(b.boxes.Box.prototype),b.boxes.FullBox.prototype.constructor=b.boxes.FullBox,b.boxes.FullBox.prototype.read=function(e,t,n){this.localPos=t,this.localEnd=n,this.version=this._readData(e,b.fields.FIELD_INT8),this.flags=this._readData(e,b.fields.FIELD_BIT24)},b.boxes.FullBox.prototype.write=function(e,t){b.boxes.Box.prototype.write.call(this,e,t),this._writeData(e,b.fields.FIELD_INT8,this.version),this._writeData(e,b.fields.FIELD_BIT24,this.flags)},b.boxes.FullBox.prototype.getFullBoxAttributesLength=function(){this.size+=b.fields.FIELD_INT8.getLength()+b.fields.FIELD_BIT24.getLength()},b.boxes.FullBox.prototype.computeLength=function(){b.boxes.Box.prototype.computeLength.call(this),b.boxes.FullBox.prototype.getFullBoxAttributesLength.call(this)},b.boxes.ContainerFullBox=function(e,t){b.boxes.FullBox.call(this,e,t),this.boxes=[]},b.boxes.ContainerFullBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.ContainerFullBox.prototype.constructor=b.boxes.ContainerFullBox,b.boxes.ContainerFullBox.prototype.computeLength=function(e){b.boxes.FullBox.prototype.computeLength.call(this);var t=0;for(e&&(this.size+=b.fields.FIELD_UINT32.getLength()),t=0;t<this.boxes.length;t++)this.boxes[t].computeLength(),this.size+=this.boxes[t].size},b.boxes.ContainerFullBox.prototype.read=function(e,t,n,i){b.boxes.FullBox.prototype.read.call(this,e,t,n);var r,o,s=0,a=0,l=null;i&&(this.entry_count=this._readData(e,b.fields.FIELD_UINT32));while(this.localPos<this.localEnd)if(s=b.fields.FIELD_UINT32.read(e,this.localPos),r=b.fields.readString(e,this.localPos+4,4),"uuid"==r&&(a=1==s?16:8,l=new b.fields.ArrayField(b.fields.FIELD_INT8,16).read(e,this.localPos+a,this.localPos+a+16),l=JSON.stringify(l)),o=b.createBox(r,s,l),"uuid"===r?(this.localPos=o.read(e,this.localPos+16*b.fields.FIELD_INT8.getLength()+8,this.localPos+s),l=null):this.localPos=o.read(e,this.localPos+8,this.localPos+s),b.debug&&(o.__sourceBuffer=e.subarray(this.localPos-o.size,this.localPos)),o.boxtype&&this.boxes.push(o),o.size<=0||null===o.size)throw new b.ParseException("Problem on size of box "+o.boxtype+", parsing stopped to avoid infinite loop");return this.localPos},b.boxes.ContainerFullBox.prototype.write=function(e,t,n){b.boxes.FullBox.prototype.write.call(this,e,t);var i=0;for(!0===n&&this._writeData(e,b.fields.FIELD_UINT32,this.entry_count),i=0;i<this.boxes.length;i++)this.localPos=this.boxes[i].write(e,this.localPos);return this.localPos},b.boxes.UnknownBox=function(e){b.boxes.Box.call(this,null,e)},b.boxes.UnknownBox.prototype=Object.create(b.boxes.Box.prototype),b.boxes.UnknownBox.prototype.constructor=b.boxes.UnknownBox,b.boxes.UnknownBox.prototype.read=function(e,t,n){return this.localPos=t,this.localEnd=n,this.unrecognized_data=e.subarray(this.localPos,this.localEnd),this.localEnd},b.boxes.UnknownBox.prototype.write=function(e,t){return b.boxes.Box.prototype.write.call(this,e,t),this._writeBuffer(e,this.unrecognized_data,this.unrecognized_data.length),this.localPos},b.boxes.UnknownBox.prototype.computeLength=function(){b.boxes.Box.prototype.computeLength.call(this),this.size+=this.unrecognized_data.length},b.boxes.FileTypeBox=function(e){b.boxes.Box.call(this,"ftyp",e)},b.boxes.FileTypeBox.prototype=Object.create(b.boxes.Box.prototype),b.boxes.FileTypeBox.prototype.constructor=b.boxes.FileTypeBox,b.boxes.FileTypeBox.prototype.computeLength=function(){b.boxes.Box.prototype.computeLength.call(this),this.size+=2*b.fields.FIELD_INT32.getLength()+b.fields.FIELD_INT32.getLength()*this.compatible_brands.length},b.boxes.FileTypeBox.prototype.read=function(e,t,n){return this.localPos=t,this.localEnd=n,this.major_brand=this._readData(e,b.fields.FIELD_INT32),this.minor_brand=this._readData(e,b.fields.FIELD_INT32),this.compatible_brands=this._readArrayData(e,b.fields.FIELD_INT32),this.localPos},b.boxes.FileTypeBox.prototype.write=function(e,t){return b.boxes.Box.prototype.write.call(this,e,t),this._writeData(e,b.fields.FIELD_INT32,this.major_brand),this._writeData(e,b.fields.FIELD_INT32,this.minor_brand),this._writeArrayData(e,b.fields.FIELD_INT32,this.compatible_brands),this.localPos},b.boxes.MovieBox=function(e){b.boxes.ContainerBox.call(this,"moov",e)},b.boxes.MovieBox.prototype=Object.create(b.boxes.ContainerBox.prototype),b.boxes.MovieBox.prototype.constructor=b.boxes.MovieBox,b.boxes.MovieFragmentBox=function(e){b.boxes.ContainerBox.call(this,"moof",e)},b.boxes.MovieFragmentBox.prototype=Object.create(b.boxes.ContainerBox.prototype),b.boxes.MovieFragmentBox.prototype.constructor=b.boxes.MovieFragmentBox,b.boxes.MovieFragmentRandomAccessBox=function(e){b.boxes.ContainerBox.call(this,"mfra",e)},b.boxes.MovieFragmentRandomAccessBox.prototype=Object.create(b.boxes.ContainerBox.prototype),b.boxes.MovieFragmentRandomAccessBox.prototype.constructor=b.boxes.MovieFragmentRandomAccessBox,b.boxes.UserDataBox=function(e){b.boxes.ContainerBox.call(this,"udta",e)},b.boxes.UserDataBox.prototype=Object.create(b.boxes.ContainerBox.prototype),b.boxes.UserDataBox.prototype.constructor=b.boxes.UserDataBox,b.boxes.TrackBox=function(e){b.boxes.ContainerBox.call(this,"trak",e)},b.boxes.TrackBox.prototype=Object.create(b.boxes.ContainerBox.prototype),b.boxes.TrackBox.prototype.constructor=b.boxes.TrackBox,b.boxes.EditBox=function(e){b.boxes.ContainerBox.call(this,"edts",e)},b.boxes.EditBox.prototype=Object.create(b.boxes.ContainerBox.prototype),b.boxes.EditBox.prototype.constructor=b.boxes.EditBox,b.boxes.MediaBox=function(e){b.boxes.ContainerBox.call(this,"mdia",e)},b.boxes.MediaBox.prototype=Object.create(b.boxes.ContainerBox.prototype),b.boxes.MediaBox.prototype.constructor=b.boxes.MediaBox,b.boxes.MediaInformationBox=function(e){b.boxes.ContainerBox.call(this,"minf",e)},b.boxes.MediaInformationBox.prototype=Object.create(b.boxes.ContainerBox.prototype),b.boxes.MediaInformationBox.prototype.constructor=b.boxes.MediaInformationBox,b.boxes.DataInformationBox=function(e){b.boxes.ContainerBox.call(this,"dinf",e)},b.boxes.DataInformationBox.prototype=Object.create(b.boxes.ContainerBox.prototype),b.boxes.DataInformationBox.prototype.constructor=b.boxes.DataInformationBox,b.boxes.SampleTableBox=function(e){b.boxes.ContainerBox.call(this,"stbl",e)},b.boxes.SampleTableBox.prototype=Object.create(b.boxes.ContainerBox.prototype),b.boxes.SampleTableBox.prototype.constructor=b.boxes.SampleTableBox,b.boxes.MovieExtendsBox=function(e){b.boxes.ContainerBox.call(this,"mvex",e)},b.boxes.MovieExtendsBox.prototype=Object.create(b.boxes.ContainerBox.prototype),b.boxes.MovieExtendsBox.prototype.constructor=b.boxes.MovieExtendsBox,b.boxes.TrackFragmentBox=function(e){b.boxes.ContainerBox.call(this,"traf",e)},b.boxes.TrackFragmentBox.prototype=Object.create(b.boxes.ContainerBox.prototype),b.boxes.TrackFragmentBox.prototype.constructor=b.boxes.TrackFragmentBox,b.boxes.MetaBox=function(e){b.boxes.ContainerFullBox.call(this,"meta",e)},b.boxes.MetaBox.prototype=Object.create(b.boxes.ContainerFullBox.prototype),b.boxes.MetaBox.prototype.constructor=b.boxes.MetaBox,b.boxes.MetaBox.prototype.computeLength=function(){b.boxes.ContainerFullBox.prototype.computeLength.call(this,!1)},b.boxes.MetaBox.prototype.read=function(e,t,n){return b.boxes.ContainerFullBox.prototype.read.call(this,e,t,n,!1)},b.boxes.MetaBox.prototype.write=function(e,t){return b.boxes.ContainerFullBox.prototype.write.call(this,e,t,!1)},b.boxes.MovieHeaderBox=function(e){b.boxes.FullBox.call(this,"mvhd",e)},b.boxes.MovieHeaderBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.MovieHeaderBox.prototype.constructor=b.boxes.MovieHeaderBox,b.boxes.MovieHeaderBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=b.fields.FIELD_INT32.getLength()+2*b.fields.FIELD_INT16.getLength(),this.size+=2*b.fields.FIELD_INT32.getLength()+9*b.fields.FIELD_INT32.getLength(),this.size+=6*b.fields.FIELD_BIT32.getLength()+b.fields.FIELD_UINT32.getLength(),1===this.version?this.size+=3*b.fields.FIELD_UINT64.getLength()+b.fields.FIELD_UINT32.getLength():this.size+=4*b.fields.FIELD_UINT32.getLength()},b.boxes.MovieHeaderBox.prototype.write=function(e,t){return b.boxes.FullBox.prototype.write.call(this,e,t),1===this.version?(this._writeData(e,b.fields.FIELD_UINT64,this.creation_time),this._writeData(e,b.fields.FIELD_UINT64,this.modification_time),this._writeData(e,b.fields.FIELD_UINT32,this.timescale),this._writeData(e,b.fields.FIELD_UINT64,this.duration)):(this._writeData(e,b.fields.FIELD_UINT32,this.creation_time),this._writeData(e,b.fields.FIELD_UINT32,this.modification_time),this._writeData(e,b.fields.FIELD_UINT32,this.timescale),this._writeData(e,b.fields.FIELD_UINT32,this.duration)),this._writeData(e,b.fields.FIELD_INT32,this.rate),this._writeData(e,b.fields.FIELD_INT16,this.volume),this._writeData(e,b.fields.FIELD_INT16,this.reserved),this._writeArrayData(e,b.fields.FIELD_INT32,this.reserved_2),this._writeArrayData(e,b.fields.FIELD_INT32,this.matrix),this._writeArrayData(e,b.fields.FIELD_BIT32,this.pre_defined),this._writeData(e,b.fields.FIELD_UINT32,this.next_track_ID),this.localPos},b.boxes.MovieHeaderBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),1==this.version?(this.creation_time=this._readData(e,b.fields.FIELD_UINT64),this.modification_time=this._readData(e,b.fields.FIELD_UINT64),this.timescale=this._readData(e,b.fields.FIELD_UINT32),this.duration=this._readData(e,b.fields.FIELD_UINT64)):(this.creation_time=this._readData(e,b.fields.FIELD_UINT32),this.modification_time=this._readData(e,b.fields.FIELD_UINT32),this.timescale=this._readData(e,b.fields.FIELD_UINT32),this.duration=this._readData(e,b.fields.FIELD_UINT32)),this.rate=this._readData(e,b.fields.FIELD_INT32),this.volume=this._readData(e,b.fields.FIELD_INT16),this.reserved=this._readData(e,b.fields.FIELD_INT16),this.reserved_2=this._readArrayFieldData(e,b.fields.FIELD_INT32,2),this.matrix=this._readArrayFieldData(e,b.fields.FIELD_INT32,9),this.pre_defined=this._readArrayFieldData(e,b.fields.FIELD_BIT32,6),this.next_track_ID=this._readData(e,b.fields.FIELD_UINT32),this.localPos},b.boxes.MediaDataBox=function(e){b.boxes.Box.call(this,"mdat",e)},b.boxes.MediaDataBox.prototype=Object.create(b.boxes.Box.prototype),b.boxes.MediaDataBox.prototype.constructor=b.boxes.MediaDataBox,b.boxes.MediaDataBox.prototype.computeLength=function(){b.boxes.Box.prototype.computeLength.call(this),this.size+=this.data.length},b.boxes.MediaDataBox.prototype.read=function(e,t,n){return this.data=e.subarray(t,n),n},b.boxes.MediaDataBox.prototype.write=function(e,t){return b.boxes.Box.prototype.write.call(this,e,t),this._writeBuffer(e,this.data,this.data.length),this.localPos},b.boxes.FreeSpaceBox=function(e){b.boxes.Box.call(this,"free",e)},b.boxes.FreeSpaceBox.prototype=Object.create(b.boxes.Box.prototype),b.boxes.FreeSpaceBox.prototype.constructor=b.boxes.FreeSpaceBox,b.boxes.FreeSpaceBox.prototype.computeLength=function(){b.boxes.Box.prototype.computeLength.call(this),this.size+=this.data.length},b.boxes.FreeSpaceBox.prototype.read=function(e,t,n){return this.localPos=t,this.localEnd=n,this.data=e.subarray(this.localPos,this.localEnd),this.localEnd},b.boxes.FreeSpaceBox.prototype.write=function(e,t){return b.boxes.Box.prototype.write.call(this,e,t),this._writeBuffer(e,this.data,this.data.length),this.localPos},b.boxes.SegmentIndexBox=function(e){b.boxes.FullBox.call(this,"sidx",e)},b.boxes.SegmentIndexBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.SegmentIndexBox.prototype.constructor=b.boxes.SegmentIndexBox,b.boxes.SegmentIndexBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=2*b.fields.FIELD_UINT32.getLength(),1===this.version?this.size+=2*b.fields.FIELD_UINT64.getLength():this.size+=2*b.fields.FIELD_UINT32.getLength(),this.size+=b.fields.FIELD_UINT16.getLength(),this.size+=b.fields.FIELD_UINT16.getLength(),this.size+=(b.fields.FIELD_UINT64.getLength()+b.fields.FIELD_UINT32.getLength())*this.reference_count},b.boxes.SegmentIndexBox.prototype.read=function(e,t,n){b.boxes.FullBox.prototype.read.call(this,e,t,n);var i=0,r={};for(this.reference_ID=this._readData(e,b.fields.FIELD_UINT32),this.timescale=this._readData(e,b.fields.FIELD_UINT32),1===this.version?(this.earliest_presentation_time=this._readData(e,b.fields.FIELD_UINT64),this.first_offset=this._readData(e,b.fields.FIELD_UINT64)):(this.earliest_presentation_time=this._readData(e,b.fields.FIELD_UINT32),this.first_offset=this._readData(e,b.fields.FIELD_UINT32)),this.reserved=this._readData(e,b.fields.FIELD_UINT16),this.reference_count=this._readData(e,b.fields.FIELD_UINT16),this.references=[],i=0;i<this.reference_count;i++)r={},r.reference_info=this._readData(e,b.fields.FIELD_UINT64),r.SAP=this._readData(e,b.fields.FIELD_UINT32),this.references.push(r);return this.localPos},b.boxes.SegmentIndexBox.prototype.write=function(e,t){b.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,b.fields.FIELD_UINT32,this.reference_ID),this._writeData(e,b.fields.FIELD_UINT32,this.timescale),1===this.version?(this._writeData(e,b.fields.FIELD_UINT64,this.earliest_presentation_time),this._writeData(e,b.fields.FIELD_UINT64,this.first_offset)):(this._writeData(e,b.fields.FIELD_UINT32,this.earliest_presentation_time),this._writeData(e,b.fields.FIELD_UINT32,this.first_offset)),this._writeData(e,b.fields.FIELD_UINT16,this.reserved),this._writeData(e,b.fields.FIELD_UINT16,this.reference_count),n=0;n<this.reference_count;n++)this._writeData(e,b.fields.FIELD_UINT64,this.references[n].reference_info),this._writeData(e,b.fields.FIELD_UINT32,this.references[n].SAP);return this.localPos},b.boxes.TrackHeaderBox=function(e){b.boxes.FullBox.call(this,"tkhd",e)},b.boxes.TrackHeaderBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.TrackHeaderBox.prototype.constructor=b.boxes.TrackHeaderBox,b.boxes.TrackHeaderBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=4*b.fields.FIELD_INT16.getLength()+2*b.fields.FIELD_INT32.getLength()+2*b.fields.FIELD_UINT32.getLength()+9*b.fields.FIELD_INT32.getLength(),1==this.version?this.size+=3*b.fields.FIELD_UINT64.getLength()+2*b.fields.FIELD_UINT32.getLength():this.size+=5*b.fields.FIELD_UINT32.getLength()},b.boxes.TrackHeaderBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),1===this.version?(this.creation_time=this._readData(e,b.fields.FIELD_UINT64),this.modification_time=this._readData(e,b.fields.FIELD_UINT64),this.track_id=this._readData(e,b.fields.FIELD_UINT32),this.reserved=this._readData(e,b.fields.FIELD_UINT32),this.duration=this._readData(e,b.fields.FIELD_UINT64)):(this.creation_time=this._readData(e,b.fields.FIELD_UINT32),this.modification_time=this._readData(e,b.fields.FIELD_UINT32),this.track_id=this._readData(e,b.fields.FIELD_UINT32),this.reserved=this._readData(e,b.fields.FIELD_UINT32),this.duration=this._readData(e,b.fields.FIELD_UINT32)),this.reserved_2=this._readArrayFieldData(e,b.fields.FIELD_UINT32,2),this.layer=this._readData(e,b.fields.FIELD_INT16),this.alternate_group=this._readData(e,b.fields.FIELD_INT16),this.volume=this._readData(e,b.fields.FIELD_INT16),this.reserved_3=this._readData(e,b.fields.FIELD_INT16),this.matrix=this._readArrayFieldData(e,b.fields.FIELD_INT32,9),this.width=this._readData(e,b.fields.FIELD_INT32),this.height=this._readData(e,b.fields.FIELD_INT32),this.localPos},b.boxes.TrackHeaderBox.prototype.write=function(e,t){return b.boxes.FullBox.prototype.write.call(this,e,t),1===this.version?(this._writeData(e,b.fields.FIELD_UINT64,this.creation_time),this._writeData(e,b.fields.FIELD_UINT64,this.modification_time),this._writeData(e,b.fields.FIELD_UINT32,this.track_id),this._writeData(e,b.fields.FIELD_UINT32,this.reserved),this._writeData(e,b.fields.FIELD_UINT64,this.duration)):(this._writeData(e,b.fields.FIELD_UINT32,this.creation_time),this._writeData(e,b.fields.FIELD_UINT32,this.modification_time),this._writeData(e,b.fields.FIELD_UINT32,this.track_id),this._writeData(e,b.fields.FIELD_UINT32,this.reserved),this._writeData(e,b.fields.FIELD_UINT32,this.duration)),this._writeArrayData(e,b.fields.FIELD_UINT32,this.reserved_2),this._writeData(e,b.fields.FIELD_INT16,this.layer),this._writeData(e,b.fields.FIELD_INT16,this.alternate_group),this._writeData(e,b.fields.FIELD_INT16,this.volume),this._writeData(e,b.fields.FIELD_INT16,this.reserved_3),this._writeArrayData(e,b.fields.FIELD_INT32,this.matrix),this._writeData(e,b.fields.FIELD_INT32,this.width),this._writeData(e,b.fields.FIELD_INT32,this.height),this.localPos},b.boxes.MediaHeaderBox=function(e){b.boxes.FullBox.call(this,"mdhd",e)},b.boxes.MediaHeaderBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.MediaHeaderBox.prototype.constructor=b.boxes.MediaHeaderBox,b.boxes.MediaHeaderBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=2*b.fields.FIELD_UINT16.getLength(),1==this.version?this.size+=3*b.fields.FIELD_UINT64.getLength()+b.fields.FIELD_UINT32.getLength():this.size+=4*b.fields.FIELD_UINT32.getLength()},b.boxes.MediaHeaderBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),1===this.version?(this.creation_time=this._readData(e,b.fields.FIELD_UINT64),this.modification_time=this._readData(e,b.fields.FIELD_UINT64),this.timescale=this._readData(e,b.fields.FIELD_UINT32),this.duration=this._readData(e,b.fields.FIELD_UINT64)):(this.creation_time=this._readData(e,b.fields.FIELD_UINT32),this.modification_time=this._readData(e,b.fields.FIELD_UINT32),this.timescale=this._readData(e,b.fields.FIELD_UINT32),this.duration=this._readData(e,b.fields.FIELD_UINT32)),this.language=this._readData(e,b.fields.FIELD_UINT16),this.pre_defined=this._readData(e,b.fields.FIELD_UINT16),this.localPos},b.boxes.MediaHeaderBox.prototype.write=function(e,t){return b.boxes.FullBox.prototype.write.call(this,e,t),1===this.version?(this._writeData(e,b.fields.FIELD_UINT64,this.creation_time),this._writeData(e,b.fields.FIELD_UINT64,this.modification_time),this._writeData(e,b.fields.FIELD_UINT32,this.timescale),this._writeData(e,b.fields.FIELD_UINT64,this.duration)):(this._writeData(e,b.fields.FIELD_UINT32,this.creation_time),this._writeData(e,b.fields.FIELD_UINT32,this.modification_time),this._writeData(e,b.fields.FIELD_UINT32,this.timescale),this._writeData(e,b.fields.FIELD_UINT32,this.duration)),this._writeData(e,b.fields.FIELD_UINT16,this.language),this._writeData(e,b.fields.FIELD_UINT16,this.pre_defined),this.localPos},b.boxes.MovieExtendsHeaderBox=function(e){b.boxes.FullBox.call(this,"mehd",e)},b.boxes.MovieExtendsHeaderBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.MovieExtendsHeaderBox.prototype.constructor=b.boxes.MovieExtendsHeaderBox,b.boxes.MovieExtendsHeaderBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),1==this.version?this.size+=b.fields.FIELD_UINT64.getLength():this.size+=b.fields.FIELD_UINT32.getLength()},b.boxes.MovieExtendsHeaderBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),1===this.version?this.fragment_duration=this._readData(e,b.fields.FIELD_UINT64):this.fragment_duration=this._readData(e,b.fields.FIELD_UINT32),this.localPos},b.boxes.MovieExtendsHeaderBox.prototype.write=function(e,t){return b.boxes.FullBox.prototype.write.call(this,e,t),1===this.version?this._writeData(e,b.fields.FIELD_UINT64,this.fragment_duration):this._writeData(e,b.fields.FIELD_UINT32,this.fragment_duration),this.localPos},b.boxes.HandlerBox=function(e){b.boxes.FullBox.call(this,"hdlr",e)},b.boxes.HandlerBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.HandlerBox.prototype.constructor=b.boxes.HandlerBox,b.boxes.HandlerBox.prototype.HANDLERTYPEVIDEO="vide",b.boxes.HandlerBox.prototype.HANDLERTYPEAUDIO="soun",b.boxes.HandlerBox.prototype.HANDLERTYPETEXT="meta",b.boxes.HandlerBox.prototype.HANDLERVIDEONAME="Video Track",b.boxes.HandlerBox.prototype.HANDLERAUDIONAME="Audio Track",b.boxes.HandlerBox.prototype.HANDLERTEXTNAME="Text Track",b.boxes.HandlerBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=2*b.fields.FIELD_UINT32.getLength()+3*b.fields.FIELD_UINT32.getLength()+b.fields.FIELD_STRING.getLength(this.name)},b.boxes.HandlerBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),this.pre_defined=this._readData(e,b.fields.FIELD_UINT32),this.handler_type=this._readData(e,b.fields.FIELD_UINT32),this.reserved=this._readArrayFieldData(e,b.fields.FIELD_UINT32,3),this.name=this._readData(e,b.fields.FIELD_STRING),this.localPos},b.boxes.HandlerBox.prototype.write=function(e,t){return b.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,b.fields.FIELD_UINT32,this.pre_defined),this._writeData(e,b.fields.FIELD_UINT32,this.handler_type),this._writeArrayData(e,b.fields.FIELD_UINT32,this.reserved),this._writeData(e,b.fields.FIELD_STRING,this.name),this.localPos},b.boxes.TimeToSampleBox=function(e){b.boxes.FullBox.call(this,"stts",e)},b.boxes.TimeToSampleBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.TimeToSampleBox.prototype.constructor=b.boxes.TimeToSampleBox,b.boxes.TimeToSampleBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=b.fields.FIELD_UINT32.getLength(),this.size+=this.entry_count*(2*b.fields.FIELD_UINT32.getLength())},b.boxes.TimeToSampleBox.prototype.read=function(e,t,n){b.boxes.FullBox.prototype.read.call(this,e,t,n);var i=0,r={};for(this.entry_count=this._readData(e,b.fields.FIELD_UINT32),this.entry=[],i=0;i<this.entry_count;i++)r={},r.sample_count=this._readData(e,b.fields.FIELD_UINT32),r.sample_delta=this._readData(e,b.fields.FIELD_UINT32),this.entry.push(r);return this.localPos},b.boxes.TimeToSampleBox.prototype.write=function(e,t){b.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,b.fields.FIELD_UINT32,this.entry_count),n=0;n<this.entry_count;n++)this._writeData(e,b.fields.FIELD_UINT32,this.entry[n].sample_count),this._writeData(e,b.fields.FIELD_UINT32,this.entry[n].sample_delta);return this.localPos},b.boxes.SampleToChunkBox=function(e){b.boxes.FullBox.call(this,"stsc",e)},b.boxes.SampleToChunkBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.SampleToChunkBox.prototype.constructor=b.boxes.SampleToChunkBox,b.boxes.SampleToChunkBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=b.fields.FIELD_UINT32.getLength(),this.size+=this.entry_count*(3*b.fields.FIELD_UINT32.getLength())},b.boxes.SampleToChunkBox.prototype.read=function(e,t,n){b.boxes.FullBox.prototype.read.call(this,e,t,n);var i=0,r={};for(this.entry_count=this._readData(e,b.fields.FIELD_UINT32),this.entry=[],i=0;i<this.entry_count;i++)r={},r.first_chunk=this._readData(e,b.fields.FIELD_UINT32),r.samples_per_chunk=this._readData(e,b.fields.FIELD_UINT32),r.samples_description_index=this._readData(e,b.fields.FIELD_UINT32),this.entry.push(r);return this.localPos},b.boxes.SampleToChunkBox.prototype.write=function(e,t){b.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,b.fields.FIELD_UINT32,this.entry_count),n=0;n<this.entry_count;n++)this._writeData(e,b.fields.FIELD_UINT32,this.entry[n].first_chunk),this._writeData(e,b.fields.FIELD_UINT32,this.entry[n].samples_per_chunk),this._writeData(e,b.fields.FIELD_UINT32,this.entry[n].samples_description_index);return this.localPos},b.boxes.ChunkOffsetBox=function(e){b.boxes.FullBox.call(this,"stco",e)},b.boxes.ChunkOffsetBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.ChunkOffsetBox.prototype.constructor=b.boxes.ChunkOffsetBox,b.boxes.ChunkOffsetBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=b.fields.FIELD_UINT32.getLength()+this.entry_count*b.fields.FIELD_UINT32.getLength()},b.boxes.ChunkOffsetBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),this.entry_count=this._readData(e,b.fields.FIELD_UINT32),this.chunk_offset=this._readArrayFieldData(e,b.fields.FIELD_UINT32,this.entry_count),this.localPos},b.boxes.ChunkOffsetBox.prototype.write=function(e,t){b.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,b.fields.FIELD_UINT32,this.entry_count),n=0;n<this.entry_count;n++)this._writeData(e,b.fields.FIELD_UINT32,this.chunk_offset[n]);return this.localPos},b.boxes.TrackExtendsBox=function(e){b.boxes.FullBox.call(this,"trex",e)},b.boxes.TrackExtendsBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.TrackExtendsBox.prototype.constructor=b.boxes.TrackExtendsBox,b.boxes.TrackExtendsBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=5*b.fields.FIELD_UINT32.getLength()},b.boxes.TrackExtendsBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),this.track_ID=this._readData(e,b.fields.FIELD_UINT32),this.default_sample_description_index=this._readData(e,b.fields.FIELD_UINT32),this.default_sample_duration=this._readData(e,b.fields.FIELD_UINT32),this.default_sample_size=this._readData(e,b.fields.FIELD_UINT32),this.default_sample_flags=this._readData(e,b.fields.FIELD_UINT32),this.localPos},b.boxes.TrackExtendsBox.prototype.write=function(e,t){return b.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,b.fields.FIELD_UINT32,this.track_ID),this._writeData(e,b.fields.FIELD_UINT32,this.default_sample_description_index),this._writeData(e,b.fields.FIELD_UINT32,this.default_sample_duration),this._writeData(e,b.fields.FIELD_UINT32,this.default_sample_size),this._writeData(e,b.fields.FIELD_UINT32,this.default_sample_flags),this.localPos},b.boxes.VideoMediaHeaderBox=function(e){b.boxes.FullBox.call(this,"vmhd",e)},b.boxes.VideoMediaHeaderBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.VideoMediaHeaderBox.prototype.constructor=b.boxes.VideoMediaHeaderBox,b.boxes.VideoMediaHeaderBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=b.fields.FIELD_INT16.getLength()+3*b.fields.FIELD_UINT16.getLength()},b.boxes.VideoMediaHeaderBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),this.graphicsmode=this._readData(e,b.fields.FIELD_INT16),this.opcolor=this._readArrayFieldData(e,b.fields.FIELD_UINT16,3),this.localPos},b.boxes.VideoMediaHeaderBox.prototype.write=function(e,t){return b.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,b.fields.FIELD_INT16,this.graphicsmode),this._writeArrayData(e,b.fields.FIELD_UINT16,this.opcolor),this.localPos},b.boxes.SoundMediaHeaderBox=function(e){b.boxes.FullBox.call(this,"smhd",e)},b.boxes.SoundMediaHeaderBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.SoundMediaHeaderBox.prototype.constructor=b.boxes.SoundMediaHeaderBox,b.boxes.SoundMediaHeaderBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=b.fields.FIELD_INT16.getLength()+b.fields.FIELD_UINT16.getLength()},b.boxes.SoundMediaHeaderBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),this.balance=this._readData(e,b.fields.FIELD_INT16),this.reserved=this._readData(e,b.fields.FIELD_UINT16),this.localPos},b.boxes.SoundMediaHeaderBox.prototype.write=function(e,t){return b.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,b.fields.FIELD_INT16,this.balance),this._writeData(e,b.fields.FIELD_UINT16,this.reserved),this.localPos},b.boxes.DataReferenceBox=function(e){b.boxes.ContainerFullBox.call(this,"dref",e)},b.boxes.DataReferenceBox.prototype=Object.create(b.boxes.ContainerFullBox.prototype),b.boxes.DataReferenceBox.prototype.constructor=b.boxes.DataReferenceBox,b.boxes.DataReferenceBox.prototype.computeLength=function(){b.boxes.ContainerFullBox.prototype.computeLength.call(this,!0)},b.boxes.DataReferenceBox.prototype.read=function(e,t,n){return b.boxes.ContainerFullBox.prototype.read.call(this,e,t,n,!0)},b.boxes.DataReferenceBox.prototype.write=function(e,t){return this.entry_count||(this.entry_count=this.boxes.length),b.boxes.ContainerFullBox.prototype.write.call(this,e,t,!0)},b.boxes.DataEntryUrlBox=function(e){b.boxes.FullBox.call(this,"url ",e)},b.boxes.DataEntryUrlBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.DataEntryUrlBox.prototype.constructor=b.boxes.DataEntryUrlBox,b.boxes.DataEntryUrlBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),void 0!==this.location&&(this.size+=b.fields.FIELD_STRING.getLength(this.location))},b.boxes.DataEntryUrlBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),!1&this.flags&&(this.location=this._readData(e,b.fields.FIELD_STRING)),this.localPos},b.boxes.DataEntryUrlBox.prototype.write=function(e,t){return b.boxes.FullBox.prototype.write.call(this,e,t),void 0!==this.location&&this._writeData(e,b.fields.FIELD_STRING,this.location),this.localPos},b.boxes.DataEntryUrnBox=function(e){b.boxes.FullBox.call(this,"urn ",e)},b.boxes.DataEntryUrnBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.DataEntryUrnBox.prototype.constructor=b.boxes.DataEntryUrnBox,b.boxes.DataEntryUrnBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),!1&this.flags&&(this.size+=b.fields.FIELD_STRING.getLength(this.name)+b.fields.FIELD_STRING.getLength(this.location))},b.boxes.DataEntryUrnBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),!1&this.flags&&(this.name=this._readData(e,b.fields.FIELD_STRING),this.location=this._readData(e,b.fields.FIELD_STRING)),this.localPos},b.boxes.DataEntryUrnBox.prototype.write=function(e,t){return b.boxes.FullBox.prototype.write.call(this,e,t),!1&this.flags&&(this._writeData(e,b.fields.FIELD_STRING,this.name),this._writeData(e,b.fields.FIELD_STRING,this.location)),this.localPos},b.boxes.MovieFragmentHeaderBox=function(e){b.boxes.FullBox.call(this,"mfhd",e)},b.boxes.MovieFragmentHeaderBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.MovieFragmentHeaderBox.prototype.constructor=b.boxes.MovieFragmentHeaderBox,b.boxes.MovieFragmentHeaderBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=b.fields.FIELD_UINT32.getLength()},b.boxes.MovieFragmentHeaderBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),this.sequence_number=this._readData(e,b.fields.FIELD_UINT32),this.localPos},b.boxes.MovieFragmentHeaderBox.prototype.write=function(e,t){return b.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,b.fields.FIELD_UINT32,this.sequence_number),this.localPos},b.boxes.TrackFragmentHeaderBox=function(e){b.boxes.FullBox.call(this,"tfhd",e)},b.boxes.TrackFragmentHeaderBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.TrackFragmentHeaderBox.prototype.constructor=b.boxes.TrackFragmentHeaderBox,b.boxes.TrackFragmentHeaderBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=b.fields.FIELD_UINT32.getLength(),0!==(1&this.flags)&&void 0!==this.base_data_offset&&(this.size+=b.fields.FIELD_UINT64.getLength()),0!==(2&this.flags)&&void 0!==this.sample_description_index&&(this.size+=b.fields.FIELD_UINT32.getLength()),0!==(8&this.flags)&&void 0!==this.default_sample_duration&&(this.size+=b.fields.FIELD_UINT32.getLength()),0!==(16&this.flags)&&void 0!==this.default_sample_size&&(this.size+=b.fields.FIELD_UINT32.getLength()),0!==(32&this.flags)&&void 0!==this.default_sample_flags&&(this.size+=b.fields.FIELD_UINT32.getLength())},b.boxes.TrackFragmentHeaderBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),this.track_ID=this._readData(e,b.fields.FIELD_UINT32),0!==(1&this.flags)&&(this.base_data_offset=this._readData(e,b.fields.FIELD_UINT64)),0!==(2&this.flags)&&(this.sample_description_index=this._readData(e,b.fields.FIELD_UINT32)),0!==(8&this.flags)&&(this.default_sample_duration=this._readData(e,b.fields.FIELD_UINT32)),0!==(16&this.flags)&&(this.default_sample_size=this._readData(e,b.fields.FIELD_UINT32)),0!==(32&this.flags)&&(this.default_sample_flags=this._readData(e,b.fields.FIELD_UINT32)),this.localPos},b.boxes.TrackFragmentHeaderBox.prototype.write=function(e,t){return b.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,b.fields.FIELD_UINT32,this.track_ID),0!==(1&this.flags)&&this._writeData(e,b.fields.FIELD_UINT64,this.base_data_offset),0!==(2&this.flags)&&this._writeData(e,b.fields.FIELD_UINT32,this.sample_description_index),0!==(8&this.flags)&&this._writeData(e,b.fields.FIELD_UINT32,this.default_sample_duration),0!==(16&this.flags)&&this._writeData(e,b.fields.FIELD_UINT32,this.default_sample_size),0!==(32&this.flags)&&this._writeData(e,b.fields.FIELD_UINT32,this.default_sample_flags),this.localPos},b.boxes.TrackFragmentBaseMediaDecodeTimeBox=function(e){b.boxes.FullBox.call(this,"tfdt",e)},b.boxes.TrackFragmentBaseMediaDecodeTimeBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.TrackFragmentBaseMediaDecodeTimeBox.prototype.constructor=b.boxes.TrackFragmentBaseMediaDecodeTimeBox,b.boxes.TrackFragmentBaseMediaDecodeTimeBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),1===this.version?this.size+=b.fields.FIELD_UINT64.getLength():this.size+=b.fields.FIELD_UINT32.getLength()},b.boxes.TrackFragmentBaseMediaDecodeTimeBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),1===this.version?this.baseMediaDecodeTime=this._readData(e,b.fields.FIELD_UINT64):this.baseMediaDecodeTime=this._readData(e,b.fields.FIELD_UINT32),this.localPos},b.boxes.TrackFragmentBaseMediaDecodeTimeBox.prototype.write=function(e,t){return b.boxes.FullBox.prototype.write.call(this,e,t),1===this.version?this._writeData(e,b.fields.FIELD_UINT64,this.baseMediaDecodeTime):this._writeData(e,b.fields.FIELD_UINT32,this.baseMediaDecodeTime),this.localPos},b.boxes.TrackFragmentRunBox=function(e){b.boxes.FullBox.call(this,"trun",e)},b.boxes.TrackFragmentRunBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.TrackFragmentRunBox.prototype.constructor=b.boxes.TrackFragmentRunBox,b.boxes.TrackFragmentRunBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this);var e=0;for(this.size+=b.fields.FIELD_UINT32.getLength(),0!==(1&this.flags)&&void 0!==this.data_offset&&(this.size+=b.fields.FIELD_INT32.getLength()),0!==(4&this.flags)&&void 0!==this.first_sample_flags&&(this.size+=b.fields.FIELD_UINT32.getLength()),e=0;e<this.sample_count;e++)0!==(256&this.flags)&&void 0!==this.samples_table[e].sample_duration&&(this.size+=b.fields.FIELD_UINT32.getLength()),0!==(512&this.flags)&&void 0!==this.samples_table[e].sample_size&&(this.size+=b.fields.FIELD_UINT32.getLength()),0!==(1024&this.flags)&&void 0!==this.samples_table[e].sample_flags&&(this.size+=b.fields.FIELD_UINT32.getLength()),1===this.version?0!==(2048&this.flags)&&void 0!==this.samples_table[e].sample_composition_time_offset&&(this.size+=b.fields.FIELD_INT32.getLength()):0!==(2048&this.flags)&&void 0!==this.samples_table[e].sample_composition_time_offset&&(this.size+=b.fields.FIELD_UINT32.getLength())},b.boxes.TrackFragmentRunBox.prototype.read=function(e,t,n){b.boxes.FullBox.prototype.read.call(this,e,t,n);var i=0,r={};for(this.sample_count=this._readData(e,b.fields.FIELD_UINT32),0!==(1&this.flags)&&(this.data_offset=this._readData(e,b.fields.FIELD_INT32)),0!==(4&this.flags)&&(this.first_sample_flags=this._readData(e,b.fields.FIELD_UINT32)),this.samples_table=[],i=0;i<this.sample_count;i++)r={},0!==(256&this.flags)&&(r.sample_duration=this._readData(e,b.fields.FIELD_UINT32)),0!==(512&this.flags)&&(r.sample_size=this._readData(e,b.fields.FIELD_UINT32)),0!==(1024&this.flags)&&(r.sample_flags=this._readData(e,b.fields.FIELD_UINT32)),1===this.version?0!==(2048&this.flags)&&(r.sample_composition_time_offset=this._readData(e,b.fields.FIELD_INT32)):0!==(2048&this.flags)&&(r.sample_composition_time_offset=this._readData(e,b.fields.FIELD_UINT32)),this.samples_table.push(r);return this.localPos},b.boxes.TrackFragmentRunBox.prototype.write=function(e,t){b.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,b.fields.FIELD_UINT32,this.sample_count),0!==(1&this.flags)&&this._writeData(e,b.fields.FIELD_INT32,this.data_offset),0!==(4&this.flags)&&this._writeData(e,b.fields.FIELD_UINT32,this.first_sample_flags),n=0;n<this.sample_count;n++)0!==(256&this.flags)&&this._writeData(e,b.fields.FIELD_UINT32,this.samples_table[n].sample_duration),0!==(512&this.flags)&&this._writeData(e,b.fields.FIELD_UINT32,this.samples_table[n].sample_size),0!==(1024&this.flags)&&this._writeData(e,b.fields.FIELD_UINT32,this.samples_table[n].sample_flags),1===this.version?0!==(2048&this.flags)&&this._writeData(e,b.fields.FIELD_INT32,this.samples_table[n].sample_composition_time_offset):0!==(2048&this.flags)&&this._writeData(e,b.fields.FIELD_UINT32,this.samples_table[n].sample_composition_time_offset);return this.localPos},b.boxes.SampleDescriptionBox=function(e){b.boxes.ContainerFullBox.call(this,"stsd",e)},b.boxes.SampleDescriptionBox.prototype=Object.create(b.boxes.ContainerFullBox.prototype),b.boxes.SampleDescriptionBox.prototype.constructor=b.boxes.SampleDescriptionBox,b.boxes.SampleDescriptionBox.prototype.computeLength=function(){b.boxes.ContainerFullBox.prototype.computeLength.call(this,!0)},b.boxes.SampleDescriptionBox.prototype.read=function(e,t,n){return b.boxes.ContainerFullBox.prototype.read.call(this,e,t,n,!0)},b.boxes.SampleDescriptionBox.prototype.write=function(e,t){return this.entry_count=this.boxes.length,b.boxes.ContainerFullBox.prototype.write.call(this,e,t,!0)},b.boxes.SampleDependencyTableBox=function(e){b.boxes.FullBox.call(this,"sdtp",e)},b.boxes.SampleDependencyTableBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.SampleDependencyTableBox.prototype.constructor=b.boxes.SampleDependencyTableBox,b.boxes.SampleDependencyTableBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=b.fields.FIELD_UINT8.getLength()*this.sample_dependency_table.length},b.boxes.SampleDependencyTableBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),this.sample_dependency_table=this._readArrayData(e,b.fields.FIELD_UINT8),this.localPos},b.boxes.SampleDependencyTableBox.prototype.write=function(e,t){return b.boxes.FullBox.prototype.write.call(this,e,t),this._writeArrayData(e,b.fields.FIELD_UINT8,this.sample_dependency_table),this.localPos},b.boxes.SampleEntryBox=function(e,t){b.boxes.Box.call(this,e,t)},b.boxes.SampleEntryBox.prototype=Object.create(b.boxes.Box.prototype),b.boxes.SampleEntryBox.prototype.constructor=b.boxes.SampleEntryBox,b.boxes.SampleEntryBox.prototype.computeLength=function(){b.boxes.Box.prototype.computeLength.call(this),this.size+=b.fields.FIELD_UINT16.getLength()+6*b.fields.FIELD_UINT8.getLength()},b.boxes.SampleEntryBox.prototype.read=function(e,t,n){return this.localPos=t,this.localEnd=n,this.reserved=this._readArrayFieldData(e,b.fields.FIELD_UINT8,6),this.data_reference_index=this._readData(e,b.fields.FIELD_UINT16),this.localPos},b.boxes.SampleEntryBox.prototype.write=function(e,t){return b.boxes.Box.prototype.write.call(this,e,t),this._writeArrayData(e,b.fields.FIELD_UINT8,this.reserved),this._writeData(e,b.fields.FIELD_UINT16,this.data_reference_index),this.localPos},b.boxes.VisualSampleEntryBox=function(e,t){b.boxes.SampleEntryBox.call(this,e,t)},b.boxes.VisualSampleEntryBox.prototype=Object.create(b.boxes.SampleEntryBox.prototype),b.boxes.VisualSampleEntryBox.prototype.constructor=b.boxes.VisualSampleEntryBox,b.boxes.VisualSampleEntryBox.prototype.computeLength=function(){b.boxes.SampleEntryBox.prototype.computeLength.call(this),this.size+=7*b.fields.FIELD_UINT16.getLength()+3*b.fields.FIELD_UINT32.getLength(),this.size+=3*b.fields.FIELD_UINT32.getLength(),this.size+=32},b.boxes.VisualSampleEntryBox.prototype.read=function(e,t,n){return b.boxes.SampleEntryBox.prototype.read.call(this,e,t,n),this.pre_defined=this._readData(e,b.fields.FIELD_UINT16),this.reserved_2=this._readData(e,b.fields.FIELD_UINT16),this.pre_defined_2=this._readArrayFieldData(e,b.fields.FIELD_UINT32,3),this.width=this._readData(e,b.fields.FIELD_UINT16),this.height=this._readData(e,b.fields.FIELD_UINT16),this.horizresolution=this._readData(e,b.fields.FIELD_UINT32),this.vertresolution=this._readData(e,b.fields.FIELD_UINT32),this.reserved_3=this._readData(e,b.fields.FIELD_UINT32),this.frame_count=this._readData(e,b.fields.FIELD_UINT16),this.compressorname=this._readArrayFieldData(e,b.fields.FIELD_UINT8,32),this.depth=this._readData(e,b.fields.FIELD_UINT16),this.pre_defined_3=this._readData(e,b.fields.FIELD_INT16),this.localPos},b.boxes.VisualSampleEntryBox.prototype.write=function(e,t){return b.boxes.SampleEntryBox.prototype.write.call(this,e,t),this._writeData(e,b.fields.FIELD_UINT16,this.pre_defined),this._writeData(e,b.fields.FIELD_UINT16,this.reserved_2),this._writeArrayData(e,b.fields.FIELD_UINT32,this.pre_defined_2),this._writeData(e,b.fields.FIELD_UINT16,this.width),this._writeData(e,b.fields.FIELD_UINT16,this.height),this._writeData(e,b.fields.FIELD_UINT32,this.horizresolution),this._writeData(e,b.fields.FIELD_UINT32,this.vertresolution),this._writeData(e,b.fields.FIELD_UINT32,this.reserved_3),this._writeData(e,b.fields.FIELD_UINT16,this.frame_count),this._writeArrayData(e,b.fields.FIELD_UINT8,this.compressorname),this._writeData(e,b.fields.FIELD_UINT16,this.depth),this._writeData(e,b.fields.FIELD_INT16,this.pre_defined_3),this.localPos},b.boxes.VisualSampleEntryContainerBox=function(e,t){b.boxes.VisualSampleEntryBox.call(this,e,t),this.boxes=[]},b.boxes.VisualSampleEntryContainerBox.prototype=Object.create(b.boxes.VisualSampleEntryBox.prototype),b.boxes.VisualSampleEntryContainerBox.prototype.constructor=b.boxes.VisualSampleEntryContainerBox,b.boxes.VisualSampleEntryContainerBox.prototype.computeLength=function(){b.boxes.VisualSampleEntryBox.prototype.computeLength.call(this);var e=0;for(e=0;e<this.boxes.length;e++)this.boxes[e].computeLength(),this.size+=this.boxes[e].size},b.boxes.VisualSampleEntryContainerBox.prototype.read=function(e,t,n){b.boxes.VisualSampleEntryBox.prototype.read.call(this,e,t,n);var i,r,o=0,s=0,a=null;while(this.localPos<this.localEnd){if(o=b.fields.FIELD_UINT32.read(e,this.localPos),i=b.fields.readString(e,this.localPos+4,4),"uuid"==i&&(s=1==o?16:8,a=new b.fields.ArrayField(b.fields.FIELD_INT8,16).read(e,this.localPos+s,this.localPos+s+16),a=JSON.stringify(a)),r=b.createBox(i,o,a),this.localPos="uuid"===i?r.read(e,this.localPos+16*b.fields.FIELD_INT8.getLength()+8,this.localPos+o):r.read(e,this.localPos+8,this.localPos+o),b.debug&&(r.__sourceBuffer=e.subarray(this.localPos-r.size,this.localPos)),this.boxes.push(r),r.size<=0||null===r.size)throw new b.ParseException("Problem on size of box "+r.boxtype+", parsing stopped to avoid infinite loop");if(!r.boxtype)throw new b.ParseException("Problem on unknown box, parsing stopped to avoid infinite loop")}return this.localPos},b.boxes.VisualSampleEntryContainerBox.prototype.write=function(e,t){b.boxes.VisualSampleEntryBox.prototype.write.call(this,e,t);var n=0;for(n=0;n<this.boxes.length;n++)this.localPos=this.boxes[n].write(e,this.localPos);return this.localPos},b.boxes.AVC1VisualSampleEntryBox=function(e){b.boxes.VisualSampleEntryContainerBox.call(this,"avc1",e)},b.boxes.AVC1VisualSampleEntryBox.prototype=Object.create(b.boxes.VisualSampleEntryContainerBox.prototype),b.boxes.AVC1VisualSampleEntryBox.prototype.constructor=b.boxes.AVC1VisualSampleEntryBox,b.boxes.EncryptedVideoBox=function(e){b.boxes.VisualSampleEntryContainerBox.call(this,"encv",e)},b.boxes.EncryptedVideoBox.prototype=Object.create(b.boxes.VisualSampleEntryContainerBox.prototype),b.boxes.EncryptedVideoBox.prototype.constructor=b.boxes.EncryptedVideoBox,b.boxes.AVCConfigurationBox=function(e){b.boxes.Box.call(this,"avcC",e)},b.boxes.AVCConfigurationBox.prototype=Object.create(b.boxes.Box.prototype),b.boxes.AVCConfigurationBox.prototype.constructor=b.boxes.AVCConfigurationBox,b.boxes.AVCConfigurationBox.prototype.computeLength=function(){b.boxes.Box.prototype.computeLength.call(this),this.size+=4*b.fields.FIELD_UINT8.getLength()+3*b.fields.FIELD_UINT8.getLength(),this.size+=this._getNALLength(this.numOfSequenceParameterSets,this.SPS_NAL),this.size+=this._getNALLength(this.numOfPictureParameterSets,this.PPS_NAL)},b.boxes.AVCConfigurationBox.prototype._getNALLength=function(e,t){var n=0,i=0;for(i=0;i<e;i++)n+=b.fields.FIELD_UINT16.getLength()+t[i].NAL_length;return n},b.boxes.AVCConfigurationBox.prototype.read=function(e,t,n){return this.localPos=t,this.localEnd=n,this.configurationVersion=this._readData(e,b.fields.FIELD_UINT8),this.AVCProfileIndication=this._readData(e,b.fields.FIELD_UINT8),this.profile_compatibility=this._readData(e,b.fields.FIELD_UINT8),this.AVCLevelIndication=this._readData(e,b.fields.FIELD_UINT8),this.temp=this._readData(e,b.fields.FIELD_UINT8),this.lengthSizeMinusOne=3&this.temp,this.numOfSequenceParameterSets_tmp=this._readData(e,b.fields.FIELD_UINT8),this.numOfSequenceParameterSets=31&this.numOfSequenceParameterSets_tmp,this.SPS_NAL=this._readNAL(e,this.numOfSequenceParameterSets),this.numOfPictureParameterSets=this._readData(e,b.fields.FIELD_UINT8),this.PPS_NAL=this._readNAL(e,this.numOfPictureParameterSets),this.localPos},b.boxes.AVCConfigurationBox.prototype._readNAL=function(e,t){var n=[],i=0,r={};for(i=0;i<t;i++)r={},r.NAL_length=this._readData(e,b.fields.FIELD_UINT16),r.NAL=e.subarray(this.localPos,this.localPos+r.NAL_length),this.localPos+=r.NAL_length,n.push(r);return n},b.boxes.AVCConfigurationBox.prototype.write=function(e,t){return b.boxes.Box.prototype.write.call(this,e,t),this._writeData(e,b.fields.FIELD_UINT8,this.configurationVersion),this._writeData(e,b.fields.FIELD_UINT8,this.AVCProfileIndication),this._writeData(e,b.fields.FIELD_UINT8,this.profile_compatibility),this._writeData(e,b.fields.FIELD_UINT8,this.AVCLevelIndication),this.temp=252|this.lengthSizeMinusOne,this._writeData(e,b.fields.FIELD_UINT8,this.temp),this.numOfSequenceParameterSets=this.SPS_NAL.length,this.numOfSequenceParameterSets_tmp=224|this.numOfSequenceParameterSets,this._writeData(e,b.fields.FIELD_UINT8,this.numOfSequenceParameterSets_tmp),this._writeNAL(e,this.numOfSequenceParameterSets,this.SPS_NAL),this._writeData(e,b.fields.FIELD_UINT8,this.numOfPictureParameterSets),this._writeNAL(e,this.numOfPictureParameterSets,this.PPS_NAL),this.localPos},b.boxes.AVCConfigurationBox.prototype._writeNAL=function(e,t,n){var i=0;for(i=0;i<t;i++)this._writeData(e,b.fields.FIELD_UINT16,n[i].NAL_length),this._writeBuffer(e,n[i].NAL,n[i].NAL_length)},b.boxes.PixelAspectRatioBox=function(e){b.boxes.Box.call(this,"pasp",e)},b.boxes.PixelAspectRatioBox.prototype=Object.create(b.boxes.Box.prototype),b.boxes.PixelAspectRatioBox.prototype.constructor=b.boxes.PixelAspectRatioBox,b.boxes.PixelAspectRatioBox.prototype.computeLength=function(){b.boxes.Box.prototype.computeLength.call(this),this.size+=2*b.fields.FIELD_INT32.getLength()},b.boxes.PixelAspectRatioBox.prototype.read=function(e,t,n){return this.localPos=t,this.localEnd=n,this.hSpacing=this._readData(e,b.fields.FIELD_INT32),this.vSpacing=this._readData(e,b.fields.FIELD_INT32),this.localPos},b.boxes.PixelAspectRatioBox.prototype.write=function(e,t){return b.boxes.Box.prototype.write.call(this,e,t),this._writeData(e,b.fields.FIELD_INT32,this.hSpacing),this._writeData(e,b.fields.FIELD_INT32,this.vSpacing),this.localPos},b.boxes.AudioSampleEntryBox=function(e,t){b.boxes.SampleEntryBox.call(this,e,t)},b.boxes.AudioSampleEntryBox.prototype=Object.create(b.boxes.SampleEntryBox.prototype),b.boxes.AudioSampleEntryBox.prototype.constructor=b.boxes.AudioSampleEntryBox,b.boxes.AudioSampleEntryBox.prototype.computeLength=function(){b.boxes.SampleEntryBox.prototype.computeLength.call(this),this.size+=4*b.fields.FIELD_UINT16.getLength()+3*b.fields.FIELD_UINT32.getLength()},b.boxes.AudioSampleEntryBox.prototype.read=function(e,t,n){return b.boxes.SampleEntryBox.prototype.read.call(this,e,t,n),this.reserved_2=this._readArrayFieldData(e,b.fields.FIELD_UINT32,2),this.channelcount=this._readData(e,b.fields.FIELD_UINT16),this.samplesize=this._readData(e,b.fields.FIELD_UINT16),this.pre_defined=this._readData(e,b.fields.FIELD_UINT16),this.reserved_3=this._readData(e,b.fields.FIELD_UINT16),this.samplerate=this._readData(e,b.fields.FIELD_UINT32),this.localPos},b.boxes.AudioSampleEntryBox.prototype.write=function(e,t){return b.boxes.SampleEntryBox.prototype.write.call(this,e,t),this._writeArrayData(e,b.fields.FIELD_UINT32,this.reserved_2),this._writeData(e,b.fields.FIELD_UINT16,this.channelcount),this._writeData(e,b.fields.FIELD_UINT16,this.samplesize),this._writeData(e,b.fields.FIELD_UINT16,this.pre_defined),this._writeData(e,b.fields.FIELD_UINT16,this.reserved_3),this._writeData(e,b.fields.FIELD_UINT32,this.samplerate),this.localPos},b.boxes.AudioSampleEntryContainerBox=function(e,t){b.boxes.AudioSampleEntryBox.call(this,e,t),this.boxes=[]},b.boxes.AudioSampleEntryContainerBox.prototype=Object.create(b.boxes.AudioSampleEntryBox.prototype),b.boxes.AudioSampleEntryContainerBox.prototype.constructor=b.boxes.AudioSampleEntryContainerBox,b.boxes.AudioSampleEntryContainerBox.prototype.computeLength=function(){b.boxes.AudioSampleEntryBox.prototype.computeLength.call(this);var e=0;for(e=0;e<this.boxes.length;e++)this.boxes[e].computeLength(),this.size+=this.boxes[e].size},b.boxes.AudioSampleEntryContainerBox.prototype.read=function(e,t,n){b.boxes.AudioSampleEntryBox.prototype.read.call(this,e,t,n);var i,r,o=0,s=0,a=null;while(this.localPos<this.localEnd){if(o=b.fields.FIELD_UINT32.read(e,this.localPos),i=b.fields.readString(e,this.localPos+4,4),"uuid"==i&&(s=1==o?16:8,a=new b.fields.ArrayField(b.fields.FIELD_INT8,16).read(e,this.localPos+s,this.localPos+s+16),a=JSON.stringify(a)),r=b.createBox(i,o,a),this.localPos="uuid"===i?r.read(e,this.localPos+16*b.fields.FIELD_INT8.getLength()+8,this.localPos+o):r.read(e,this.localPos+8,this.localPos+o),b.debug&&(r.__sourceBuffer=e.subarray(this.localPos-r.size,this.localPos)),this.boxes.push(r),r.size<=0||null===r.size)throw new b.ParseException("Problem on size of box "+r.boxtype+", parsing stopped to avoid infinite loop");if(!r.boxtype)throw new b.ParseException("Problem on unknown box, parsing stopped to avoid infinite loop")}return this.localPos},b.boxes.AudioSampleEntryContainerBox.prototype.write=function(e,t){b.boxes.AudioSampleEntryBox.prototype.write.call(this,e,t);var n=0;for(n=0;n<this.boxes.length;n++)this.localPos=this.boxes[n].write(e,this.localPos);return this.localPos},b.boxes.MP4AudioSampleEntryBox=function(e){b.boxes.AudioSampleEntryContainerBox.call(this,"mp4a",e)},b.boxes.MP4AudioSampleEntryBox.prototype=Object.create(b.boxes.AudioSampleEntryContainerBox.prototype),b.boxes.MP4AudioSampleEntryBox.prototype.constructor=b.boxes.MP4AudioSampleEntryBox,b.boxes.EncryptedAudioBox=function(e){b.boxes.AudioSampleEntryContainerBox.call(this,"enca",e)},b.boxes.EncryptedAudioBox.prototype=Object.create(b.boxes.AudioSampleEntryContainerBox.prototype),b.boxes.EncryptedAudioBox.prototype.constructor=b.boxes.EncryptedAudioBox,b.boxes.ESDBox=function(e){b.boxes.FullBox.call(this,"esds",e)},b.boxes.ESDBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.ESDBox.prototype.constructor=b.boxes.ESDBox,b.boxes.ESDBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=2*b.fields.FIELD_UINT8.getLength()+this.ES_length},b.boxes.ESDBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),this.ES_tag=this._readData(e,b.fields.FIELD_UINT8),this.ES_length=this._readData(e,b.fields.FIELD_UINT8),this.ES_data=e.subarray(this.localPos,this.localPos+this.ES_length),this.localPos+=this.ES_length,this.localPos},b.boxes.ESDBox.prototype.write=function(e,t){return b.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,b.fields.FIELD_UINT8,this.ES_tag),this._writeData(e,b.fields.FIELD_UINT8,this.ES_length),this._writeBuffer(e,this.ES_data,this.ES_length),this.localPos},b.boxes.SampleSizeBox=function(e){b.boxes.FullBox.call(this,"stsz",e)},b.boxes.SampleSizeBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.SampleSizeBox.prototype.constructor=b.boxes.SampleSizeBox,b.boxes.SampleSizeBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=2*b.fields.FIELD_UINT32.getLength()+b.fields.FIELD_UINT32.getLength()*this.sample_count},b.boxes.SampleSizeBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),this.sample_size=this._readData(e,b.fields.FIELD_UINT32),this.sample_count=this._readData(e,b.fields.FIELD_UINT32),this.entries=this._readArrayFieldData(e,b.fields.FIELD_UINT32,this.sample_count),this.localPos},b.boxes.SampleSizeBox.prototype.write=function(e,t){b.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,b.fields.FIELD_UINT32,this.sample_size),this._writeData(e,b.fields.FIELD_UINT32,this.sample_count),n=0;n<this.sample_count;n++)this._writeData(e,b.fields.FIELD_UINT32,this.entries[n]);return this.localPos},b.boxes.ProtectionSystemSpecificHeaderBox=function(e){b.boxes.FullBox.call(this,"pssh",e)},b.boxes.ProtectionSystemSpecificHeaderBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.ProtectionSystemSpecificHeaderBox.prototype.constructor=b.boxes.ProtectionSystemSpecificHeaderBox,b.boxes.ProtectionSystemSpecificHeaderBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=16*b.fields.FIELD_UINT8.getLength(),this.size+=b.fields.FIELD_UINT32.getLength(),this.size+=b.fields.FIELD_UINT8.getLength()*this.DataSize},b.boxes.ProtectionSystemSpecificHeaderBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),this.SystemID=this._readArrayFieldData(e,b.fields.FIELD_UINT8,16),this.DataSize=this._readData(e,b.fields.FIELD_UINT32),this.Data=this._readArrayFieldData(e,b.fields.FIELD_UINT8,this.DataSize),this.localPos},b.boxes.ProtectionSystemSpecificHeaderBox.prototype.write=function(e,t){b.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(n=0;n<16;n++)this._writeData(e,b.fields.FIELD_UINT8,this.SystemID[n]);for(this._writeData(e,b.fields.FIELD_UINT32,this.DataSize),n=0;n<this.DataSize;n++)this._writeData(e,b.fields.FIELD_UINT8,this.Data[n]);return this.localPos},b.boxes.SampleEncryptionBox=function(e){b.boxes.FullBox.call(this,"senc",e)},b.boxes.SampleEncryptionBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.SampleEncryptionBox.prototype.constructor=b.boxes.SampleEncryptionBox,b.boxes.SampleEncryptionBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this);var e=0,t=0;for(this.size+=b.fields.FIELD_UINT32.getLength(),1&this.flags&&(this.size+=b.fields.FIELD_UINT8.getLength()),e=0;e<this.sample_count;e++)if(this.size+=8,2&this.flags)for(this.size+=b.fields.FIELD_UINT16.getLength(),t=0;t<this.entry[e].NumberOfEntries;t++)this.size+=b.fields.FIELD_UINT16.getLength(),this.size+=b.fields.FIELD_UINT32.getLength()},b.boxes.SampleEncryptionBox.prototype.write=function(e,t){b.boxes.FullBox.prototype.write.call(this,e,t);var n=0,i=0;for(this._writeData(e,b.fields.FIELD_UINT32,this.sample_count),1&this.flags&&this._writeData(e,b.fields.FIELD_UINT8,this.IV_size),n=0;n<this.sample_count;n++)if(this._writeBuffer(e,this.entry[n].InitializationVector,8),2&this.flags)for(this._writeData(e,b.fields.FIELD_UINT16,this.entry[n].NumberOfEntries),i=0;i<this.entry[n].NumberOfEntries;i++)this._writeData(e,b.fields.FIELD_UINT16,this.entry[n].clearAndCryptedData[i].BytesOfClearData),this._writeData(e,b.fields.FIELD_UINT32,this.entry[n].clearAndCryptedData[i].BytesOfEncryptedData);return this.localPos},b.boxes.SampleEncryptionBox.prototype.read=function(e,t,n){b.boxes.FullBox.prototype.read.call(this,e,t,n);var i=0,r=0,o={},s={};for(this.sample_count=this._readData(e,b.fields.FIELD_UINT32),1&this.flags&&(this.IV_size=this._readData(e,b.fields.FIELD_UINT8)),this.entry=[],i=0;i<this.sample_count;i++){if(s={},s.InitializationVector=e.subarray(this.localPos,this.localPos+8),this.localPos+=8,2&this.flags)for(s.NumberOfEntries=this._readData(e,b.fields.FIELD_UINT16),s.clearAndCryptedData=[],r=0;r<s.NumberOfEntries;r++)o={},o.BytesOfClearData=this._readData(e,b.fields.FIELD_UINT16),o.BytesOfEncryptedData=this._readData(e,b.fields.FIELD_UINT32),s.clearAndCryptedData.push(o);this.entry.push(s)}return this.localPos},b.boxes.SampleAuxiliaryInformationSizesBox=function(e){b.boxes.FullBox.call(this,"saiz",e)},b.boxes.SampleAuxiliaryInformationSizesBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.SampleAuxiliaryInformationSizesBox.prototype.constructor=b.boxes.SampleAuxiliaryInformationSizesBox,b.boxes.SampleAuxiliaryInformationSizesBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),1&this.flags&&(this.size+=2*b.fields.FIELD_UINT32.getLength()),this.size+=b.fields.FIELD_UINT8.getLength()+b.fields.FIELD_UINT32.getLength(),0===this.default_sample_info_size&&(this.size+=b.fields.FIELD_UINT8.getLength()*this.sample_count)},b.boxes.SampleAuxiliaryInformationSizesBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),1&this.flags&&(this.aux_info_type=this._readData(e,b.fields.FIELD_UINT32),this.aux_info_type_parameter=this._readData(e,b.fields.FIELD_UINT32)),this.default_sample_info_size=this._readData(e,b.fields.FIELD_UINT8),this.sample_count=this._readData(e,b.fields.FIELD_UINT32),0===this.default_sample_info_size&&(this.sample_info_size=this._readArrayFieldData(e,b.fields.FIELD_UINT8,this.sample_count)),this.localPos},b.boxes.SampleAuxiliaryInformationSizesBox.prototype.write=function(e,t){b.boxes.FullBox.prototype.write.call(this,e,t);var n=0;if(1&this.flags&&(this._writeData(e,b.fields.FIELD_UINT32,this.aux_info_type),this._writeData(e,b.fields.FIELD_UINT32,this.aux_info_type_parameter)),this._writeData(e,b.fields.FIELD_UINT8,this.default_sample_info_size),this._writeData(e,b.fields.FIELD_UINT32,this.sample_count),0===this.default_sample_info_size)for(n=0;n<this.sample_count;n++)this._writeData(e,b.fields.FIELD_UINT8,this.sample_info_size[n]);return this.localPos},b.boxes.SampleAuxiliaryInformationOffsetsBox=function(e){b.boxes.FullBox.call(this,"saio",e)},b.boxes.SampleAuxiliaryInformationOffsetsBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.SampleAuxiliaryInformationOffsetsBox.prototype.constructor=b.boxes.SampleAuxiliaryInformationOffsetsBox,b.boxes.SampleAuxiliaryInformationOffsetsBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),1&this.flags&&(this.size+=2*b.fields.FIELD_UINT32.getLength()),this.size+=b.fields.FIELD_UINT32.getLength(),0===this.version?this.size+=b.fields.FIELD_UINT32.getLength()*this.entry_count:this.size+=b.fields.FIELD_UINT64.getLength()*this.entry_count},b.boxes.SampleAuxiliaryInformationOffsetsBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),1&this.flags&&(this.aux_info_type=this._readData(e,b.fields.FIELD_UINT32),this.aux_info_type_parameter=this._readData(e,b.fields.FIELD_UINT32)),this.entry_count=this._readData(e,b.fields.FIELD_UINT32),0===this.version?this.offset=this._readArrayFieldData(e,b.fields.FIELD_UINT32,this.entry_count):this.offset=this._readArrayFieldData(e,b.fields.FIELD_UINT64,this.entry_count),this.localPos},b.boxes.SampleAuxiliaryInformationOffsetsBox.prototype.write=function(e,t){b.boxes.FullBox.prototype.write.call(this,e,t);var n=0;if(1&this.flags&&(this._writeData(e,b.fields.FIELD_UINT32,this.aux_info_type),this._writeData(e,b.fields.FIELD_UINT32,this.aux_info_type_parameter)),this._writeData(e,b.fields.FIELD_UINT32,this.entry_count),0===this.version)for(n=0;n<this.entry_count;n++)this._writeData(e,b.fields.FIELD_UINT32,this.offset[n]);else for(n=0;n<this.entry_count;n++)this._writeData(e,b.fields.FIELD_UINT64,this.offset[n]);return this.localPos},b.boxes.ProtectionSchemeInformationBox=function(e){b.boxes.ContainerBox.call(this,"sinf",e)},b.boxes.ProtectionSchemeInformationBox.prototype=Object.create(b.boxes.ContainerBox.prototype),b.boxes.ProtectionSchemeInformationBox.prototype.constructor=b.boxes.ProtectionSchemeInformationBox,b.boxes.SchemeInformationBox=function(e){b.boxes.ContainerBox.call(this,"schi",e)},b.boxes.SchemeInformationBox.prototype=Object.create(b.boxes.ContainerBox.prototype),b.boxes.SchemeInformationBox.prototype.constructor=b.boxes.SchemeInformationBox,b.boxes.TrackEncryptionBox=function(e){b.boxes.FullBox.call(this,"tenc",e)},b.boxes.TrackEncryptionBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.TrackEncryptionBox.prototype.constructor=b.boxes.TrackEncryptionBox,b.boxes.TrackEncryptionBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=b.fields.FIELD_BIT24.getLength(),this.size+=b.fields.FIELD_UINT8.getLength(),this.size+=16*b.fields.FIELD_UINT8.getLength()},b.boxes.TrackEncryptionBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),this.default_IsEncrypted=this._readData(e,b.fields.FIELD_BIT24),this.default_IV_size=this._readData(e,b.fields.FIELD_UINT8),this.default_KID=this._readArrayFieldData(e,b.fields.FIELD_UINT8,16),this.localPos},b.boxes.TrackEncryptionBox.prototype.write=function(e,t){return b.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,b.fields.FIELD_BIT24,this.default_IsEncrypted),this._writeData(e,b.fields.FIELD_UINT8,this.default_IV_size),this._writeArrayData(e,b.fields.FIELD_UINT8,this.default_KID),this.localPos},b.boxes.SchemeTypeBox=function(e){b.boxes.FullBox.call(this,"schm",e)},b.boxes.SchemeTypeBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.SchemeTypeBox.prototype.constructor=b.boxes.SchemeTypeBox,b.boxes.SchemeTypeBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=2*b.fields.FIELD_UINT32.getLength(),1&this.flags&&(this.size+=b.fields.FIELD_STRING.getLength(this.scheme_uri))},b.boxes.SchemeTypeBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),this.scheme_type=this._readData(e,b.fields.FIELD_UINT32),this.scheme_version=this._readData(e,b.fields.FIELD_UINT32),1&this.flags&&(this.scheme_uri=this._readData(e,b.fields.FIELD_STRING)),this.localPos},b.boxes.SchemeTypeBox.prototype.write=function(e,t){return b.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,b.fields.FIELD_UINT32,this.scheme_type),this._writeData(e,b.fields.FIELD_UINT32,this.scheme_version),1&this.flags&&this._writeData(e,b.fields.FIELD_STRING,this.scheme_uri),this.localPos},b.boxes.EditListBox=function(e){b.boxes.FullBox.call(this,"elst",e),this.entries=[]},b.boxes.EditListBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.EditListBox.prototype.constructor=b.boxes.EditListBox,b.boxes.EditListBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=b.fields.FIELD_UINT32.getLength(),1===this.version?this.size+=(2*b.fields.FIELD_UINT64.getLength()+2*b.fields.FIELD_UINT16.getLength())*this.entry_count:this.size+=(2*b.fields.FIELD_UINT32.getLength()+2*b.fields.FIELD_UINT16.getLength())*this.entry_count},b.boxes.EditListBox.prototype.read=function(e,t,n){b.boxes.FullBox.prototype.read.call(this,e,t,n);var i=0,r={};for(this.entry_count=this._readData(e,b.fields.FIELD_UINT32),i=0;i<this.entry_count;i++)r={},1===this.version?(r.segment_duration=this._readData(e,b.fields.FIELD_UINT64),r.media_time=this._readData(e,b.fields.FIELD_UINT64)):(r.segment_duration=this._readData(e,b.fields.FIELD_UINT32),r.media_time=this._readData(e,b.fields.FIELD_UINT32)),r.media_rate_integer=this._readData(e,b.fields.FIELD_UINT16),r.media_rate_fraction=this._readData(e,b.fields.FIELD_UINT16),this.entries.push(r);return this.localPos},b.boxes.EditListBox.prototype.write=function(e,t){b.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,b.fields.FIELD_UINT32,this.entry_count),n=0;n<this.entry_count;n++)1===this.version?(this._writeData(e,b.fields.FIELD_UINT64,this.entries[n].segment_duration),this._writeData(e,b.fields.FIELD_UINT64,this.entries[n].media_time)):(this._writeData(e,b.fields.FIELD_UINT32,this.entries[n].segment_duration),this._writeData(e,b.fields.FIELD_UINT32,this.entries[n].media_time)),this._writeData(e,b.fields.FIELD_UINT16,this.entries[n].media_rate_integer),this._writeData(e,b.fields.FIELD_UINT16,this.entries[n].media_rate_fraction);return this.localPos},b.boxes.HintMediaHeaderBox=function(e){b.boxes.FullBox.call(this,"hmhd",e)},b.boxes.HintMediaHeaderBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.HintMediaHeaderBox.prototype.constructor=b.boxes.HintMediaHeaderBox,b.boxes.HintMediaHeaderBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=2*b.fields.FIELD_UINT16.getLength(),this.size+=3*b.fields.FIELD_UINT32.getLength()},b.boxes.HintMediaHeaderBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),this.maxPDUsize=this._readData(e,b.fields.FIELD_UINT16),this.avgPDUsize=this._readData(e,b.fields.FIELD_UINT16),this.maxbitrate=this._readData(e,b.fields.FIELD_UINT32),this.avgbitrate=this._readData(e,b.fields.FIELD_UINT32),this.reserved=this._readData(e,b.fields.FIELD_UINT32),this.localPos},b.boxes.HintMediaHeaderBox.prototype.write=function(e,t){return b.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,b.fields.FIELD_UINT16,this.maxPDUsize),this._writeData(e,b.fields.FIELD_UINT16,this.avgPDUsize),this._writeData(e,b.fields.FIELD_UINT32,this.maxbitrate),this._writeData(e,b.fields.FIELD_UINT32,this.avgbitrate),this._writeData(e,b.fields.FIELD_UINT32,this.reserved),this.localPos},b.boxes.NullMediaHeaderBox=function(e){b.boxes.FullBox.call(this,"nmhd",e)},b.boxes.NullMediaHeaderBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.NullMediaHeaderBox.prototype.constructor=b.boxes.NullMediaHeaderBox,b.boxes.CompositionOffsetBox=function(e){b.boxes.FullBox.call(this,"ctts",e),this.entries=[]},b.boxes.CompositionOffsetBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.CompositionOffsetBox.prototype.constructor=b.boxes.CompositionOffsetBox,b.boxes.CompositionOffsetBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=b.fields.FIELD_UINT32.getLength(),0===this.version?this.size+=2*b.fields.FIELD_UINT32.getLength()*this.entry_count:this.size+=(b.fields.FIELD_UINT32.getLength()+b.fields.FIELD_INT32.getLength())*this.entry_count},b.boxes.CompositionOffsetBox.prototype.read=function(e,t,n){b.boxes.FullBox.prototype.read.call(this,e,t,n);var i=0,r={};for(this.entry_count=this._readData(e,b.fields.FIELD_UINT32),i=0;i<this.entry_count;i++)r={},0===this.version?(r.sample_count=this._readData(e,b.fields.FIELD_UINT32),r.sample_offset=this._readData(e,b.fields.FIELD_UINT32)):(r.sample_count=this._readData(e,b.fields.FIELD_UINT32),r.sample_offset=this._readData(e,b.fields.FIELD_INT32)),this.entries.push(r);return this.localPos},b.boxes.CompositionOffsetBox.prototype.write=function(e,t){b.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,b.fields.FIELD_UINT32,this.entry_count),n=0;n<this.entry_count;n++)0===this.version?(this._writeData(e,b.fields.FIELD_UINT32,this.entries[n].sample_count),this._writeData(e,b.fields.FIELD_UINT32,this.entries[n].sample_offset)):(this._writeData(e,b.fields.FIELD_UINT32,this.entries[n].sample_count),this._writeData(e,b.fields.FIELD_INT32,this.entries[n].sample_offset));return this.localPos},b.boxes.CompositionToDecodeBox=function(e){b.boxes.FullBox.call(this,"cslg",e)},b.boxes.CompositionToDecodeBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.CompositionToDecodeBox.prototype.constructor=b.boxes.CompositionToDecodeBox,b.boxes.CompositionToDecodeBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=5*b.fields.FIELD_INT32.getLength()},b.boxes.CompositionToDecodeBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),this.compositionToDTSShift=this._readData(e,b.fields.FIELD_INT32),this.leastDecodeToDisplayDelta=this._readData(e,b.fields.FIELD_INT32),this.greatestDecodeToDisplayDelta=this._readData(e,b.fields.FIELD_INT32),this.compositionStartTime=this._readData(e,b.fields.FIELD_INT32),this.compositionEndTime=this._readData(e,b.fields.FIELD_INT32),this.localPos},b.boxes.CompositionToDecodeBox.prototype.write=function(e,t){return b.boxes.FullBox.prototype.write.call(this,e,t),this._writeData(e,b.fields.FIELD_INT32,this.compositionToDTSShift),this._writeData(e,b.fields.FIELD_INT32,this.leastDecodeToDisplayDelta),this._writeData(e,b.fields.FIELD_INT32,this.greatestDecodeToDisplayDelta),this._writeData(e,b.fields.FIELD_INT32,this.compositionStartTime),this._writeData(e,b.fields.FIELD_INT32,this.compositionEndTime),this.localPos},b.boxes.SyncSampleBox=function(e){b.boxes.FullBox.call(this,"stss",e),this.entries=[]},b.boxes.SyncSampleBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.SyncSampleBox.prototype.constructor=b.boxes.SyncSampleBox,b.boxes.SyncSampleBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=b.fields.FIELD_UINT32.getLength(),this.size+=b.fields.FIELD_UINT32.getLength()*this.entry_count},b.boxes.SyncSampleBox.prototype.read=function(e,t,n){b.boxes.FullBox.prototype.read.call(this,e,t,n);var i=0,r={};for(this.entry_count=this._readData(e,b.fields.FIELD_UINT32),i=0;i<this.entry_count;i++)r={},r.sample_number=this._readData(e,b.fields.FIELD_UINT32),this.entries.push(r);return this.localPos},b.boxes.SyncSampleBox.prototype.write=function(e,t){b.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,b.fields.FIELD_UINT32,this.entry_count),n=0;n<this.entry_count;n++)this._writeData(e,b.fields.FIELD_UINT32,this.entries[n].sample_number);return this.localPos},b.boxes.TrackReferenceBox=function(e){b.boxes.FullBox.call(this,"tref",e)},b.boxes.TrackReferenceBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.TrackReferenceBox.prototype.constructor=b.boxes.TrackReferenceBox,b.boxes.TrackReferenceBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=b.fields.FIELD_UINT32.getLength()*this.track_IDs.length},b.boxes.TrackReferenceBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),this.track_IDs=this._readArrayData(e,b.fields.FIELD_UINT32),this.localPos},b.boxes.TrackReferenceBox.prototype.write=function(e,t){return b.boxes.FullBox.prototype.write.call(this,e,t),this._writeArrayData(e,b.fields.FIELD_UINT32,this.track_IDs),this.localPos},b.boxes.OriginalFormatBox=function(e){b.boxes.Box.call(this,"frma",e)},b.boxes.OriginalFormatBox.prototype=Object.create(b.boxes.Box.prototype),b.boxes.OriginalFormatBox.prototype.constructor=b.boxes.OriginalFormatBox,b.boxes.OriginalFormatBox.prototype.computeLength=function(){b.boxes.Box.prototype.computeLength.call(this),this.size+=b.fields.FIELD_UINT32.getLength()},b.boxes.OriginalFormatBox.prototype.read=function(e,t,n){return this.localPos=t,this.localEnd=n,this.data_format=this._readData(e,b.fields.FIELD_UINT32),this.localPos},b.boxes.OriginalFormatBox.prototype.write=function(e,t){return b.boxes.Box.prototype.write.call(this,e,t),this._writeData(e,b.fields.FIELD_UINT32,this.data_format),this.localPos},b.boxes.PiffSampleEncryptionBox=function(e){b.boxes.FullBox.call(this,"sepiff",e,[162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244])},b.boxes.PiffSampleEncryptionBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.PiffSampleEncryptionBox.prototype.constructor=b.boxes.PiffSampleEncryptionBox,b.boxes.PiffSampleEncryptionBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this);var e=0,t=0;for(this.size+=b.fields.FIELD_UINT32.getLength(),1&this.flags&&(this.size+=b.fields.FIELD_UINT8.getLength()),e=0;e<this.sample_count;e++)if(this.size+=8,2&this.flags)for(this.size+=b.fields.FIELD_UINT16.getLength(),t=0;t<this.entry[e].NumberOfEntries;t++)this.size+=b.fields.FIELD_UINT16.getLength(),this.size+=b.fields.FIELD_UINT32.getLength()},b.boxes.PiffSampleEncryptionBox.prototype.write=function(e,t){b.boxes.FullBox.prototype.write.call(this,e,t);var n=0,i=0;for(this._writeData(e,b.fields.FIELD_UINT32,this.sample_count),1&this.flags&&this._writeData(e,b.fields.FIELD_UINT8,this.IV_size),n=0;n<this.sample_count;n++)if(this._writeBuffer(e,this.entry[n].InitializationVector,8),2&this.flags)for(this._writeData(e,b.fields.FIELD_UINT16,this.entry[n].NumberOfEntries),i=0;i<this.entry[n].NumberOfEntries;i++)this._writeData(e,b.fields.FIELD_UINT16,this.entry[n].clearAndCryptedData[i].BytesOfClearData),this._writeData(e,b.fields.FIELD_UINT32,this.entry[n].clearAndCryptedData[i].BytesOfEncryptedData);return this.localPos},b.boxes.PiffSampleEncryptionBox.prototype.read=function(e,t,n){b.boxes.FullBox.prototype.read.call(this,e,t,n);var i=0,r=0,o={},s={};for(this.sample_count=this._readData(e,b.fields.FIELD_UINT32),1&this.flags&&(this.IV_size=this._readData(e,b.fields.FIELD_UINT8)),this.entry=[],i=0;i<this.sample_count;i++){if(s={},s.InitializationVector=e.subarray(this.localPos,this.localPos+8),this.localPos+=8,2&this.flags)for(s.NumberOfEntries=this._readData(e,b.fields.FIELD_UINT16),s.clearAndCryptedData=[],r=0;r<s.NumberOfEntries;r++)o={},o.BytesOfClearData=this._readData(e,b.fields.FIELD_UINT16),o.BytesOfEncryptedData=this._readData(e,b.fields.FIELD_UINT32),s.clearAndCryptedData.push(o);this.entry.push(s)}return this.localPos},b.boxes.PiffTrackEncryptionBox=function(e){b.boxes.FullBox.call(this,"tepiff",e,[137,116,219,206,123,231,76,81,132,249,113,72,249,136,37,84])},b.boxes.PiffTrackEncryptionBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.PiffTrackEncryptionBox.prototype.constructor=b.boxes.PiffTrackEncryptionBox,b.boxes.PiffProtectionSystemSpecificHeaderBox=function(e){b.boxes.FullBox.call(this,"psshpiff",e,[208,138,79,24,16,243,74,130,182,200,50,216,171,161,131,211])},b.boxes.PiffProtectionSystemSpecificHeaderBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.PiffProtectionSystemSpecificHeaderBox.prototype.constructor=b.boxes.PiffProtectionSystemSpecificHeaderBox,b.boxes.TfxdBox=function(e){b.boxes.FullBox.call(this,"tfxd",e,[109,29,155,5,66,213,68,230,128,226,20,29,175,247,87,178])},b.boxes.TfxdBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.TfxdBox.prototype.constructor=b.boxes.TfxdBox,b.boxes.TfxdBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),1===this.version?this.size+=2*b.fields.FIELD_UINT64.getLength():this.size+=2*b.fields.FIELD_UINT32.getLength()},b.boxes.TfxdBox.prototype.write=function(e,t){return b.boxes.FullBox.prototype.write.call(this,e,t),1===this.version?(this._writeData(e,b.fields.FIELD_UINT64,this.fragment_absolute_time),this._writeData(e,b.fields.FIELD_UINT64,this.fragment_duration)):(this._writeData(e,b.fields.FIELD_UINT32,this.fragment_absolute_time),this._writeData(e,b.fields.FIELD_UINT32,this.fragment_duration)),this.localPos},b.boxes.TfxdBox.prototype.read=function(e,t,n){return b.boxes.FullBox.prototype.read.call(this,e,t,n),1===this.version?(this.fragment_absolute_time=this._readData(e,b.fields.FIELD_UINT64),this.fragment_duration=this._readData(e,b.fields.FIELD_UINT64)):(this.fragment_absolute_time=this._readData(e,b.fields.FIELD_UINT32),this.fragment_duration=this._readData(e,b.fields.FIELD_UINT32)),this.localPos},b.boxes.TfrfBox=function(e){b.boxes.FullBox.call(this,"tfrf",e,[212,128,126,242,202,57,70,149,142,84,38,203,158,70,167,159])},b.boxes.TfrfBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.TfrfBox.prototype.constructor=b.boxes.TfrfBox,b.boxes.TfrfBox.prototype.computeLength=function(){b.boxes.FullBox.prototype.computeLength.call(this),this.size+=b.fields.FIELD_UINT8.getLength(),1===this.version?this.size+=2*b.fields.FIELD_UINT64.getLength()*this.fragment_count:this.size+=2*b.fields.FIELD_UINT32.getLength()*this.fragment_count},b.boxes.TfrfBox.prototype.write=function(e,t){b.boxes.FullBox.prototype.write.call(this,e,t);var n=0;for(this._writeData(e,b.fields.FIELD_UINT8,this.fragment_count),n=0;n<this.fragment_count;n++)1===this.version?(this._writeData(e,b.fields.FIELD_UINT64,this.entry[n].fragment_absolute_time),this._writeData(e,b.fields.FIELD_UINT64,this.entry[n].fragment_duration)):(this._writeData(e,b.fields.FIELD_UINT32,this.entry[n].fragment_absolute_time),this._writeData(e,b.fields.FIELD_UINT32,this.entry[n].fragment_duration));return this.localPos},b.boxes.TfrfBox.prototype.read=function(e,t,n){b.boxes.FullBox.prototype.read.call(this,e,t,n);var i=0,r={};for(this.fragment_count=this._readData(e,b.fields.FIELD_UINT8),this.entry=[],i=0;i<this.fragment_count;i++)r={},1===this.version?(r.fragment_absolute_time=this._readData(e,b.fields.FIELD_UINT64),r.fragment_duration=this._readData(e,b.fields.FIELD_UINT64)):(r.fragment_absolute_time=this._readData(e,b.fields.FIELD_UINT32),r.fragment_duration=this._readData(e,b.fields.FIELD_UINT32)),this.entry.push(r);return this.localPos},b.boxes.SubSampleInformationBox=function(e){b.boxes.FullBox.call(this,"subs",e)},b.boxes.SubSampleInformationBox.prototype=Object.create(b.boxes.FullBox.prototype),b.boxes.SubSampleInformationBox.prototype.constructor=b.boxes.SubSampleInformationBox,b.boxes.SubSampleInformationBox.prototype.computeLength=function(){for(b.boxes.FullBox.prototype.computeLength.call(this),this.size+=b.fields.FIELD_UINT32.getLength(),i=0;i<this.entry_count;i++)if(this.size+=b.fields.FIELD_UINT32.getLength(),this.size+=b.fields.FIELD_UINT16.getLength(),this.entry[i].subsample_count>0)for(j=0;j<this.entry[i].subsample_count;j++)1===this.version?this.size+=b.fields.FIELD_UINT32.getLength():this.size+=b.fields.FIELD_UINT16.getLength(),this.size+=b.fields.FIELD_UINT8.getLength(),this.size+=b.fields.FIELD_UINT8.getLength(),this.size+=b.fields.FIELD_UINT32.getLength()},b.boxes.SubSampleInformationBox.prototype.read=function(e,t,n){b.boxes.FullBox.prototype.read.call(this,e,t,n);var i=0,r=0,o={},s={};for(this.entry_count=this._readData(e,b.fields.FIELD_UINT32),this.entry=[],i=0;i<this.entry_count;i++){if(o={},o.sample_delta=this._readData(e,b.fields.FIELD_UINT32),o.subsample_count=this._readData(e,b.fields.FIELD_UINT16),o.subsample_count>0)for(o.subSampleEntries=[],r=0;r<o.subsample_count;r++)s={},1===this.version?s.subsample_size=this._readData(e,b.fields.FIELD_UINT32):s.subsample_size=this._readData(e,b.fields.FIELD_UINT16),s.subsample_priority=this._readData(e,b.fields.FIELD_UINT8),s.discardable=this._readData(e,b.fields.FIELD_UINT8),s.reserved=this._readData(e,b.fields.FIELD_UINT32),o.subSampleEntries.push(s);this.entry.push(o)}return this.localPos},b.boxes.SubSampleInformationBox.prototype.write=function(e,t){b.boxes.FullBox.prototype.write.call(this,e,t);var n=0,i=0;for(this._writeData(e,b.fields.FIELD_UINT32,this.entry_count),n=0;n<this.entry_count;n++)if(this._writeData(e,b.fields.FIELD_UINT32,this.entry[n].sample_delta),this._writeData(e,b.fields.FIELD_UINT16,this.entry[n].subsample_count),this.entry[n].subsample_count>0)for(i=0;i<this.entry[n].subsample_count;i++)1===this.version?this._writeData(e,b.fields.FIELD_UINT32,this.entry[n].subSampleEntries[i].subsample_size):this._writeData(e,b.fields.FIELD_UINT16,this.entry[n].subSampleEntries[i].subsample_size),this._writeData(e,b.fields.FIELD_UINT8,this.entry[n].subSampleEntries[i].subsample_priority),this._writeData(e,b.fields.FIELD_UINT8,this.entry[n].subSampleEntries[i].discardable),this._writeData(e,b.fields.FIELD_UINT32,this.entry[n].subSampleEntries[i].reserved);return this.localPos},b.registerTypeBoxes();var E=function(){return{pes:{},si:{},binary:{},ts:{},Pts:{},aac:{},h264:{}}}();function _(){"use strict";var e,t,n;try{e=navigator.userAgent.toLowerCase(),/msie (\d+\.\d+);/.test(e)?(n=Number(RegExp.$1),e.indexOf("trident/6")>-1&&(n=10),e.indexOf("trident/5")>-1&&(n=9),e.indexOf("trident/4")>-1&&(n=8),t="Internet Explorer"):e.indexOf("trident/7")>-1?(n=11,t="Internet Explorer"):/edge[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Edge"):/firefox[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Firefox"):/opera[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Opera"):/chrome[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Chrome"):/version[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Safari"):/rv[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Mozilla"):/mozilla[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Mozilla"):/binget[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (BinGet)"):/curl[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (cURL)"):/java[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (Java)"):/libwww-perl[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (libwww-perl)"):/microsoft url control -[\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (Microsoft URL Control)"):/peach[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (Peach)"):/php[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (PHP)"):/pxyscand[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (pxyscand)"):/pycurl[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (PycURL)"):/python-urllib[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="Library (Python URLlib)"):/appengine-google/.test(e)?(n=Number(RegExp.$1),t="Cloud (Google AppEngine)"):/trident/.test(e)?(n=Number(RegExp.$1),t="Trident"):/adventurer/.test(e)?(n=Number(RegExp.$1),t="Adventurer"):/webkit[\/\s](\d+\.\d+)/.test(e)?(n=Number(RegExp.$1),t="WebKit"):(n="unknown",t="unknown")}catch(i){t="error",n="error"}return{name:t.replace(/\s+/g,""),version:n}}function x(){"use strict";var e,t,n,i;try{e=navigator.userAgent.toLowerCase(),n=-1!==e.indexOf("windows nt 10.0")?"Windows 10":-1!==e.indexOf("windows nt 6.3")?"Windows 8.1":-1!==e.indexOf("windows nt 6.2")?"Windows 8":-1!==e.indexOf("windows nt 6.1")?"Windows 7":-1!==e.indexOf("windows nt 6.0")?"Windows Vista/Windows Server 2008":-1!==e.indexOf("windows nt 5.2")?"Windows XP x64/Windows Server 2003":-1!==e.indexOf("windows nt 5.1")?"Windows XP":-1!==e.indexOf("windows nt 5.01")?"Windows 2000, Service Pack 1 (SP1)":-1!==e.indexOf("windows xp")?"Windows XP":-1!==e.indexOf("windows 2000")?"Windows 2000":-1!==e.indexOf("windows nt 5.0")?"Windows 2000":-1!==e.indexOf("windows nt 4.0")?"Windows NT 4.0":-1!==e.indexOf("windows nt")?"Windows NT 4.0":-1!==e.indexOf("winnt4.0")?"Windows NT 4.0":-1!==e.indexOf("winnt")?"Windows NT 4.0":-1!==e.indexOf("windows me")?"Windows ME":-1!==e.indexOf("win 9x 4.90")?"Windows ME":-1!==e.indexOf("windows 98")?"Windows 98":-1!==e.indexOf("win98")?"Windows 98":-1!==e.indexOf("windows 95")?"Windows 95":-1!==e.indexOf("windows_95")?"Windows 95":-1!==e.indexOf("win95")?"Windows 95":-1!==e.indexOf("ce")?"Windows CE":-1!==e.indexOf("win16")?"Windows 3.11":-1!==e.indexOf("iemobile")?"Windows Mobile":-1!==e.indexOf("wm5 pie")?"Windows Mobile":-1!==e.indexOf("windows phone 10.0")?"Windows Phone 10":-1!==e.indexOf("windows")?"Windows (Unknown Version)":-1!==e.indexOf("openbsd")?"Open BSD":-1!==e.indexOf("sunos")?"Sun OS":-1!==e.indexOf("ubuntu")?"Ubuntu":-1!==e.indexOf("ipad")?"iOS (iPad)":-1!==e.indexOf("ipod")?"iOS (iTouch)":-1!==e.indexOf("iphone")?"iOS (iPhone)":-1!==e.indexOf("mac os x beta")?"Mac O SX Beta":-1!==e.indexOf("mac os x 10")?/mac os x 10_(\d+)\_(\d+)/.test(e)?"Mac OS X 10."+RegExp.$1:"Mac OS X 10":-1!==e.indexOf("mac os x")?"Mac OS X":-1!==e.indexOf("mac_68000")?"Mac OS Classic (68000)":-1!==e.indexOf("68K")?"Mac OS Classic (68000)":-1!==e.indexOf("mac_powerpc")?"Mac OS Classic (PowerPC)":-1!==e.indexOf("ppc mac")?"Mac OS Classic (PowerPC)":-1!==e.indexOf("macintosh")?"Mac OS Classic":-1!==e.indexOf("googletv")?"Android (GoogleTV)":-1!==e.indexOf("xoom")?"Android (Xoom)":-1!==e.indexOf("htc_flyer")?"Android (HTC Flyer)":-1!==e.indexOf("android")?"Android":-1!==e.indexOf("symbian")?"Symbian":-1!==e.indexOf("series60")?"Symbian (Series 60)":-1!==e.indexOf("series70")?"Symbian (Series 70)":-1!==e.indexOf("series80")?"Symbian (Series 80)":-1!==e.indexOf("series90")?"Symbian (Series 90)":-1!==e.indexOf("x11")?"UNIX":-1!==e.indexOf("nix")?"UNIX":-1!==e.indexOf("linux")?"Linux":-1!==e.indexOf("qnx")?"QNX":-1!==e.indexOf("os/2")?"IBM OS/2":-1!==e.indexOf("beos")?"BeOS":-1!==e.indexOf("blackberry95")?"Blackberry (Storm 1/2)":-1!==e.indexOf("blackberry97")?"Blackberry (Bold)":-1!==e.indexOf("blackberry96")?"Blackberry (Tour)":-1!==e.indexOf("blackberry89")?"Blackberry (Curve 2)":-1!==e.indexOf("blackberry98")?"Blackberry (Torch)":-1!==e.indexOf("playbook")?"Blackberry (Playbook)":-1!==e.indexOf("wnd.rim")?"Blackberry (IE/FF Emulator)":-1!==e.indexOf("blackberry")?"Blackberry":-1!==e.indexOf("palm")?"Palm OS":-1!==e.indexOf("webos")?"WebOS":-1!==e.indexOf("hpwos")?"WebOS (HP)":-1!==e.indexOf("blazer")?"Palm OS (Blazer)":-1!==e.indexOf("xiino")?"Palm OS (Xiino)":-1!==e.indexOf("kindle")?"Kindle":-1!==e.indexOf("wii")?"Nintendo (Wii)":-1!==e.indexOf("nintendo ds")?"Nintendo (DS)":-1!==e.indexOf("playstation 3")?"Sony (Playstation Console)":-1!==e.indexOf("playstation portable")?"Sony (Playstation Portable)":-1!==e.indexOf("webtv")?"MSN TV (WebTV)":-1!==e.indexOf("inferno")?"Inferno":"Unknown",t=navigator.platform.toLowerCase(),i=-1!==t.indexOf("x64")?"64":-1!==e.indexOf("x86_64")?"64":-1!==e.indexOf("x86-64")?"64":-1!==e.indexOf("win64")?"64":-1!==e.indexOf("x64;")?"64":-1!==e.indexOf("amd64")?"64":-1!==e.indexOf("wow64")?"64":-1!==e.indexOf("x64_64")?"64":-1!==e.indexOf("ia65")?"64":-1!==e.indexOf("sparc64")?"64":-1!==e.indexOf("ppc64")?"64":-1!==e.indexOf("irix64")?"64":-1!==e.indexOf("irix64")?"64":"32"}catch(r){n="error",i="error"}return{name:n.replace(/\s+/g,""),bits:"x"+i}}return"undefined"!==typeof e.exports?e.exports=E:window.mpegts=E,E.si.PSISection=function(e){this.m_table_id=e,this.m_section_syntax_indicator=1,this.m_section_length=E.si.PSISection.prototype.SECTION_LENGTH,this.m_transport_stream_id=0,this.m_version_number=0,this.m_current_next_indicator=!0,this.m_section_number=0,this.m_last_section_number=0,this.m_bValid=null},E.si.PSISection.prototype.parse=function(e){this.m_bValid=!1;var t=0,n=e[t];return t=0===n?t+1:t+n,this.m_table_id=e[t],t++,this.m_section_syntax_indicator=E.binary.getBitFromByte(e[t],0),this.m_section_length=E.binary.getValueFrom2Bytes(e.subarray(t,t+2),4),t+=2,this.m_transport_stream_id=E.binary.getValueFrom2Bytes(e.subarray(t,t+2)),t+=2,this.m_version_number=E.binary.getValueFromByte(e[t],2,5),this.m_current_next_indicator=E.binary.getBitFromByte(e[t],7),t++,this.m_section_number=e[t],t++,this.m_last_section_number=e[t],this.m_bValid=!0,t},E.si.PSISection.prototype.getSectionLength=function(){return this.m_section_length},E.si.PSISection.prototype.SECTION_LENGTH=9,E.si.PSISection.prototype.HEADER_LENGTH=8,E.aac.SAMPLING_FREQUENCY=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],E.aac.getAudioSpecificConfig=function(e){var t=E.binary.getValueFromByte(e[2],0,2),n=E.binary.getValueFromByte(e[2],2,4),i=E.binary.getValueFrom2Bytes(e.subarray(2,5),7,3),r=new Uint8Array(2);return r[0]=t+1<<3,r[0]|=(14&n)>>1,r[1]|=(1&n)<<7,r[1]|=i<<3,r},E.aac.parseADTS=function(e,t){var n,i,r=[],o={},s=0;while(s<e.length)i=s,o.syncword=(e[s]<<4)+((240&e[s+1])>>4),o.protection_absent=1&e[s+1],o.sampling_frequency_index=(60&e[s+2])>>2,o.channel_configuration=((1&e[s+2])<<1)+((192&e[s+3])>>6),o.aac_frame_length=((3&e[s+3])<<11)+(e[s+4]<<3)+((224&e[s+5])>>5),o.number_of_raw_data_blocks_in_frame=(3&e[s+6])>>2,s+=7,0===o.number_of_raw_data_blocks_in_frame&&(0===o.protection_absent&&(s+=2),n={},n.offset=s,n.length=o.aac_frame_length-(s-i),t&&t[i]&&(n.cts=t[i]),r.push(n),s+=n.length);return r},E.ts.AdaptationField=function(){this.m_cAFLength=null,this.m_bDiscontinuityInd=null,this.m_bRAI=null,this.m_bESPriority=null,this.m_bPCRFlag=null,this.m_bOPCRFlag=null,this.m_bSplicingPointFlag=null,this.m_bPrivateDataFlag=null,this.m_bAdaptationFieldExtFlag=null},E.ts.AdaptationField.prototype.getLength=function(){return this.m_cAFLength+1},E.ts.AdaptationField.prototype.parse=function(e){if(this.m_cAFLength=e[0],0!==this.m_cAFLength){var t=1;this.m_bDiscontinuityInd=E.binary.getBitFromByte(e[t],0),this.m_bRAI=E.binary.getBitFromByte(e[t],1),this.m_bESPriority=E.binary.getBitFromByte(e[t],2),this.m_bPCRFlag=E.binary.getBitFromByte(e[t],3),this.m_bOPCRFlag=E.binary.getBitFromByte(e[t],4),this.m_bSplicingPointFlag=E.binary.getBitFromByte(e[t],5),this.m_bPrivateDataFlag=E.binary.getBitFromByte(e[t],6),this.m_bAdaptationFieldExtFlag=E.binary.getBitFromByte(e[t],7)}},E.binary.readBytes=function(e,t,n){for(var i=0,r=0;r<n;r++)i<<=8,i+=e[t],t++;return i},E.binary.getBitFromByte=function(e,t){var n=0;return n+=1<<7-t,0!==(e&n)},E.binary.getValueFrom3Bytes=function(e,t,n){"undefined"===typeof n&&(n=-1),"undefined"===typeof t&&(t=0);var i=-1==n?-1:n-(16-t),r=-1==n?0:8-i,o=E.binary.getValueFromByte(e[0],t),s=E.binary.getValueFromByte(e[1]),a=E.binary.getValueFromByte(e[2],0,i,!1);return(o<<16&16711680|s<<8&65280|255&a)>>r},E.binary.getValueFrom2Bytes=function(e,t,n){"undefined"===typeof n&&(n=-1),"undefined"===typeof t&&(t=0);var i=-1==n?-1:n-(8-t),r=-1==n?0:8-i,o=E.binary.getValueFromByte(e[0],t),s=E.binary.getValueFromByte(e[1],0,i,!1);return(o<<8&65280|255&s)>>r},E.binary.getValueFromByte=function(e,t,n,i){var r=0,o=0;"undefined"===typeof n&&(n=-1),"undefined"===typeof t&&(t=0);var s=-1==n?7:t+n-1;for(o=t;o<=s;o++)r+=1<<7-o;var a=e&r;return(i||"undefined"===typeof i)&&(a>>=7-s),a},E.h264.getSequenceHeader=function(e){var t,n=-1,i=-1,r=0,o=null,s=0,a=0;while(r<e.length)if(0===e[r]&&0===e[r+1]&&0===e[r+2]&&1===e[r+3]){if(t=31&e[r+4],t>=E.h264.NALUTYPE_SPS&&t<=E.h264.NALUTYPE_PPS){if(-1===n&&(n=r),t===E.h264.NALUTYPE_SPS){var l=E.h264.parseSPS(e.subarray(r+5));s=l.pic_width_in_mbs_minus1+1<<4,a=l.pic_height_in_map_units_minus1+1<<4}}else n>0&&(i=r-n);if(t===E.h264.NALUTYPE_IDR||t===E.h264.NALUTYPE_NONIDR)break;r+=4}else{if(0===e[r]&&0===e[r+1]&&1===e[r+2]){n>0&&(i=r-n);break}r++}return-1===n||-1===i?null:(o=new Uint8Array(i),o.set(e.subarray(n,n+i)),{bytes:o,width:s,height:a})},E.h264.read_ue=function(e,t){var n=1,i=0,r=0;t._bit=t._byte>>t._bitPos&1,t._bitPos--,t._bitPos<0&&(t._byte=e[t._bytePos],t._bytePos++,t._bitPos=7);while(0===t._bit)r++,n<<=1,t._bit=t._byte>>t._bitPos&1,t._bitPos--,t._bitPos<0&&(t._byte=e[t._bytePos],t._bytePos++,t._bitPos=7);if(n-=1,i=0,r)while(r>0)t._bit=t._byte>>t._bitPos&1,t._bitPos--,i=(i<<1)+t._bit,r--,t._bitPos<0&&(t._byte=e[t._bytePos],t._bytePos++,t._bitPos=7);return n+=i,n},E.h264.read_flag=function(e,t){var n=0;return t._bit=t._byte>>t._bitPos&1,t._bitPos--,t._bitPos<0&&(t._byte=e[t._bytePos],t._bytePos++,t._bitPos=7),n=t._bit,n},E.h264.parseSPS=function(e){var t={profile_idc:0,constraint_set0_flag:0,constraint_set1_flag:0,constraint_set2_flag:0,constraint_set3_flag:0,level_idc:0,seq_parameter_set_id:0,chroma_format_idc:0,separate_colour_plane_flag:0,bit_depth_luma_minus8:0,bit_depth_chroma_minus8:0,qpprime_y_zero_transform_bypass_flag:0,seq_scaling_matrix_present_flag:0,log2_max_frame_num_minus4:0,pic_order_cnt_type:0,log2_max_pic_order_cnt_lsb_minus4:0,num_ref_frames:0,gaps_in_frame_num_value_allowed_flag:0,pic_width_in_mbs_minus1:0,pic_height_in_map_units_minus1:0},n={_byte:0,_bit:0,_bytePos:0,_bitPos:0};return n._bytePos=n._bitPos=0,n._byte=e[n._bytePos],n._bytePos++,t.profile_idc=n._byte,n._byte=e[n._bytePos],n._bytePos++,t.constraint_set0_flag=(128&n._byte)>>7,t.constraint_set1_flag=(64&n._byte)>>6,t.constraint_set2_flag=(32&n._byte)>>5,t.constraint_set3_flag=(16&n._byte)>>4,n._byte=e[n._bytePos],n._bytePos++,t.level_idc=n._byte,n._byte=e[n._bytePos],n._bytePos++,n._bitPos=7,t.seq_parameter_set_id=E.h264.read_ue(e,n),100!==t.profile_idc&&110!==t.profile_idc&&122!==t.profile_idc&&244!==t.profile_idc&&44!==t.profile_idc&&83!==t.profile_idc&&86!==t.profile_idc||(t.chroma_format_idc=E.h264.read_ue(e,n),3===t.chroma_format_idc&&(t.separate_colour_plane_flag=E.h264.read_flag(e,n)),t.bit_depth_luma_minus8=E.h264.read_ue(e,n),t.bit_depth_chroma_minus8=E.h264.read_ue(e,n),t.qpprime_y_zero_transform_bypass_flag=E.h264.read_flag(e,n),t.seq_scaling_matrix_present_flag=E.h264.read_flag(e,n),t.seq_scaling_matrix_present_flag),t.log2_max_frame_num_minus4=E.h264.read_ue(e,n),t.pic_order_cnt_type=E.h264.read_ue(e,n),0===t.pic_order_cnt_type?t.log2_max_pic_order_cnt_lsb_minus4=E.h264.read_ue(e,n):t.pic_order_cnt_type,t.num_ref_frames=E.h264.read_ue(e,n),t.gaps_in_frame_num_value_allowed_flag=E.h264.read_flag(e,n),t.pic_width_in_mbs_minus1=E.h264.read_ue(e,n),t.pic_height_in_map_units_minus1=E.h264.read_ue(e,n),t},E.h264.parseNALUs=function(e){var t,n=0,i=e.length,r=0,o=[];while(n<i)0===e[n]&&r++,1===e[n]&&r>=2&&(n++,o.length>0&&(o[o.length-1].size=n-(r+1)-o[o.length-1].offset),t={},t.type=31&e[n],t.offset=n,o.push(t),r=0),e[n]&&(r=0),n++;return o.length>0&&(o[o.length-1].size=n-o[o.length-1].offset),o},E.h264.bytestreamToMp4=function(e){var t=0,n=e.length,i=-1,r=0;while(t<n)0===e[t]&&0===e[t+1]&&0===e[t+2]&&1===e[t+3]?(i>=0&&(r=t-i-4,e[i]=(4278190080&r)>>24,e[i+1]=(16711680&r)>>16,e[i+2]=(65280&r)>>8,e[i+3]=255&r),i=t,t+=4):t++;r=t-i-4,e[i]=(4278190080&r)>>24,e[i+1]=(16711680&r)>>16,e[i+2]=(65280&r)>>8,e[i+3]=255&r},E.h264.isIDR=function(e){var t,n=0;while(n<e.length)if(0===e[n]&&0===e[n+1]&&1===e[n+2]){if(t=31&e[n+3],t===E.h264.NALUTYPE_IDR)return!0;n+=3}else n++;return!1},E.h264.NALUTYPE_NONIDR=1,E.h264.NALUTYPE_IDR=5,E.h264.NALUTYPE_SEI=6,E.h264.NALUTYPE_SPS=7,E.h264.NALUTYPE_PPS=8,E.h264.NALUTYPE_AU_DELIMITER=9,E.si.PAT=function(){E.si.PSISection.call(this,E.si.PAT.prototype.TABLE_ID),this.m_listOfProgramAssociation=[],this.m_network_pid=null},E.si.PAT.prototype=Object.create(E.si.PSISection.prototype),E.si.PAT.prototype.constructor=E.si.PAT,E.si.PAT.prototype.parse=function(e){var t=E.si.PSISection.prototype.parse.call(this,e);if(t++,this.m_bValid&&(this.m_bValid=!1,this.m_table_id===this.TABLE_ID)){var n=this.getSectionLength()-this.SECTION_LENGTH;while(n>=4){var i=new E.si.ProgramAssociation(e.subarray(t,t+4));0===i.getProgramNumber()?this.m_network_pid=i.getProgramMapPid():this.m_listOfProgramAssociation.push(i),n-=4,t+=4}this.m_bValid=!0}},E.si.PAT.prototype.getPmtPid=function(){var e=E.ts.TsPacket.prototype.UNDEFINED_PID;if(this.m_listOfProgramAssociation.length>=1){var t=this.m_listOfProgramAssociation[0];e=t.getProgramMapPid()}return e},E.si.PAT.prototype.TABLE_ID=0,E.si.PAT.prototype.PID=0,E.si.ProgramAssociation=function(e){this.m_program_number=0,this.m_program_map_pid=0,this.parse(e)},E.si.ProgramAssociation.prototype.getProgramNumber=function(){return this.m_program_number},E.si.ProgramAssociation.prototype.getProgramMapPid=function(){return this.m_program_map_pid},E.si.ProgramAssociation.prototype.getLength=function(){return 4},E.si.ProgramAssociation.prototype.parse=function(e){this.m_program_number=E.binary.getValueFrom2Bytes(e.subarray(0,2)),this.m_program_map_pid=E.binary.getValueFrom2Bytes(e.subarray(2,4),3,13)},E.pes.PesPacket=function(){this.m_cStreamID=null,this.m_nPESPacketLength=null,this.m_cPESScramblingCtrl=null,this.m_bPESpriority=null,this.m_bDataAlignement=null,this.m_bCopyright=null,this.m_bOriginalOrCopy=null,this.m_cPES_header_data_length=null,this.m_cPTS_DTS_flags=null,this.m_bESCR_flag=null,this.m_bES_rate_flag=null,this.m_bDSM_trick_mode_flag=null,this.m_bAdditional_copy_info_flag=null,this.m_bPES_CRC_flag=null,this.m_bPES_extension_flag=null,this.m_pPTS=null,this.m_pDTS=null,this.m_pESCR=null,this.m_ES_rate=null,this.m_DSM_trick_mode=null,this.m_Additional_copy_info=null,this.m_PES_CRC=null,this.m_cNbStuffingBytes=null,this.m_pPESExtension=null,this.m_pPrivateData=null,this.m_payloadArray=null,this.m_nPayloadLength=null,this.m_bDirty=null,this.m_bValid=!1},E.pes.PesPacket.prototype.parse=function(e){var t=0;this.m_nLength=e.length;var n=E.binary.getValueFrom3Bytes(e.subarray(t,t+3));if(n===this.START_CODE_PREFIX)if(t=3,this.m_cStreamID=e[t],t++,this.m_nPESPacketLength=E.binary.getValueFrom2Bytes(e.subarray(t,t+2)),t+=2,this.m_cStreamID!==E.ts.TsPacket.prototype.STREAM_ID_PADDING_STREAM){if(!this.hasOptionalPESHeader())return this.m_payloadArray=e.subarray(t+E.pes.PesPacket.prototype.FIXED_HEADER_LENGTH),this.m_nPayloadLength=this.m_nLength-E.pes.PesPacket.prototype.FIXED_HEADER_LENGTH,void(this.m_bValid=!0);var i=E.binary.getValueFromByte(e[t],0,2);if(2===i){this.m_cPESScramblingCtrl=E.binary.getValueFromByte(e[t],2,2),this.m_bPESpriority=E.binary.getBitFromByte(e[t],4),this.m_bDataAlignement=E.binary.getBitFromByte(e[t],5),this.m_bCopyright=E.binary.getBitFromByte(e[t],6),this.m_bOriginalOrCopy=E.binary.getBitFromByte(e[t],7),t++,this.m_cPTS_DTS_flags=E.binary.getValueFromByte(e[t],0,2),this.m_bESCR_flag=E.binary.getBitFromByte(e[t],2),this.m_bES_rate_flag=E.binary.getBitFromByte(e[t],3),this.m_bDSM_trick_mode_flag=E.binary.getBitFromByte(e[t],4),this.m_bAdditional_copy_info_flag=E.binary.getBitFromByte(e[t],5),this.m_bPES_CRC_flag=E.binary.getBitFromByte(e[t],6),this.m_bPES_extension_flag=E.binary.getBitFromByte(e[t],7),t++,this.m_cPES_header_data_length=255&e[t],t++,(this.m_cPTS_DTS_flags&E.pes.PesPacket.prototype.FLAG_PTS)==E.pes.PesPacket.prototype.FLAG_PTS&&(this.m_pPTS=new E.Pts(e.subarray(t,t+5)),t+=5),(this.m_cPTS_DTS_flags&E.pes.PesPacket.prototype.FLAG_DTS)==E.pes.PesPacket.prototype.FLAG_DTS&&(this.m_pDTS=new E.Pts(e.subarray(t,t+5)),t+=5),this.m_bESCR_flag&&(t+=6),this.m_bES_rate_flag&&(this.m_ES_rate=E.binary.getValueFrom3Bytes(e.subarray(t,t+3),1,22),t+=3),this.m_bDSM_trick_mode_flag&&(this.m_DSM_trick_mode=e[t],t++),this.m_bAdditional_copy_info_flag&&(this.m_Additional_copy_info=e[t],t++),this.m_bPES_CRC_flag&&(this.m_PES_CRC=E.binary.getValueFrom2Bytes(e.subarray(t,t+2)),t+=2),this.m_bPES_extension_flag;var r=E.pes.PesPacket.prototype.FIXED_HEADER_LENGTH+E.pes.PesPacket.prototype.FIXED_OPTIONAL_HEADER_LENGTH+this.m_cPES_header_data_length;this.m_cNbStuffingBytes=r-t,t+=this.m_cNbStuffingBytes,this.m_nPayloadLength=this.m_nLength-r,this.m_payloadArray=e.subarray(r,r+this.m_nPayloadLength),this.m_bValid=!0}}else this.m_bValid=!0},E.pes.PesPacket.prototype.hasOptionalPESHeader=function(){return this.m_cStreamID!==E.ts.TsPacket.prototype.STREAM_ID_PROGRAM_STREAM_MAP&&this.m_cStreamID!==E.ts.TsPacket.prototype.STREAM_ID_PADDING_STREAM&&this.m_cStreamID!==E.ts.TsPacket.prototype.STREAM_ID_PRIVATE_STREAM_2&&this.m_cStreamID!==E.ts.TsPacket.prototype.STREAM_ID_ECM_STREAM&&this.m_cStreamID!==E.ts.TsPacket.prototype.STREAM_ID_EMM_STREAM&&this.m_cStreamID!==E.ts.TsPacket.prototype.STREAM_ID_PROGRAM_STREAM_DIRECTORY&&this.m_cStreamID!==E.ts.TsPacket.prototype.STREAM_ID_DSMCC_STREAM&&this.m_cStreamID!==E.ts.TsPacket.prototype.STREAM_ID_H2221_TYPE_E_STREAM},E.pes.PesPacket.prototype.getHeaderLength=function(){return E.pes.PesPacket.prototype.FIXED_HEADER_LENGTH+E.pes.PesPacket.prototype.FIXED_OPTIONAL_HEADER_LENGTH+this.m_cPES_header_data_length},E.pes.PesPacket.prototype.getPayload=function(){return this.m_payloadArray},E.pes.PesPacket.prototype.getPts=function(){return this.m_pPTS},E.pes.PesPacket.prototype.getDts=function(){return this.m_pDTS},E.pes.PesPacket.prototype.START_CODE_PREFIX=1,E.pes.PesPacket.prototype.FIXED_HEADER_LENGTH=6,E.pes.PesPacket.prototype.FIXED_OPTIONAL_HEADER_LENGTH=3,E.pes.PesPacket.prototype.FLAG_DTS=1,E.pes.PesPacket.prototype.FLAG_PTS=2,E.si.PMT=function(){E.si.PSISection.call(this,E.si.PMT.prototype.TABLE_ID),this.m_listOfComponents=[],this.m_PCR_PID=null,this.m_program_info_length=null},E.si.PMT.prototype=Object.create(E.si.PSISection.prototype),E.si.PMT.prototype.constructor=E.si.PMT,E.si.PMT.prototype.parse=function(e){var t=E.si.PSISection.prototype.parse.call(this,e);if(t++,this.m_bValid&&(this.m_bValid=!1,this.m_table_id===this.TABLE_ID)){var n=this.getSectionLength()-this.SECTION_LENGTH;if(!(n<4)){this.m_PCR_PID=E.binary.getValueFrom2Bytes(e.subarray(t,t+2),3),t+=2,this.m_program_info_length=E.binary.getValueFrom2Bytes(e.subarray(t,t+2),4),t+=2,t+=this.m_program_info_length,n=this.m_section_length-this.SECTION_LENGTH-4-this.m_program_info_length;var i=null;while(n>0)i=new E.si.ESDescription(e.subarray(t,t+n)),this.m_listOfComponents.push(i),n-=i.getLength(),t+=i.getLength();this.m_bValid=!0}}},E.si.PMT.prototype.TABLE_ID=2,E.si.PMT.prototype.gStreamTypes=[{name:"Reserved",value:0,desc:"ITU-T | ISO/IEC Reserved"},{name:"MPEG1-Video",value:224,desc:"ISO/IEC 11172-2 Video"},{name:"MPEG2-Video",value:224,desc:"ITU-T Rec. H.262 | ISO/IEC 13818-2 Video or ISO/IEC 11172-2 constrained parameter video stream"},{name:"MPEG1-Audio",value:192,desc:"ISO/IEC 11172-3 Audio"},{name:"MPEG2-Audio",value:192,desc:"ISO/IEC 13818-3 Audio"},{name:"PRIVATE_SECTIONS",value:189,desc:"ITU-T Rec. H.222.0 | ISO/IEC 13818-1 private_sections"},{name:"PRIVATE",value:189,desc:"ITU-T Rec. H.222.0 | ISO/IEC 13818-1 PES packets containing private data"},{name:"MHEG",value:243,desc:"ISO/IEC 13522 MHEG"},{name:"MPEG1-DSM-CC",value:242,desc:"ITU-T Rec. H.222.0 | ISO/IEC 13818-1 Annex A DSM-CC"},{name:"H.222.1",value:244,desc:"ITU-T Rec. H.222.1"},{name:"DSM-CC_A",value:244,desc:"ISO/IEC 13818-6 type A"},{name:"DSM-CC_B",value:245,desc:"ISO/IEC 13818-6 type B"},{name:"DSM-CC_C",value:246,desc:"ISO/IEC 13818-6 type C"},{name:"DSM-CC_D",value:247,desc:"ISO/IEC 13818-6 type D"},{name:"Auxiliary",value:0,desc:"ITU-T Rec. H.222.0 | ISO/IEC 13818-1 auxiliary"},{name:"MPEG2-AAC-ADTS",value:192,desc:"ISO/IEC 13818-7 Audio with ADTS transport syntax"},{name:"MPEG4-Video",value:224,desc:"ISO/IEC 14496-2 Visual"},{name:"MPEG4-AAC-LATM",value:192,desc:"ISO/IEC 14496-3 Audio with the LATM transport syntax as defined in ISO/IEC 14496-3/AMD-1"},{name:"MPEG4-SL",value:250,desc:"ISO/IEC 14496-1 SL-packetized stream or FlexMux stream carried in PES packets"},{name:"MPEG4-SL",value:250,desc:"ISO/IEC 14496-1 SL-packetized stream or FlexMux stream carried in ISO/IEC14496_sections"},{name:"DSM-CC_SDP",value:0,desc:"ISO/IEC 13818-6 Synchronized Download Protocol"},{name:"META_PES",value:252,desc:"Metadata carried in PES packets"},{name:"META_SECTIONS",value:252,desc:"Metadata carried in metadata_sections"},{name:"META_DSM-CC",value:252,desc:"Metadata carried in ISO/IEC 13818-6 Data Carousel"},{name:"META_DSM-CC",value:252,desc:"Metadata carried in ISO/IEC 13818-6 Object Carousel"},{name:"META_DSM-CC",value:252,desc:"Metadata carried in ISO/IEC 13818-6 Synchronized Download Protocol"},{name:"MPEG2-IPMP",value:0,desc:"IPMP stream (defined in ISO/IEC 13818-11, MPEG-2 IPMP)"},{name:"H.264",value:224,desc:"AVC video stream as defined in ITU-T Rec. H.264 | ISO/IEC 14496-10 Video"},{name:"MPEG4AAC",value:192,desc:"ISO/IEC 14496-3 Audio, without using any additional transport syntax, such as DST, ALS and SLS"},{name:"MPEG4Text",value:0,desc:"ISO/IEC 14496-17 Text"},{name:"Aux. Video (23002-3)",value:30,desc:"Auxiliary video stream as defined in ISO/IEC 23002-3"},{name:"H.264-SVC",value:224,desc:"SVC video sub-bitstream of a video stream as defined in the Annex G of ITU-T Rec. H.264 | ISO/IEC 14496-10 Video"},{name:"H.264-MVC",value:224,desc:"MVC video sub-bitstream of a video stream as defined in the Annex H of ITU-T Rec. H.264 | ISO/IEC 14496-10 Video"},{name:"Reserved1",value:0,desc:"TBC Reserved"},{name:"Reserved2",value:0,desc:"TBC Reserved"},{name:"Reserved3",value:0,desc:"TBC Reserved"},{name:"HEVC",value:224,desc:"ITU.-T Rec H.26x | ISO/IEC 23008-2 video stream"}],E.si.PMT.prototype.MPEG2_VIDEO_STREAM_TYPE=2,E.si.PMT.prototype.AVC_VIDEO_STREAM_TYPE=27,E.si.PMT.prototype.MPEG1_AUDIO_STREAM_TYPE=3,E.si.PMT.prototype.MPEG2_AUDIO_STREAM_TYPE=4,E.si.PMT.prototype.AAC_AUDIO_STREAM_TYPE=17,E.si.PMT.prototype.AC3_AUDIO_STREAM_TYPE=6,E.si.PMT.prototype.SUB_STREAM_TYPE=6,E.si.PMT.prototype.STREAM_TYPE_MP1V=1,E.si.PMT.prototype.STREAM_TYPE_MP2V=2,E.si.PMT.prototype.STREAM_TYPE_MP1A=3,E.si.PMT.prototype.STREAM_TYPE_MP2A=4,E.si.PMT.prototype.STREAM_TYPE_PRIVATE=6,E.si.PMT.prototype.STREAM_TYPE_TELETEXT=6,E.si.PMT.prototype.STREAM_TYPE_DVBSUBTITLE=6,E.si.PMT.prototype.STREAM_TYPE_AC3=6,E.si.PMT.prototype.STREAM_TYPE_MP2AAC_ADTS=15,E.si.PMT.prototype.STREAM_TYPE_MP4AAC_LATM=17,E.si.PMT.prototype.STREAM_TYPE_H264=27,E.si.PMT.prototype.STREAM_TYPE_MP4AAC=28,E.si.PMT.prototype.STREAM_TYPE_AUX_23002_3=30,E.si.PMT.prototype.STREAM_TYPE_SVC=31,E.si.PMT.prototype.STREAM_TYPE_MVC=32,E.si.PMT.prototype.STREAM_TYPE_HEVC=36,E.si.ESDescription=function(e){this.m_stream_type=null,this.m_elementary_PID=null,this.m_ES_info_length=null,this.parse(e)},E.si.ESDescription.prototype.getStreamType=function(){return this.m_stream_type},E.si.ESDescription.prototype.getPID=function(){return this.m_elementary_PID},E.si.ESDescription.prototype.getLength=function(){return 5+this.m_ES_info_length},E.si.ESDescription.prototype.parse=function(e){this.m_stream_type=e[0],this.m_elementary_PID=E.binary.getValueFrom2Bytes(e.subarray(1,3),3),this.m_ES_info_length=E.binary.getValueFrom2Bytes(e.subarray(3,5),4)},E.Pts=function(e){var t,n,i=e[0]>>1&7;n=i>>2,t=(3&i)<<30>>>0;var o=e[1];t=(t|o<<22)>>>0;var s=e[2]>>1;t=(t|s<<15)>>>0;var a=e[3];t=(t|a<<7)>>>0;var l=e[4]>>1;t=(t|l)>>>0,this.m_lPTS=r.math.Long.fromBits(t,n).toNumber(),this.m_fPTS=this.m_lPTS/E.Pts.prototype.SYSTEM_CLOCK_FREQUENCY},E.Pts.prototype.getValue=function(){return this.m_lPTS},E.Pts.prototype.getValueInSeconds=function(){return this.m_fPTS},E.Pts.prototype.SYSTEM_CLOCK_FREQUENCY=9e4,E.ts.TsPacket=function(){this.m_cSync=null,this.m_bTransportError=null,this.m_bPUSI=null,this.m_bTransportPriority=null,this.m_nPID=null,this.m_cTransportScramblingCtrl=null,this.m_cAdaptationFieldCtrl=null,this.m_cContinuityCounter=null,this.m_pAdaptationField=null,this.m_payloadArray=null,this.m_cPayloadLength=null,this.m_bDirty=null,this.m_time=null,this.m_arrivalTime=null,this.m_bIgnored=null},E.ts.TsPacket.prototype.parse=function(e){var t=0;if(this.m_cSync=e[t],this.m_cSync===this.SYNC_WORD){if(t++,this.m_bTransportError=E.binary.getBitFromByte(e[t],0),this.m_bPUSI=E.binary.getBitFromByte(e[t],1),this.m_bTransportPriority=E.binary.getBitFromByte(e[t],2),this.m_nPID=E.binary.getValueFrom2Bytes(e.subarray(t,t+2),3,13),t+=2,this.m_cTransportScramblingCtrl=E.binary.getValueFromByte(e[t],0,2),this.m_cAdaptationFieldCtrl=E.binary.getValueFromByte(e[t],2,2),this.m_cContinuityCounter=E.binary.getValueFromByte(e[t],4,4),t++,2&this.m_cAdaptationFieldCtrl){var n=e[t];if(n+t>=this.TS_PACKET_SIZE)return;this.m_pAdaptationField=new E.ts.AdaptationField,this.m_pAdaptationField.parse(e.subarray(t)),t+=this.m_pAdaptationField.getLength()}0!==this.m_cAdaptationFieldCtrl&&1&this.m_cAdaptationFieldCtrl&&(this.m_cPayloadLength=this.TS_PACKET_SIZE-t,this.m_payloadArray=e.subarray(t,t+this.m_cPayloadLength))}},E.ts.TsPacket.prototype.checkSyncWord=function(e){var t=0,n=e[t];return n===this.SYNC_WORD},E.ts.TsPacket.prototype.getPid=function(){return this.m_nPID},E.ts.TsPacket.prototype.getPayload=function(){return this.m_payloadArray},E.ts.TsPacket.prototype.getPayloadLength=function(){return this.m_cPayloadLength},E.ts.TsPacket.prototype.getPusi=function(){return this.m_bPUSI},E.ts.TsPacket.prototype.hasAdaptationFieldOnly=function(){return 2===this.m_cAdaptationFieldCtrl},E.ts.TsPacket.prototype.SYNC_WORD=71,E.ts.TsPacket.prototype.TS_PACKET_SIZE=188,E.ts.TsPacket.prototype.UNDEFINED_PID=65535,E.ts.TsPacket.prototype.PAT_PID=0,E.ts.TsPacket.prototype.STREAM_ID_PROGRAM_STREAM_MAP=188,E.ts.TsPacket.prototype.STREAM_ID_PADDING_STREAM=190,E.ts.TsPacket.prototype.STREAM_ID_PADDING_STREAM=190,E.ts.TsPacket.prototype.STREAM_ID_PRIVATE_STREAM_2=191,E.ts.TsPacket.prototype.STREAM_ID_ECM_STREAM=240,E.ts.TsPacket.prototype.STREAM_ID_EMM_STREAM=241,E.ts.TsPacket.prototype.STREAM_ID_DSMCC_STREAM=242,E.ts.TsPacket.prototype.STREAM_ID_H2221_TYPE_E_STREAM=248,E.ts.TsPacket.prototype.STREAM_ID_PROGRAM_STREAM_DIRECTORY=255,o=this.dijon,d})}).call(this,n("4362"))},"52a7":function(e,t){t.f={}.propertyIsEnumerable},"551c":function(e,t,n){"use strict";var i,r,o,s,a=n("2d00"),l=n("7726"),u=n("9b43"),c=n("23c6"),d=n("5ca1"),h=n("d3f4"),f=n("d8e8"),p=n("f605"),m=n("4a59"),g=n("ebd6"),y=n("1991").set,v=n("8079")(),b=n("a5b8"),E=n("9c80"),_=n("a25f"),x=n("bcaa"),T="Promise",S=l.TypeError,w=l.process,I=w&&w.versions,D=I&&I.v8||"",M=l[T],A="process"==c(w),L=function(){},R=r=b.f,P=!!function(){try{var e=M.resolve(1),t=(e.constructor={})[n("2b4c")("species")]=function(e){e(L,L)};return(A||"function"==typeof PromiseRejectionEvent)&&e.then(L)instanceof t&&0!==D.indexOf("6.6")&&-1===_.indexOf("Chrome/66")}catch(i){}}(),C=function(e){var t;return!(!h(e)||"function"!=typeof(t=e.then))&&t},N=function(e,t){if(!e._n){e._n=!0;var n=e._c;v(function(){var i=e._v,r=1==e._s,o=0,s=function(t){var n,o,s,a=r?t.ok:t.fail,l=t.resolve,u=t.reject,c=t.domain;try{a?(r||(2==e._h&&k(e),e._h=1),!0===a?n=i:(c&&c.enter(),n=a(i),c&&(c.exit(),s=!0)),n===t.promise?u(S("Promise-chain cycle")):(o=C(n))?o.call(n,l,u):l(n)):u(i)}catch(d){c&&!s&&c.exit(),u(d)}};while(n.length>o)s(n[o++]);e._c=[],e._n=!1,t&&!e._h&&B(e)})}},B=function(e){y.call(l,function(){var t,n,i,r=e._v,o=F(e);if(o&&(t=E(function(){A?w.emit("unhandledRejection",r,e):(n=l.onunhandledrejection)?n({promise:e,reason:r}):(i=l.console)&&i.error&&i.error("Unhandled promise rejection",r)}),e._h=A||F(e)?2:1),e._a=void 0,o&&t.e)throw t.v})},F=function(e){return 1!==e._h&&0===(e._a||e._c).length},k=function(e){y.call(l,function(){var t;A?w.emit("rejectionHandled",e):(t=l.onrejectionhandled)&&t({promise:e,reason:e._v})})},O=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,t._a||(t._a=t._c.slice()),N(t,!0))},U=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw S("Promise can't be resolved itself");(t=C(e))?v(function(){var i={_w:n,_d:!1};try{t.call(e,u(U,i,1),u(O,i,1))}catch(r){O.call(i,r)}}):(n._v=e,n._s=1,N(n,!1))}catch(i){O.call({_w:n,_d:!1},i)}}};P||(M=function(e){p(this,M,T,"_h"),f(e),i.call(this);try{e(u(U,this,1),u(O,this,1))}catch(t){O.call(this,t)}},i=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},i.prototype=n("dcbc")(M.prototype,{then:function(e,t){var n=R(g(this,M));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=A?w.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&N(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new i;this.promise=e,this.resolve=u(U,e,1),this.reject=u(O,e,1)},b.f=R=function(e){return e===M||e===s?new o(e):r(e)}),d(d.G+d.W+d.F*!P,{Promise:M}),n("7f20")(M,T),n("7a56")(T),s=n("8378")[T],d(d.S+d.F*!P,T,{reject:function(e){var t=R(this),n=t.reject;return n(e),t.promise}}),d(d.S+d.F*(a||!P),T,{resolve:function(e){return x(a&&this===s?M:this,e)}}),d(d.S+d.F*!(P&&n("5cc5")(function(e){M.all(e)["catch"](L)})),T,{all:function(e){var t=this,n=R(t),i=n.resolve,r=n.reject,o=E(function(){var n=[],o=0,s=1;m(e,!1,function(e){var a=o++,l=!1;n.push(void 0),s++,t.resolve(e).then(function(e){l||(l=!0,n[a]=e,--s||i(n))},r)}),--s||i(n)});return o.e&&r(o.v),n.promise},race:function(e){var t=this,n=R(t),i=n.reject,r=E(function(){m(e,!1,function(e){t.resolve(e).then(n.resolve,i)})});return r.e&&i(r.v),n.promise}})},5537:function(e,t,n){var i=n("8378"),r=n("7726"),o="__core-js_shared__",s=r[o]||(r[o]={});(e.exports=function(e,t){return s[e]||(s[e]=void 0!==t?t:{})})("versions",[]).push({version:i.version,mode:n("2d00")?"pure":"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"})},"55dd":function(e,t,n){"use strict";var i=n("5ca1"),r=n("d8e8"),o=n("4bf8"),s=n("79e5"),a=[].sort,l=[1,2,3];i(i.P+i.F*(s(function(){l.sort(void 0)})||!s(function(){l.sort(null)})||!n("2f21")(a)),"Array",{sort:function(e){return void 0===e?a.call(o(this)):a.call(o(this),r(e))}})},"584a":function(e,t){var n=e.exports={version:"2.6.5"};"number"==typeof __e&&(__e=n)},"59ad":function(e,t,n){e.exports=n("7be7")},"5ca1":function(e,t,n){var i=n("7726"),r=n("8378"),o=n("32e9"),s=n("2aba"),a=n("9b43"),l="prototype",u=function(e,t,n){var c,d,h,f,p=e&u.F,m=e&u.G,g=e&u.S,y=e&u.P,v=e&u.B,b=m?i:g?i[t]||(i[t]={}):(i[t]||{})[l],E=m?r:r[t]||(r[t]={}),_=E[l]||(E[l]={});for(c in m&&(n=t),n)d=!p&&b&&void 0!==b[c],h=(d?b:n)[c],f=v&&d?a(h,i):y&&"function"==typeof h?a(Function.call,h):h,b&&s(b,c,h,e&u.U),E[c]!=h&&o(E,c,f),y&&_[c]!=h&&(_[c]=h)};i.core=r,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},"5cc5":function(e,t,n){var i=n("2b4c")("iterator"),r=!1;try{var o=[7][i]();o["return"]=function(){r=!0},Array.from(o,function(){throw 2})}catch(s){}e.exports=function(e,t){if(!t&&!r)return!1;var n=!1;try{var o=[7],a=o[i]();a.next=function(){return{done:n=!0}},o[i]=function(){return a},e(o)}catch(s){}return n}},"613b":function(e,t,n){var i=n("5537")("keys"),r=n("ca5a");e.exports=function(e){return i[e]||(i[e]=r(e))}},"626a":function(e,t,n){var i=n("2d95");e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},"63b6":function(e,t,n){var i=n("e53d"),r=n("584a"),o=n("d864"),s=n("35e8"),a=n("07e3"),l="prototype",u=function(e,t,n){var c,d,h,f=e&u.F,p=e&u.G,m=e&u.S,g=e&u.P,y=e&u.B,v=e&u.W,b=p?r:r[t]||(r[t]={}),E=b[l],_=p?i:m?i[t]:(i[t]||{})[l];for(c in p&&(n=t),n)d=!f&&_&&void 0!==_[c],d&&a(b,c)||(h=d?_[c]:n[c],b[c]=p&&"function"!=typeof _[c]?n[c]:y&&d?o(h,i):v&&_[c]==h?function(e){var t=function(t,n,i){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,i)}return e.apply(this,arguments)};return t[l]=e[l],t}(h):g&&"function"==typeof h?o(Function.call,h):h,g&&((b.virtual||(b.virtual={}))[c]=h,e&u.R&&E&&!E[c]&&s(E,c,h)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},6821:function(e,t,n){var i=n("626a"),r=n("be13");e.exports=function(e){return i(r(e))}},"69a8":function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},"6a99":function(e,t,n){var i=n("d3f4");e.exports=function(e,t){if(!i(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!i(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},7333:function(e,t,n){"use strict";var i=n("0d58"),r=n("2621"),o=n("52a7"),s=n("4bf8"),a=n("626a"),l=Object.assign;e.exports=!l||n("79e5")(function(){var e={},t={},n=Symbol(),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach(function(e){t[e]=e}),7!=l({},e)[n]||Object.keys(l({},t)).join("")!=i})?function(e,t){var n=s(e),l=arguments.length,u=1,c=r.f,d=o.f;while(l>u){var h,f=a(arguments[u++]),p=c?i(f).concat(c(f)):i(f),m=p.length,g=0;while(m>g)d.call(f,h=p[g++])&&(n[h]=f[h])}return n}:l},7514:function(e,t,n){"use strict";var i=n("5ca1"),r=n("0a49")(5),o="find",s=!0;o in[]&&Array(1)[o](function(){s=!1}),i(i.P+i.F*s,"Array",{find:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(o)},7726:function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},"77f1":function(e,t,n){var i=n("4588"),r=Math.max,o=Math.min;e.exports=function(e,t){return e=i(e),e<0?r(e+t,0):o(e,t)}},"794b":function(e,t,n){e.exports=!n("8e60")&&!n("294c")(function(){return 7!=Object.defineProperty(n("1ec9")("div"),"a",{get:function(){return 7}}).a})},"79aa":function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},"79e5":function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},"7a56":function(e,t,n){"use strict";var i=n("7726"),r=n("86cc"),o=n("9e1e"),s=n("2b4c")("species");e.exports=function(e){var t=i[e];o&&t&&!t[s]&&r.f(t,s,{configurable:!0,get:function(){return this}})}},"7be7":function(e,t,n){n("0a90"),e.exports=n("584a").parseFloat},"7f20":function(e,t,n){var i=n("86cc").f,r=n("69a8"),o=n("2b4c")("toStringTag");e.exports=function(e,t,n){e&&!r(e=n?e:e.prototype,o)&&i(e,o,{configurable:!0,value:t})}},"7f7f":function(e,t,n){var i=n("86cc").f,r=Function.prototype,o=/^\s*function ([^ (]*)/,s="name";s in r||n("9e1e")&&i(r,s,{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(e){return""}}})},8079:function(e,t,n){var i=n("7726"),r=n("1991").set,o=i.MutationObserver||i.WebKitMutationObserver,s=i.process,a=i.Promise,l="process"==n("2d95")(s);e.exports=function(){var e,t,n,u=function(){var i,r;l&&(i=s.domain)&&i.exit();while(e){r=e.fn,e=e.next;try{r()}catch(o){throw e?n():t=void 0,o}}t=void 0,i&&i.enter()};if(l)n=function(){s.nextTick(u)};else if(!o||i.navigator&&i.navigator.standalone)if(a&&a.resolve){var c=a.resolve(void 0);n=function(){c.then(u)}}else n=function(){r.call(i,u)};else{var d=!0,h=document.createTextNode("");new o(u).observe(h,{characterData:!0}),n=function(){h.data=d=!d}}return function(i){var r={fn:i,next:void 0};t&&(t.next=r),e||(e=r,n()),t=r}}},8378:function(e,t){var n=e.exports={version:"2.6.5"};"number"==typeof __e&&(__e=n)},"84f2":function(e,t){e.exports={}},"86cc":function(e,t,n){var i=n("cb7c"),r=n("c69a"),o=n("6a99"),s=Object.defineProperty;t.f=n("9e1e")?Object.defineProperty:function(e,t,n){if(i(e),t=o(t,!0),i(n),r)try{return s(e,t,n)}catch(a){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},"8c4f":function(e,t,n){"use strict";
/*!
  * vue-router v3.0.2
  * (c) 2018 Evan You
  * @license MIT
  */function i(e,t){0}function r(e){return Object.prototype.toString.call(e).indexOf("Error")>-1}function o(e,t){for(var n in t)e[n]=t[n];return e}var s={name:"RouterView",functional:!0,props:{name:{type:String,default:"default"}},render:function(e,t){var n=t.props,i=t.children,r=t.parent,s=t.data;s.routerView=!0;var l=r.$createElement,u=n.name,c=r.$route,d=r._routerViewCache||(r._routerViewCache={}),h=0,f=!1;while(r&&r._routerRoot!==r)r.$vnode&&r.$vnode.data.routerView&&h++,r._inactive&&(f=!0),r=r.$parent;if(s.routerViewDepth=h,f)return l(d[u],s,i);var p=c.matched[h];if(!p)return d[u]=null,l();var m=d[u]=p.components[u];s.registerRouteInstance=function(e,t){var n=p.instances[u];(t&&n!==e||!t&&n===e)&&(p.instances[u]=t)},(s.hook||(s.hook={})).prepatch=function(e,t){p.instances[u]=t.componentInstance};var g=s.props=a(c,p.props&&p.props[u]);if(g){g=s.props=o({},g);var y=s.attrs=s.attrs||{};for(var v in g)m.props&&v in m.props||(y[v]=g[v],delete g[v])}return l(m,s,i)}};function a(e,t){switch(typeof t){case"undefined":return;case"object":return t;case"function":return t(e);case"boolean":return t?e.params:void 0;default:0}}var l=/[!'()*]/g,u=function(e){return"%"+e.charCodeAt(0).toString(16)},c=/%2C/g,d=function(e){return encodeURIComponent(e).replace(l,u).replace(c,",")},h=decodeURIComponent;function f(e,t,n){void 0===t&&(t={});var i,r=n||p;try{i=r(e||"")}catch(s){i={}}for(var o in t)i[o]=t[o];return i}function p(e){var t={};return e=e.trim().replace(/^(\?|#|&)/,""),e?(e.split("&").forEach(function(e){var n=e.replace(/\+/g," ").split("="),i=h(n.shift()),r=n.length>0?h(n.join("=")):null;void 0===t[i]?t[i]=r:Array.isArray(t[i])?t[i].push(r):t[i]=[t[i],r]}),t):t}function m(e){var t=e?Object.keys(e).map(function(t){var n=e[t];if(void 0===n)return"";if(null===n)return d(t);if(Array.isArray(n)){var i=[];return n.forEach(function(e){void 0!==e&&(null===e?i.push(d(t)):i.push(d(t)+"="+d(e)))}),i.join("&")}return d(t)+"="+d(n)}).filter(function(e){return e.length>0}).join("&"):null;return t?"?"+t:""}var g=/\/?$/;function y(e,t,n,i){var r=i&&i.options.stringifyQuery,o=t.query||{};try{o=v(o)}catch(a){}var s={name:t.name||e&&e.name,meta:e&&e.meta||{},path:t.path||"/",hash:t.hash||"",query:o,params:t.params||{},fullPath:_(t,r),matched:e?E(e):[]};return n&&(s.redirectedFrom=_(n,r)),Object.freeze(s)}function v(e){if(Array.isArray(e))return e.map(v);if(e&&"object"===typeof e){var t={};for(var n in e)t[n]=v(e[n]);return t}return e}var b=y(null,{path:"/"});function E(e){var t=[];while(e)t.unshift(e),e=e.parent;return t}function _(e,t){var n=e.path,i=e.query;void 0===i&&(i={});var r=e.hash;void 0===r&&(r="");var o=t||m;return(n||"/")+o(i)+r}function x(e,t){return t===b?e===t:!!t&&(e.path&&t.path?e.path.replace(g,"")===t.path.replace(g,"")&&e.hash===t.hash&&T(e.query,t.query):!(!e.name||!t.name)&&(e.name===t.name&&e.hash===t.hash&&T(e.query,t.query)&&T(e.params,t.params)))}function T(e,t){if(void 0===e&&(e={}),void 0===t&&(t={}),!e||!t)return e===t;var n=Object.keys(e),i=Object.keys(t);return n.length===i.length&&n.every(function(n){var i=e[n],r=t[n];return"object"===typeof i&&"object"===typeof r?T(i,r):String(i)===String(r)})}function S(e,t){return 0===e.path.replace(g,"/").indexOf(t.path.replace(g,"/"))&&(!t.hash||e.hash===t.hash)&&w(e.query,t.query)}function w(e,t){for(var n in t)if(!(n in e))return!1;return!0}var I,D=[String,Object],M=[String,Array],A={name:"RouterLink",props:{to:{type:D,required:!0},tag:{type:String,default:"a"},exact:Boolean,append:Boolean,replace:Boolean,activeClass:String,exactActiveClass:String,event:{type:M,default:"click"}},render:function(e){var t=this,n=this.$router,i=this.$route,r=n.resolve(this.to,i,this.append),s=r.location,a=r.route,l=r.href,u={},c=n.options.linkActiveClass,d=n.options.linkExactActiveClass,h=null==c?"router-link-active":c,f=null==d?"router-link-exact-active":d,p=null==this.activeClass?h:this.activeClass,m=null==this.exactActiveClass?f:this.exactActiveClass,g=s.path?y(null,s,null,n):a;u[m]=x(i,g),u[p]=this.exact?u[m]:S(i,g);var v=function(e){L(e)&&(t.replace?n.replace(s):n.push(s))},b={click:L};Array.isArray(this.event)?this.event.forEach(function(e){b[e]=v}):b[this.event]=v;var E={class:u};if("a"===this.tag)E.on=b,E.attrs={href:l};else{var _=R(this.$slots.default);if(_){_.isStatic=!1;var T=_.data=o({},_.data);T.on=b;var w=_.data.attrs=o({},_.data.attrs);w.href=l}else E.on=b}return e(this.tag,E,this.$slots.default)}};function L(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&(void 0===e.button||0===e.button)){if(e.currentTarget&&e.currentTarget.getAttribute){var t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function R(e){if(e)for(var t,n=0;n<e.length;n++){if(t=e[n],"a"===t.tag)return t;if(t.children&&(t=R(t.children)))return t}}function P(e){if(!P.installed||I!==e){P.installed=!0,I=e;var t=function(e){return void 0!==e},n=function(e,n){var i=e.$options._parentVnode;t(i)&&t(i=i.data)&&t(i=i.registerRouteInstance)&&i(e,n)};e.mixin({beforeCreate:function(){t(this.$options.router)?(this._routerRoot=this,this._router=this.$options.router,this._router.init(this),e.util.defineReactive(this,"_route",this._router.history.current)):this._routerRoot=this.$parent&&this.$parent._routerRoot||this,n(this,this)},destroyed:function(){n(this)}}),Object.defineProperty(e.prototype,"$router",{get:function(){return this._routerRoot._router}}),Object.defineProperty(e.prototype,"$route",{get:function(){return this._routerRoot._route}}),e.component("RouterView",s),e.component("RouterLink",A);var i=e.config.optionMergeStrategies;i.beforeRouteEnter=i.beforeRouteLeave=i.beforeRouteUpdate=i.created}}var C="undefined"!==typeof window;function N(e,t,n){var i=e.charAt(0);if("/"===i)return e;if("?"===i||"#"===i)return t+e;var r=t.split("/");n&&r[r.length-1]||r.pop();for(var o=e.replace(/^\//,"").split("/"),s=0;s<o.length;s++){var a=o[s];".."===a?r.pop():"."!==a&&r.push(a)}return""!==r[0]&&r.unshift(""),r.join("/")}function B(e){var t="",n="",i=e.indexOf("#");i>=0&&(t=e.slice(i),e=e.slice(0,i));var r=e.indexOf("?");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{path:e,query:n,hash:t}}function F(e){return e.replace(/\/\//g,"/")}var k=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)},O=ie,U=q,H=z,j=W,V=ne,K=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function q(e,t){var n,i=[],r=0,o=0,s="",a=t&&t.delimiter||"/";while(null!=(n=K.exec(e))){var l=n[0],u=n[1],c=n.index;if(s+=e.slice(o,c),o=c+l.length,u)s+=u[1];else{var d=e[o],h=n[2],f=n[3],p=n[4],m=n[5],g=n[6],y=n[7];s&&(i.push(s),s="");var v=null!=h&&null!=d&&d!==h,b="+"===g||"*"===g,E="?"===g||"*"===g,_=n[2]||a,x=p||m;i.push({name:f||r++,prefix:h||"",delimiter:_,optional:E,repeat:b,partial:v,asterisk:!!y,pattern:x?X(x):y?".*":"[^"+G(_)+"]+?"})}}return o<e.length&&(s+=e.substr(o)),s&&i.push(s),i}function z(e,t){return W(q(e,t))}function Y(e){return encodeURI(e).replace(/[\/?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function $(e){return encodeURI(e).replace(/[?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function W(e){for(var t=new Array(e.length),n=0;n<e.length;n++)"object"===typeof e[n]&&(t[n]=new RegExp("^(?:"+e[n].pattern+")$"));return function(n,i){for(var r="",o=n||{},s=i||{},a=s.pretty?Y:encodeURIComponent,l=0;l<e.length;l++){var u=e[l];if("string"!==typeof u){var c,d=o[u.name];if(null==d){if(u.optional){u.partial&&(r+=u.prefix);continue}throw new TypeError('Expected "'+u.name+'" to be defined')}if(k(d)){if(!u.repeat)throw new TypeError('Expected "'+u.name+'" to not repeat, but received `'+JSON.stringify(d)+"`");if(0===d.length){if(u.optional)continue;throw new TypeError('Expected "'+u.name+'" to not be empty')}for(var h=0;h<d.length;h++){if(c=a(d[h]),!t[l].test(c))throw new TypeError('Expected all "'+u.name+'" to match "'+u.pattern+'", but received `'+JSON.stringify(c)+"`");r+=(0===h?u.prefix:u.delimiter)+c}}else{if(c=u.asterisk?$(d):a(d),!t[l].test(c))throw new TypeError('Expected "'+u.name+'" to match "'+u.pattern+'", but received "'+c+'"');r+=u.prefix+c}}else r+=u}return r}}function G(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function X(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function Q(e,t){return e.keys=t,e}function J(e){return e.sensitive?"":"i"}function Z(e,t){var n=e.source.match(/\((?!\?)/g);if(n)for(var i=0;i<n.length;i++)t.push({name:i,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return Q(e,t)}function ee(e,t,n){for(var i=[],r=0;r<e.length;r++)i.push(ie(e[r],t,n).source);var o=new RegExp("(?:"+i.join("|")+")",J(n));return Q(o,t)}function te(e,t,n){return ne(q(e,n),t,n)}function ne(e,t,n){k(t)||(n=t||n,t=[]),n=n||{};for(var i=n.strict,r=!1!==n.end,o="",s=0;s<e.length;s++){var a=e[s];if("string"===typeof a)o+=G(a);else{var l=G(a.prefix),u="(?:"+a.pattern+")";t.push(a),a.repeat&&(u+="(?:"+l+u+")*"),u=a.optional?a.partial?l+"("+u+")?":"(?:"+l+"("+u+"))?":l+"("+u+")",o+=u}}var c=G(n.delimiter||"/"),d=o.slice(-c.length)===c;return i||(o=(d?o.slice(0,-c.length):o)+"(?:"+c+"(?=$))?"),o+=r?"$":i&&d?"":"(?="+c+"|$)",Q(new RegExp("^"+o,J(n)),t)}function ie(e,t,n){return k(t)||(n=t||n,t=[]),n=n||{},e instanceof RegExp?Z(e,t):k(e)?ee(e,t,n):te(e,t,n)}O.parse=U,O.compile=H,O.tokensToFunction=j,O.tokensToRegExp=V;var re=Object.create(null);function oe(e,t,n){try{var i=re[e]||(re[e]=O.compile(e));return i(t||{},{pretty:!0})}catch(r){return""}}function se(e,t,n,i){var r=t||[],o=n||Object.create(null),s=i||Object.create(null);e.forEach(function(e){ae(r,o,s,e)});for(var a=0,l=r.length;a<l;a++)"*"===r[a]&&(r.push(r.splice(a,1)[0]),l--,a--);return{pathList:r,pathMap:o,nameMap:s}}function ae(e,t,n,i,r,o){var s=i.path,a=i.name;var l=i.pathToRegexpOptions||{},u=ue(s,r,l.strict);"boolean"===typeof i.caseSensitive&&(l.sensitive=i.caseSensitive);var c={path:u,regex:le(u,l),components:i.components||{default:i.component},instances:{},name:a,parent:r,matchAs:o,redirect:i.redirect,beforeEnter:i.beforeEnter,meta:i.meta||{},props:null==i.props?{}:i.components?i.props:{default:i.props}};if(i.children&&i.children.forEach(function(i){var r=o?F(o+"/"+i.path):void 0;ae(e,t,n,i,c,r)}),void 0!==i.alias){var d=Array.isArray(i.alias)?i.alias:[i.alias];d.forEach(function(o){var s={path:o,children:i.children};ae(e,t,n,s,r,c.path||"/")})}t[c.path]||(e.push(c.path),t[c.path]=c),a&&(n[a]||(n[a]=c))}function le(e,t){var n=O(e,[],t);return n}function ue(e,t,n){return n||(e=e.replace(/\/$/,"")),"/"===e[0]?e:null==t?e:F(t.path+"/"+e)}function ce(e,t,n,i){var r="string"===typeof e?{path:e}:e;if(r.name||r._normalized)return r;if(!r.path&&r.params&&t){r=o({},r),r._normalized=!0;var s=o(o({},t.params),r.params);if(t.name)r.name=t.name,r.params=s;else if(t.matched.length){var a=t.matched[t.matched.length-1].path;r.path=oe(a,s,"path "+t.path)}else 0;return r}var l=B(r.path||""),u=t&&t.path||"/",c=l.path?N(l.path,u,n||r.append):u,d=f(l.query,r.query,i&&i.options.parseQuery),h=r.hash||l.hash;return h&&"#"!==h.charAt(0)&&(h="#"+h),{_normalized:!0,path:c,query:d,hash:h}}function de(e,t){var n=se(e),i=n.pathList,r=n.pathMap,o=n.nameMap;function s(e){se(e,i,r,o)}function a(e,n,s){var a=ce(e,n,!1,t),l=a.name;if(l){var u=o[l];if(!u)return c(null,a);var d=u.regex.keys.filter(function(e){return!e.optional}).map(function(e){return e.name});if("object"!==typeof a.params&&(a.params={}),n&&"object"===typeof n.params)for(var h in n.params)!(h in a.params)&&d.indexOf(h)>-1&&(a.params[h]=n.params[h]);if(u)return a.path=oe(u.path,a.params,'named route "'+l+'"'),c(u,a,s)}else if(a.path){a.params={};for(var f=0;f<i.length;f++){var p=i[f],m=r[p];if(he(m.regex,a.path,a.params))return c(m,a,s)}}return c(null,a)}function l(e,n){var i=e.redirect,r="function"===typeof i?i(y(e,n,null,t)):i;if("string"===typeof r&&(r={path:r}),!r||"object"!==typeof r)return c(null,n);var s=r,l=s.name,u=s.path,d=n.query,h=n.hash,f=n.params;if(d=s.hasOwnProperty("query")?s.query:d,h=s.hasOwnProperty("hash")?s.hash:h,f=s.hasOwnProperty("params")?s.params:f,l){o[l];return a({_normalized:!0,name:l,query:d,hash:h,params:f},void 0,n)}if(u){var p=fe(u,e),m=oe(p,f,'redirect route with path "'+p+'"');return a({_normalized:!0,path:m,query:d,hash:h},void 0,n)}return c(null,n)}function u(e,t,n){var i=oe(n,t.params,'aliased route with path "'+n+'"'),r=a({_normalized:!0,path:i});if(r){var o=r.matched,s=o[o.length-1];return t.params=r.params,c(s,t)}return c(null,t)}function c(e,n,i){return e&&e.redirect?l(e,i||n):e&&e.matchAs?u(e,n,e.matchAs):y(e,n,i,t)}return{match:a,addRoutes:s}}function he(e,t,n){var i=t.match(e);if(!i)return!1;if(!n)return!0;for(var r=1,o=i.length;r<o;++r){var s=e.keys[r-1],a="string"===typeof i[r]?decodeURIComponent(i[r]):i[r];s&&(n[s.name||"pathMatch"]=a)}return!0}function fe(e,t){return N(e,t.parent?t.parent.path:"/",!0)}var pe=Object.create(null);function me(){window.history.replaceState({key:Ae()},"",window.location.href.replace(window.location.origin,"")),window.addEventListener("popstate",function(e){ye(),e.state&&e.state.key&&Le(e.state.key)})}function ge(e,t,n,i){if(e.app){var r=e.options.scrollBehavior;r&&e.app.$nextTick(function(){var o=ve(),s=r.call(e,t,n,i?o:null);s&&("function"===typeof s.then?s.then(function(e){Se(e,o)}).catch(function(e){0}):Se(s,o))})}}function ye(){var e=Ae();e&&(pe[e]={x:window.pageXOffset,y:window.pageYOffset})}function ve(){var e=Ae();if(e)return pe[e]}function be(e,t){var n=document.documentElement,i=n.getBoundingClientRect(),r=e.getBoundingClientRect();return{x:r.left-i.left-t.x,y:r.top-i.top-t.y}}function Ee(e){return Te(e.x)||Te(e.y)}function _e(e){return{x:Te(e.x)?e.x:window.pageXOffset,y:Te(e.y)?e.y:window.pageYOffset}}function xe(e){return{x:Te(e.x)?e.x:0,y:Te(e.y)?e.y:0}}function Te(e){return"number"===typeof e}function Se(e,t){var n="object"===typeof e;if(n&&"string"===typeof e.selector){var i=document.querySelector(e.selector);if(i){var r=e.offset&&"object"===typeof e.offset?e.offset:{};r=xe(r),t=be(i,r)}else Ee(e)&&(t=_e(e))}else n&&Ee(e)&&(t=_e(e));t&&window.scrollTo(t.x,t.y)}var we=C&&function(){var e=window.navigator.userAgent;return(-1===e.indexOf("Android 2.")&&-1===e.indexOf("Android 4.0")||-1===e.indexOf("Mobile Safari")||-1!==e.indexOf("Chrome")||-1!==e.indexOf("Windows Phone"))&&(window.history&&"pushState"in window.history)}(),Ie=C&&window.performance&&window.performance.now?window.performance:Date,De=Me();function Me(){return Ie.now().toFixed(3)}function Ae(){return De}function Le(e){De=e}function Re(e,t){ye();var n=window.history;try{t?n.replaceState({key:De},"",e):(De=Me(),n.pushState({key:De},"",e))}catch(i){window.location[t?"replace":"assign"](e)}}function Pe(e){Re(e,!0)}function Ce(e,t,n){var i=function(r){r>=e.length?n():e[r]?t(e[r],function(){i(r+1)}):i(r+1)};i(0)}function Ne(e){return function(t,n,i){var o=!1,s=0,a=null;Be(e,function(e,t,n,l){if("function"===typeof e&&void 0===e.cid){o=!0,s++;var u,c=Ue(function(t){Oe(t)&&(t=t.default),e.resolved="function"===typeof t?t:I.extend(t),n.components[l]=t,s--,s<=0&&i()}),d=Ue(function(e){var t="Failed to resolve async component "+l+": "+e;a||(a=r(e)?e:new Error(t),i(a))});try{u=e(c,d)}catch(f){d(f)}if(u)if("function"===typeof u.then)u.then(c,d);else{var h=u.component;h&&"function"===typeof h.then&&h.then(c,d)}}}),o||i()}}function Be(e,t){return Fe(e.map(function(e){return Object.keys(e.components).map(function(n){return t(e.components[n],e.instances[n],e,n)})}))}function Fe(e){return Array.prototype.concat.apply([],e)}var ke="function"===typeof Symbol&&"symbol"===typeof Symbol.toStringTag;function Oe(e){return e.__esModule||ke&&"Module"===e[Symbol.toStringTag]}function Ue(e){var t=!1;return function(){var n=[],i=arguments.length;while(i--)n[i]=arguments[i];if(!t)return t=!0,e.apply(this,n)}}var He=function(e,t){this.router=e,this.base=je(t),this.current=b,this.pending=null,this.ready=!1,this.readyCbs=[],this.readyErrorCbs=[],this.errorCbs=[]};function je(e){if(!e)if(C){var t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^https?:\/\/[^\/]+/,"")}else e="/";return"/"!==e.charAt(0)&&(e="/"+e),e.replace(/\/$/,"")}function Ve(e,t){var n,i=Math.max(e.length,t.length);for(n=0;n<i;n++)if(e[n]!==t[n])break;return{updated:t.slice(0,n),activated:t.slice(n),deactivated:e.slice(n)}}function Ke(e,t,n,i){var r=Be(e,function(e,i,r,o){var s=qe(e,t);if(s)return Array.isArray(s)?s.map(function(e){return n(e,i,r,o)}):n(s,i,r,o)});return Fe(i?r.reverse():r)}function qe(e,t){return"function"!==typeof e&&(e=I.extend(e)),e.options[t]}function ze(e){return Ke(e,"beforeRouteLeave",$e,!0)}function Ye(e){return Ke(e,"beforeRouteUpdate",$e)}function $e(e,t){if(t)return function(){return e.apply(t,arguments)}}function We(e,t,n){return Ke(e,"beforeRouteEnter",function(e,i,r,o){return Ge(e,r,o,t,n)})}function Ge(e,t,n,i,r){return function(o,s,a){return e(o,s,function(e){a(e),"function"===typeof e&&i.push(function(){Xe(e,t.instances,n,r)})})}}function Xe(e,t,n,i){t[n]&&!t[n]._isBeingDestroyed?e(t[n]):i()&&setTimeout(function(){Xe(e,t,n,i)},16)}He.prototype.listen=function(e){this.cb=e},He.prototype.onReady=function(e,t){this.ready?e():(this.readyCbs.push(e),t&&this.readyErrorCbs.push(t))},He.prototype.onError=function(e){this.errorCbs.push(e)},He.prototype.transitionTo=function(e,t,n){var i=this,r=this.router.match(e,this.current);this.confirmTransition(r,function(){i.updateRoute(r),t&&t(r),i.ensureURL(),i.ready||(i.ready=!0,i.readyCbs.forEach(function(e){e(r)}))},function(e){n&&n(e),e&&!i.ready&&(i.ready=!0,i.readyErrorCbs.forEach(function(t){t(e)}))})},He.prototype.confirmTransition=function(e,t,n){var o=this,s=this.current,a=function(e){r(e)&&(o.errorCbs.length?o.errorCbs.forEach(function(t){t(e)}):(i(!1,"uncaught error during route navigation:"),console.error(e))),n&&n(e)};if(x(e,s)&&e.matched.length===s.matched.length)return this.ensureURL(),a();var l=Ve(this.current.matched,e.matched),u=l.updated,c=l.deactivated,d=l.activated,h=[].concat(ze(c),this.router.beforeHooks,Ye(u),d.map(function(e){return e.beforeEnter}),Ne(d));this.pending=e;var f=function(t,n){if(o.pending!==e)return a();try{t(e,s,function(e){!1===e||r(e)?(o.ensureURL(!0),a(e)):"string"===typeof e||"object"===typeof e&&("string"===typeof e.path||"string"===typeof e.name)?(a(),"object"===typeof e&&e.replace?o.replace(e):o.push(e)):n(e)})}catch(i){a(i)}};Ce(h,f,function(){var n=[],i=function(){return o.current===e},r=We(d,n,i),s=r.concat(o.router.resolveHooks);Ce(s,f,function(){if(o.pending!==e)return a();o.pending=null,t(e),o.router.app&&o.router.app.$nextTick(function(){n.forEach(function(e){e()})})})})},He.prototype.updateRoute=function(e){var t=this.current;this.current=e,this.cb&&this.cb(e),this.router.afterHooks.forEach(function(n){n&&n(e,t)})};var Qe=function(e){function t(t,n){var i=this;e.call(this,t,n);var r=t.options.scrollBehavior,o=we&&r;o&&me();var s=Je(this.base);window.addEventListener("popstate",function(e){var n=i.current,r=Je(i.base);i.current===b&&r===s||i.transitionTo(r,function(e){o&&ge(t,e,n,!0)})})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.go=function(e){window.history.go(e)},t.prototype.push=function(e,t,n){var i=this,r=this,o=r.current;this.transitionTo(e,function(e){Re(F(i.base+e.fullPath)),ge(i.router,e,o,!1),t&&t(e)},n)},t.prototype.replace=function(e,t,n){var i=this,r=this,o=r.current;this.transitionTo(e,function(e){Pe(F(i.base+e.fullPath)),ge(i.router,e,o,!1),t&&t(e)},n)},t.prototype.ensureURL=function(e){if(Je(this.base)!==this.current.fullPath){var t=F(this.base+this.current.fullPath);e?Re(t):Pe(t)}},t.prototype.getCurrentLocation=function(){return Je(this.base)},t}(He);function Je(e){var t=decodeURI(window.location.pathname);return e&&0===t.indexOf(e)&&(t=t.slice(e.length)),(t||"/")+window.location.search+window.location.hash}var Ze=function(e){function t(t,n,i){e.call(this,t,n),i&&et(this.base)||tt()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.setupListeners=function(){var e=this,t=this.router,n=t.options.scrollBehavior,i=we&&n;i&&me(),window.addEventListener(we?"popstate":"hashchange",function(){var t=e.current;tt()&&e.transitionTo(nt(),function(n){i&&ge(e.router,n,t,!0),we||ot(n.fullPath)})})},t.prototype.push=function(e,t,n){var i=this,r=this,o=r.current;this.transitionTo(e,function(e){rt(e.fullPath),ge(i.router,e,o,!1),t&&t(e)},n)},t.prototype.replace=function(e,t,n){var i=this,r=this,o=r.current;this.transitionTo(e,function(e){ot(e.fullPath),ge(i.router,e,o,!1),t&&t(e)},n)},t.prototype.go=function(e){window.history.go(e)},t.prototype.ensureURL=function(e){var t=this.current.fullPath;nt()!==t&&(e?rt(t):ot(t))},t.prototype.getCurrentLocation=function(){return nt()},t}(He);function et(e){var t=Je(e);if(!/^\/#/.test(t))return window.location.replace(F(e+"/#"+t)),!0}function tt(){var e=nt();return"/"===e.charAt(0)||(ot("/"+e),!1)}function nt(){var e=window.location.href,t=e.indexOf("#");return-1===t?"":decodeURI(e.slice(t+1))}function it(e){var t=window.location.href,n=t.indexOf("#"),i=n>=0?t.slice(0,n):t;return i+"#"+e}function rt(e){we?Re(it(e)):window.location.hash=e}function ot(e){we?Pe(it(e)):window.location.replace(it(e))}var st=function(e){function t(t,n){e.call(this,t,n),this.stack=[],this.index=-1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.push=function(e,t,n){var i=this;this.transitionTo(e,function(e){i.stack=i.stack.slice(0,i.index+1).concat(e),i.index++,t&&t(e)},n)},t.prototype.replace=function(e,t,n){var i=this;this.transitionTo(e,function(e){i.stack=i.stack.slice(0,i.index).concat(e),t&&t(e)},n)},t.prototype.go=function(e){var t=this,n=this.index+e;if(!(n<0||n>=this.stack.length)){var i=this.stack[n];this.confirmTransition(i,function(){t.index=n,t.updateRoute(i)})}},t.prototype.getCurrentLocation=function(){var e=this.stack[this.stack.length-1];return e?e.fullPath:"/"},t.prototype.ensureURL=function(){},t}(He),at=function(e){void 0===e&&(e={}),this.app=null,this.apps=[],this.options=e,this.beforeHooks=[],this.resolveHooks=[],this.afterHooks=[],this.matcher=de(e.routes||[],this);var t=e.mode||"hash";switch(this.fallback="history"===t&&!we&&!1!==e.fallback,this.fallback&&(t="hash"),C||(t="abstract"),this.mode=t,t){case"history":this.history=new Qe(this,e.base);break;case"hash":this.history=new Ze(this,e.base,this.fallback);break;case"abstract":this.history=new st(this,e.base);break;default:0}},lt={currentRoute:{configurable:!0}};function ut(e,t){return e.push(t),function(){var n=e.indexOf(t);n>-1&&e.splice(n,1)}}function ct(e,t,n){var i="hash"===n?"#"+t:t;return e?F(e+"/"+i):i}at.prototype.match=function(e,t,n){return this.matcher.match(e,t,n)},lt.currentRoute.get=function(){return this.history&&this.history.current},at.prototype.init=function(e){var t=this;if(this.apps.push(e),!this.app){this.app=e;var n=this.history;if(n instanceof Qe)n.transitionTo(n.getCurrentLocation());else if(n instanceof Ze){var i=function(){n.setupListeners()};n.transitionTo(n.getCurrentLocation(),i,i)}n.listen(function(e){t.apps.forEach(function(t){t._route=e})})}},at.prototype.beforeEach=function(e){return ut(this.beforeHooks,e)},at.prototype.beforeResolve=function(e){return ut(this.resolveHooks,e)},at.prototype.afterEach=function(e){return ut(this.afterHooks,e)},at.prototype.onReady=function(e,t){this.history.onReady(e,t)},at.prototype.onError=function(e){this.history.onError(e)},at.prototype.push=function(e,t,n){this.history.push(e,t,n)},at.prototype.replace=function(e,t,n){this.history.replace(e,t,n)},at.prototype.go=function(e){this.history.go(e)},at.prototype.back=function(){this.go(-1)},at.prototype.forward=function(){this.go(1)},at.prototype.getMatchedComponents=function(e){var t=e?e.matched?e:this.resolve(e).route:this.currentRoute;return t?[].concat.apply([],t.matched.map(function(e){return Object.keys(e.components).map(function(t){return e.components[t]})})):[]},at.prototype.resolve=function(e,t,n){var i=ce(e,t||this.history.current,n,this),r=this.match(i,t),o=r.redirectedFrom||r.fullPath,s=this.history.base,a=ct(s,o,this.mode);return{location:i,route:r,href:a,normalizedTo:i,resolved:r}},at.prototype.addRoutes=function(e){this.matcher.addRoutes(e),this.history.current!==b&&this.history.transitionTo(this.history.getCurrentLocation())},Object.defineProperties(at.prototype,lt),at.install=P,at.version="3.0.2",C&&window.Vue&&window.Vue.use(at),t["a"]=at},"8e60":function(e,t,n){e.exports=!n("294c")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},"9b43":function(e,t,n){var i=n("d8e8");e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)}}return function(){return e.apply(t,arguments)}}},"9c6c":function(e,t,n){var i=n("2b4c")("unscopables"),r=Array.prototype;void 0==r[i]&&n("32e9")(r,i,{}),e.exports=function(e){r[i][e]=!0}},"9c80":function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(t){return{e:!0,v:t}}}},"9def":function(e,t,n){var i=n("4588"),r=Math.min;e.exports=function(e){return e>0?r(i(e),9007199254740991):0}},"9e1e":function(e,t,n){e.exports=!n("79e5")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},a1ce:function(e,t,n){var i=n("63b6"),r=n("25eb"),o=n("294c"),s=n("e692"),a="["+s+"]",l="",u=RegExp("^"+a+a+"*"),c=RegExp(a+a+"*$"),d=function(e,t,n){var r={},a=o(function(){return!!s[e]()||l[e]()!=l}),u=r[e]=a?t(h):s[e];n&&(r[n]=u),i(i.P+i.F*a,"String",r)},h=d.trim=function(e,t){return e=String(r(e)),1&t&&(e=e.replace(u,"")),2&t&&(e=e.replace(c,"")),e};e.exports=d},a21f:function(e,t,n){var i=n("584a"),r=i.JSON||(i.JSON={stringify:JSON.stringify});e.exports=function(e){return r.stringify.apply(r,arguments)}},a25f:function(e,t,n){var i=n("7726"),r=i.navigator;e.exports=r&&r.userAgent||""},a5b8:function(e,t,n){"use strict";var i=n("d8e8");function r(e){var t,n;this.promise=new e(function(e,i){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=i}),this.resolve=i(t),this.reject=i(n)}e.exports.f=function(e){return new r(e)}},ac6a:function(e,t,n){for(var i=n("cadf"),r=n("0d58"),o=n("2aba"),s=n("7726"),a=n("32e9"),l=n("84f2"),u=n("2b4c"),c=u("iterator"),d=u("toStringTag"),h=l.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=r(f),m=0;m<p.length;m++){var g,y=p[m],v=f[y],b=s[y],E=b&&b.prototype;if(E&&(E[c]||a(E,c,h),E[d]||a(E,d,y),l[y]=h,v))for(g in i)E[g]||o(E,g,i[g],!0)}},aebd:function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},bcaa:function(e,t,n){var i=n("cb7c"),r=n("d3f4"),o=n("a5b8");e.exports=function(e,t){if(i(e),r(t)&&t.constructor===e)return t;var n=o.f(e),s=n.resolve;return s(t),n.promise}},be13:function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},c366:function(e,t,n){var i=n("6821"),r=n("9def"),o=n("77f1");e.exports=function(e){return function(t,n,s){var a,l=i(t),u=r(l.length),c=o(s,u);if(e&&n!=n){while(u>c)if(a=l[c++],a!=a)return!0}else for(;u>c;c++)if((e||c in l)&&l[c]===n)return e||c||0;return!e&&-1}}},c69a:function(e,t,n){e.exports=!n("9e1e")&&!n("79e5")(function(){return 7!=Object.defineProperty(n("230e")("div"),"a",{get:function(){return 7}}).a})},c8ba:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(i){"object"===typeof window&&(n=window)}e.exports=n},ca5a:function(e,t){var n=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+i).toString(36))}},cadf:function(e,t,n){"use strict";var i=n("9c6c"),r=n("d53b"),o=n("84f2"),s=n("6821");e.exports=n("01f9")(Array,"Array",function(e,t){this._t=s(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,r(1)):r(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},cb7c:function(e,t,n){var i=n("d3f4");e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},cd1c:function(e,t,n){var i=n("e853");e.exports=function(e,t){return new(i(e))(t)}},ce10:function(e,t,n){var i=n("69a8"),r=n("6821"),o=n("c366")(!1),s=n("613b")("IE_PROTO");e.exports=function(e,t){var n,a=r(e),l=0,u=[];for(n in a)n!=s&&i(a,n)&&u.push(n);while(t.length>l)i(a,n=t[l++])&&(~o(u,n)||u.push(n));return u}},d3f4:function(e,t){e.exports=function(e){return"object"===typeof e?null!==e:"function"===typeof e}},d53b:function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},d864:function(e,t,n){var i=n("79aa");e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)}}return function(){return e.apply(t,arguments)}}},d8e8:function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},d9f6:function(e,t,n){var i=n("e4ae"),r=n("794b"),o=n("1bc3"),s=Object.defineProperty;t.f=n("8e60")?Object.defineProperty:function(e,t,n){if(i(e),t=o(t,!0),i(n),r)try{return s(e,t,n)}catch(a){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},dcbc:function(e,t,n){var i=n("2aba");e.exports=function(e,t,n){for(var r in t)i(e,r,t[r],n);return e}},df7c:function(e,t,n){(function(e){function n(e,t){for(var n=0,i=e.length-1;i>=0;i--){var r=e[i];"."===r?e.splice(i,1):".."===r?(e.splice(i,1),n++):n&&(e.splice(i,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,r=function(e){return i.exec(e).slice(1)};function o(e,t){if(e.filter)return e.filter(t);for(var n=[],i=0;i<e.length;i++)t(e[i],i,e)&&n.push(e[i]);return n}t.resolve=function(){for(var t="",i=!1,r=arguments.length-1;r>=-1&&!i;r--){var s=r>=0?arguments[r]:e.cwd();if("string"!==typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(t=s+"/"+t,i="/"===s.charAt(0))}return t=n(o(t.split("/"),function(e){return!!e}),!i).join("/"),(i?"/":"")+t||"."},t.normalize=function(e){var i=t.isAbsolute(e),r="/"===s(e,-1);return e=n(o(e.split("/"),function(e){return!!e}),!i).join("/"),e||i||(e="."),e&&r&&(e+="/"),(i?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(o(e,function(e,t){if("string"!==typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,n){function i(e){for(var t=0;t<e.length;t++)if(""!==e[t])break;for(var n=e.length-1;n>=0;n--)if(""!==e[n])break;return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var r=i(e.split("/")),o=i(n.split("/")),s=Math.min(r.length,o.length),a=s,l=0;l<s;l++)if(r[l]!==o[l]){a=l;break}var u=[];for(l=a;l<r.length;l++)u.push("..");return u=u.concat(o.slice(a)),u.join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){var t=r(e),n=t[0],i=t[1];return n||i?(i&&(i=i.substr(0,i.length-1)),n+i):"."},t.basename=function(e,t){var n=r(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){return r(e)[3]};var s="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,n("4362"))},e11e:function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},e4ae:function(e,t,n){var i=n("f772");e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},e53d:function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},e692:function(e,t){e.exports="\t\n\v\f\r \u2028\u2029\ufeff"},e853:function(e,t,n){var i=n("d3f4"),r=n("1169"),o=n("2b4c")("species");e.exports=function(e){var t;return r(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!r(t.prototype)||(t=void 0),i(t)&&(t=t[o],null===t&&(t=void 0))),void 0===t?Array:t}},ebd6:function(e,t,n){var i=n("cb7c"),r=n("d8e8"),o=n("2b4c")("species");e.exports=function(e,t){var n,s=i(e).constructor;return void 0===s||void 0==(n=i(s)[o])?t:r(n)}},f499:function(e,t,n){e.exports=n("a21f")},f605:function(e,t){e.exports=function(e,t,n,i){if(!(e instanceof t)||void 0!==i&&i in e)throw TypeError(n+": incorrect invocation!");return e}},f751:function(e,t,n){var i=n("5ca1");i(i.S+i.F,"Object",{assign:n("7333")})},f772:function(e,t){e.exports=function(e){return"object"===typeof e?null!==e:"function"===typeof e}},fa5b:function(e,t,n){e.exports=n("5537")("native-function-to-string",Function.toString)},fab2:function(e,t,n){var i=n("7726").document;e.exports=i&&i.documentElement}}]);
//# sourceMappingURL=chunk-vendors.fd8f057b.js.map